!function(y,b,p){"use strict";function j(V,w){if("function"!=typeof w&&null!==w)throw new TypeError("Super expression must either be null or a function");V.prototype=b.create(w&&w.prototype,{constructor:{value:V,writable:!0,configurable:!0}}),w&&Ul(V,w)}function v(g){var L=b.prototype.toString.call(g);return"Array]"===L.substring(L.length-6)}function V(e,u,p,Z,m,U){u=u||[],p=p||[],Z=Z||[];try{u.push(e);var L=Function.apply(0,u);return p[p.length]="return "+L,Function.apply(0,p).apply(0,Z)}catch(g){return U&&U(g),m}}function L(w){var V={};return{get:function(L){if(V[L]!==p)return V[L];var v;switch(L){case"WEBGL_depth_texture":v=w.getExtension("WEBGL_depth_texture")||w.getExtension("MOZ_WEBGL_depth_texture")||w.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":v=w.getExtension("EXT_texture_filter_anisotropic")||w.getExtension("MOZ_EXT_texture_filter_anisotropic")||w.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":v=w.getExtension("WEBGL_compressed_texture_s3tc")||w.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":v=w.getExtension("WEBGL_compressed_texture_pvrtc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":v=w.getExtension("WEBGL_compressed_texture_etc1");break;default:v=w.getExtension(L)}return V[L]=v,v}}}function C(f,M,s){function l(){if(r!==p)return r;var x=M.get("EXT_texture_filter_anisotropic");return r=null!==x?f.getParameter(x.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function A($){if("highp"===$){if(f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).precision>0&&f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).precision>0)return"highp";$="mediump"}return"mediump"===$&&f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).precision>0&&f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var r;s=s||{};var q="undefined"!=typeof WebGL2RenderingContext&&f instanceof WebGL2RenderingContext,c=s.precision!==p?s.precision:"highp",j=A(c);j!==c&&(console.warn("WebGL:",c,"not supported, using",j,"instead."),c=j);var H=s.logarithmicDepthBuffer===!0,W=f.getParameter(f.MAX_TEXTURE_IMAGE_UNITS),i=f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS),e=f.getParameter(f.MAX_TEXTURE_SIZE),K=f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE),a=f.getParameter(f.MAX_VERTEX_ATTRIBS),P=f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS),I=f.getParameter(f.MAX_VARYING_VECTORS),g=f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS),k=i>0,E=q||!!M.get("OES_texture_float"),J=(q||!!M.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,x=k&&E,d=q?f.getParameter(f.MAX_SAMPLES):0;return{getMaxAnisotropy:l,getMaxPrecision:A,precision:c,logarithmicDepthBuffer:H,maxTextures:W,maxVertexTextures:i,maxTextureSize:e,maxCubemapSize:K,maxAttributes:a,maxVertexUniforms:P,maxVaryings:I,maxFragmentUniforms:g,vertexTextures:k,floatFragmentTextures:E,elementTypeUint:J,floatVertexTextures:x,maxSamples:d}}function k(n,o){return n.z!==o.z?o.z-n.z:n.id-o.id}var K="ht";if(!y[K]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),y.performance&&y.performance.now||function(){var R=Date.now();y.performance||(y.performance={}),y.performance.now=function(){return Date.now()-R}}();for(var V=Date.now(),F=16,S=["ms","moz","webkit","o"],W=0;W<S.length&&!y.requestAnimationFrame;++W)y.requestAnimationFrame=y[S[W]+"RequestAnimationFrame"],y.cancelAnimationFrame=y[S[W]+"CancelAnimationFrame"]||y[S[W]+"CancelRequestAnimationFrame"];y.requestAnimationFrame||(y.requestAnimationFrame=function(q){var D=Date.now(),m=F+V-D;return 0>m&&(m=0),V=D,y.setTimeout(function(){V=Date.now(),q(performance.now())},m)}),y.cancelAnimationFrame||(y.cancelAnimationFrame=function(e){return y.clearTimeout(e)}),b.assign===p&&(b.assign=function(e){if(e===p||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var N=b(e),V=1;V<arguments.length;V++){var J=arguments[V];if(J!==p&&null!==J)for(var n in J)b.prototype.hasOwnProperty.call(J,n)&&(N[n]=J[n])}return N}),y.btoa===p&&(y.btoa=function(M){for(var T,g,b=String(M),N=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",V="";b.charAt(0|N)||(l="=",N%1);V+=l.charAt(63&T>>8-8*(N%1))){if(g=b.charCodeAt(N+=.75),g>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");T=T<<8|g}return V})}();var H,h,Q,Y,D=y.location,i=D&&y.document,X=null,Z=p,S=y[K]={},_=y[K+"config"],E=S.Default=_&&_.Default||{},G=S.Style=_&&_.Style||{},J=S.Attr=_&&_.Attr||{},g=function(){return!0},U=function(){return!1},l=function(C){return C},A=function(f){return!f},M=S.Color=_&&_.Color||{},n=S.IsGetter=_&&_.IsGetter||{};!function(){var g=!1;try{var V=b.defineProperty({},"passive",{get:function(){return g=!0,p}});D&&(Q=H=D)&&y.addEventListener("test",V,V),D&&(Y=h=D)&&y.removeEventListener("test",V,V)}catch(x){g=!1}E.passiveSupported=g}();var e,R,W,c,w=E.passiveSupported,m=E.eventListenerOptionsFalse=w?{passive:!1,capture:!1}:!1,F=E.eventListenerOptionsTrue=w?{passive:!1,capture:!0}:!0,q=function($,L,E,M){$.addEventListener(L,E,M?F:m)},O=function(B,C,x,Z){B.removeEventListener(C,x,Z?F:m)},u=Math,s=u.round,x=u.floor,I=u.ceil,B=u.sqrt,P=u.max,d=u.min,a=u.abs,t=u.cos,z=u.acos,T=u.sin,N=u.pow,r=u.asin,o=u.exp,f=u.PI,$=2*f,fs=f/2,Bl=u.tan,$g=u.atan2,Zm=u.random,si=u.log,yc=function(A,x,B){return Math.max(x,Math.min(B,A))},xo=N(2,1),kr=!1,js=y.parseInt||global.parseInt,Hq="2021-12-15",cj=D&&(y.navigator?y.navigator.platform.indexOf("Win")>-1:!1),Dr=function(U){return U*U},td=D&&y.setTimeout,zr=D&&y.clearTimeout,Bq=D&&(y.navigator?y.navigator.userAgent.toLowerCase():""),Jj=function(k){return k.test(Bq)},ur=Jj(/msie/),Ao=Jj(/msie/)||Jj(/trident/),hb=Jj(/msie 10/),qm=Jj(/edge/),Ad=Jj(/firefox/),Rc=Jj(/mac/),Ko=Jj(/mscAndroid/),Iq=E.isTouchable===p?cj?!1:i?"ontouchend"in i:!1:E.isTouchable,xr="default",mh="single",No="multiple",Vo="front",ii="back",cq="left",Jo="right",yb="top",jc="bottom",Yn="center",kj="eye",zc="middle",Ce="east",Vg="west",Ij="north",Ui="none",Dp="px",ge="absolute",sk="border",nj="triangle",zo="rect",ed="circle",kc="cylinder",Zi="shape",sf="items",ji="normal",Uc="remove",ef="clear",zm="width",mn="height",gh="ingroup",ws="check",wo="uncheck",Oe="radio",jk="radioOn",_f="radioOff",tk="points",nf="values",Oi="series",se="body",lp="label",_m="label2",Pl="note",Io="note2",ll="icons",ak="labelFont",Eh="labelColor",Lj="labelSelectColor",ym="note.expanded",We="note2.expanded",Cf="edge.expanded",Vi="edge.points",Ug="edge.type",Uh="rotation",Ik="hidden",_c="visible",fr="tuv",ie="no",Th="draw",th="select",rq="currentSubGraph",Jm="selectBackground",cb="autoMakeVisible",Xq="autoHideScrollBar",Gb="scrollBarColor",lh="scrollBarSize",Fl="indent",jb="rowHeight",wl="columnLineColor",tj="rowLineColor",Gj="columnLineVisible",zs="rowLineVisible",Bj="visibleFunc",$p="expandIcon",kp="collapseIcon",Pd="checkMode",vh="sortFunc",cs="editable",Tn="batchEditable",Eg="tristate",ao="asc",oc="desc",rn="position",vq="__",od="elevation",ze="children",Sg="translateX",of="translateY",Zd="dataModel",fi="maxSize",Wq="enc",Ge="state",fp=Wq+"o"+"de",Yp="shape3d",nl="shape3d.resolution",Zj="shape3d.visible",bj="shape3d.from.visible",qg="shape3d.to.visible",wc="shape3d.top.visible",zg="shape3d.bottom.visible",Ep="repeat.uv.length",xk="serializeValue",ho="deserializeValue",ti="centerUniform",Gl="uniform",ac="rgba(255,255,255,0)",Kg="style",Df="attr",ug="field",Fn="string",vj="boolean",Ur="color",Di="int",lg="number",$n="ew-resize",Yk="ns-resize",be="pointer",Or="auto",Cs="mousedown",ss="mousemove",pi="mouseup",Jh="mouseout",Im="touchstart",sj="touchmove",Gk="touchend",hf="keydown",Kq="keyup",wg=["DOMMouseScroll","mousewheel"],Fh=Ad?wg[0]:wg[1],Yl=vq+K+vq+fp,mp=[Im,sj,Gk],uo=[Cs,ss,pi,Jh,Fh,"wheel","mouseenter","mouseleave","mouseover"],oh=[hf,Kq,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],mi=Iq?mp.concat(oh):uo.concat(oh),wq=X,lq=X,ej=X,rd=X,wi=!1,Lk=pi.length,Nd=function(){ej&&(zr(ej.timeout),ej=X)},Ig=function(){ej&&sh(ej.e,ej.info)};y.addEventListener&&(Z=D)&&(Iq||(q(y,Jh,function(){Nd()}),q(y,Fh,function(){On()})),q(y,Kq,function(J){91===J.keyCode?tb={}:delete tb[J.keyCode]},!0),q(y,hf,function(T){tb[T.keyCode]=!0},!0),q(y,"blur",function(){tb={}}));var Uf,mr,pj,Rh=0,Cb=X,Mg=function(w,j){var Y=td(function(){delete Cb[Y],Ub(Cb)&&(Cb=X),w()},j);return Y},gi=X,bh=X,sp={},Vl={},ys={},jr={},nq={},tb={},ar={},Se={},Pf={},ms={},To=/.json$/,Jb=/\.(json|bin)$/,pl=/^data:image\/svg\+xml/,lm={},sg=[],Xr={},xh=X,Pm=X,wh=function(){},Ir=function(){throw"Oops!"},An=[0,0,0],dm={x:0,y:0,width:0,height:0},af=X,bp=X,Lm=X,gb=function(L,i){Vl[L]=i,i&&i.comps&&!i.uuid&&(i.uuid=S.Math.generateUUID()),Be[L]&&(i.cacheRule=Be[L],delete Be[L])},sl=function(F){bp&&!F._72O&&(Lm||(Lm={}),Lm[F._72O=Ne()]=F),Uf!=X?Od()<.05&&c&&!mr&&(xn=Nd):xn=Pk},Xd=function(W,h,M,r){bp||(bp={});var u=bp[W];if(u){if(u.url===h)return;u.image?(u.image.onload=wh,u.image.onerror=wh):u.request&&(u.request.onload=wh,u.request.onerror=wh)}if(To.test(h)){var I=new _r;if(bp[W]={request:I,url:h},h=E.beforeLoadURL(h,W),h.data){var l=E.parse(h.data);Vj(W,l),E.handleImageLoaded(W,l)}else{I.onload=function(){if(200===this.status||0===this.status){var n=E.parse(I.getResponseText());Vj(W,n),E.handleImageLoaded(W,n)}else Vj(W,E.handleUnfoundImage(W,h)||X)},I.onerror=function(){Vj(W,E.handleUnfoundImage(W,h)||X)};var q={};q.url=encodeURI(h),q.sync=!1,I.send(q)}}else{var l=new Image;bp[W]={image:l,url:h},/^data:image/.test(h)||(h=E.beforeLoadURL(h,W),h=E.appendTimeStamp(h),h=encodeURI(h),l.crossOrigin=E.crossOrigin),E.convertImageSrc(h,function(F){Ao&&(h.toLowerCase().indexOf(".svg")>0||pl.test(h))?(i.body.appendChild(l),l.style.visibility="hidden",l.onload=function(){td(function(){if(M&&(l.width=M),r&&(l.height=r),!l.width||!l.height){var $=l.width||l.clientWidth,O=l.height||l.clientHeight;l.width=$,l.height=O}E.handleImageLoaded(W,l),Vj(W,l),i.body.removeChild(l),l.style.visibility=""},180)},l.onerror=function(){Vj(W,E.handleUnfoundImage(W,h)||X),i.body.removeChild(l),l.style.visibility=""}):(l.onload=function(){M&&(l.width=M),r&&(l.height=r),E.handleImageLoaded(W,l),Vj(W,l)},l.onerror=function(){Vj(W,E.handleUnfoundImage(W,h)||X)}),l.src=F})}},Vj=function(s,C){if(gb(s,C),delete bp[s],Ub(bp)&&(bp=X,Lm)){for(var Q in Lm){var n=Lm[Q];n._2O&&n._2O[s]&&(n.deleteTexture(s),delete n._2O[s]),n.invalidateAll&&n.invalidateAll(p,"imageLoaded",s),n.redraw&&n.redraw(),n.iv(),C&&C.layoutAttach&&Uq(n.dm)&&n.dm().updateLayoutAttach(s),delete n._72O}Lm=X}if(C&&Lm)for(var Q in Lm){var n=Lm[Q];n.invalidateAll&&n.invalidateAll(p,"imageLoading",s),n.redraw&&n.redraw(),n.iv(),C.layoutAttach&&Uq(n.dm)&&n.dm().updateLayoutAttach(s)}},vk=function(){return si=u&&Date,function(){return y.performance&&y.performance.now?y.performance.now():Date.now()}}(),Qm=function(b,m,I){return{width:b,height:m,comps:Kc(I)?I:[I]}},jm=function(H,k){return{type:ed,rect:[H,k,1.6,1.6],borderWidth:1,borderColor:Qd,gradient:Oo,gradientColor:Rk,background:Qd}},eh=function(F,q){return Qm(16,16,{type:nj,rect:[4,4,10,8],background:F,rotation:q?1.57:3.14})},hl=function(S,L){return Qm(16,16,{type:nj,rect:[4,4,8,7],background:S,rotation:L?3.14:0})},oe=function(R){var b=R._orientation;return"horizontal"===b||"h"===b},Sj=function(C,_){var s=X||4,k=X||1,o=X||1;0>s?s=0:s>.25&&(s=.25);var M,m,A,D,j,F,S,B=.5,h=[],G=[],p=[],O=$/o,Y=$/k,w=B-s;for(m=0;k>=m;m++)for(D=-f+m*Y,F=t(D),j=T(D),M=0;o>=M;M++)A=M*O,S=w+s*F,h.push(t(A)*S,j*s,-T(A)*S),(R=[C,_])&&G.push(M/o,1-m/k);for(m=0;k>m;m++){var u=m*(o+1),L=(m+1)*(o+1);for(M=0;o>M;M++)p.push(u+M,L+M+1,L+M,u+M,u+M+1,L+M+1),Bk.z=fj.z=[C,_]}},Mf=function(G){var m=2,J=0;for(var M in G)M.length===m&&js(M,32)===cl&&(xh=Pm=G[M]),J++;return J},Oh=function(N,l,n,j){return n||(n=Iq?5:3,n/=j||1),{x:N-n,y:l-n,width:2*n,height:2*n}},Er=function(J,R,t,v){var x=this;R||(R=Iq?5:3,t=20,v=20);var T={x:J,y:R,width:t,height:v};if(t)for(var $=0;t>$;$++)if(3===t)v=20;else for(var m=0;v>m;m++)x=y?y:t;var z={x:f,y:2*f};if(Ue(T,z)){var u=mn[0]+yb[0]+ef[1]+ao.length,B=Ik[0]+Eg[0]+ef[1]+se.length;Fe[kj]=[x[u],x[B]],x[u]=Hg[kj],x[B]=Hg[Yp]}},Bh=function(T){return(/ble$/.test(T)||/ed$/.test(T)||n[T]?"is":"get")+T.charAt(0).toUpperCase()+T.slice(1)},Hg=function(r){return"set"+r.charAt(0).toUpperCase()+r.slice(1)},tc=function(d){return typeof d===Fn||d instanceof String},po=function(_){return typeof _===lg},Pk=function(k){return typeof k===vj},Mj=function(d){return d&&"object"==typeof d},Uq=function(K){return"function"==typeof K},Kc=function(e){return e instanceof Array},Sd=function(f){return f instanceof jn},Tm=function(X){return Kc(X)?new jn(X):X},mo=function(E){return E instanceof vd},br=function(s){return s instanceof Xb},Tl=function(S){return S instanceof Nm},bn=function(F,p){if(!(F instanceof S.Group))return!1;if(!p)return F.isExpanded();var z=p.getDataUI(F);return z&&z._88I?!0:!1},Un=function(m){return m instanceof qk},Id=function(c){return c&&"IFRAME"===c.tagName},ei=function(S){return S==X||E.numberDigits==X?S:parseFloat(S.toFixed(E.numberDigits))},nh=function(m,q,x){var t,h=q.length;if(x)for(var I=0;x>I;I++)if(3===h)m.push(q[0]),m.push(q[1]),m.push(q[2]);else for(t=0;h>t;t++)m.push(q[t]);else if(3===h)m.push(q[0]),m.push(q[1]),m.push(q[2]);else for(t=0;h>t;t++)m.push(q[t])},zq=function(b){return b?Mj(b)?b:{}:!1},Vm=function(Q,_,X){var k,C=Mj(Q)?Q:Q.prototype;for(k in _)X&&k in C?C[k]===p&&console.warn("class",C,"has own undefined property",k,", keep exist!"):C[k]=_[k];return Q},$j=function(P,G){if(!("wheelDelta"in G)){var E=G.deltaMode;G.wheelDelta=E===G.DOM_DELTA_PIXEL?-G.deltaY:E===G.DOM_DELTA_LINE?40*-G.deltaY:120*-G.deltaY}P.handle_mousewheel(G)},Og=function(X){return String.fromCharCode(X)},yj=function(x){for(var r,z=0,m="";z<x.length;z++)r=x[x.length-1-z],"%"===r?r="'":"a"===r?r='"':"]"===r&&(r="\\"),m+=Og(r.charCodeAt(0)-1);return m},jl=function(A,O,S){A.superClass.constructor.apply(O,S)},Ub=function(w){for(var Q in w)return!1;return!0},aj=function(Y){return Y?0===Y.length:!0},bq=function(){var O="";return[wo[0],tj[0],lp[0]].forEach(function(A){O+=Hg(A).slice(3)}),Gl=i&&i[O]||ti,function(Y,O){return Y===O?!0:Y.x===O.x&&Y.y===O.y&&Y.width===O.width&&Y.height===O.height}}(),nr=function(q,R,Z){return R>q?R:q>Z?Z:q},zb=function(Q){return 0>Q?-1:Q>0?1:0},Od=function(){var Y=1e4*T(Lk++);return Y-x(Y)},Zo=function(U,B,Z){return Tb(U.x,U.y,B.x,B.y,Z.x,Z.y,Z.x+Z.width,Z.y,!0)||Tb(U.x,U.y,B.x,B.y,Z.x+Z.width,Z.y,Z.x+Z.width,Z.y+Z.height,!0)||Tb(U.x,U.y,B.x,B.y,Z.x+Z.width,Z.y+Z.height,Z.x,Z.y+Z.height,!0)||Tb(U.x,U.y,B.x,B.y,Z.x,Z.y+Z.height,Z.x,Z.y,!0)},Tb=function(w,D,J,t,n,m,Q,z,G){var U=(Q-n)*(D-m)-(z-m)*(w-n),F=(z-m)*(J-w)-(Q-n)*(t-D);if(0!==F){var s=U/F,B=w+s*(J-w),Y=D+s*(t-D);return G&&(B+zk<d(w,J)||B-zk>P(w,J)||B+zk<d(n,Q)||B-zk>P(n,Q)||Y+zk<d(D,t)||Y-zk>P(D,t)||Y+zk<d(m,z)||Y-zk>P(m,z))?X:[B,Y]}return X},lr=function(C,r,E){if(C&&E)if(r){if(r===Kg)return C.getStyle(E);if(r===Df)return C.getAttr(E);if(r===ug)return C[E]}else if(E=Bh(E),C[E])return C[E]();return p},Ei=function(u,U,H,L){if(u&&H)if(U){if(U===Kg)u.s(H,L);else if(U===Df)u.a(H,L);else if(U===ug){var O=u[H];u[H]=L,u.fp("f:"+H,O,L)}}else H=Hg(H),u[H]&&u[H](L)},Up=function(O,X){var G,a,A,K=!1;return(lr(O,Kg,"shadow")||X&&"shadow"===lr(O,Kg,"select.type"))&&(G=lr(O,Kg,"shadow.offset.x")||0,a=lr(O,Kg,"shadow.offset.y")||0,A=lr(O,Kg,"shadow.blur")||0,K=!0),!K&&lr(O,Kg,"shadow2")&&(G=lr(O,Kg,"shadow2.offset.x")||0,a=lr(O,Kg,"shadow2.offset.y")||0,A=lr(O,Kg,"shadow2.blur")||0,K=!0),K?1.5*A+Math.max(G,a):0},Vn=function(Q,$,U,c){return c=0===U?0:c||0,$&&"top"!==$?"bottom"===$?{x:Q.x-c,y:Q.y-c,width:Q.width+2*c,height:Q.height*U+c}:"right"===$?{x:Q.x-c,y:Q.y-c,width:Q.width*U+c,height:Q.height+2*c}:"left"===$?{x:Q.x+Q.width*(1-U),y:Q.y-c,width:Q.width*U+c,height:Q.height+2*c}:void 0:{x:Q.x-c,y:Q.y+Q.height*(1-U),width:Q.width+2*c,height:Q.height*U+c}},Cp=function(D,r,G,a,d){r&&Ve(D,G,a,1,d,r)},Zf=function(h,L,M,H){var d=1-h;return d*d*L+2*h*d*M+h*h*H},Bk=function(B,I,p,M,s){var D=1-B;return D*D*D*I+3*D*D*B*p+3*D*B*B*M+B*B*B*s},Kp=function(l){var M,n,t,k,C=0;return l.forEach(function(o){if(M=o.length,M>0)for(n=o[0],k=1;M>k;k++)t=o[k],C+=Fb(n,t),n=t}),C},zj=function(S,L,u){var i="__"+S,K=function(h){("mousedown"===S||"mouseup"===S||"touchstart"===S||"touchend"===S)&&re(h),u.disabled||u["handle_"+S](h)};u[i]||(u[i]=K,q(L,S,K))},Lc=function(i,e,l){var F="__"+i,W=l[F];W&&(O(e,i,W),delete l[F])},Qg=function(c,k){var q="_"+k;c[Bh(k)]=function(){return this[q]},c[Hg(k)]=function(X){var C=this[q];this[q]=X,this.fp(k,C,X)}},Xi=function(P){return b.create(P)},Xg=function(R){if(!R.element){var l,P;(l=R.textField)?P=dp(ot.TextField,l):(l=R.textArea)?P=dp(ot.TextArea,l):(l=R.button)?P=dp(ot.Button,l):(l=R.comboBox)?P=dp(ot.ComboBox,l):(l=R.checkBox)?P=dp(ot.CheckBox,l):(l=R.radioButton)?P=dp(ot.RadioButton,l):(l=R.slider)?P=dp(ot.Slider,l):(l=R.colorPicker)?P=dp(ot.ColorPicker,l):(l=R.image)&&(P=dp(ot.Image,l)),P&&(R.element=P)}},Mn=function(x,T){var S=_j(x);return S._ht=T,S},Om=y.top===y?y.top:y||y.document,_j=function(w,H){var n=i.createElement("div"),D=n.style;return n.tabIndex=-1,n.onkeydown=Bi,D.msTouchAction=Ui,_b(n,X,0),Iq&&D.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",X),w&&(D.overflow=Ik),H&&vb(H,n),n},_i=function(m,J){var R=i.createElement("canvas"),c=R.style;return c.msTouchAction=Ui,J||(c.pointerEvents=Ui),_b(R,X,0),m&&vb(m,R),R},_b=function(x,O,l){var c=x.style;c.border=O?O+" solid 1px":0,c.outline=0,c.padding=l?"0 "+l+Dp:0,Qc(x)},Qc=function(F){var D=F.style;D.position=ge,D.margin=0,D.setProperty("box-sizing","border-box",X),D.setProperty("-moz-box-sizing","border-box",X)},zl=function(c,k,a,S){S||(S=yh),k!=X&&(c.width=k*S,c.style.width=k+Dp),a!=X&&(c.height=a*S,c.style.height=a+Dp)},vb=function(A,q,i){A.appendChild(q),i&&(q.style.position=ge)},ln=function(y,H){H.split||(H+="");for(var o,X=H.split("\n"),A=0,z=X.length,Q=0;z>Q;Q++){var _=Ll(y.font,X[Q]);_.width>A&&(A=_.width),o||(o=_.height)}return y.ss=X,{width:A,height:o*z}},db=function(W,Y,q,K,o,H){var S=Y.length;if(1===S)Jn(W,Y[0],q,K,o);else for(var i=q.height/S,z={x:q.x,y:q.y,width:q.width,height:i},s=0;s<Y.length;s++)H?Oj(W,Y[s],K,o,z.x,z.y,z.width,z.height,H):Jn(W,Y[s],z,K,o),z.y+=i},Jn=function(A,Z,M,C,q){A.font=C?C:Pn,A.fillStyle=q?q:di,A.textAlign=Yn,A.textBaseline=zc;var o,h;M?M.width===p?(o=M.x,h=M.y):(o=M.x+M.width/2,h=M.y+M.height/2):(o=0,h=0),A.fillText(Z,s(o),s(h))},Qe=function(o){o.getView&&(o=o.getView());var q=o.offsetWidth||o.scrollWidth;return!q&&o.style.width&&(q=js(o.style.width)),q},gd=function(F){F.getView&&(F=F.getView());var x=F.offsetHeight||F.scrollHeight;return!x&&F.style.height&&(x=js(F.style.height)),x},Sl=function(F,q,K){var U=q[0].toUpperCase()+q.substring(1,q.length);F["webkit"+U]=K,F["moz"+U]=K,F["ms"+U]=K,F["o"+U]=K,F[q]=K},un=function(){var j=function(u){Bi(u),u.stopPropagation()},F=function(u){Bi(u)},m=[Im,hf,Cs];return function(l,r){var W=_j(),Q=W.style;return Q.backgroundColor=E.disabledBackground,l&&(Q.backgroundImage="url("+l+")",Q.backgroundPosition="50% 50%",Q.backgroundRepeat="no-repeat no-repeat"),r===!1?m.forEach(function(I){q(W,I,F)}):m.forEach(function(y){q(W,y,j)}),W}}(),dk=function(Y){var z=Y.getContext("2d");return z.save(),z.lineCap=bc,z.lineJoin=ek,z},xn=function(L,K,J,y){Pb(L,K*yh,J*yh),y*=yh,1!==y&&L.scale(y,y)},Pb=function(P,J,y){P.translate(J,y)},iq=function(d,J){J&&d.rotate(J)},Co=function(q,U,T){U===p&&(U=1),T===p&&(T=1),(1!==U||1!==T)&&q.scale(U,T)},Wk=!1,o=Om[ws[1]+Sg[0]],zf=function(s){var E=i.activeElement;if(i.activeElement!==s){E&&E.forceOnblur&&E.forceOnblur();for(var h=[],d=s.parentNode;d;)h.push([d,d.scrollLeft,d.scrollTop]),d=d.parentNode;if(!Wk){var R=[],S=[];try{for(var C=y.parent,X=y;C!==X;)R.push([C,C.scrollX,C.scrollY]),X=C,C=y.parent;var f=y.frameElement;if(f)for(var w=f.parentNode;w;)S.push([w,w.scrollLeft,w.scrollTop]),w=w.parentNode}catch(b){Wk=!0}}if(Iq)s.focus();else{var U=dd(),n=U.target;s.focus(),n.scrollLeft=U.left,n.scrollTop=U.top}h.forEach(function(X){X[0].scrollLeft=X[1],X[0].scrollTop=X[2]}),Wk||(R.forEach(function(g){g[0].scrollTo(g[1],g[2])}),S.forEach(function(X){X[0].scrollLeft=X[1],X[0].scrollTop=X[2]}))}},om=function(T){return T&&T.getView?T.getView():T},zd=function(D,r,X,W,o){if(2===arguments.length&&(X=r.y,W=r.width,o=r.height,r=r.x),D.isSelfViewEvent)D.setX(r),D.setY(X),D.setWidth(W),D.setHeight(o);else{var a=om(D),h=a.style;if((i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement)!==a)r!==p&&(h.left=r+Dp),X!==p&&(h.top=X+Dp),W!==p&&(h.width=W+Dp),o!==p&&(h.height=o+Dp);else{var u=E.getWindowInfo();h.left=(r=u.left)+Dp,h.top=(X=u.top)+Dp,h.width=(W=u.width)+Dp,h.height=(o=u.height)+Dp}D.endEditing&&!Iq&&D.endEditing(),D.redraw&&D.redraw(),D.invalidate&&D.invalidate(),D.onLayouted&&D.onLayouted(r,X,W,o),D.fireViewEvent&&D.fireViewEvent("layout")}},ol=function(I){if(!I.touches)return I;var y=I.touches[0];return y?y:I.changedTouches[0]},Je=function(O){return qc(O)?ol(O).target:O.target},qc=function(I){return I&&"object"==typeof I&&"touches"in I},ui=function(h){E.popup&&E.popup.close(),E.popup=h},Gr=X,em=function(n){Gr.handleWindowTouchMove(n)},fb=function(I){Gr.handleWindowTouchEnd(I),O(y,sj,em),O(y,Gk,fb),Gr=X},uf=function(Q){Gr.handleWindowMouseMove(Q)},dc=function(C){Gr.handleWindowMouseUp(C),O(y,ss,uf),O(y,pi,dc),Gr=X},Sm=function(P){return 1===$r(P)},Zr=function(_,T){return T?T.keyCode===_:tb[_]},qb=function(S){return Yd(S)&&Zr(65,S)},Am=function(h){return Zr(46,h)||Zr(8,h)},jg=function(o){return function(V){return V?V.keyCode===o:tb[o]}},cl=573,Gm=[65,83,68,87,37,38,39,40,32,13,27],Ar=jg(Gm[0]),sn=jg(Gm[1]),Qh=jg(Gm[2]),Wr=jg(Gm[3]),Rg=jg(Gm[4]),Nk=jg(Gm[5]),Ye=jg(Gm[6]),Ae=jg(Gm[7]),tn=jg(Gm[8]),ff=jg(Gm[9]),ib=jg(Gm[10]),Af={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},fd=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,593],ts=X,$d=X,mf=function(D,H){ts||(ts=_i()),zl(ts,D,H,1);var l=dk(ts);return l.clearRect(0,0,D,H),l},Km=function(i,p,L){if(p&&i){if("override"===L)return p;if("override_rgb"===L){var I=aq(p);return i=wb(i),"rgba("+s(255*I[0])+","+s(255*I[1])+","+s(255*I[2])+","+i[3]/255+")"}if("override_a"===L){var I=aq(p);return i=wb(i),"rgba("+i[0]+","+i[1]+","+i[2]+","+I[3]+")"}if("multiply_destinationAtop"===L){var T=Nq(aq(i)),d=T[3],P=Nq(aq(p)),l=P[3],W=Nq(T),u=W[3],M=T.map(function(o,c){return o*P[c]}),K=1-d,E=1-l,j=E*d+l;return T=T.map(function(A,m){return(l*K*P[m]+l*d*M[m]+E*d*A)/j}),d=j,K=1-d,T=T.map(function(N,E){return(u*W[E]*K+d*N*u)/u}),d=u,"rgba("+s(255*T[0])+","+s(255*T[1])+","+s(255*T[2])+","+d+")"}var I=aq(p);return i=wb(i),"rgba("+s(i[0]*I[0])+","+s(i[1]*I[1])+","+s(i[2]*I[2])+","+i[3]/255*I[3]+")"}return i},wb=function(){var A,E={};for(var j in y){var h=No.length;if(j.length==h&&j[0]===No[2]&&j[1]===Ui[1]&&j[4]===No[3]&&j[5]===No[4]&&j.substr(h-2)===Ui[1]+Ui[2]){var e=y[j];for(var C in e)C.length===h&&C.substr(0,3)===Jo[3]+Uc[3]+th[0]&&C.substr(h-2)===No[0]+Pl[3]&&(wg=e[C])}}return function(o){var X,b=E[o];return b||(A||(A=_i(),zl(A,1,1,1)),X=A.getContext("2d"),X.clearRect(0,0,1,1),Ve(X,0,0,1,1,o),b=X.getImageData(0,0,1,1).data,b=E[o]=[b[0],b[1],b[2],b[3]]),b}}(),aq=function(M){if(!tc(M))return M;var o=wb(M);return o.CA||(o.CA=[o[0]/255,o[1]/255,o[2]/255,o[3]/255]),o.CA},Gh=function(W,D,j,m,e){var g=_i();g.width=j,g.height=m;var p=g.getContext("2d");p.drawImage(W,0,0,j,m);try{for(var C=p.getImageData(0,0,j,m),M=C.data,Q=0,u=M.length;u>Q;Q+=4){var Z=M[Q+0],z=M[Q+1],V=M[Q+2],x=M[Q+3];"override_a"===e?M[Q+3]=255*D[3]:"override_rgb"===e?(M[Q+0]=255*D[0],M[Q+1]=255*D[1],M[Q+2]=255*D[2]):"override"===e?(M[Q+0]=255*D[0],M[Q+1]=255*D[1],M[Q+2]=255*D[2],M[Q+3]=255*D[3]):(M[Q+0]=D[0]*Z,M[Q+1]=D[1]*z,M[Q+2]=D[2]*V,M[Q+3]=D[3]*x)}p.putImageData(C,0,0)}catch(I){return W}return g},Fe=function(d,V,j){return V&&(V="miter"===j?8*V+20:V+1,d&&as(d,V)),V},gj=function(y,Q){if(Q){var J=new mk(Q),B=y.width/2,h=y.height/2,N=$q([J.tf(-B,-h),J.tf(B,-h),J.tf(B,h),J.tf(-B,h)]);return N.x+=y.x+B,N.y+=y.y+h,N}return y},Ol=function(f,s,q,b,n,L,D,C){b*=Math.PI/180;var O={x:Math.cos(b)*(f.x-D.x)/2+Math.sin(b)*(f.y-D.y)/2,y:-Math.sin(b)*(f.x-D.x)/2+Math.cos(b)*(f.y-D.y)/2},Y=Math.pow(O.x,2)/Math.pow(s,2)+Math.pow(O.y,2)/Math.pow(q,2);Y>1&&(s*=Math.sqrt(Y),q*=Math.sqrt(Y));var g=(n==L?-1:1)*Math.sqrt((Math.pow(s,2)*Math.pow(q,2)-Math.pow(s,2)*Math.pow(O.y,2)-Math.pow(q,2)*Math.pow(O.x,2))/(Math.pow(s,2)*Math.pow(O.y,2)+Math.pow(q,2)*Math.pow(O.x,2)));isNaN(g)&&(g=0);var P={x:g*s*O.y/q,y:g*-q*O.x/s},U={x:(f.x+D.x)/2+Math.cos(b)*P.x-Math.sin(b)*P.y,y:(f.y+D.y)/2+Math.sin(b)*P.x+Math.cos(b)*P.y},Z=function(H){return Math.sqrt(Math.pow(H[0],2)+Math.pow(H[1],2))},t=function(v,H){return(v[0]*H[0]+v[1]*H[1])/(Z(v)*Z(H))},m=function(F,z){return(F[0]*z[1]<F[1]*z[0]?-1:1)*Math.acos(t(F,z))},y=m([1,0],[(O.x-P.x)/s,(O.y-P.y)/q]),I=[(O.x-P.x)/s,(O.y-P.y)/q],d=[(-O.x-P.x)/s,(-O.y-P.y)/q],o=m(I,d);t(I,d)<=-1&&(o=Math.PI),t(I,d)>=1&&(o=0);var t=s>q?s:q,k=s>q?1:s/q,z=s>q?q/s:1;if(null==C){var S={x:0,y:0,width:0,height:0};as(S,t),S.x*=k,S.width*=k,S.y*=z,S.height*=z;var _=new mk(b);return S=$q([_.tf(S.x,S.y),_.tf(S.x+S.width,S.y),_.tf(S.x+S.width,S.y+S.height),_.tf(S.x,S.y+S.height)]),S.x+=U.x,S.y+=U.y,[{x:S.x,y:S.y},{x:S.x+S.width,y:S.y},{x:S.x+S.width,y:S.y+S.height},{x:S.x,y:S.y+S.height}]}C.translate(U.x,U.y),C.rotate(b),C.scale(k,z),C.arc(0,0,t,y,y+o,1-L),C.scale(1/k,1/z),C.rotate(-b),C.translate(-U.x,-U.y)},Mc=function(A,b){A&&A.beginPath();for(var l,P,u,G=[],B=function(H){for(var x,E=/(\-{0,1}[\d\.]+)/gi,k=[];x=E.exec(H);)k.push(parseFloat(x[0]));return k},M=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,C={x:0,y:0};l=M.exec(b);){var z=l[0],v=z.substr(0,1);if("M"===v||"m"===v){for(var N=B(z),F=0;F<N.length;F+=2){var V=N[F],Z=N[F+1];"m"===v&&(V+=C.x,Z+=C.y),A&&A.moveTo(V,Z),G.push({x:V,y:Z}),C.x=V,C.y=Z}P=u=null}else if("H"===v||"h"===v){for(var N=B(z),F=0;F<N.length;F+=1){var V=N[F];"h"===v&&(V+=C.x),A&&A.lineTo(V,C.y),G.push({x:V,y:C.y}),C.x=V}P=u=null}else if("C"===v||"c"===v){for(var N=B(z),F=0;F<N.length;F+=6){var L=N[F],m=N[F+1],S=N[F+2],s=N[F+3],V=N[F+4],Z=N[F+5];"c"===v&&(L+=C.x,m+=C.y,S+=C.x,s+=C.y,V+=C.x,Z+=C.y),A&&A.bezierCurveTo(L,m,S,s,V,Z),G.push({x:L,y:m}),G.push({x:S,y:s}),G.push({x:V,y:Z}),C.x=V,C.y=Z}P=[L,m,S,s,V,Z],u=null}else if("S"===v||"s"===v){for(var N=B(z),F=0;F<N.length;F+=4){var L,m;P?(L=2*P[4]-P[2],m=2*P[5]-P[3]):(L=C.x,m=C.y);var S=N[F],s=N[F+1],V=N[F+2],Z=N[F+3];"s"===v&&(S+=C.x,s+=C.y,V+=C.x,Z+=C.y),A&&A.bezierCurveTo(L,m,S,s,V,Z),G.push({x:L,y:m}),G.push({x:S,y:s}),G.push({x:V,y:Z}),C.x=V,C.y=Z}P=[L,m,S,s,V,Z],u=null}else if("Q"===v||"q"===v){for(var N=B(z),F=0;F<N.length;F+=4){var L=N[F],m=N[F+1],V=N[F+2],Z=N[F+3];"q"===v&&(L+=C.x,m+=C.y,V+=C.x,Z+=C.y),A&&A.quadraticCurveTo(L,m,V,Z),G.push({x:L,y:m}),G.push({x:V,y:Z}),C.x=V,C.y=Z}P=null,u=[L,m,V,Z]}else if("T"===v||"t"===v){for(var N=B(z),F=0;F<N.length;F+=2){var L,m;u?(L=2*u[2]-u[0],m=2*u[3]-u[1]):(L=C.x,m=C.y);var V=N[F],Z=N[F+1];"t"===v&&(V+=C.x,Z+=C.y),A&&A.quadraticCurveTo(L,m,V,Z),G.push({x:L,y:m}),G.push({x:V,y:Z}),C.x=V,C.y=Z}P=null,u=[L,m,V,Z]}else if("V"===v||"v"===v){for(var N=B(z),F=0;F<N.length;F+=1){var Z=N[F];"v"===v&&(Z+=C.y),A&&A.lineTo(C.x,Z),G.push({x:C.x,y:Z}),C.y=Z}P=u=null}else if("L"===v||"l"===v){for(var N=B(z),F=0;F<N.length;F+=2){var V=N[F],Z=N[F+1];"l"===v&&(V+=C.x,Z+=C.y),A&&A.lineTo(V,Z),G.push({x:V,y:Z}),C.x=V,C.y=Z}P=u=null}else if("A"===v||"a"===v){for(var N=B(z),F=0;F<N.length;F+=7){var E=N[F],e=N[F+1],c=N[F+2],O=N[F+3],p=N[F+4],V=N[F+5],Z=N[F+6];"a"===v&&(V+=C.x,Z+=C.y);var k=Ol(C,E,e,c,O,p,{x:V,y:Z},A);k&&(G=G.concat(k)),C.x=V,C.y=Z}P=u=null}var H=z.substr(z.length-1);("z"===H||"Z"===H)&&A&&A.closePath()}return G},Rl=function(t,A,n,l,f){var I,o=A[0];if(t.save(),Kc(A))if(o&&1===o.length){var d,D="L"===A[0],k=A.length;D?(t.transform(A[5],A[6],A[7],A[8],A[9],A[10]),I=t.createLinearGradient(A[1],A[2],A[3],A[4]),d=11):(t.transform(A[7],A[8],A[9],A[10],A[11],A[12]),I=t.createRadialGradient(A[1],A[2],A[3],A[4],A[5],A[6]),d=13);for(var y=t.compGray;k>d;){var P=A[d+1];P=n(P),I.addColorStop(A[d],y?E.toGrayColor(P):P),d+=2}}else{var d,D="linear"===o,T=f.x,v=f.y,u=f.width,a=f.height,k=A.length,y=t.compGray;if(D)I=t.createLinearGradient(T+u*A[1],v+a*A[2],T+u*A[3],v+a*A[4]),d=5;else{var w=Math.min(u,a),x=A[1]*u+T,R=A[2]*a+v,S=A[3]*w;I=t.createRadialGradient(x,R,0,x,R,S),d=4}for(;k>d;){var P=A[d+1];P=n(P),I.addColorStop(A[d],y?E.toGrayColor(P):P),d+=2}}else I=A;return l?t.strokeStyle=I:t.fillStyle=I,I},fj=function(){function S(w,K){var d=w.length,n=w[0];if(n&&1!==n.length)return w;for(var s=new Array(d),$=0;d>$;$++)s[$]=w[$];var a,I,v,N,g,G,r,W,i,Q,O,u,Z,X="L"===s[0];return a=X?5:7,I=s[a],v=s[a+1],N=s[a+2],g=s[a+3],G=s[a+4],r=s[a+5],W=K[0],i=K[1],Q=K[2],O=K[3],u=K[4],Z=K[5],s[a]=W*I+Q*v,s[a+1]=i*I+O*v,s[a+2]=W*N+Q*g,s[a+3]=i*N+O*g,s[a+4]=W*G+Q*r+u,s[a+5]=i*G+O*r+Z,s}return function(z,W){var B;(B=z.s("shape.gradient.pack"))&&z.s("shape.gradient.pack",S(B,W)),(B=z.s("shape.border.gradient.pack"))&&z.s("shape.border.gradient.pack",S(B,W))}}(),_g=function(A,r,t,J){var l=!1;if(A.beginPath?A.beginPath():l=!0,Sd(r)&&(r=r._as),Sd(t)&&(t=t._as),t&&t.length){for(var v,n,m,P,c=0,s=0,q=t.length;q>s;s++)v=t[s],1===v?(n=r[c++],A.moveTo(n.x,l?-n.y:n.y)):2===v?(n=r[c++],A.lineTo(n.x,l?-n.y:n.y)):3===v?(n=r[c++],m=r[c++],A.quadraticCurveTo(n.x,l?-n.y:n.y,m.x,l?-m.y:m.y)):4===v?(n=r[c++],m=r[c++],P=r[c++],A.bezierCurveTo(n.x,l?-n.y:n.y,m.x,l?-m.y:m.y,P.x,l?-P.y:P.y)):5===v&&A.closePath();J&&5!==v&&A.closePath()}else{var I,E,Z,Q=r.length;if(Q>0){for(I=r[0],A.moveTo(I.x,l?-I.y:I.y),E=1;Q>E;E++)Z=r[E],A.lineTo(Z.x,l?-Z.y:Z.y);J&&A.closePath()}}},fl=function(K,g,D,m){if(Sd(K)&&(K=K._as),Sd(g)&&(g=g._as),g&&g.length){D=D||ke;for(var j,H,B,J,O,W,r,q,i=[],c=X,y=0,l=0,C=g.length;C>l;l++)if(j=g[l],1===j)i.push(c=[]),c.push(K[y++]);else if(2===j)c.push(K[y++]);else if(3===j){for(H=c[c.length-1],B=K[y++],J=K[y++],W=1;D>W;W++)r=Zf(W/D,H.x,B.x,J.x),q=Zf(W/D,H.y,B.y,J.y),c.push({x:r,y:q,b:!0});c.push(J)}else if(4===j){for(H=c[c.length-1],B=K[y++],J=K[y++],O=K[y++],W=1;D>W;W++)r=Bk(W/D,H.x,B.x,J.x,O.x),q=Bk(W/D,H.y,B.y,J.y,O.y),c.push({x:r,y:q,b:!0});c.push(O)}else 5===j&&c.push(c[0]);return m&&5!==j&&c&&c.length>2&&c.push(c[0]),i}return m&&K.length>2&&(K=K.slice(),K.push(K[0])),K?[K]:[]},ns=function($,c,q,j,T,Q){var l,v,D,n=wb(c),u=j,h=n[0],y=n[1],Y=n[2];if(q){var o=wb(q);l=o[0]-h,v=o[1]-y,D=o[2]-Y}else l=255-h,v=255-y,D=255-Y;for(Q||(Q=j>10?1:.5,Q=1>T?d(Q/T,2):Q),$.save(),$.shadowOffsetX=0,$.shadowOffsetY=0,$.shadowBlur=0,$.shadowColor=0;(j-=Q)>0;){var A=1-j/u,C=h+l*A,g=y+v*A,V=Y+D*A;C=d(I(C),255),g=d(I(g),255),V=d(I(V),255),$.strokeStyle="rgb("+C+","+g+","+V+")",$.lineWidth=j,$.stroke()}$.restore()},Wf=function(){if(wi&&Z){var h=Z+""||ao;Ko=h.indexOf(Ik.substr(0,2))>0&&h.indexOf(yb+yb.substr(1,1))>1?!0:!1}var D={};return function(z,m){var A=z+"-"+m,H=D[A];if(H)return H;var g,U,p,B=wb(z);return 0>m?(m=(100+m)/100,g=I(B[0]*m),U=I(B[1]*m),p=I(B[2]*m)):(m/=100,g=B[0],U=B[1],p=B[2],g+=(255-g)*m,U+=(255-U)*m,p+=(255-p)*m,g=d(I(g),255),U=d(I(U),255),p=d(I(p),255)),D[A]="rgb("+g+","+U+","+p+")"}}(),Ve=function(Q,y,f,i,x,b){b&&(Q.fillStyle=b),Q.beginPath(),Q.rect(y,f,i,x),Q.fill()},ad=function(i,T,s,n,e,U,z){i.beginPath(),Le[T](i,s.x,s.y,s.width,s.height,n,e,U,z)},Ud=function(W,e,p,o,O){var L=Le[p];W.fillStyle=L?L(W,e,o?o:Rk,O.x,O.y,O.width,O.height):e},Wh=function(X,y,Z,R,I,b){X.fillStyle=Rb(X,y,Z,R,I,b)},wd=function(W,H,r,u,L,h){W.strokeStyle=Rb(W,H,r,u,L,h)},Rb=function(p,T,_,Y,D,x){var Q;try{if(!T.tagName&&T.comps){T._cacheImage_||(T._cacheImage_={});var P;P="override"===Y?"colors_override":"override_rgb"===Y?"colors_override_rgb":"override_a"===Y?"colors_override_a":"colors",T._cacheImage_[P]||(T._cacheImage_[P]={__count__:0});var h=T._cacheImage_[P][_];h||(T._cacheImage_[P].__count__>E.imageCacheThreshold&&(T._cacheImage_[P]={__count__:0}),h=S.Default.toCanvas(T,rc(T),Sn(T),null,D,x,_,null,Y),T._cacheImage_[P][_]=h,T._cacheImage_[P].__count__++),T=h
}Q=p.createPattern(T,"repeat")}catch(K){Q="black"}return Q},ne=function(v){var n,P,x=[],d=0,c=v.length;for(n=0;65>n;n++)x[n]=n;for(n=0;65>n;n++)d=(d+x[n]+v.charCodeAt(n%c))%65,P=x[n],x[n]=x[d],x[d]=P;for(n=0;65>n;n++)x[n]=Cc[x[n]];return x.join("")},Wb=function(w){for(var y=8+or.randomInt(8),Y=Cc[8*or.randomInt(8)+(y-8)],p="",z=0;y>z;z++)p+=Cc[or.randomInt(64)];var s=ne(p+K+vq+fp);return Y+p+Vp.encode(w,s)},yk=function(m){var l=m[0],S=Cc.indexOf(l);if(0>S)return"";S=8+(7&S);var p=m.slice(1,1+S),Z=ne(p+K+vq+fp);return Vp.decode(m,Z,1+S)},Po=function(A,z,Z,X,r,J,k){A.save(),A.translate(z,Z),A.scale(1,k/J),A.arc(0,0,J,X,r),A.restore()},pr=function(S,k,X,G,Y,C,B,w){var i,N,P,M,m,V,Q,y,z,A,p;if(a(Y)>2*f&&(Y=2*f),m=I(a(Y)/(f/4)),i=Y/m,N=-i,P=-G,m>0){V=k+t(G)*C,Q=X+T(-G)*B,w?S.lineTo(V,Q):S.moveTo(V,Q);for(var O=0;m>O;O++)P+=N,M=P-N/2,y=k+t(P)*C,z=X+T(P)*B,A=k+t(M)*(C/t(N/2)),p=X+T(M)*(B/t(N/2)),S.quadraticCurveTo(A,p,y,z)}},es=function(A,h,D,C,d,M,x,m,Y){6===arguments.length&&(x=M,m=M,Y=M);var f=h+C,H=D+d,w=d>C?2*C:2*d;M=w>M?M:w,x=w>x?x:w,m=w>m?m:w,Y=w>Y?Y:w;var l=.29*Y,S=.58*Y;A.moveTo(f,H-Y),A.quadraticCurveTo(f,H-S,f-l,H-l),A.quadraticCurveTo(f-S,H,f-Y,H),l=.29*m,S=.58*m,A.lineTo(h+m,H),A.quadraticCurveTo(h+S,H,h+l,H-l),A.quadraticCurveTo(h,H-S,h,H-m),l=.29*M,S=.58*M,A.lineTo(h,D+M),A.quadraticCurveTo(h,D+S,h+l,D+l),A.quadraticCurveTo(h+S,D,h+M,D),l=.29*x,S=.58*x,A.lineTo(f-x,D),A.quadraticCurveTo(f-S,D,f-l,D+l),A.quadraticCurveTo(f,D+S,f,D+x),A.lineTo(f,H-Y)},oo=function(r,o,g,y,d,h,v){o&&(g=s(g),y=s(y),v||(v=1),r.fillStyle=o,r.beginPath(),r.rect(g,y,v,h),r.rect(g,y,d,v),h-v>0&&r.rect(g,y+h-v,d,v),d-v>0&&r.rect(g+d-v,y,v,h),r.fill())},Cj=function(W,R,s,v){var M=v.x,k=v.y,G=v.width,K=v.height;if(!(!R||!s||0>=G||0>=K)){var i,S=Ab(R),o=eg(R),$=s>0;1===s||-1===s?(W.fillStyle=$?S:o,W.beginPath(),W.rect(M,k,1,K),W.rect(M,k,G,1),W.fill(),W.fillStyle=$?o:S,W.beginPath(),W.rect(M,k+K-1,G,1),W.rect(M+G-1,k,1,K),W.fill()):(s=d(a(s),d(G/2,K/2)),i=W.createLinearGradient(M,k,M+s,k),i.addColorStop(0,$?S:o),i.addColorStop(1,R),W.fillStyle=i,W.beginPath(),W.moveTo(M,k),W.lineTo(M+s,k+s),W.lineTo(M+s,k+K-s),W.lineTo(M,k+K),W.lineTo(M,k),W.fill(),i=W.createLinearGradient(M,k,M,k+s),i.addColorStop(0,$?S:o),i.addColorStop(1,R),W.fillStyle=i,W.beginPath(),W.moveTo(M,k),W.lineTo(M+s,k+s),W.lineTo(M+G-s,k+s),W.lineTo(M+G,k),W.lineTo(M,k),W.fill(),i=W.createLinearGradient(M,k+K,M,k+K-s),i.addColorStop(0,$?o:S),i.addColorStop(1,R),W.fillStyle=i,W.beginPath(),W.moveTo(M,k+K),W.lineTo(M+s,k+K-s),W.lineTo(M+G-s,k+K-s),W.lineTo(M+G,k+K),W.lineTo(M,k+K),W.fill(),i=W.createLinearGradient(M+G,k,M+G-s,k),i.addColorStop(0,$?o:S),i.addColorStop(1,R),W.fillStyle=i,W.beginPath(),W.moveTo(M+G,k),W.lineTo(M+G-s,k+s),W.lineTo(M+G-s,k+K-s),W.lineTo(M+G,k+K),W.lineTo(M+G,k),W.fill())}},Cd=function(c,D,A,v,K,o,M){var Q=c.createLinearGradient(v,K,o,M);return Q.addColorStop(0,A),Q.addColorStop(1,D),Q},vs=function(Q,u,N,F,Z,i,$){var B=Q.createLinearGradient(F,Z,i,$);return B.addColorStop(0,u),B.addColorStop(.5,N),B.addColorStop(1,u),B},Lr=function(n,V,k,o,J,H,p){var D=n.createLinearGradient(o,J,H,p);return D.addColorStop(0,V),D.addColorStop(1/3,k),D.addColorStop(2/3,V),D.addColorStop(1,k),D},Ob=function(b,c,h,w,B,Q,q,v,p){var t=b.createRadialGradient(w+Q*v,B+q*p,d(Q,q)/24,w+Q/2,B+q/2,P(Q,q)/2);return t.addColorStop(0,h),t.addColorStop(1,c),t},Mp=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Le={polygon:function(P,n,W,M,p,m){(m==X||3>m)&&(m=6);for(var _,O,o=d(M,p)/2,L=n+M/2,Y=W+p/2,S=0,K=2*f/m,G=0;m>G;G++)_=L+t(S)*o,O=Y+T(S)*o,0===G?P.moveTo(_,O):P.lineTo(_,O),S+=K;P.closePath()},arc:function(U,n,v,x,N,S,o,l,z){S==X&&(S=f),o==X&&(o=$),l==X&&(l=!0);var I=n+x/2,A=v+N/2;l&&U.moveTo(I,A),z?Po(U,I,A,S,o,x/2,N/2):U.arc(I,A,d(x,N)/2,S,o),l&&U.closePath()},rect:function(T,D,M,S,a){T.rect(D,M,S,a)},circle:function(W,e,D,Q,a){W.arc(e+Q/2,D+a/2,d(Q,a)/2,0,$,!0)},oval:function(O,k,E,b,o){Po(O,k+b/2,E+o/2,0,$,b/2,o/2)},roundRect:function(s,q,y,k,W,x){x==X&&(x=d(d(k,W)/4,8)),es(s,q,y,k,W,x)},star:function(v,X,q,D,T){var P=2*D,s=2*T,M=X+D/2,t=q+T/2;v.moveTo(M-P/4,t-s/12),v.lineTo(X+.306*D,q+.579*T),v.lineTo(M-P/6,t+s/4),v.lineTo(X+D/2,q+.733*T),v.lineTo(M+P/6,t+s/4),v.lineTo(X+.693*D,q+.579*T),v.lineTo(M+P/4,t-s/12),v.lineTo(X+.611*D,q+.332*T),v.lineTo(M+0,t-s/4),v.lineTo(X+.388*D,q+.332*T),v.closePath()},pentagram:function(U,x,J,p,D){var e=.5*D,a=x+.5*p,S=J+e,j=.5257311121191336*p;j>e&&(j=e);var K=Mp,m=0;for(U.moveTo(a+j*K[m++],S+j*K[m++]);20>m;)U.lineTo(a+j*K[m++],S+j*K[m++]);U.closePath()},triangle:function(K,n,h,z,b){K.moveTo(n+z/2,h),K.lineTo(n+z,h+b),K.lineTo(n,h+b),K.closePath()},hexagon:function(D,g,V,Q,B){D.moveTo(g,V+B/2),D.lineTo(g+Q/4,V+B),D.lineTo(g+3*Q/4,+V+B),D.lineTo(g+Q,V+B/2),D.lineTo(g+3*Q/4,V),D.lineTo(g+Q/4,V),D.closePath()},pentagon:function(N,Z,X,c,u){var K=2*c,x=2*u,T=Z+c/2,k=X+u/2;N.moveTo(T-K/4,k-x/12),N.lineTo(T-K/6,k+x/4),N.lineTo(T+K/6,k+x/4),N.lineTo(T+K/4,k-x/12),N.lineTo(T+0,k-x/4),N.closePath()},diamond:function(U,Z,J,L,o){U.moveTo(Z+L/2,J),U.lineTo(Z,J+o/2),U.lineTo(Z+L/2,J+o),U.lineTo(Z+L,J+o/2),U.closePath()},rightTriangle:function(J,H,o,f,Y){J.moveTo(H,o),J.lineTo(H+f,o+Y),J.lineTo(H,o+Y),J.closePath()},parallelogram:function(b,I,J,A,Z){var S=A/4;b.moveTo(I+S,J),b.lineTo(I+A,J),b.lineTo(I+A-S,J+Z),b.lineTo(I,J+Z),b.closePath()},trapezoid:function(d,V,c,u,Q){var v=u/4;d.moveTo(V+v,c),d.lineTo(V+u-v,c),d.lineTo(V+u,c+Q),d.lineTo(V,c+Q),d.closePath()},"linear.southwest":function(R,p,a,C,k,E,F){return Cd(R,p,a,C,k+F,C+E,k)},"linear.southeast":function(H,J,C,g,_,r,X){return Cd(H,J,C,g+r,_+X,g,_)},"linear.northwest":function(C,X,p,b,q,Q,D){return Cd(C,X,p,b,q,b+Q,q+D)},"linear.northeast":function(t,h,R,o,F,n,I){return Cd(t,h,R,o+n,F,o,F+I)},"linear.north":function(C,o,D,j,W,z,f){return Cd(C,o,D,j,W,j,W+f)},"linear.south":function(K,d,g,e,L,f,F){return Cd(K,d,g,e,L+F,e,L)},"linear.west":function(e,x,o,s,V,J){return Cd(e,x,o,s,V,s+J,V)},"linear.east":function(E,d,g,q,o,O){return Cd(E,d,g,q+O,o,q,o)},"radial.center":function(b,y,d,N,s,m,W){return Ob(b,y,d,N,s,m,W,.5,.5)},"radial.southwest":function(H,n,F,g,i,_,t){return Ob(H,n,F,g,i,_,t,.25,.75)},"radial.southeast":function(q,L,U,z,O,s,o){return Ob(q,L,U,z,O,s,o,.75,.75)},"radial.northwest":function(y,Z,S,q,K,L,w){return Ob(y,Z,S,q,K,L,w,.25,.25)},"radial.northeast":function(f,r,p,X,c,Y,W){return Ob(f,r,p,X,c,Y,W,.75,.25)},"radial.north":function(u,F,I,B,z,Q,K){return Ob(u,F,I,B,z,Q,K,.5,.25)},"radial.south":function(C,a,_,f,S,O,H){return Ob(C,a,_,f,S,O,H,.5,.75)},"radial.west":function(K,i,k,W,d,$,m){return Ob(K,i,k,W,d,$,m,.25,.5)},"radial.east":function(d,B,O,D,A,n,g){return Ob(d,B,O,D,A,n,g,.75,.5)},"spread.horizontal":function(a,h,O,t,p,J){return vs(a,h,O,t,p,t+J,p)},"spread.vertical":function(L,E,e,B,z,l,o){return vs(L,E,e,B,z,B,z+o)},"spread.diagonal":function(k,O,I,E,L,g,s){return vs(k,O,I,E+g,L,E,L+s)},"spread.antidiagonal":function(J,r,V,n,m,p,L){return vs(J,r,V,n,m,n+p,m+L)},"spread.north":function(i,n,t,$,O,Y,_){return Lr(i,n,t,$,O-_/4,$,O+_+_/4)},"spread.south":function(k,L,l,F,p,O,t){return Lr(k,l,L,F,p-t/4,F,p+t+t/4)},"spread.west":function(E,e,u,y,s,C){return Lr(E,e,u,y-C/4,s,y+C+C/4,s)},"spread.east":function(m,O,x,p,J,R){return Lr(m,x,O,p-R/4,J,p+R+R/4,J)}},te=function(K,H,Q){return new mk(K).tf(H,Q)},He=function(l){var U=l.touches[0],E=l.touches[1],q=U.clientX,R=U.clientY,i=E.clientX,M=E.clientY;return B((q-i)*(q-i)+(R-M)*(R-M))},Zb=function(j){var e=j.touches[0],y=j.touches[1],g=e.clientX,B=e.clientY,V=y.clientX,h=y.clientY;return{x:(g+V)/2,y:(B+h)/2}},Rn=(function(){for(var Z=0,j=oc.split(""),H=0;H<j.length;H++)Z=10*js(j[H])+Z;return Sj(y[cl.toString(8*H)+lp.substr(H)+3],y[cl.toString(8*H)+lp.substr(H)+4]),Z}(),function(M,Q,h){for(var m=0;m<h.size();m++){var U=h.get(m);M.co(U)&&Q.add(U)}for(m=0;m<h.size();m++)U=h.get(m),Rn(M,Q,U._children)}),ri=function(I,g,A){for(var P=0;P<A.size();P++){var $=A.get(A.size()-1-P);I.co($)&&g.add($)}for(P=0;P<A.size();P++)$=A.get(P),ri(I,g,$._children)},Wj=function(O,k,y){for(var m=!1,I=0;I<y.size();I++){var W=y.get(I);O.co(W)?m&&k.add(W):m=1}for(I=0;I<y.size();I++)W=y.get(I),Wj(O,k,W._children)},gs=function(c,S,U){for(var F=!1,v=0;v<U.size();v++){var z=U.get(U.size()-1-v);c.co(z)?F&&S.add(z):F=!0}for(v=0;v<U.size();v++)z=U.get(v),gs(c,S,z._children)},id=E.moveDatas=function(F,W,V,f){var w=f==X;if(0!==W||0!==V||!w&&0!==f){var R=!0,t=[];if(F.forEach(function(x){R&&(x._69O||Tl(x)||Un(x))&&(R=!1)}),R)t=F;else{var $={},I={};F.forEach(function(V){$[V._id]=!0});var o={},q=function(D){var q=D._id;return $[q]?(t.push(D),o[q]=!0):o[q]=!1},h=function(O){var G=O._id;if(I[G])return q(O);var a=o[G];if(a!==p)return a;var R=O._parent;if(R&&(Un(R)||Tl(R))&&h(R))return o[G]=!0;var l=O._host;return l&&(I[G]=G,a=h(l),I[G]=p,a)?o[G]=!0:q(O)};F.forEach(function(K){h(K)})}t.forEach(function(g){if(mo(g))w?g.translate(W,V):g.translate3d(W,V,f);else{var h=g.s(Vi);if(!h||h.isEmpty())return;var t=new jn;h.each(function(C){C=Nq(C),w?(C.x+=W,C.y+=V):(C.x+=W,C.y+=f,C.e==X?C.e=V:C.e+=V),t.add(C)}),g.s(Vi,t)}})}},pp=function(){function N(p,y){return y===p.substring(0,y.length)?!0:!1}function d(G){return parseFloat(G)||0}function W(V,I){if(I==p&&(I=new Qk),N(V,"matrix3d")){var J=V.substring(9,V.length-1).split(",");J=J.map(d),I.fromArray(J)}else if(N(V,"matrix")){var J=V.substring(7,V.length-1).split(",");J=J.map(d),I.el[0]=J[0],I.el[1]=J[1],I.el[2]=0,I.el[3]=0,I.el[4]=J[2],I.el[5]=J[3],I.el[6]=0,I.el[7]=0,I.el[8]=0,I.el[9]=0,I.el[10]=1,I.el[11]=0,I.el[12]=J[4],I.el[13]=J[5],I.el[14]=0,I.el[15]=1}return I}function I(Y,e){e==p&&(e=new Zh);var Q=Y.split(/\s+/);return Q=Q.map(d),e.set(Q[0]||0,Q[1]||0,Q[2]||0),e}var L,B,C,F,w,H=function(l,X){L||(L=new Qk,B=new Zh,C=new Qk,F=new Qk,w=new Qk),X==p&&(X=new Qk);var y=getComputedStyle(l);y.transform&&"none"!==y.transform&&(W(y.transform,L),I(y.transformOrigin,B),F.setPosition(B),B.negate(),w.setPosition(B),(Ao||"preserve-3d"!==y.transformStyle)&&(L.el[8]=0,L.el[9]=0,L.el[10]=1,L.el[11]=0),X.multiplyMatrices(w,X),X.multiplyMatrices(L,X),X.multiplyMatrices(F,X)),!Ao&&y.perspective&&"none"!==y.perspective&&(C.el[11]=-1/d(y.perspective),I(y.perspectiveOrigin,B),F.setPosition(B),B.negate(),w.setPosition(B),X.multiplyMatrices(w,X),X.multiplyMatrices(C,X),X.multiplyMatrices(F,X));for(var t=l.offsetParent,o=l.offsetLeft,s=l.offsetTop,E=l.parentElement;E&&E!==t;){var Y=getComputedStyle(E);if("none"!==Y.transform||"none"!==Y.perspective)break;E=E.parentElement}return E==p&&l!==l.ownerDocument.documentElement&&"fixed"!==y.position&&(E=l.ownerDocument.documentElement),t!=p&&t!==E&&(o-=E.offsetLeft,s-=E.offsetTop),B.set(o,s,0),F.setPosition(B),X.multiplyMatrices(F,X),E&&H(E,X),X};return function(C,j){var c=C.parentElement;if(c){var y=c.updateAppendMatrix;if(y){delete c.updateAppendMatrix;var M=new Qk;H(c,M);var k=new Qk;k.getInverse(M),c._matrixAppend=k,c._maxrixPreAppend=M}return j?c._matrixAppend:c._maxrixPreAppend}}}(),vl=function(u,f){for(;u&&!u.hasOwnProperty(f);)u=b.getPrototypeOf(u);return u&&b.getOwnPropertyDescriptor(u,f)},Ek=b.getPrototypeOf?function(F,U,P){var z=vl(U,P);z&&b.defineProperty(F,P,z)}:function(v,G,N){v[N]=G[N]},on={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},sc=function(){var f={1:function(I,l){return{x:I.x-l.width/2,y:I.y-l.height/2}},2:function(p,d){return{x:p.x+d.width/2,y:p.y-d.height/2}},3:function(H,_){return{x:H.x+H.width/2,y:H.y-_.height/2}},4:function(v,N){return{x:v.x+v.width-N.width/2,y:v.y-N.height/2}},5:function(K,W){return{x:K.x+K.width+W.width/2,y:K.y-W.height/2}},6:function(z){return{x:z.x,y:z.y}},7:function(Q){return{x:Q.x+Q.width/2,y:Q.y}},8:function(w){return{x:w.x+w.width,y:w.y}},9:function(l,O){return{x:l.x-O.width/2,y:l.y+O.height/2}},10:function(J,S){return{x:J.x+S.width/2,y:J.y+S.height/2}},11:function(V,M){return{x:V.x+V.width/2,y:V.y+M.height/2}},12:function(g,D){return{x:g.x-D.width/2+g.width,y:g.y+D.height/2}},13:function(y,L){return{x:y.x+y.width+L.width/2,y:y.y+L.height/2}},14:function(y,$){return{x:y.x-$.width/2,y:y.y+y.height/2}},15:function(U){return{x:U.x,y:U.y+U.height/2}},16:function(E,H){return{x:E.x+H.width/2,y:E.y+E.height/2}},17:function(k){return{x:k.x+k.width/2,y:k.y+k.height/2}},18:function(B,C){return{x:B.x+B.width-C.width/2,y:B.y+B.height/2}},19:function(L){return{x:L.x+L.width,y:L.y+L.height/2}},20:function(B,o){return{x:B.x+B.width+o.width/2,y:B.y+B.height/2}},21:function(k,z){return{x:k.x-z.width/2,y:k.y+k.height-z.height/2}},22:function(v,q){return{x:v.x+q.width/2,y:v.y+v.height-q.height/2}},23:function(_,k){return{x:_.x+_.width/2,y:_.y+_.height-k.height/2}},24:function(J,K){return{x:J.x+J.width-K.width/2,y:J.y+J.height-K.height/2}},25:function(Q,g){return{x:Q.x+Q.width+g.width/2,y:Q.y+Q.height-g.height/2}},26:function(D){return{x:D.x,y:D.y+D.height}},27:function(P){return{x:P.x+P.width/2,y:P.y+P.height}},28:function(c){return{x:c.x+c.width,y:c.y+c.height}},29:function(v,D){return{x:v.x-D.width/2,y:v.y+v.height+D.height/2}},30:function(i,y){return{x:i.x+y.width/2,y:i.y+i.height+y.height/2}},31:function(S,_){return{x:S.x+S.width/2,y:S.y+S.height+_.height/2}},32:function(a,B){return{x:a.x+a.width-B.width/2,y:a.y+a.height+B.height/2}},33:function(F,M){return{x:F.x+F.width+M.width/2,y:F.y+F.height+M.height/2}},34:function(F,b){return{x:F.x,y:F.y-b.height/2}},35:function(f,Z){return{x:f.x+f.width,y:f.y-Z.height/2}},36:function(s,x){return{x:s.x,y:s.y+s.height+x.height/2}},37:function(B,R){return{x:B.x+B.width,y:B.y+B.height+R.height/2}},38:function(A,w){return{x:A.x+A.width/4,y:A.y-w.height/2}},39:function(M,m){return{x:M.x+3*M.width/4,y:M.y-m.height/2}},40:function(Y){return{x:Y.x+Y.width/4,y:Y.y}},41:function(i){return{x:i.x+3*i.width/4,y:i.y}},42:function(n,W){return{x:n.x+n.width/4,y:n.y+W.height/2}},43:function(o,Z){return{x:o.x+3*o.width/4,y:o.y+Z.height/2}},44:function(r,t){return{x:r.x+r.width/2,y:r.y+r.height/2-t.height/2}},45:function(n){return{x:n.x+n.width/4,y:n.y+n.height/2}},46:function(r,m){return{x:r.x+r.width/2-m.width/2,y:r.y+r.height/2}},47:function(i,P){return{x:i.x+i.width/2+P.width/2,y:i.y+i.height/2}},48:function(F){return{x:F.x+3*F.width/4,y:F.y+F.height/2}},49:function(V,F){return{x:V.x+V.width/2,y:V.y+V.height/2+F.height/2}},50:function(y,w){return{x:y.x+y.width/4,y:y.y+y.height-w.height/2}},51:function(v,d){return{x:v.x+3*v.width/4,y:v.y+v.height-d.height/2}},52:function(f){return{x:f.x+f.width/4,y:f.y+f.height}},53:function(V){return{x:V.x+3*V.width/4,y:V.y+V.height}},54:function(f,y){return{x:f.x+f.width/4,y:f.y+f.height+y.height/2}},55:function(J,C){return{x:J.x+3*J.width/4,y:J.y+J.height+C.height/2}}};return Mf(y)?function(x,q,B){return f[x](q,B?B:dm)}:void 0}();Vm(M,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Go=M.reverse,Zc=M.transparent,Cl=M.rectSelectBackground,Tj=M.dash,Jl=M.titleBackground,Gd=M.titleIconBackground,Cq=M.headerBackground,ps=M.headerIconBackground,ee=M.headerSeparator,vr=M.headerLine,Ie=M.contentIconBackground,Nf=M.contentLine,nk=(M.widgetIconHighlight,M.widgetIconBorder),Qd=(M.widgetIconGradient,M.imageBackground),Rk=M.imageGradient,$k=M.highlight,kn=M.label,Gi=M.labelSelect;if(Hq&&!y.shutAlert1){var Dg=new Date,ae=Hq.split("-"),fn=new Date(Dg.getFullYear(),Dg.getMonth(),Dg.getDate()),Hq=new Date(js(ae[0],10),js(ae[1],10)-1,js(ae[2],10)),rk=fn.getTime(),Hj=Hq.getTime(),us=K+"_try",fk=y.alert;try{var ic=y.localStorage;if(ic&&fk)if(Hj>rk&&1728e6>Hj-rk){var Do=(Hj-rk)/864e5;ic&&ic[us]!=Do&&(ic[us]=Do,y.htWillExpire?fk(y.htWillExpire.replace("{{day}}",Do)):fk("HT for Web free trial license will expire in "+Do+" days, please apply for a new license!"))}else rk>=Hj&&(y.htExpired?'':''),ic&&delete ic[us]}catch(Hk){}}Math.sign===p&&(Math.sign=function(V){return 0>V?-1:V>0?1:+V});var Cc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Vp={encode:function(T,L){var d,q,V,K,c,Q,H,f="",l=0;for(T=unescape(encodeURIComponent(T));l<T.length;)d=T.charCodeAt(l++),q=T.charCodeAt(l++),V=T.charCodeAt(l++),K=d>>2,c=(3&d)<<4|q>>4,Q=(15&q)<<2|V>>6,H=63&V,isNaN(q)?Q=H=64:isNaN(V)&&(H=64),f=f+L.charAt(K)+L.charAt(c)+L.charAt(Q)+L.charAt(H);return f},decode:function(m,l,R){for(var U,C,y,L,u,K,h,A="",i=R||0;i<m.length;)L=l.indexOf(m.charAt(i++)),u=l.indexOf(m.charAt(i++)),K=l.indexOf(m.charAt(i++)),h=l.indexOf(m.charAt(i++)),U=L<<2|u>>4,C=(15&u)<<4|K>>2,y=(3&K)<<6|h,A+=String.fromCharCode(U),64!=K&&(A+=String.fromCharCode(C)),64!=h&&(A+=String.fromCharCode(y));return A=decodeURIComponent(escape(A))},_utf8_encode:function(j){j=j.replace(/\r\n/g,"\n");for(var X="",e=0;e<j.length;e++){var $=j.charCodeAt(e);128>$?X+=String.fromCharCode($):$>127&&2048>$?(X+=String.fromCharCode(192|$>>6),X+=String.fromCharCode(128|63&$)):(X+=String.fromCharCode(224|$>>12),X+=String.fromCharCode(128|63&$>>6),X+=String.fromCharCode(128|63&$))}return X},_utf8_decode:function(b){for(var C="",$=0,G=0,Y=0,a=0;$<b.length;)G=b.charCodeAt($),128>G?(C+=String.fromCharCode(G),$++):G>191&&224>G?(Y=b.charCodeAt($+1),C+=String.fromCharCode((31&G)<<6|63&Y),$+=2):(Y=b.charCodeAt($+1),a=b.charCodeAt($+2),C+=String.fromCharCode((15&G)<<12|(63&Y)<<6|63&a),$+=3);return C}},an=[],hq=[],or=S.Math={generateUUID:function(){for(var T=[],u=0;256>u;u++)T[u]=(16>u?"0":"")+u.toString(16).toUpperCase();return function(){var I=0|4294967295*Math.random(),V=0|4294967295*Math.random(),K=0|4294967295*Math.random(),X=0|4294967295*Math.random();return T[255&I]+T[255&I>>8]+T[255&I>>16]+T[255&I>>24]+"-"+T[255&V]+T[255&V>>8]+"-"+T[64|15&V>>16]+T[255&V>>24]+"-"+T[128|63&K]+T[255&K>>8]+"-"+T[255&K>>16]+T[255&K>>24]+T[255&X]+T[255&X>>8]+T[255&X>>16]+T[255&X>>24]}}(),clamp:function(b,E,q){return Math.max(E,Math.min(q,b))},generateIncreasingID:function(){var s=0;return function(){return++s}}(),encodeBase64:function(d,W){return Vp.encode(d,W||Cc)},decodeBase64:function(r,C){return Vp.decode(r,C||Cc)},randomArray:function(i,e){e=e||i.length;for(var R=e-1;R>0;R--){var J=Math.floor(Math.random()*(R+1)),g=i[R];i[R]=i[J],i[J]=g}return i},randomInt:function(m,q){return q===p&&(q=m,m=0),m+Math.floor(Math.random()*(q-m))},isPOT:function(W){return W>0&&0===(W-1&W)},nearestPOT:function(W){if(!W)return 1;var m=W;m--,m|=m>>1,m|=m>>2,m|=m>>4,m|=m>>8,m|=m>>16,m++;var q=m>>1;return W-q>m-W?m:q},requestMatrix4:function(){return an.length>0?an.pop():new or.Matrix4},releaseMatrix4:function(c){an.push(c)},requestVector3:function(){return hq.length>0?hq.pop():new or.Vector3},releaseVector3:function(m){hq.push(m)}},zh=S.Matrix=S.Math.Matrix2d=function(O,U,Y,f,h){this.setFromTransform(O,U,Y,f,h)},mk=zh;zh.prototype={},zh.prototype.constructor=zh,zh.prototype.set=function($,E,d,f,T,K){return this.a=$,this.b=E,this.c=d,this.d=f,this.tx=T,this.ty=K,this},zh.prototype.setFromTransform=function(F,M,Y,c,s){var v=this;if(F===p)return v.a=1,v.b=0,v.c=0,v.d=1,v.tx=0,v.ty=0,void 0;var o,b;return F?(o=T(F),b=t(F)):(o=0,b=1),c=c||1,s=s||1,v.a=b*c,v.b=o*c,v.c=-o*s,v.d=b*s,v.tx=M||0,v.ty=Y||0,v},zh.prototype.apply=function(Q,m){m=m||new Qf;var M=Q.x,j=Q.y;return m.x=this.a*M+this.c*j+this.tx,m.y=this.b*M+this.d*j+this.ty,m},zh.prototype.applyInverse=function(g,F){F=F||new Qf;var h=1/(this.a*this.d+this.c*-this.b),J=g.x,T=g.y;return F.x=this.d*h*J+-this.c*h*T+(this.ty*this.c-this.tx*this.d)*h,F.y=this.a*h*T+-this.b*h*J+(-this.ty*this.a+this.tx*this.b)*h,F},zh.prototype.translate=function(H,y){return this.tx+=H,this.ty+=y,this},zh.prototype.scale=function(w,S){return this.a*=w,this.d*=S,this.c*=w,this.b*=S,this.tx*=w,this.ty*=S,this},zh.prototype.rotate=function(B){var h=Math.cos(B),G=Math.sin(B),j=this.a,s=this.c,H=this.tx;return this.a=j*h-this.b*G,this.b=j*G+this.b*h,this.c=s*h-this.d*G,this.d=s*G+this.d*h,this.tx=H*h-this.ty*G,this.ty=H*G+this.ty*h,this},zh.prototype.appendTranslate=function(Y,g){return this.tx+=this.a*Y+this.c*g,this.ty+=this.b*Y+this.d*g,this},zh.prototype.appendScale=function(U,X){return this.a*=U,this.d*=X,this.c*=X,this.b*=U,this},zh.prototype.appendRotate=function(Q){if(!Q)return this;var d=Math.cos(Q),Y=Math.sin(Q),t=this.a,S=this.b;return this.a=t*d+this.c*Y,this.b=S*d+this.d*Y,this.c=-t*Y+this.c*d,this.d=-S*Y+this.d*d,this},zh.prototype.append=function(P){var j=this.a,V=this.b,h=this.c,G=this.d;return this.a=P.a*j+P.b*h,this.b=P.a*V+P.b*G,this.c=P.c*j+P.d*h,this.d=P.c*V+P.d*G,this.tx=P.tx*j+P.ty*h+this.tx,this.ty=P.tx*V+P.ty*G+this.ty,this},zh.prototype.setTransform=function(q,m,c,e,M,$,Y,B,J){var v,r,G,l,z,C,w,T,K,U;return z=Math.sin(Y),C=Math.cos(Y),w=Math.cos(J),T=Math.sin(J),K=-Math.sin(B),U=Math.cos(B),v=C*M,r=z*M,G=-z*$,l=C*$,this.a=w*v+T*G,this.b=w*r+T*l,this.c=K*v+U*G,this.d=K*r+U*l,this.tx=q+(c*v+e*G),this.ty=m+(c*r+e*l),this},zh.prototype.prepend=function(E){var _=this.tx;if(1!==E.a||0!==E.b||0!==E.c||1!==E.d){var J=this.a,s=this.c;this.a=J*E.a+this.b*E.c,this.b=J*E.b+this.b*E.d,this.c=s*E.a+this.d*E.c,this.d=s*E.b+this.d*E.d}return this.tx=_*E.a+this.ty*E.c+E.tx,this.ty=_*E.b+this.ty*E.d+E.ty,this},zh.prototype.transform=zh.prototype.prepend,zh.prototype.invert=function(){var F=this.a,u=this.b,k=this.c,r=this.d,K=this.tx,n=F*r-u*k;return this.a=r/n,this.b=-u/n,this.c=-k/n,this.d=F/n,this.tx=(k*this.ty-r*K)/n,this.ty=-(F*this.ty-u*K)/n,this},zh.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},zh.prototype.clone=function(){var O=new zh;return O.a=this.a,O.b=this.b,O.c=this.c,O.d=this.d,O.tx=this.tx,O.ty=this.ty,O},zh.prototype.copy=function(M){return M.a=this.a,M.b=this.b,M.c=this.c,M.d=this.d,M.tx=this.tx,M.ty=this.ty,M},zh.prototype.tf=function(l,Q){1===arguments.length&&(Q=l.y,l=l.x);var U=this;return{x:U.a*l+U.c*Q+U.tx,y:U.b*l+U.d*Q+U.ty}},zh.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},zh.prototype.fromArray=function(C){return this.a=C[0],this.b=C[1],this.c=C[2],this.d=C[3],this.tx=C[4],this.ty=C[5],this},zh.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},zh.prototype.tfi=function(G,C){1===arguments.length&&(C=G.y,G=G.x);var X=this,x=1/(X.a*X.d+X.c*-X.b);return{x:X.d*x*G+-X.c*x*C+(X.ty*X.c-X.tx*X.d)*x,y:X.a*x*C+-X.b*x*G+(-X.ty*X.a+X.tx*X.b)*x}},zh.IDENTITY=new zh,zh.TEMP_MATRIX=new zh;var nd=S.Math.Quaternion=function(v,o,s,k){this.set(v,o,s,k)};b.assign(nd.prototype,{set:function(f,I,r,u){var K=this;return K._x=f||0,K._y=I||0,K._z=r||0,K._w=u!==p?u:1,K},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(V){var A=this;return A._x=V._x,A._y=V._y,A._z=V._z,A._w=V._w,A},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(P){return this._x*P._x+this._y*P._y+this._z*P._z+this._w*P._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var s=this.length();return 0===s?(this._x=0,this._y=0,this._z=0,this._w=1):(s=1/s,this._x=this._x*s,this._y=this._y*s,this._z=this._z*s,this._w=this._w*s),this},fromArray:function(A,R){R===p&&(R=0);var r=this;return r._x=A[R],r._y=A[R+1],r._z=A[R+2],r._w=A[R+3],this},slerp:function(G,c){if(0===c)return this;if(1===c)return this.copy(G);var J=this._x,x=this._y,s=this._z,y=this._w,p=y*G._w+J*G._x+x*G._y+s*G._z;if(0>p?(this._w=-G._w,this._x=-G._x,this._y=-G._y,this._z=-G._z,p=-p):this.copy(G),p>=1)return this._w=y,this._x=J,this._y=x,this._z=s,this;var A=Math.sqrt(1-p*p);if(Math.abs(A)<.001)return this._w=.5*(y+this._w),this._x=.5*(J+this._x),this._y=.5*(x+this._y),this._z=.5*(s+this._z),this;var $=Math.atan2(A,p),I=Math.sin((1-c)*$)/A,V=Math.sin(c*$)/A;return this._w=y*I+this._w*V,this._x=J*I+this._x*V,this._y=x*I+this._y*V,this._z=s*I+this._z*V,this},setFromAxisAngle:function(J,x){var c=x/2,j=Math.sin(c);return this._x=J.x*j,this._y=J.y*j,this._z=J.z*j,this._w=Math.cos(c),this},setFromEuler:function(d){var V=d._x,s=d._y,w=d._z,t=d._order,o=Math.cos,i=Math.sin,K=o(V/2),X=o(s/2),c=o(w/2),J=i(V/2),D=i(s/2),x=i(w/2);return"XYZ"===t?(this._x=J*X*c+K*D*x,this._y=K*D*c-J*X*x,this._z=K*X*x+J*D*c,this._w=K*X*c-J*D*x):"YXZ"===t?(this._x=J*X*c+K*D*x,this._y=K*D*c-J*X*x,this._z=K*X*x-J*D*c,this._w=K*X*c+J*D*x):"ZXY"===t?(this._x=J*X*c-K*D*x,this._y=K*D*c+J*X*x,this._z=K*X*x+J*D*c,this._w=K*X*c-J*D*x):"ZYX"===t?(this._x=J*X*c-K*D*x,this._y=K*D*c+J*X*x,this._z=K*X*x-J*D*c,this._w=K*X*c+J*D*x):"YZX"===t?(this._x=J*X*c+K*D*x,this._y=K*D*c+J*X*x,this._z=K*X*x-J*D*c,this._w=K*X*c-J*D*x):"XZY"===t&&(this._x=J*X*c-K*D*x,this._y=K*D*c-J*X*x,this._z=K*X*x+J*D*c,this._w=K*X*c+J*D*x),this},setFromRotationMatrix:function($){var b,l=$.el,L=l[0],R=l[4],B=l[8],k=l[1],I=l[5],t=l[9],D=l[2],c=l[6],Z=l[10],T=L+I+Z;return T>0?(b=.5/Math.sqrt(T+1),this._w=.25/b,this._x=(c-t)*b,this._y=(B-D)*b,this._z=(k-R)*b):L>I&&L>Z?(b=2*Math.sqrt(1+L-I-Z),this._w=(c-t)/b,this._x=.25*b,this._y=(R+k)/b,this._z=(B+D)/b):I>Z?(b=2*Math.sqrt(1+I-L-Z),this._w=(B-D)/b,this._x=(R+k)/b,this._y=.25*b,this._z=(t+c)/b):(b=2*Math.sqrt(1+Z-L-I),this._w=(k-R)/b,this._x=(B+D)/b,this._y=(t+c)/b,this._z=.25*b),this},setFromToVectors:function(){var f,$;return function(K,m){return f===p&&(f=new Zh),$=K.dot(m)+1,1e-7>$?($=0,Math.abs(K.x)>Math.abs(K.z)?f.set(-K.y,K.x,0):f.set(0,-K.z,K.y)):f.crossVectors(K,m),this._x=f.x,this._y=f.y,this._z=f.z,this._w=$,this.normalize()}}(),setFromUnitVectors:function(){var f,B,g=1e-6;return function(v,l){return f===p&&(f=new Zh),B=v.dot(l)+1,g>B?(B=0,Math.abs(v.x)>Math.abs(v.z)?f.set(-v.y,v.x,0):f.set(0,-v.z,v.y)):f.crossVectors(v,l),this._x=f.x,this._y=f.y,this._z=f.z,this._w=B,this.normalize()}}(),multiply:function(S){return this.multiplyQuaternions(this,S)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(r,d){var G=r._x,b=r._y,n=r._z,h=r._w,a=d._x,u=d._y,Q=d._z,l=d._w;return this._x=G*l+h*a+b*Q-n*u,this._y=b*l+h*u+n*a-G*Q,this._z=n*l+h*Q+G*u-b*a,this._w=h*l-G*a-b*u-n*Q,this},toArray:function(X,P){return X||(X=[]),P=P||0,X[P]=this._x,X[P+1]=this._y,X[P+2]=this._z,X[P+3]=this._w,X}});var Gg=S.Math.Vector4=function(D,o,l,i){this.x=D||0,this.y=o||0,this.z=l||0,this.w=i!==p?i:1};b.assign(Gg.prototype,{isVector4:!0,set:function(e,z,P,Q){return this.x=e,this.y=z,this.z=P,this.w=Q,this},setScalar:function(Z){return this.x=Z,this.y=Z,this.z=Z,this.w=Z,this},setX:function(e){return this.x=e,this},setY:function(K){return this.y=K,this},setZ:function(E){return this.z=E,this},setW:function(M){return this.w=M,this},setComponent:function(B,$){switch(B){case 0:this.x=$;break;case 1:this.y=$;break;case 2:this.z=$;break;case 3:this.w=$;break;default:throw new Error("index is out of range: "+B)}return this},getComponent:function(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(k){return this.x=k.x,this.y=k.y,this.z=k.z,this.w=k.w!==p?k.w:1,this},add:function(M,E){return E!==p?this.addVectors(M,E):(this.x+=M.x,this.y+=M.y,this.z+=M.z,this.w+=M.w,this)},addScalar:function(F){return this.x+=F,this.y+=F,this.z+=F,this.w+=F,this},addVectors:function(Z,O){return this.x=Z.x+O.x,this.y=Z.y+O.y,this.z=Z.z+O.z,this.w=Z.w+O.w,this},addScaledVector:function(r,q){return this.x+=r.x*q,this.y+=r.y*q,this.z+=r.z*q,this.w+=r.w*q,this},sub:function(L,e){return e!==p?this.subVectors(L,e):(this.x-=L.x,this.y-=L.y,this.z-=L.z,this.w-=L.w,this)},subScalar:function(K){return this.x-=K,this.y-=K,this.z-=K,this.w-=K,this},subVectors:function(Y,g){return this.x=Y.x-g.x,this.y=Y.y-g.y,this.z=Y.z-g.z,this.w=Y.w-g.w,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this},applyMatrix4:function(u){var O=this.x,V=this.y,M=this.z,Q=this.w,i=u.el;return this.x=i[0]*O+i[4]*V+i[8]*M+i[12]*Q,this.y=i[1]*O+i[5]*V+i[9]*M+i[13]*Q,this.z=i[2]*O+i[6]*V+i[10]*M+i[14]*Q,this.w=i[3]*O+i[7]*V+i[11]*M+i[15]*Q,this},divideScalar:function(o){return this.multiplyScalar(1/o)},setAxisAngleFromQuaternion:function(O){this.w=2*Math.acos(O.w);var T=Math.sqrt(1-O.w*O.w);return 1e-4>T?(this.x=1,this.y=0,this.z=0):(this.x=O.x/T,this.y=O.y/T,this.z=O.z/T),this},setAxisAngleFromRotationMatrix:function(N){var n,M,_,Y,b=.01,u=.1,D=N.el,K=D[0],e=D[4],B=D[8],j=D[1],U=D[5],p=D[9],F=D[2],r=D[6],V=D[10];if(Math.abs(e-j)<b&&Math.abs(B-F)<b&&Math.abs(p-r)<b){if(Math.abs(e+j)<u&&Math.abs(B+F)<u&&Math.abs(p+r)<u&&Math.abs(K+U+V-3)<u)return this.set(1,0,0,0),this;n=Math.PI;var s=(K+1)/2,G=(U+1)/2,g=(V+1)/2,T=(e+j)/4,S=(B+F)/4,f=(p+r)/4;return s>G&&s>g?b>s?(M=0,_=.707106781,Y=.707106781):(M=Math.sqrt(s),_=T/M,Y=S/M):G>g?b>G?(M=.707106781,_=0,Y=.707106781):(_=Math.sqrt(G),M=T/_,Y=f/_):b>g?(M=.707106781,_=.707106781,Y=0):(Y=Math.sqrt(g),M=S/Y,_=f/Y),this.set(M,_,Y,n),this}var h=Math.sqrt((r-p)*(r-p)+(B-F)*(B-F)+(j-e)*(j-e));return Math.abs(h)<.001&&(h=1),this.x=(r-p)/h,this.y=(B-F)/h,this.z=(j-e)/h,this.w=Math.acos((K+U+V-1)/2),this},min:function(I){return this.x=Math.min(this.x,I.x),this.y=Math.min(this.y,I.y),this.z=Math.min(this.z,I.z),this.w=Math.min(this.w,I.w),this},max:function(Z){return this.x=Math.max(this.x,Z.x),this.y=Math.max(this.y,Z.y),this.z=Math.max(this.z,Z.z),this.w=Math.max(this.w,Z.w),this},clamp:function(s,Z){return this.x=Math.max(s.x,Math.min(Z.x,this.x)),this.y=Math.max(s.y,Math.min(Z.y,this.y)),this.z=Math.max(s.z,Math.min(Z.z,this.z)),this.w=Math.max(s.w,Math.min(Z.w,this.w)),this},clampScalar:function(){var O,L;return function(F,R){return O===p&&(O=new Gg,L=new Gg),O.set(F,F,F,F),L.set(R,R,R,R),this.clamp(O,L)}}(),clampLength:function(A,h){var O=this.length();return this.divideScalar(O||1).multiplyScalar(Math.max(A,Math.min(h,O)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(F){return this.x*F.x+this.y*F.y+this.z*F.z+this.w*F.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w
},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(G){return this.normalize().multiplyScalar(G)},lerp:function(s,A){return this.x+=(s.x-this.x)*A,this.y+=(s.y-this.y)*A,this.z+=(s.z-this.z)*A,this.w+=(s.w-this.w)*A,this},lerpVectors:function(k,T,W){return this.subVectors(T,k).multiplyScalar(W).add(k)},equals:function(x){return x.x===this.x&&x.y===this.y&&x.z===this.z&&x.w===this.w},fromArray:function(N,_){return _===p&&(_=0),this.x=N[_],this.y=N[_+1],this.z=N[_+2],this.w=N[_+3],this},toArray:function(g,y){return g===p&&(g=[]),y===p&&(y=0),g[y]=this.x,g[y+1]=this.y,g[y+2]=this.z,g[y+3]=this.w,g},fromBufferAttribute:function(I,y){return this.x=I.getX(y),this.y=I.getY(y),this.z=I.getZ(y),this.w=I.getW(y),this}});var Zh=S.Math.Vector3=function(K,Y,U){K===p?(this.x=0,this.y=0,this.z=0):"object"==typeof K?this.copy(K):this.set(K,Y==p?K:Y,U==p?K:U)},Ph=S.Math.Vector3;b.assign(Zh.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(v,X,U){return this.x=v,this.y=X,this.z=U,this},equals:function(U){return U&&this.x===U.x&&this.y===U.y&&this.z===U.z},setScalar:function(j){return this.x=j,this.y=j,this.z=j,this},setX:function(N){return this.x=N,this},setY:function(u){return this.y=u,this},setZ:function(M){return this.z=M,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(u){return u.x===p?(this.x=u[0],this.y=u[1],this.z=u[2]):(this.x=u.x,this.y=u.y,this.z=u.z||0),this},add:function(S){return this.x+=S.x,this.y+=S.y,this.z+=S.z,this},addScalar:function(i){return this.x+=i,this.y+=i,this.z+=i,this},addVectors:function(b,i){return this.x=b.x+i.x,this.y=b.y+i.y,this.z=b.z+i.z,this},addScaledVector:function(n,Z){return this.x+=n.x*Z,this.y+=n.y*Z,this.z+=n.z*Z,this},sub:function(s){return this.x-=s.x,this.y-=s.y,this.z-=s.z,this},subScalar:function(f){return this.x-=f,this.y-=f,this.z-=f,this},subVectors:function(d,W){return this.x=d.x-W.x,this.y=d.y-W.y,this.z=d.z-W.z,this},divide:function(m){return this.x/=m.x,this.y/=m.y,this.z/=m.z,this},multiply:function(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this},multiplyScalar:function(m){return this.x*=m,this.y*=m,this.z*=m,this},divideScalar:function(t){if(0!==t){var W=1/t;this.x*=W,this.y*=W,this.z*=W}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(L){return Math.sqrt(this.distanceToSquared(L))},distanceToSquared:function(F){var d=this.x-F.x,P=this.y-F.y,W=this.z-F.z;return d*d+P*P+W*W},distanceToSquared2:function(X){var g=this.x-X[0],K=this.y-X[1],R=this.z-X[2];return g*g+K*K+R*R},divideVectors:function(Y,j){return this.x=Y.x/j.x,this.y=Y.y/j.y,this.z=Y.z/j.z,this},multiplyVectors:function(T,h){return this.x=T.x*h.x,this.y=T.y*h.y,this.z=T.z*h.z,this},transformDirection:function(Y){var G=this.x,q=this.y,J=this.z,B=Y.el;return this.x=B[0]*G+B[4]*q+B[8]*J,this.y=B[1]*G+B[5]*q+B[9]*J,this.z=B[2]*G+B[6]*q+B[10]*J,this.normalize()},applyAxisAngle:function(){var X=new nd;return function(n,i){return this.applyQuaternion(X.setFromAxisAngle(n,i))}}(),applyEuler:function(){var g=new nd;return function(N){return this.applyQuaternion(g.setFromEuler(N))}}(),applyQuaternion:function(R){var Q=this.x,T=this.y,q=this.z,x=R._x,K=R._y,N=R._z,J=R._w,I=J*Q+K*q-N*T,p=J*T+N*Q-x*q,b=J*q+x*T-K*Q,a=-x*Q-K*T-N*q;return this.x=I*J+a*-x+p*-N-b*-K,this.y=p*J+a*-K+b*-x-I*-N,this.z=b*J+a*-N+I*-K-p*-x,this},applyMatrix4:function(Z){var w=this.x,X=this.y,m=this.z,N=Z.el,H=1/(N[3]*w+N[7]*X+N[11]*m+N[15]);return this.x=(N[0]*w+N[4]*X+N[8]*m+N[12])*H,this.y=(N[1]*w+N[5]*X+N[9]*m+N[13])*H,this.z=(N[2]*w+N[6]*X+N[10]*m+N[14])*H,this},applyMatrix3:function(W){var h=this.x,V=this.y,D=this.z,L=W.el;return this.x=L[0]*h+L[3]*V+L[6]*D,this.y=L[1]*h+L[4]*V+L[7]*D,this.z=L[2]*h+L[5]*V+L[8]*D,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var F=new Zh;return function(C){return this.sub(F.copy(C).multiplyScalar(2*this.dot(C)))}}(),dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var b=this.length();return b?this.multiplyScalar(1/b):this},setLength:function(C){return this.normalize().multiplyScalar(C)},fromArray:function(B,F){return F===p&&(F=0),this.x=B[F],this.y=B[F+1],this.z=B[F+2],this},toArray:function(L,O){return L===p&&(L=[0,0,0]),O===p&&(O=0),L[O]=this.x,L[O+1]=this.y,L[O+2]=this.z,L},cross:function(I){return this.crossVectors(this,I)},angleTo:function(y){var z=this.dot(y)/Math.sqrt(this.lengthSq()*y.lengthSq());return z>1||-1>z?0:Math.acos(z)},lerp:function(B,G){return this.x+=(B.x-this.x)*G,this.y+=(B.y-this.y)*G,this.z+=(B.z-this.z)*G,this},lerpVectors:function(v,E,t){return this.subVectors(E,v).multiplyScalar(t).add(v)},crossVectors:function(E,W){var c=E.x,Y=E.y,j=E.z,h=W.x,S=W.y,o=W.z;return this.x=Y*o-j*S,this.y=j*h-c*o,this.z=c*S-Y*h,this},min:function(X){return this.x=Math.min(this.x,X.x),this.y=Math.min(this.y,X.y),this.z=Math.min(this.z,X.z),this},max:function(I){return this.x=Math.max(this.x,I.x),this.y=Math.max(this.y,I.y),this.z=Math.max(this.z,I.z),this},setFromMatrixPosition:function(K){return this.setFromMatrixColumn(K,3)},setFromMatrixScale:function(O){var d=this.setFromMatrixColumn(O,0).length(),F=this.setFromMatrixColumn(O,1).length(),E=this.setFromMatrixColumn(O,2).length();return this.x=d,this.y=F,this.z=E,this},setFromMatrixColumn:function(F,$){return this.fromArray(F.el,4*$)}}),Zh.UP=new Zh(0,1,0),Zh.AxisX=new Zh(1,0,0),Zh.AxisY=new Zh(0,1,0),Zh.AxisZ=new Zh(0,0,1);var Qf=S.Math.Vector2=function(r,v,j){"object"==typeof r&&(r.x!=p?(v=r.y,j=r.e,r=r.x):(j=r[2],v=r[1],r=r[0])),this.set(r||0,v||0,j)};Qf.prototype={},Qf.prototype.constructor=Qf;var So=Qf;b.defineProperties(Qf.prototype,{width:{get:function(){return this.x},set:function(o){this.x=o}},height:{get:function(){return this.y},set:function(K){this.y=K}}}),Qf.prototype.clone=function(){return new Qf(this.x,this.y,this.e)},Qf.prototype.copy=function(l){return this.set(l.x,l.y,l.e),this},Qf.prototype.equals=function(b){return b.x===this.x&&b.y===this.y&&b.e===this.e},Qf.prototype.set=function(R,j,_){return this.x=R||0,this.y=j||(0!==j?this.x:0),_!=p&&(this.e=_),this},Qf.prototype.setScalar=function($){return this.x=$,this.y=$,this.e=$,this},Qf.prototype.setX=function(d){return this.x=d||0,this},Qf.prototype.setY=function(S){return this.y=S||0,this},Qf.prototype.setE=function(l){return this.e=l||0,this},Qf.prototype.add=function(r){return this.x+=r.x,this.y+=r.y,this},Qf.prototype.addVectors=function(w,f){return this.x=w.x+f.x,this.y=w.y+f.y,this},Qf.prototype.addScalar=function(w){return this.x+=w,this.y+=w,this},Qf.prototype.addScaledVector=function(D,n){return this.x+=D.x*n,this.y+=D.y*n,this},Qf.prototype.sub=function(h){return this.x-=h.x,this.y-=h.y,this},Qf.prototype.subScalar=function(P){return this.x-=P,this.y-=P,this},Qf.prototype.subVectors=function(L,X){return this.x=L.x-X.x,this.y=L.y-X.y,this},Qf.prototype.multiply=function(d){return this.x*=d.x,this.y*=d.y,this},Qf.prototype.multiplyScalar=function(Y){return this.x*=Y,this.y*=Y,this},Qf.prototype.divide=function(U){return this.x/=U.x,this.y/=U.y,this},Qf.prototype.divideScalar=function(K){return this.multiplyScalar(1/K)},Qf.prototype.min=function(x){return this.x=Math.min(this.x,x.x),this.y=Math.min(this.y,x.y),this},Qf.prototype.max=function(V){return this.x=Math.max(this.x,V.x),this.y=Math.max(this.y,V.y),this},Qf.prototype.fromArray=function(r,I){return I===p&&(I=0),this.x=r[I],this.y=r[I+1],this},Qf.prototype.clamp=function(L,E){return this.x=Math.max(L.x,Math.min(E.x,this.x)),this.y=Math.max(L.y,Math.min(E.y,this.y)),this},Qf.prototype.clampScalar=function(){var W,f;return function(n,T){return W===p&&(W=new Qf,f=new Qf),W.set(n,n),f.set(T,T),this.clamp(W,f)}}(),Qf.prototype.clampLength=function(c,i){var w=this.length();return this.multiplyScalar(Math.max(c,Math.min(i,w))/w)},Qf.prototype.dot=function(u){return this.x*u.x+this.y*u.y},Qf.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Qf.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Qf.prototype.normalize=function(){return this.divideScalar(this.length())},Qf.prototype.angle=function(){var r=Math.atan2(this.y,this.x);return 0>r&&(r+=2*Math.PI),r},Qf.prototype.distanceTo=function(C){return Math.sqrt(this.distanceToSquared(C))},Qf.prototype.distanceToSquared=function(v){var K=this.x-v.x,w=this.y-v.y;return K*K+w*w},Qf.prototype.isNearEnough=function(W){return this.distanceToSquared(W)<1e-8},Qf.prototype.setLength=function(v){var w=this.length();return w?this.multiplyScalar(v/w):this},Qf.prototype.lerp=function(D,d){return this.x+=(D.x-this.x)*d,this.y+=(D.y-this.y)*d,"number"==typeof D.e&&"number"==typeof this.e&&(this.e+=(D.e-this.e)*d),this},Qf.prototype.lerpVectors=function(W,P,X){return this.subVectors(P,W).multiplyScalar(X).add(W)},Qf.prototype.rotateAround=function(t,o){var U=t?t.x:0,G=t?t.y:0,_=Math.cos(o),E=Math.sin(o),d=this.x-U,r=this.y-G;return this.x=d*_-r*E+U,this.y=d*E+r*_+G,this};var Cr=S.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};b.assign(Cr.prototype,{isMatrix3:!0,set:function(D,w,i,Q,q,G,S,V,y){var Y=this.el;return Y[0]=D,Y[1]=Q,Y[2]=S,Y[3]=w,Y[4]=q,Y[5]=V,Y[6]=i,Y[7]=G,Y[8]=y,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(h){var y=this.el,x=h.el;return y[0]=x[0],y[1]=x[1],y[2]=x[2],y[3]=x[3],y[4]=x[4],y[5]=x[5],y[6]=x[6],y[7]=x[7],y[8]=x[8],this},setFromMatrix4:function(k){var s=k.el;return this.set(s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]),this},applyToBufferAttribute:function(){var u=new Zh;return function(D){for(var k=0,P=D.count;P>k;k++)u.x=D.getX(k),u.y=D.getY(k),u.z=D.getZ(k),u.applyMatrix3(this),D.setXYZ(k,u.x,u.y,u.z);return D}}(),multiply:function(x){return this.multiplyMatrices(this,x)},premultiply:function(X){return this.multiplyMatrices(X,this)},multiplyMatrices:function(p,w){var R=p.el,r=w.el,K=this.el,c=R[0],g=R[3],B=R[6],u=R[1],O=R[4],W=R[7],s=R[2],y=R[5],Y=R[8],m=r[0],t=r[3],H=r[6],F=r[1],U=r[4],T=r[7],n=r[2],x=r[5],b=r[8];return K[0]=c*m+g*F+B*n,K[3]=c*t+g*U+B*x,K[6]=c*H+g*T+B*b,K[1]=u*m+O*F+W*n,K[4]=u*t+O*U+W*x,K[7]=u*H+O*T+W*b,K[2]=s*m+y*F+Y*n,K[5]=s*t+y*U+Y*x,K[8]=s*H+y*T+Y*b,this},multiplyScalar:function(O){var Z=this.el;return Z[0]*=O,Z[3]*=O,Z[6]*=O,Z[1]*=O,Z[4]*=O,Z[7]*=O,Z[2]*=O,Z[5]*=O,Z[8]*=O,this},determinant:function(){var r=this.el,j=r[0],h=r[1],g=r[2],e=r[3],W=r[4],M=r[5],s=r[6],d=r[7],A=r[8];return j*W*A-j*M*d-h*e*A+h*M*s+g*e*d-g*W*s},getInverse:function(p){var W=p.el,H=this.el,g=W[0],q=W[1],T=W[2],Z=W[3],N=W[4],s=W[5],X=W[6],O=W[7],S=W[8],i=S*N-s*O,Q=s*X-S*Z,z=O*Z-N*X,c=g*i+q*Q+T*z;if(0===c)return this.identity();var o=1/c;return H[0]=i*o,H[1]=(T*O-S*q)*o,H[2]=(s*q-T*N)*o,H[3]=Q*o,H[4]=(S*g-T*X)*o,H[5]=(T*Z-s*g)*o,H[6]=z*o,H[7]=(q*X-O*g)*o,H[8]=(N*g-q*Z)*o,this},transpose:function(){var T,J=this.el;return T=J[1],J[1]=J[3],J[3]=T,T=J[2],J[2]=J[6],J[6]=T,T=J[5],J[5]=J[7],J[7]=T,this},getNormalMatrix:function(B){return this.setFromMatrix4(B).getInverse(this).transpose()},transposeIntoArray:function(r){var t=this.el;return r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8],this},setUvTransform:function($,M,E,P,R,g,d){var x=Math.cos(R),Y=Math.sin(R);this.set(E*x,E*Y,-E*(x*g+Y*d)+g+$,-P*Y,P*x,-P*(-Y*g+x*d)+d+M,0,0,1)},scale:function(C,r){var Q=this.el;return Q[0]*=C,Q[3]*=C,Q[6]*=C,Q[1]*=r,Q[4]*=r,Q[7]*=r,this},rotate:function(X){var t=Math.cos(X),I=Math.sin(X),r=this.el,G=r[0],J=r[3],s=r[6],M=r[1],B=r[4],H=r[7];return r[0]=t*G+I*M,r[3]=t*J+I*B,r[6]=t*s+I*H,r[1]=-I*G+t*M,r[4]=-I*J+t*B,r[7]=-I*s+t*H,this},translate:function(X,V){var N=this.el;return N[0]+=X*N[2],N[3]+=X*N[5],N[6]+=X*N[8],N[1]+=V*N[2],N[4]+=V*N[5],N[7]+=V*N[8],this},equals:function(A){for(var a=this.el,c=A.el,S=0;9>S;S++)if(a[S]!==c[S])return!1;return!0},fromArray:function(j,_){_===p&&(_=0);for(var B=0;9>B;B++)this.el[B]=j[B+_];return this},toArray:function(G,F){G===p&&(G=[]),F===p&&(F=0);var l=this.el;return G[F]=l[0],G[F+1]=l[1],G[F+2]=l[2],G[F+3]=l[3],G[F+4]=l[4],G[F+5]=l[5],G[F+6]=l[6],G[F+7]=l[7],G[F+8]=l[8],G}});var Fc=S.Math.Plane=function(N,R){this.normal=N!==p?N:new Zh(1,0,0),this.constant=R!==p?R:0};b.assign(Fc.prototype,{set:function(W,D){return this.normal.copy(W),this.constant=D,this},setComponents:function(J,A,d,E){return this.normal.set(J,A,d),this.constant=E,this},setFromNormalAndCoplanarPoint:function(C,W){return this.normal.copy(C),this.constant=-W.dot(this.normal),this},setFromCoplanarPoints:function(){var R=new Zh,E=new Zh;return function(d,c,u){var K=R.subVectors(u,c).cross(E.subVectors(d,c)).normalize();return this.setFromNormalAndCoplanarPoint(K,d),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(V){return this.normal.copy(V.normal),this.constant=V.constant,this},normalize:function(){var S=1/this.normal.length();return this.normal.multiplyScalar(S),this.constant*=S,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(_){return this.normal.dot(_)+this.constant},distanceToSphere:function(k){return this.distanceToPoint(k.center)-k.radius},projectPoint:function(m,O){return O===p&&(O=new Zh),O.copy(this.normal).multiplyScalar(-this.distanceToPoint(m)).add(m)},intersectLine:function(){var H=new Zh;return function(r,U){U===p&&(U=new Zh);var $=r.delta(H),n=this.normal.dot($);if(0===n)return 0===this.distanceToPoint(r.start)?U.copy(r.start):p;var a=-(r.start.dot(this.normal)+this.constant)/n;return 0>a||a>1?p:U.copy($).multiplyScalar(a).add(r.start)}}(),intersectsLine:function(f){var w=this.distanceToPoint(f.start),k=this.distanceToPoint(f.end);return 0>w&&k>0||0>k&&w>0},intersectsBox:function(X){return X.intersectsPlane(this)},intersectsSphere:function(_){return _.intersectsPlane(this)},coplanarPoint:function(d){return d===p&&(d=new Zh),d.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var Q=new Zh,f=new Cr;return function(y,i){var t=i||f.getNormalMatrix(y),O=this.coplanarPoint(Q).applyMatrix4(y),l=this.normal.applyMatrix3(t).normalize();return this.constant=-O.dot(l),this}}(),translate:function(n){return this.constant-=n.dot(this.normal),this},equals:function(i){return i.normal.equals(this.normal)&&i.constant===this.constant}});var Hp=S.Math.Ray=function(Y,z){this.origin=Y!==p?Y.clone():new Zh,this.direction=z!==p?z.clone():new Zh};b.assign(Hp.prototype,{set:function(n,u){return this.origin.copy(n),this.direction.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(o){return this.origin.copy(o.origin),this.direction.copy(o.direction),this.maxHitLen=o.maxHitLen,this},at:function(s,X){var e=X||new Zh;return e.copy(this.direction).multiplyScalar(s).add(this.origin)},setMaxHitLength:function(t){this.maxHitLen=t},lookAt:function(b){return this.direction.copy(b).sub(this.origin).normalize(),this},applyMatrix4:function(f){var w=this.maxHitLen;if(w){var N=this.direction.clone().multiplyScalar(w).add(this.origin);N.applyMatrix4(f)}return this.origin.applyMatrix4(f),this.direction.transformDirection(f),w&&(this.maxHitLen=this.origin.distanceTo(N)),this},distanceToPlane:function(S){var y=S.normal.dot(this.direction);if(0===y)return 0===S.distanceToPoint(this.origin)?0:null;var T=-(this.origin.dot(S.normal)+S.constant)/y;return T>=0?T:null},intersectPlane:function(L,G){var z=this.distanceToPlane(L);return null===z?null:this.at(z,G)},intersectSphere:function(){var F=new Zh;return function(z,V){F.subVectors(z.center,this.origin);var W=F.dot(this.direction),S=F.dot(F)-W*W,c=z.radius*z.radius;if(S>c)return null;var b=Math.sqrt(c-S),P=W-b,R=W+b;return 0>P&&0>R?null:0>P?this.at(R,V):this.at(P,V)}}(),intersectEllipsoid:function(){var X=new Zh,H=new Zh;return function(M,O){X.subVectors(M.center,this.origin),X.divide(M.radius),H.divideVectors(this.direction,M.radius);var u=H.lengthSq(),D=X.dot(H),y=X.dot(X)*u-D*D;if(y>u)return null;var Y=Math.sqrt(u-y),J=(D-Y)/u,q=(D+Y)/u;return 0>J&&0>q?null:0>J?this.at(q,O):this.at(J,O)}}(),intersectBox:function(r,s){var L,F,M,x,W,g,u=1/this.direction.x,e=1/this.direction.y,R=1/this.direction.z,P=this.origin;if(u>=0?(L=(r.min.x-P.x)*u,F=(r.max.x-P.x)*u):(L=(r.max.x-P.x)*u,F=(r.min.x-P.x)*u),e>=0?(M=(r.min.y-P.y)*e,x=(r.max.y-P.y)*e):(M=(r.max.y-P.y)*e,x=(r.min.y-P.y)*e),L>x||M>F)return null;if((M>L||L!==L)&&(L=M),(F>x||F!==F)&&(F=x),R>=0?(W=(r.min.z-P.z)*R,g=(r.max.z-P.z)*R):(W=(r.max.z-P.z)*R,g=(r.min.z-P.z)*R),L>g||W>F)return null;if((W>L||L!==L)&&(L=W),(F>g||F!==F)&&(F=g),0>F)return null;var k=L>=0?L:F,n=this.maxHitLen;return n&&k>n?null:this.at(k,s)},intersectTriangle:function(){var r=new Zh,o=new Zh,q=new Zh,u=new Zh;return function(w,f,l,S,t){o.subVectors(f,w),q.subVectors(l,w),u.crossVectors(o,q);var e,g=this.direction.dot(u);if(g>0){if(S)return null;e=1}else{if(!(0>g))return null;e=-1,g=-g}r.subVectors(this.origin,w);var k=e*this.direction.dot(q.crossVectors(r,q));if(0>k)return null;var K=e*this.direction.dot(o.cross(r));if(0>K||k+K>g)return null;var Q=-e*r.dot(u);if(0>Q)return null;var I=Q/g,B=this.maxHitLen;return B&&I>B?null:this.at(I,t)}}()});var ml=S.Math.Box3=function(c,Q){this.min=c!==p?c:new Zh(1/0,1/0,1/0),this.max=Q!==p?Q:new Zh(-1/0,-1/0,-1/0)};b.assign(ml.prototype,{set:function(u,l){return this.min.copy(u),this.max.copy(l),this},setFromArray:function(Y){for(var t=1/0,B=1/0,X=1/0,d=-1/0,k=-1/0,L=-1/0,H=0,l=Y.length;l>H;H+=3){var s=Y[H],z=Y[H+1],Q=Y[H+2];t>s&&(t=s),B>z&&(B=z),X>Q&&(X=Q),s>d&&(d=s),z>k&&(k=z),Q>L&&(L=Q)}return this.min.set(t,B,X),this.max.set(d,k,L),this},setFromPoints:function(w){this.makeEmpty();for(var A=0,l=w.length;l>A;A++)this.expandByPoint(w[A]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(E){return E.max.x<this.min.x||E.min.x>this.max.x||E.max.y<this.min.y||E.min.y>this.max.y||E.max.z<this.min.z||E.min.z>this.max.z?!1:!0},copy:function(Z){return this.min.copy(Z.min),this.max.copy(Z.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(y){return this.min.min(y),this.max.max(y),this},expandByBox:function(E){return this.min.min(E.min),this.max.max(E.max),this},applyMatrix4:function(){var s=[new Zh,new Zh,new Zh,new Zh,new Zh,new Zh,new Zh,new Zh];return function(l){return this.isEmpty()?this:(s[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(l),s[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(l),s[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(l),s[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(l),s[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(l),s[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(l),s[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(l),s[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(l),this.setFromPoints(s),this)}}()});var Xp=S.Math.Sphere=function(F,i){this.center=F!==p?F:new Zh,this.radius=i!==p?i:0};b.assign(Xp.prototype,{set:function(g,B){return this.center.copy(g),this.radius=B,this},setFromPoints:function(){var G=new ml;return function(Q,O){var k=this.center;O!==p?k.copy(O):G.setFromPoints(Q).getCenter(k);for(var h=0,e=0,D=Q.length;D>e;e++)h=Math.max(h,k.distanceToSquared(Q[e]));return this.radius=Math.sqrt(h),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(j){return this.center.copy(j.center),this.radius=j.radius,this},empty:function(){return this.radius<=0},containsPoint:function(T){return T.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(k){return k.distanceTo(this.center)-this.radius},intersectsSphere:function(I){var K=this.radius+I.radius;return I.center.distanceToSquared(this.center)<=K*K},intersectsBox:function(W){return W.intersectsSphere(this)},intersectsPlane:function(I){return Math.abs(I.distanceToPoint(this.center))<=this.radius},clampPoint:function(o,g){var j=this.center.distanceToSquared(o);return g===p&&(g=new Zh),g.copy(o),j>this.radius*this.radius&&(g.sub(this.center).normalize(),g.multiplyScalar(this.radius).add(this.center)),g},getBoundingBox:function(B){return B===p&&(B=new ml),B.set(this.center,this.center),B.expandByScalar(this.radius),B},applyMatrix4:function(Z){return this.center.applyMatrix4(Z),this.radius=this.radius*Z.getMaxScaleOnAxis(),this},translate:function(h){return this.center.add(h),this},equals:function(s){return s.center.equals(this.center)&&s.radius===this.radius}});var lk=S.Math.Frustum=function(s,t,i,T,u,J){this.planes=[s!==p?s:new Fc,t!==p?t:new Fc,i!==p?i:new Fc,T!==p?T:new Fc,u!==p?u:new Fc,J!==p?J:new Fc]};b.assign(lk.prototype,{set:function(j,D,V,h,G,R){var _=this.planes;return _[0].copy(j),_[1].copy(D),_[2].copy(V),_[3].copy(h),_[4].copy(G),_[5].copy(R),this},clone:function(){return(new this.constructor).copy(this)},copy:function(K){for(var Y=this.planes,g=0;6>g;g++)Y[g].copy(K.planes[g]);return this},setFromMatrix:function(R){var f=this.planes,O=R.el,m=O[0],T=O[1],l=O[2],Y=O[3],C=O[4],A=O[5],U=O[6],I=O[7],M=O[8],o=O[9],X=O[10],z=O[11],V=O[12],K=O[13],r=O[14],Z=O[15];return f[0].setComponents(Y-m,I-C,z-M,Z-V).normalize(),f[1].setComponents(Y+m,I+C,z+M,Z+V).normalize(),f[2].setComponents(Y+T,I+A,z+o,Z+K).normalize(),f[3].setComponents(Y-T,I-A,z-o,Z-K).normalize(),f[4].setComponents(Y-l,I-U,z-X,Z-r).normalize(),f[5].setComponents(Y+l,I+U,z+X,Z+r).normalize(),this},intersectsObject:function(){var p=new Xp;return function(n){var v=n.geometry;return null===v.boundingSphere&&v.computeBoundingSphere(),p.copy(v.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(p)}}(),intersectsSprite:function(){var R=new Xp;return function(C){return R.center.set(0,0,0),R.radius=.7071067811865476,R.applyMatrix4(C.matrixWorld),this.intersectsSphere(R)}}(),intersectsSphere:function(I){for(var u=this.planes,Z=I.center,c=-I.radius,v=0;6>v;v++){var P=u[v].distanceToPoint(Z);if(c>P)return!1}return!0},intersectsBox:function(){var q=new Zh;return function(S){for(var j=this.planes,d=0;6>d;d++){var w=j[d];if(q.x=w.normal.x>0?S.max.x:S.min.x,q.y=w.normal.y>0?S.max.y:S.min.y,q.z=w.normal.z>0?S.max.z:S.min.z,w.distanceToPoint(q)<0)return!1}return!0}}(),containsPoint:function(S){for(var V=this.planes,O=0;6>O;O++)if(V[O].distanceToPoint(S)<0)return!1;return!0}});var Qk=S.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};b.assign(Qk.prototype,{set:function(P,I,r,g,Q,k,V,R,v,C,Z,H,d,t,U,l){var w=this.el;return w[0]=P,w[4]=I,w[8]=r,w[12]=g,w[1]=Q,w[5]=k,w[9]=V,w[13]=R,w[2]=v,w[6]=C,w[10]=Z,w[14]=H,w[3]=d,w[7]=t,w[11]=U,w[15]=l,this},clone:function(){return(new Qk).fromArray(this.el)},fromArray:function(z,D){D===p&&(D=0);for(var V=this.el,W=0;16>W;W++)V[W]=z[W+D];return this},getElements:function(){return this.el},scale:function(g){var Q=this.el,p=g.x,u=g.y,V=g.z;return Q[0]*=p,Q[4]*=u,Q[8]*=V,Q[1]*=p,Q[5]*=u,Q[9]*=V,Q[2]*=p,Q[6]*=u,Q[10]*=V,Q[3]*=p,Q[7]*=u,Q[11]*=V,this},makeRotationFromEuler:function(e){var J=this.el,s=e._x,c=e._y,z=e._z,P=e._order,T=Math.cos(s),L=Math.sin(s),Y=Math.cos(c),r=Math.sin(c),i=Math.cos(z),H=Math.sin(z);if("XYZ"===P){var I=T*i,F=T*H,S=L*i,t=L*H;J[0]=Y*i,J[4]=-Y*H,J[8]=r,J[1]=F+S*r,J[5]=I-t*r,J[9]=-L*Y,J[2]=t-I*r,J[6]=S+F*r,J[10]=T*Y}else if("YXZ"===P){var o=Y*i,m=Y*H,f=r*i,_=r*H;J[0]=o+_*L,J[4]=f*L-m,J[8]=T*r,J[1]=T*H,J[5]=T*i,J[9]=-L,J[2]=m*L-f,J[6]=_+o*L,J[10]=T*Y}else if("ZXY"===P){var o=Y*i,m=Y*H,f=r*i,_=r*H;J[0]=o-_*L,J[4]=-T*H,J[8]=f+m*L,J[1]=m+f*L,J[5]=T*i,J[9]=_-o*L,J[2]=-T*r,J[6]=L,J[10]=T*Y}else if("ZYX"===P){var I=T*i,F=T*H,S=L*i,t=L*H;J[0]=Y*i,J[4]=S*r-F,J[8]=I*r+t,J[1]=Y*H,J[5]=t*r+I,J[9]=F*r-S,J[2]=-r,J[6]=L*Y,J[10]=T*Y}else if("YZX"===P){var M=T*Y,x=T*r,G=L*Y,V=L*r;J[0]=Y*i,J[4]=V-M*H,J[8]=G*H+x,J[1]=H,J[5]=T*i,J[9]=-L*i,J[2]=-r*i,J[6]=x*H+G,J[10]=M-V*H}else if("XZY"===P){var M=T*Y,x=T*r,G=L*Y,V=L*r;J[0]=Y*i,J[4]=-H,J[8]=r*i,J[1]=M*H+V,J[5]=T*i,J[9]=x*H-G,J[2]=G*H-x,J[6]=L*i,J[10]=V*H+M}return J[3]=0,J[7]=0,J[11]=0,J[12]=0,J[13]=0,J[14]=0,J[15]=1,this},makeRotationFromQuaternion:function(q){var V=this.el,I=q._x,y=q._y,F=q._z,l=q._w,L=I+I,g=y+y,X=F+F,o=I*L,C=I*g,M=I*X,G=y*g,Z=y*X,K=F*X,T=l*L,W=l*g,x=l*X;return V[0]=1-(G+K),V[4]=C-x,V[8]=M+W,V[1]=C+x,V[5]=1-(o+K),V[9]=Z-T,V[2]=M-W,V[6]=Z+T,V[10]=1-(o+G),V[3]=0,V[7]=0,V[11]=0,V[12]=0,V[13]=0,V[14]=0,V[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(X){var u=this.el,G=X.el,C=G[0],H=G[1],M=G[2],J=G[3],g=G[4],D=G[5],$=G[6],d=G[7],E=G[8],r=G[9],o=G[10],K=G[11],b=G[12],N=G[13],Q=G[14],R=G[15],v=r*Q*d-N*o*d+N*$*K-D*Q*K-r*$*R+D*o*R,n=b*o*d-E*Q*d-b*$*K+g*Q*K+E*$*R-g*o*R,p=E*N*d-b*r*d+b*D*K-g*N*K-E*D*R+g*r*R,k=b*r*$-E*N*$-b*D*o+g*N*o+E*D*Q-g*r*Q,s=C*v+H*n+M*p+J*k;if(0===s)return this.identity();var A=1/s;return u[0]=v*A,u[1]=(N*o*J-r*Q*J-N*M*K+H*Q*K+r*M*R-H*o*R)*A,u[2]=(D*Q*J-N*$*J+N*M*d-H*Q*d-D*M*R+H*$*R)*A,u[3]=(r*$*J-D*o*J-r*M*d+H*o*d+D*M*K-H*$*K)*A,u[4]=n*A,u[5]=(E*Q*J-b*o*J+b*M*K-C*Q*K-E*M*R+C*o*R)*A,u[6]=(b*$*J-g*Q*J-b*M*d+C*Q*d+g*M*R-C*$*R)*A,u[7]=(g*o*J-E*$*J+E*M*d-C*o*d-g*M*K+C*$*K)*A,u[8]=p*A,u[9]=(b*r*J-E*N*J-b*H*K+C*N*K+E*H*R-C*r*R)*A,u[10]=(g*N*J-b*D*J+b*H*d-C*N*d-g*H*R+C*D*R)*A,u[11]=(E*D*J-g*r*J-E*H*d+C*r*d+g*H*K-C*D*K)*A,u[12]=k*A,u[13]=(E*N*M-b*r*M+b*H*o-C*N*o-E*H*Q+C*r*Q)*A,u[14]=(b*D*M-g*N*M-b*H*$+C*N*$+g*H*Q-C*D*Q)*A,u[15]=(g*r*M-E*D*M+E*H*$-C*r*$-g*H*o+C*D*o)*A,this},makeRotationAxis:function(c,q){var V=Math.cos(q),B=Math.sin(q),t=1-V,M=c.x,Y=c.y,j=c.z,o=t*M,A=t*Y;return this.set(o*M+V,o*Y-B*j,o*j+B*Y,0,o*Y+B*j,A*Y+V,A*j-B*M,0,o*j-B*Y,A*j+B*M,t*j*j+V,0,0,0,0,1),this},multiply:function(h){return this.multiplyMatrices(this,h)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(q,O){var s=q.el,i=O.el,k=this.el,H=s[0],V=s[4],l=s[8],z=s[12],A=s[1],S=s[5],Y=s[9],y=s[13],I=s[2],L=s[6],j=s[10],m=s[14],X=s[3],e=s[7],u=s[11],t=s[15],Q=i[0],U=i[4],E=i[8],p=i[12],J=i[1],C=i[5],c=i[9],n=i[13],R=i[2],v=i[6],r=i[10],G=i[14],d=i[3],D=i[7],K=i[11],g=i[15];return k[0]=H*Q+V*J+l*R+z*d,k[4]=H*U+V*C+l*v+z*D,k[8]=H*E+V*c+l*r+z*K,k[12]=H*p+V*n+l*G+z*g,k[1]=A*Q+S*J+Y*R+y*d,k[5]=A*U+S*C+Y*v+y*D,k[9]=A*E+S*c+Y*r+y*K,k[13]=A*p+S*n+Y*G+y*g,k[2]=I*Q+L*J+j*R+m*d,k[6]=I*U+L*C+j*v+m*D,k[10]=I*E+L*c+j*r+m*K,k[14]=I*p+L*n+j*G+m*g,k[3]=X*Q+e*J+u*R+t*d,k[7]=X*U+e*C+u*v+t*D,k[11]=X*E+e*c+u*r+t*K,k[15]=X*p+e*n+u*G+t*g,this},lookAt:function(){var w=new Zh;return function(L,o,g){return w.subVectors(L,o),this.lookAtDirection(w,g)}}(),lookAtDirection:function(){var b=new Zh,f=new Zh,I=new Zh;return function(B,o){var M=this.el;return I.copy(B),0===I.lengthSq()&&(I.z=1),I.normalize(),b.crossVectors(o,I),0===b.lengthSq()&&(1===Math.abs(o.z)?I.x+=1e-4:I.z+=1e-4,I.normalize(),b.crossVectors(o,I)),b.normalize(),f.crossVectors(I,b),M[0]=b.x,M[4]=f.x,M[8]=I.x,M[1]=b.y,M[5]=f.y,M[9]=I.y,M[2]=b.z,M[6]=f.z,M[10]=I.z,this}}(),extractScale:function(){var V;return function(u){V===p&&(V=new Zh),u===p&&(u=new Zh);var s=V.setFromMatrixColumn(this,0).length(),S=V.setFromMatrixColumn(this,1).length(),X=V.setFromMatrixColumn(this,2).length();return u.set(s,S,X),u}}(),extractRotation:function(){var Q;return function(V){Q===p&&(Q=new Zh),V===p&&(V=new Qk);var B=this.el,c=V.el,z=1/Q.setFromMatrixColumn(V,0).length(),u=1/Q.setFromMatrixColumn(V,1).length(),C=1/Q.setFromMatrixColumn(V,2).length();return B[0]=c[0]*z,B[1]=c[1]*z,B[2]=c[2]*z,B[4]=c[4]*u,B[5]=c[5]*u,B[6]=c[6]*u,B[8]=c[8]*C,B[9]=c[9]*C,B[10]=c[10]*C,this}}(),multiplyScalar:function(g){var w=this.el;return w[0]*=g,w[4]*=g,w[8]*=g,w[12]*=g,w[1]*=g,w[5]*=g,w[9]*=g,w[13]*=g,w[2]*=g,w[6]*=g,w[10]*=g,w[14]*=g,w[3]*=g,w[7]*=g,w[11]*=g,w[15]*=g,this},getPosition:function(F){return F===p&&(F=new Zh),F.setFromMatrixColumn(this,3)},setPosition:function(H){var T=this.el;return T[12]=H.x,T[13]=H.y,T[14]=H.z,this},toArray:function(u,A){u===p&&(u=[]),A===p&&(A=0);var e=this.el;return u[A]=e[0],u[A+1]=e[1],u[A+2]=e[2],u[A+3]=e[3],u[A+4]=e[4],u[A+5]=e[5],u[A+6]=e[6],u[A+7]=e[7],u[A+8]=e[8],u[A+9]=e[9],u[A+10]=e[10],u[A+11]=e[11],u[A+12]=e[12],u[A+13]=e[13],u[A+14]=e[14],u[A+15]=e[15],u},determinant:function(){var p=this.el,t=p[0],J=p[4],s=p[8],j=p[12],n=p[1],Y=p[5],Q=p[9],E=p[13],b=p[2],B=p[6],S=p[10],M=p[14],u=p[3],V=p[7],U=p[11],g=p[15];return u*(+j*Q*B-s*E*B-j*Y*S+J*E*S+s*Y*M-J*Q*M)+V*(+t*Q*M-t*E*S+j*n*S-s*n*M+s*E*b-j*Q*b)+U*(+t*E*B-t*Y*M-j*n*B+J*n*M+j*Y*b-J*E*b)+g*(-s*Y*b-t*Q*B+t*Y*S+s*n*B-J*n*S+J*Q*b)},copy:function(C){var y=this.el,l=C.el;return y[0]=l[0],y[1]=l[1],y[2]=l[2],y[3]=l[3],y[4]=l[4],y[5]=l[5],y[6]=l[6],y[7]=l[7],y[8]=l[8],y[9]=l[9],y[10]=l[10],y[11]=l[11],y[12]=l[12],y[13]=l[13],y[14]=l[14],y[15]=l[15],this},compose:function(S,u,h){var b=this.el,$=u._x,y=u._y,t=u._z,O=u._w,U=$+$,Z=y+y,j=t+t,J=$*U,P=$*Z,q=$*j,X=y*Z,K=y*j,p=t*j,A=O*U,W=O*Z,i=O*j,k=h.x,z=h.y,Y=h.z;return b[0]=(1-(X+p))*k,b[1]=(P+i)*k,b[2]=(q-W)*k,b[3]=0,b[4]=(P-i)*z,b[5]=(1-(J+p))*z,b[6]=(K+A)*z,b[7]=0,b[8]=(q+W)*Y,b[9]=(K-A)*Y,b[10]=(1-(J+X))*Y,b[11]=0,b[12]=S.x,b[13]=S.y,b[14]=S.z,b[15]=1,this},decompose:function(){var d=new Zh,c=new Qk;return function(k,q,V){var S=this.el,s=d.set(S[0],S[1],S[2]).length(),A=d.set(S[4],S[5],S[6]).length(),z=d.set(S[8],S[9],S[10]).length(),n=this.determinant();0>n&&(s=-s),k.x=S[12],k.y=S[13],k.z=S[14],c.copy(this);var j=1/s,w=1/A,Y=1/z;return c.el[0]*=j,c.el[1]*=j,c.el[2]*=j,c.el[4]*=w,c.el[5]*=w,c.el[6]*=w,c.el[8]*=Y,c.el[9]*=Y,c.el[10]*=Y,q.setFromRotationMatrix(c),V.x=s,V.y=A,V.z=z,this}}()});var Zq=S.Math.Triangle=function(j,z,I){this.a=j!==p?j:new Zh,this.b=z!==p?z:new Zh,this.c=I!==p?I:new Zh};b.assign(Zq,{barycoordFromPoint:function(){var w=new Zh,V=new Zh,F=new Zh;return function(I,W,G,Q,b){w.subVectors(Q,W),V.subVectors(G,W),F.subVectors(I,W);var T=w.dot(w),L=w.dot(V),j=w.dot(F),v=V.dot(V),D=V.dot(F),M=T*v-L*L,n=b||new Zh;if(0===M)return n.set(-2,-1,-1);var o=1/M,_=(v*j-L*D)*o,U=(T*D-L*j)*o;return n.set(1-_-U,U,_)}}()});var Zg=S.Math.Euler=function(G,X,A,y,E){this.set(G,X,A,y,E)};Zg.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Zg.DefaultOrder="XYZ",Zg.ReverseOrder=function(){var Y={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(z){return Y[z]}}(),b.defineProperties(Zg.prototype,{x:{get:function(){return this._x},set:function(N){this._x=N,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(P){this._y=P,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(L){this._order=L,this.onChangeCallback()}}}),b.assign(Zg.prototype,{set:function(u,W,r,A,_){return Kc(u)&&(_=r,A=W,r=u[2],W=u[1],u=u[0]),A?_&&(A=Zg.ReverseOrder(A)):A="ZYX",this._x=u||0,this._y=W||0,this._z=r||0,this._order=A||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(r){return this._x=r._x,this._y=r._y,this._z=r._z,this._order=r._order,this.onChangeCallback(),this},setFromRotationMatrix:function(Z,v,l){var I=S.Math.clamp,o=Z.el||Z,h=o[0],J=o[4],c=o[8],f=o[1],E=o[5],p=o[9],V=o[2],D=o[6],n=o[10];return v=v||this._order,"XYZ"===v?(this._y=Math.asin(I(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-p,n),this._z=Math.atan2(-J,h)):(this._x=Math.atan2(D,E),this._z=0)):"YXZ"===v?(this._x=Math.asin(-I(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(c,n),this._z=Math.atan2(f,E)):(this._y=Math.atan2(-V,h),this._z=0)):"ZXY"===v?(this._x=Math.asin(I(D,-1,1)),Math.abs(D)<.99999?(this._y=Math.atan2(-V,n),this._z=Math.atan2(-J,E)):(this._y=0,this._z=Math.atan2(f,h))):"ZYX"===v?(this._y=Math.asin(-I(V,-1,1)),Math.abs(V)<.99999?(this._x=Math.atan2(D,n),this._z=Math.atan2(f,h)):(this._x=0,this._z=Math.atan2(-J,E))):"YZX"===v?(this._z=Math.asin(I(f,-1,1)),Math.abs(f)<.99999?(this._x=Math.atan2(-p,E),this._y=Math.atan2(-V,h)):(this._x=0,this._y=Math.atan2(c,n))):"XZY"===v?(this._z=Math.asin(-I(J,-1,1)),Math.abs(J)<.99999?(this._x=Math.atan2(D,E),this._y=Math.atan2(c,h)):(this._x=Math.atan2(-p,n),this._y=0)):console.warn("unsupported order: "+v),this._order=v,l!==!1&&this.onChangeCallback(),this
},setFromQuaternion:function(){var r=new Qk;return function(Q,f,b){return r.makeRotationFromQuaternion(Q),this.setFromRotationMatrix(r,f,b)}}(),setFromVector3:function(m,E){return this.set(m.x,m.y,m.z,E||this._order)},reorder:function(){var s=new nd;return function(x){return s.setFromEuler(this),this.setFromQuaternion(s,x)}}(),equals:function(o){return o._x===this._x&&o._y===this._y&&o._z===this._z&&o._order===this._order},fromArray:function(u){return this._x=u[0],this._y=u[1],this._z=u[2],u[3]!==p&&(this._order=u[3]),this.onChangeCallback(),this},toArray:function(Q,e){return Q===p&&(Q=[]),e===p&&(e=0),Q[e]=this._x,Q[e+1]=this._y,Q[e+2]=this._z,Q[e+3]=this._order,Q},toVector3:function(r){return r?r.set(this._x,this._y,this._z):new Zh(this._x,this._y,this._z)},onChange:function(l){return this.onChangeCallback=l,this},onChangeCallback:function(){}});var cm={ms_ac:function(q,L){for(var w=L.ms_ac,i=0;i<w.length;i++)Qg(q,w[i])},ms_listener:function(Y){Y.addListeners=function(){var l=this,j=mi;E.mockTouch&&(j=mp.concat(uo).concat(oh)),l.__events__=j;for(var G=0,A=j.length;A>G;G++){var H=j[G];"wheel"===H&&!l.handle_wheel&&l.handle_mousewheel&&(l.handle_wheel=function(J){$j(l,J)}),l["handle_"+H]&&zj(H,l.getView(),l)}},Y.removeListeners=function(){var I=this,o=I.__events__;if(o){I.__events__=p;for(var B=0,S=o.length;S>B;B++)I["handle_"+o[B]]&&Lc(o[B],I.getView(),I)}}},ms_fire:function(q){q.mp=function(s,z,y){this.addPropertyChangeListener(s,z,y)},q.ump=function(J,y){this.removePropertyChangeListener(J,y)},q.fp=function(W,r,K,$,v){return this.firePropertyChange(W,r,K,$,v)},q.addPropertyChangeListener=function(A,N,m){var v=this;v._62I||(v._62I=new Hd),v._62I.add(A,N,m)},q.removePropertyChangeListener=function(A,t){this._62I&&this._62I.remove(A,t)},q.firePropertyChange=function(r,J,G,n,f){if(n){if(n(J,G))return!1}else if(J===G)return!1;var j=this,h=f||{};return h.property=r,h.oldValue=J,h.newValue=G,h.source=j,h.data=j,j._62I&&j._62I.fire(h),j.onPropertyChanged&&j.onPropertyChanged(h),!0}},ms_attr:function(C){C.a=function(k,V){var G=this;if(2===arguments.length)G.setAttr(k,V);else{if(!Mj(k))return G.getAttr(k);for(var b in k)G.setAttr(b,k[b])}return G},C.getAttr=function(O,S){if(S===p&&(S=1),this._attrObject&&O in this._attrObject)return this._attrObject[O];if(this.getImage){var Y=this.getImage();if(tc(Y)&&(Y=Vl[Y]),Mj(Y)&&"dataBindings"in Y)for(var c=Y.dataBindings,V=c.length-1;V>=0;V--){var a=c[V];if(a.attr===O){if("defaultValue"in a)return a.defaultValue;break}}}return S?J[O]:p},C.setAttr=function(F,l){var q=this;q._attrObject||(q._attrObject={});var f=q._attrObject[F];l===p?delete q._attrObject[F]:q._attrObject[F]=l,q.fp&&q.fp("a:"+F,f,l)&&q.onAttrChanged&&q.onAttrChanged(F,f,l)},C.getSerializableAttrs=function(){var P,L={};for(P in this._attrObject)L[P]=1;return L}},ms_bnb:function(p){p.getBodyColor=function(m){return m.s("body.color")},p.getBorderColor=function(R){return R.s("border.color")}},_51o:function(D){D.mi=function(H,B,Q){this.addInteractorListener(H,B,Q)},D.umi=function(b,F){this.removeInteractorListener(b,F)},D.fi=function(t){this.fireInteractorEvent(t)},D.addInteractorListener=function(W,S,G){var h=this;h._63I||(h._63I=new Hd),h._63I.add(W,S,G)},D.removeInteractorListener=function(S,l){this._63I&&this._63I.remove(S,l)},D.fireInteractorEvent=function(X){this._63I&&this._63I.fire(X)},D.setInteractors=function(p){var j=this,A=j._interactors;A&&A.each(function(R){R.tearDown()}),Kc(p)&&(p=new jn(p)),j._interactors=p,p&&p.each(function(d){d.setUp()}),j.fp("interactors",A,p),j.invalidateSelection()},D.getInteractors=function(){return this._interactors}},_49o:function(G){G._44O=X,G._45O=X,G.getTopPainters=function(){return this._44O},G.getBottomPainters=function(){return this._45O},G.addTopPainter=function(N){var w=this;w._44O||(w._44O=new jn),w._44O.contains(N)||(w._44O.add(N),w.redraw&&w.redraw())},G.removeTopPainter=function(K){var T=this;T._44O&&(T._44O.remove(K),T.redraw&&T.redraw())},G.addBottomPainter=function(s){var E=this;E._45O||(E._45O=new jn),E._45O.contains(s)||(E._45O.add(s),E.redraw&&E.redraw())},G.removeBottomPainter=function(r){var k=this;k._45O&&(k._45O.remove(r),k.redraw&&k.redraw())},G._93db=function(A,m){var o=this;o._45O&&o._45O.each(function(g){g.draw?g.draw(A,m):g.call(o,A,m)})},G._92db=function(A,Q){var D=this;D._44O&&D._44O.each(function(J){J.draw?J.draw(A,Q):J.call(D,A,Q)})}},ms_sm:function(o){o.sm=function(){return this.getSelectionModel()},o.setSelectableFunc=function(V){this.sm().setFilterFunc(V)},o.getSelectableFunc=function(){return this.sm().getFilterFunc()},o.getSelectionModel=function(){var n=this;return n._selectionModel?n._selectionModel:n.dm().sm()},o.isSelectionModelShared=function(){return!this._selectionModel},o.setSelectionModelShared=function(z){var j=this,l=j.sm(),w=!j._selectionModel,G=j.handleSelectionChange,t=j.dm();w!==z&&(j.invalidateSelection&&j.invalidateSelection(),z?(t.sm().ms(G,j),j._selectionModel.ums(G,j),j._selectionModel.dispose(),j._selectionModel=X):(t.sm().ums(G,j),j._selectionModel=new In(t),j._selectionModel.ms(G,j)),j.onSelectionModelSharedChanged(),j.fp("selectionModelShared",w,z),j.fireViewEvent({kind:"selectionModelSharedChange",oldValue:w,newValue:z,oldSelectionModel:l,newSelectionModel:j.sm()}))},o.onSelectionModelSharedChanged=function(){var z=this;z.redraw(),z.invalidateSelection&&z.invalidateSelection()},o.removeSelection=function(){var e=this.dm();e.beginTransaction(),this.sm().toSelection().each(e.remove,e),e.endTransaction()},o.selectAll=function(){var j=this;j.sm().ss(j.dm().toDatas(function(b){return j.isVisible(b)&&j.isSelectable(b)}))},o.isSelected=function(e){return this.sm().co(e)},o.isSelectedById=function(I){var x=this.dm().getDataById(I);return x?this.isSelected(x):!1},o.isSelectable=function(r){return this.sm().isSelectable(r)}},ms_tx:function(N){N._64I=0,N._65O=0,N.isScrollable=function(){return this.getWidth()<this._64I},N._40o=function(){return this.isScrollable()},N.getLogicalPoint=function(x){return Bm(x,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},N.tx=function(m){return m===p?this.getTranslateX():(this.setTranslateX(m),void 0)},N.getTranslateX=function(){return this._65O},N.setTranslateX=function(e){var H=this,t=H.getWidth()-H._64I;t>e&&(e=t),e>0&&(e=0),e=s(e);var y=H._65O;H._65O=e,H.fp(Sg,y,e)}},ms_ty:function(Q){Q._23Q=0,Q._66O=0,Q._41o=function(){return this.getHeight()<this._23Q},Q.getLogicalPoint=function(E){return Bm(E,this._canvas||this._view,this.tx?this.tx():0,this.ty())},Q.ty=function(D){return D===p?this.getTranslateY():(this.setTranslateY(D),void 0)},Q.getTranslateY=function(){return this._66O},Q.setTranslateY=function(D){var o=this,f=o.getHeight()-o._23Q;f>D&&(D=f),D>0&&(D=0),D=s(D);var i=o._66O;o._66O=D,o.fp(of,i,D)}},ms_txy:function(b){b._65O=0,b._66O=0,b.tx=function(B){return B===p?this.getTranslateX():(this.setTranslateX(B),void 0)},b.ty=function(P){return P===p?this.getTranslateY():(this.setTranslateY(P),void 0)},b.onTranslateEnded=function(){},b.setTranslate=function(v,t,m){var x=this;if(m=zq(m)){x._65I&&x._65I.stop(!0);var S=x.tx(),H=x.ty();m.action=function(p){x.setTranslate(S+(v-S)*p,H+(t-H)*p)},m._37o=function(){delete x._66I,delete x._65I,x.onTranslateEnded()},x._66I=1,x._65I=Ti(m)}else x.tx(v),x.ty(t)},b.getTranslateX=function(){return this._65O},b.setTranslateX=function(s){var e=this;s=e.adjustTranslateX(s);var k=e._65O;e._65O=s,e.fp(Sg,k,s)},b.getTranslateY=function(){return this._66O},b.setTranslateY=function(K){var z=this;K=z.adjustTranslateY(K);var V=z._66O;z._66O=K,z.fp(of,V,K)},b.adjustTranslateX=function(x){return s(x)},b.adjustTranslateY=function(_){return s(_)},b.translate=function(k,i,M){this.setTranslate(this.tx()+k,this.ty()+i,M)},b.getLogicalPoint=function(L){var C=this;return Bm(L,this._canvas||C._view,C.tx(),C.ty())}},ms_dm:function(l){l.dm=function(V){return V?(this.setDataModel(V),void 0):this.getDataModel()},l.getDataModel=function(){return this._dataModel}},ms_lp:function(g){g.lp=function(c){return this.getLogicalPoint(c)}},ms_v:function(f){f._disabled=!1,f.setDisabled=function(r,J){var E=this,c=E._disabled;c!==r&&(c&&(cp(E._63O),delete E._63O),r&&(vb(E._view,E._63O=un(J)),E.iv()),E._disabled=r,E.fp("disabled",c,r))},f.isDisabled=function(){return this._disabled},f.getDisabledDiv=function(){return this._63O},f.getView=function(){return this._view},f.addToDOM=function(f){var Z=this,x=Z.getView(),B=x.style;f=f||i.body,f.appendChild(x),B.left="0",B.right="0",B.top="0",B.bottom="0",q(y,"resize",function(){Z.iv()}),Z.iv()},f.setCursor=function(Z){"default"===Z&&(Z=this._defaultCursor||Z);var a=this.getView().style;a.cursor=Z,a.cursor="-webkit-"+Z,a.cursor="-moz-"+Z},f.getWidth=function(){return this._view.clientWidth},f.getHeight=function(){return this._view.clientHeight},f.setWidth=function(I){var z=this;z._view.style.width=I+Dp,z.iv(),z.fp&&z.fp(zm,X,I)},f.setHeight=function(n){var P=this;P._view.style.height=n+Dp,P.iv(),P.fp&&P.fp(mn,X,n)},f.setFocus=function(L){var K=this,j=K._currentEditor;return L&&j&&(j.getView&&(j=j.getView()),j.contains(L.target))?!1:(zf(K._view),K.endEditing&&K.endEditing(),K.fireViewEvent("focus"),!0)},f.iv=function(W){this.invalidate(W)},f.invalidate=function(D){var k=this;k._68I||(k._68I=1,hm(k.validate,k,X,D),k.onInvalidated&&k.onInvalidated(),k.fireViewEvent("invalidate"))},f.validate=function(){var u=this,M=u._view;if(u._68I&&(delete u._68I,M.parentNode))if(0===M.offsetWidth&&0===M.offsetHeight&&u._67I!==X)u._67I===p&&(u._67I=E.reinvalidateCount),u._67I>0?u._67I--:u._67I=X,u.iv();else{u.fireViewEvent("beginValidate"),u.validateImpl(),u.onValidated&&u.onValidated(),u.fireViewEvent("validate");var J=u._63O;J&&(M.lastChild!==J&&(cp(J),vb(M,J)),zd(J,0,0,u.getWidth(),u.getHeight())),sl(u),pd(u),xf(u)}},f.layout=function(Q,M,f,s){1===arguments.length?zd(this,Q):zd(this,Q,M,f,s)},f.addViewListener=function(c,K,B){var H=this;H._67O||(H._67O=new Hd),H._67O.add(c,K,B)},f.removeViewListener=function(D,d){this._67O.remove(D,d)},f.fireViewEvent=function(j){var x=this;x._67O&&(tc(j)&&(j={kind:j}),x._67O.fire(j)),E.viewListener&&E.viewListener(x,j)}},ms_tip:function(W){W.setToolTipEnabled=function(S){var _=this;S?Iq||_._13o||(_.enableToolTip(),_.fp("toolTipEnabled",!1,!0)):_._13o&&(_.disableToolTip(),_.fp("toolTipEnabled",!0,!1))},W.isToolTipEnabled=function(){return!!this._13o},W.enableToolTip=function(){var e=this;if(!Iq&&!e._13o){e._13o=function(M){var o=e.getToolTip(M);o!=X?(E.toolTipContinual&&E.isToolTipShowing()?sh(M,o):(On(),ej={timeout:td(Ig,Fk),e:M,info:o}),rd={e:M,view:e}):On()};var u=e.getView();q(u,ss,e._13o),q(u,"mouseleave",E.hideToolTip)}},W.disableToolTip=function(){var j=this;if(j._13o){var l=j.getView();O(l,ss,j._13o),O(l,"mouseleave",E.hideToolTip),delete j._13o}},W.getToolTip=function(s){var r=this;if(r.getDataAt){var J=r.getDataAt(s);return J?J.getToolTip():X}return r.getValue?r.getValue():void 0}},_52o:function(d){d._zoom=1,d._29I=dm,d.zoomIn=function(W,Y){this.setZoom(this._zoom*Nl,W,Y)},d.zoomOut=function(j,T){this.setZoom(this._zoom/Nl,j,T)},d.zoomReset=function(V,g){this.setZoom(1,V,g)},d.scrollZoomIn=function(y){this.setZoom(this._zoom*lj,X,y)},d.scrollZoomOut=function(e){this.setZoom(this._zoom/lj,X,e)},d.pinchZoomIn=function(L){this.setZoom(this._zoom*Td,X,L)},d.pinchZoomOut=function(P){this.setZoom(this._zoom/Td,X,P)},d.adjustZoom=function(v){return gl>v?gl:v>sr?sr:v},d.getZoom=function(){return this._zoom},d.setZoom=function(D,u,B){var L=this;if(u=zq(u)){L._14o&&L._14o.stop(!0);var R=L._zoom;u.action=function(W){L._96O(R+(D-R)*W,B)},u._37o=function(){delete L._zooming,delete L._14o,L.onZoomEnded()},L._zooming=1,L._14o=Ti(u)}else L._96O(D,B)},d._96O=function(L,E){var k=this;if(L=k.adjustZoom(L),L!==k._zoom){k.validate();var W=k._29I,R=k._zoom;0!==W.width&&0!==W.height&&(E=E?E:{x:W.x+W.width/2,y:W.y+W.height/2},k.tx((E.x-W.x)*R-E.x*L),k.ty((E.y-W.y)*R-E.y*L)),k._zoom=L,k.fp("zoom",R,L)}}},ms_edge:function(C){C._2I=function(L){var D=this;D._44I||(D._44I=new jn),D._42I||(D._42I=new jn),D._44I.add(L),D._42I.add(L),D._20I()},C._4I=function(C){var H=this;H._44I||(H._44I=new jn),H._43I||(H._43I=new jn),H._44I.add(C),H._43I.add(C),H._20I()},C._16I=function(P){var R=this;R._44I.remove(P),R._42I.remove(P),R._44I.isEmpty()&&delete R._44I,R._42I.isEmpty()&&delete R._42I,R._20I()},C._18I=function(g){var z=this;z._44I.remove(g),z._43I.remove(g),z._44I.isEmpty()&&delete z._44I,z._43I.isEmpty()&&delete z._43I,z._20I()},C._20I=function(){var G=this;if(delete G._45I,!G._44I||G._44I.isEmpty())return delete G._70O,void 0;var N;G._44I.each(function(U){U.isLooped()&&(N||(N={}),N[U._id]||(G._45I||(G._45I=new jn),G._45I.add(U),N[U._id]=U))}),N?(G._70O=new jn,G._44I.each(function(P){N[P._id]?"A"===N[P._id]||(N[P._id]="A",G._70O.add(P)):G._70O.add(P)})):G._70O=G._44I},C.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},C.getSourceAgentEdges=function(){return this._46I},C.getTargetAgentEdges=function(){return this._47I},C._1I=function(X){var z=this;z._46I||(z._46I=new jn),z._48I||(z._48I=new jn),z._46I.add(X),z._48I.add(X),z._19I()},C._3I=function(H){var v=this;v._47I||(v._47I=new jn),v._48I||(v._48I=new jn),v._47I.add(H),v._48I.add(H),v._19I()},C._15I=function(N){var U=this;U._46I.remove(N),U._48I.remove(N),U._46I.isEmpty()&&delete U._46I,U._48I.isEmpty()&&delete U._48I,U._19I()},C._17I=function(Y){var E=this;E._47I.remove(Y),E._48I.remove(Y),E._47I.isEmpty()&&delete E._47I,E._48I.isEmpty()&&delete E._48I,E._19I()},C._19I=function(){var r=this;delete r._49I;var N=r._48I;if(N&&!N.isEmpty()){var P={};N.each(function(k){P[k._id]?r._49I||(r._49I=new jn):P[k._id]=k}),r._49I?N.each(function(O){P[O._id]&&(r._49I.add(O),delete P[O._id])}):r._49I=N}},C.getLoopedEdges=function(){return this._45I},C.getEdges=function(){return this._70O},C.getAgentEdges=function(){return this._49I},C.getSourceEdges=function(){return this._42I},C.getTargetEdges=function(){return this._43I},C._8I=function(){this._70O&&this._70O.each(function(m){m._7I()})}},ms_shadow:function(h){Xl.PARAMS.forEach(function(R){var T=R.replace(/(^|\.)[a-z]/g,function(z){return z[z.length-1].toUpperCase()}),z=T.charAt(0).toLowerCase()+T.substr(1);h["getShadow"+T]=function(){return this._getShadowParam(z)},h["setShadow"+T]=function(X){this._setShadowParam(z,X)}}),h.enableShadow=function(H){this.shadowMap.setShadow(!0,H)},h.disableShadow=function(){this.shadowMap.setShadow(!1)},h._getShadowParam=function(w){return this.shadowMap.getShadow()[w]},h._setShadowParam=function($,C){var w=this._getShadowParam($),v={};v[$]=C;var g=this.shadowMap;g.setShadow(g.enable,v),this.firePropertyChange("shadow"+$.charAt(0).toUpperCase()+$.substr(1),w,C)}}};Vm(E,{getVersion:function(){return"7.2.5-dev1"}},!0),Vm(E,{numberDigits:5,crossOrigin:"",baseZIndex:p,isTouchable:Iq,mockTouch:!0,devicePixelRatio:y.devicePixelRatio?y.devicePixelRatio:y.screen?y.screen.deviceXDPI/y.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:M.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Gr},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(D){return D*D},labelColor:kn,labelSelectColor:Gi,labelFont:"12px arial, sans-serif",widgetIndent:Iq?30:20,widgetRowHeight:Iq?30:20,widgetHeaderHeight:Iq?32:22,widgetTitleHeight:Iq?34:24,scrollBarColor:Zc,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Iq?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Zo,intersectionLineLine:Tb,isEnter:ff,isEsc:ib,isDelete:Am,isSpace:tn,isLeft:Rg,isUp:Nk,isRight:Ye,isDown:Ae,isTouchEvent:qc,getTarget:Je,isString:tc,isNumber:po,isBoolean:Pk,isArray:Kc,isSelectAll:qb,isFunction:Uq,isObject:Mj,getPropertyValue:lr,setPropertyValue:Ei,addMethod:Vm,createGradient:function(x,$,N,e,J,Y,o,F){var Z=Le[$];return Z(x,N,e,J,Y,o,F)},appendToScreen:function(W){W=W.getView?W.getView():W,(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement||i.body).appendChild(W)},encodeString:function(i){return S.Math.encodeBase64(i,E.encodeStringKey)},decodeString:function(V){return S.Math.decodeBase64(V,E.encodeStringKey)},findView:function(F){var V=function(o,L){var F=L._ht;F&&o.push(F);var x=L.children,f=x.length;if(f)for(var i=0;f>i;i++)V(o,x[i])},q=[];V(q,i.body);var L=function(C,p){for(var v="2d"===p?Um.GraphView:Gq.Graph3dView,U=0,R=C.length;R>U;U++)if(C[U]instanceof v)return q[U];return null};return"all"===F?q:"2d"===F?L(q,"2d"):"3d"===F?L(q,"3d"):L(q,"3d")||L(q,"2d")},toggleFullscreen:function(y){var a=y.getView();if(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement)i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen();else{var E=!0;if(y.isSelfViewEvent){var p=y.getX(),Y=y.getY(),n=y.getWidth(),g=y.getHeight(),j=a.style.background,H=a.style.backgroundColor;j||H||(a.style.backgroundColor="white"),a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen();var d=setInterval(function(){if(a!==(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement))clearInterval(d),y.setX(p),y.setY(Y),y.setWidth(n),y.setHeight(g),y._fullscreen=!1,a.style.oldBackgroundColor=H,y.iv();else{var D=S.Default.getWindowInfo();(E||D.width!==y.getWidth()||D.height!==y.getHeight())&&(y.setX(D.left),y.setY(D.top),y.setWidth(D.width),y.setHeight(D.height),y._fullscreen=!0,y.iv(),E=!1)}},500)}else{var e=a.style.left,q=a.style.top,n=a.style.width,g=a.style.height,j=a.style.background,H=a.style.backgroundColor;j||H||(a.style.backgroundColor="white"),a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen();var d=setInterval(function(){if(a!==(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement))clearInterval(d),a.style.left=e,a.style.top=q,a.style.width=n,a.style.height=g,a.style.oldBackgroundColor=H,y.iv();else{var M=S.Default.getWindowInfo();(E||M.width!==y.getWidth()||M.height!==y.getHeight())&&(zd(y),E=!1)}},500)}}},appendTimeStamp:function(W){return W},setCompType:function(b,i){tc(i)&&i.substr(0,12)==Yl&&(i=E.parse(i)),Uq(i)||Mj(i)?ar[b]=i:fe(b)},getCompType:function(s){var _=ar[s];return _===p&&To.test(s)&&fe(s),_},getCompTypeMap:function(){return ar},drawCompType:function(V,f,k,p,$,G){V(f,k,p,$,G)},numberListener:function(){var a={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(D){var T=D.keyCode;a[T]||65===T&&E.isCtrlDown(D)||86===T&&E.isCtrlDown(D)||67===T&&E.isCtrlDown(D)||88===T&&E.isCtrlDown(D)||T>=35&&40>=T||(D.shiftKey||48>T||T>57)&&(96>T||T>105)&&D.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(e){var n=e.target.tagName;("DIV"===n||"CANVAS"===n)&&!(E.ignoreKeyCodes.indexOf(e.keyCode)>=0)&&("keydown"!==e.type||Rg(e)||Ye(e)||Nk(e)||Ae(e)||Am(e)||65===e.keyCode&&(e.metaKey||e.ctrlKey))&&e.cancelable===!0&&(e.preventDefault(),e.preventManipulation&&e.preventManipulation())},getWindowInfo:function(){var e=i.documentElement,T=e&&(e.scrollLeft||e.scrollTop)?e:i.body;return{target:T,left:T.scrollLeft,top:T.scrollTop,width:y.innerWidth||T.clientWidth,height:y.innerHeight||T.clientHeight}},isDragging:function(){return!!Gr},isLeftButton:function(W){return qc(W)?!0:0===W.button},isMiddleButton:function(r){return qc(r)?!1:r&&(1===r.button||4&(r.buttons||0))},isRightButton:function(F){return qc(F)?!1:F&&(2===F.button||2&(F.buttons||0))},isInput:function(I){if(!I)return!1;var l=I.tagName;return"INPUT"===l||"TEXTAREA"===l||"SELECT"===l},getTouchCount:function(Y){return qc(Y)?Y.touches.length:1},isDoubleClick:function(){function n(S){S.details=0,S.timeout=null,S.lastPoint=null}var z={};return gi=new si,bh=gi.getTime(),function(G){if($r(G)>1)return!1;var B=G.button==X?"":G.button,J=G.type+B,j=J+"_isDoubleClick",l=z[J];if(l||(l=z[J]={details:0,timeout:null,lastPoint:null}),G[j]===p){G[j]=!0;var I=Wc(G);l.timeout&&(zr(l.timeout),l.timeout=null);var d=qc(G)?E.doubleTouchRange:E.doubleClickRange;l.lastPoint&&Fb(l.lastPoint,I)>d&&n(l),l.lastPoint=I,l.details++,l.timeout=td(function(){n(this)}.bind(l),E.doubleClickSpeed)}return 2===l.details}}(),isShiftDown:function(q){return q?q.shiftKey:tb["16"]},isCtrlDown:function(z){return z?Rc?z.metaKey:z.ctrlKey:Rc?tb["91"]:tb["17"]},getClientPoint:function(D){return qc(D)&&(D=ol(D)),{x:D.clientX,y:D.clientY}},isMouseEvent:function(W){return W instanceof MouseEvent||0===W.type.indexOf("mouse")},getTargetElement:function(X){var c,f=_n(X);if(c=E.isMouseEvent(X)||!i.elementFromPoint?X.target:i.elementFromPoint(f.x,f.y),Ao&&i.elementFromPoint){for(var b=[],K=[];"none"===c.style.pointerEvents;)b.push(c),K.push(c.style.display||""),c.style.display="none",c=i.elementFromPoint(f.x,f.y);b.forEach(function(n,u){n.style.display=K[u]})}return c},getPagePoint:function(s){return qc(s)&&(s=ol(s)),{x:s.pageX,y:s.pageY}},createObject:function(I,F){var l=new I;for(var M in F){var n=F[M];if(Uq(n))l[M]=n;else if(0===M.indexOf("s:"))l.s(M.substr(2),F[M]);else if(0===M.indexOf("a:"))l.a(M.substr(2),F[M]);else{var b=Hg(M),n=F[M];l[b]?(l[b](n),"setToolTip"===b&&l.enableToolTip&&l.enableToolTip()):l[M]=n}}return l},setImage:function(k,J,P,N){var o=arguments.length;4===o?Xd(k,N,J,P):2===o?tc(J)?J.substr(0,12)==Yl?gb(k,E.parse(J)):Xd(k,J):gb(k,J):1===o&&Xd(k,k)},getImage:function(L,a,H){var n;if(L==X)return X;if(Mj(L)?n=L:(n=Vl[L],L&&n===p&&(bp&&bp[L]||Xd(L,L))),a&&n&&n.tagName){var V;V="override"===H?"colors_override":"override_rgb"===H?"colors_override_rgb":"override_a"===H?"colors_override_a":"colors",n[V]||(n[V]={__count__:0});var h=n[V][a];return h||(n[V].__count__>E.imageCacheThreshold&&(n[V]={__count__:0}),h=Gh(n,aq(a),n.width,n.height,H),n[V][a]=h,n[V].__count__++),h}return n},isImageComplete:function(Z,B,l){var w=ir(Z);if(!w)return!1;if(w.tagName)return w.complete;for(var q,Z,M,N=w.comps,Y=!0,R=0,Q=N.length;Q>R;R++)if(q=N[R],M=q.type,"image"===q.type){Z=q.name,Z&&Z.func&&(Z=Qn(Z,B));var H=pq(Z,B,l);if(!H){Y=!1;break}}else if(To.test(M)&&E.getCompType(M)===p){Y=!1,fe(M);break}return Y},getId:function(){var Y=1;return function(){return++Y}}(),callLater:function(u,b,d,P){var v=function(){u.apply(b,d)};return P?td(v,P):y.requestAnimationFrame(v)},cancelLater:function(_,Q){Q?zr(_):y.cancelAnimationFrame(_)},clone:function(X){if(null==X||"object"!=typeof X)return X;if(X instanceof Date){var t=new Date;return t.setTime(X.getTime()),t}if(X instanceof Array){for(var t=[],l=0,D=X.length;D>l;l++)t[l]=Nq(X[l]);return t}if(X instanceof jn){for(var t=new jn,l=0,D=X.length;D>l;l++)t.set(l,Nq(X.get(l)));return t}if(X instanceof $m)return X;if(X instanceof pf){var t=new pf;return t.deserialize(X.serialize()),t}if(X instanceof b){var t={};for(var M in X)X.hasOwnProperty(M)&&(t[M]=Nq(X[M]));return t}return X},callWhenLoaded:function(h,Q){Q=Q||100;var o=Mg(h,Q);Cb||(Cb={}),Cb[o]={tick:o,cb:h,delay:Q}},beforeLoadURL:function(z,d){if(Cb){var r={};for(var d in Cb){var f=Cb[d];zr(f.tick);var Y=Mg(f.cb,f.delay);r[Y]={tick:Y,delay:f.delay,cb:f.cb}}Cb=r}return E.convertURL?E.convertURL(z,d):z},convertURL:function(Z){return Z},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return E.getImage("default_blank")},resizeImage:function(Q,T,z){z||(z=T);var s=_i(),b=s.getContext("2d");return zl(s,T,z,1),b.drawImage(Q,0,0,T,z),s},resizeImagePOT:function(z,s){if(!z||!z.tagName)return z;var g=z.width,Y=z.height;if(!g||!Y)return z;if(or.isPOT(g)&&or.isPOT(Y)&&(!s||g===Y))return z;var y,e;return s?e=y=or.nearestPOT(Math.min(g,Y)):(y=or.nearestPOT(g),e=or.nearestPOT(Y)),E.resizeImage(z,y,e)},sortFunc:function(t,Z){if(t===Z)return 0;if(t==X&&Z!=X)return 1;if(t!=X&&Z==X)return-1;if(t==X&&Z==X)return 0;var M,K=typeof t,i=typeof Z;return K===Fn&&i===Fn?M=t.localeCompare(Z):K===lg&&i===lg&&(M=t-Z),M===p&&(M=(""+t).localeCompare(""+Z)),M>0?1:0>M?-1:0},getClassMap:function(){return sp},getClass:function(r){if(tc(r)){var o,z=sp[r];if(!z){o=r.split("."),z=y;for(var Q=0;Q<o.length;Q++)z=z[o[Q]];sp[r]=z}return z}return r},def:function(R,y,I){var C,N,Y,o=function(){};if(o.prototype=y.prototype,C=new o,tc(R)){if(sp[R])throw"'"+R+"' already defined";Y=Fg(R),C.getClassName=function(){return R}}else Y=R;if(C.constructor=Y,C.getClass=function(){return Y},C.getSuperClass=function(){return y},I)for(N in I)cm[N]&&cm.hasOwnProperty(N)?cm[N](C,I):Ek(C,I,N);Y.prototype=C,Y.superClass=y.prototype},startAnim:function(){var T=function(l){l.duration&&(l.startTime=vk()),l.timeId=hm(l.tick,X,X,l.interval)};return function(m){return m=Nq(m),m.easing=m.easing||E.animEasing,m.duration||m.frames||(m.duration=E.animDuration),m.t=0,m.duration?m.interval=0:(m.frame=0,m.interval=m.interval||10),m.tick=function(){if(m.duration){var o=(vk()-m.startTime)/m.duration;if(o>1&&(o=1),m.t=o,m.action(m.easing(o),o),!m.isRunning())return;1===o?m.stop():m._isPaused||(m.timeId=hm(m.tick))}else{if(m.frame++,o=m.t=m.frame/m.frames,m.action(m.easing(o),o),!m.isRunning())return;m.frame<m.frames?m._isPaused||(m.timeId=hm(m.tick,X,X,m.interval)):m.stop()}},m.resume=function(){m._isPaused&&(delete m._isPaused,m.duration?m.t<1&&(m.startTime=vk()-m.duration*m.t,m.timeId=hm(m.tick)):m.frame<m.frames&&(m.timeId=hm(m.tick,X,X,m.interval)))},m.pause=function(){yl(m.timeId,!m.duration),m._isPaused=!0},m.isPaused=function(){return this._isPaused},m.stop=function(v){m.isRunning()&&(yl(m.timeId,!m.duration),delete m.timeId,m.duration?m.t<1&&v&&(m.t=1,m.action(m.easing(1),1)):m.frame<m.frames&&v&&(m.frame=m.frames,m.action(m.easing(1),1)),m._37o&&m._37o(),m.finishFunc&&m.finishFunc())},m.isRunning=function(){return m.timeId!=X},m.delay?hm(T,X,[m],m.delay):T(m),m}}(),getTextSize:function(){var t={},J=i?_i().getContext("2d"):X;return function(x,D){J.font=x?x:Pn;var G=t[J.font];return G||(G=2*J.measureText("e").width+4,t[J.font]=G),{width:J.measureText(D).width+E.textExtraWidth,height:G}}}(),drawText:function(Q,R,V,B,o,I,x,K,l,Z,E){if(R!=X){var U=Ll(V,R),q={};if(q.y=Z&&Z!==zc?Z===yb?I+U.height/2:I+K-U.height/2:I+K/2,q.x=l&&l!==cq?l===Jo?o+x-U.width/2:o+x/2:o+U.width/2,Jn(Q,R,q,V,B),E){Q.font=V;var k=Q.measureText(R);Q.beginPath(),Q.strokeStyle=B,"underline"===E?(Q.moveTo(q.x-U.width/2,q.y+k.actualBoundingBoxDescent+1),Q.lineTo(q.x+U.width/2,q.y+k.actualBoundingBoxDescent+1)):"strikethrough"===E?(Q.moveTo(q.x-U.width/2,q.y),Q.lineTo(q.x+U.width/2,q.y)):"overline"===E&&(Q.moveTo(q.x-U.width/2,q.y-k.fontBoundingBoxAscent),Q.lineTo(q.x+U.width/2,q.y-k.fontBoundingBoxAscent)),Q.stroke()}}},getDistance:function(O,l){var R=O.length;return l?3===R?B(Dr(O[0]-l[0])+Dr(O[1]-l[1])+Dr(O[2]-l[2])):2===R?B(Dr(O[0]-l[0])+Dr(O[1]-l[1])):O.z===p?B(Dr(l.x-O.x)+Dr(l.y-O.y)):B(Dr(l.x-O.x)+Dr(l.y-O.y)+Dr(l.z-O.z)):3===R?B(Dr(O[0])+Dr(O[1])+Dr(O[2])):2===R?B(Dr(O[0])+Dr(O[1])):void 0},brighter:function(c,I){return 0>I&&(I=-I),Wf(c,I?I:40)},darker:function(Z,Q){return Q>0&&(Q=-Q),Wf(Z,Q?Q:-40)},unionPoint:function(W,y){if(!W)return X;if(2===arguments.length)return W&&y?{x:d(W.x,y.x),y:d(W.y,y.y),width:a(W.x-y.x),height:a(W.y-y.y)}:X;var Z=W;if(Z._as&&(Z=Z._as),Z.length===p)return X;var o=Z.length;if(0>=o)return X;for(var w=1,b=Z[0],k={x:b.x,y:b.y,width:0,height:0};o>w;w++){b=Z[w];var f=d(k.x,b.x),z=P(k.x+k.width,b.x),D=d(k.y,b.y),K=P(k.y+k.height,b.y);k.x=f,k.y=D,k.width=z-f,k.height=K-D}return k},unionRect:function(H,m){if(H&&!m)return Nq(H);if(!H&&m)return Nq(m);if(H&&m){var W={x:d(H.x,m.x),y:d(H.y,m.y)};return W.width=P(H.x+H.width,m.x+m.width)-W.x,W.height=P(H.y+H.height,m.y+m.height)-W.y,W}return X},containsPoint:function(B,v,M,E){if(E!=X&&1!==E){var H=B.x+B.width/2,O=B.y+B.height/2;B={x:H-B.width/2*E,y:O-B.height/2*E,width:B.width*E,height:B.height*E}}if(M){var j=B.width/2,u=B.height/2,i=T(-M),c=t(-M),k=v.x-B.x-j,S=v.y-B.y-u;return v={x:c*k-i*S,y:i*k+c*S},Ue({x:-j,y:-u,width:B.width,height:B.height},v)}return!(!B||v.x<B.x||v.y<B.y||v.x>B.x+B.width||v.y>B.y+B.height)},containsRect:function(S,m){if(!S||!m)return!1;var Y=m.x,b=m.y,L=m.width,d=m.height,W=S.width,w=S.height;if(0>(W|w|L|d))return!1;var N=S.x,Q=S.y;if(N>Y||Q>b)return!1;if(W+=N,L+=Y,Y>=L){if(W>=N||L>W)return!1}else if(W>=N&&L>W)return!1;if(w+=Q,d+=b,b>=d){if(w>=Q||d>w)return!1}else if(w>=Q&&d>w)return!1;return!0},intersectsRect:function(A,s){if(!A||!s)return!1;var X=s.width,k=s.height,j=A.width,K=A.height;if(0>=j||0>=K||0>=X||0>=k)return!1;var V=s.x,u=s.y,d=A.x,B=A.y;return j+=d,K+=B,X+=V,k+=u,j>V&&K>u&&X>d&&k>B},intersection:function(u,d){if(!u||!d)return X;var e=d.x,T=d.y,v=u.x,R=u.y,h=e,r=T,l=v,P=R;return h+=d.width,r+=d.height,l+=u.width,P+=u.height,v>e&&(e=v),R>T&&(T=R),h>l&&(h=l),r>P&&(r=P),h-=e,r-=T,0>=h||0>=r?X:{x:e,y:T,width:h,height:r}},grow:function(O,T,e){e===p&&(e=T),O.x-=T,O.y-=e,O.width=O.width+2*T,O.height=O.height+2*e},getScreenPoint:function(U,c,b,V,A,e,q){var Z=b.getBoundingClientRect(),h=U*(e||1)-b.scrollLeft+(V||0),W=c*(q||1)-b.scrollTop+(A||0),m=pp(b,!1);if(m){var _=new Zh(h,W,0);return _.applyMatrix4(m),console.log(_),{x:_.x,y:_.y}}return{x:h+Z.left,y:W+Z.top}},getLogicalPoint:function(a,A,Y,N,q,O){var l,p,v=A.getBoundingClientRect();a.target?(Yd(a)?Rc?tb["91"]=!0:tb["17"]=!0:Rc?tb["91"]=!1:tb["17"]=!1,tb["16"]=am(a)?!0:!1,a=qc(a)?ol(a):a,l=a.clientX,p=a.clientY):(l=a.x,p=a.y);var T=pp(A,!0);if(T){var y=new Zh(l,p,0);y.applyMatrix4(T);do{if(Math.abs(y.z)<=1e-6)break;var u=new Zh(l,p,1);if(u.applyMatrix4(matrix),Math.abs(u.z)<=1e-6){y=u;break}if(u.sub(y),Math.abs(u.z)<=1e-6)break;y.addScaledVector(u,-y.z/u.z)}while(!1);return{x:(y.x+A.scrollLeft-(Y||0))/(q||1),y:(y.y+A.scrollTop-(N||0))/(O||1)}}return{x:(l-v.left+A.scrollLeft-(Y||0))/(q||1),y:(p-v.top+A.scrollTop-(N||0))/(O||1)}},removeHTML:function(){var U;return function(A){return A&&A.getView&&(A=A.getView()),A&&A.parentNode?U===A?!0:(U=A,A.parentNode.removeChild(A),U=X,!0):!1}}(),getToolTipDiv:function(){if(!wq){wq=_j(),lq=_j();var A=wq.style;E.baseZIndex!=X&&(A.zIndex=js(E.baseZIndex)+3+""),A.whiteSpace="nowrap",A.color=E.toolTipLabelColor,A.background=E.toolTipBackground,A.font=E.toolTipLabelFont,A.padding="5px",A.boxShadow="0px 0px 3px "+E.toolTipShadowColor}return wq},isToolTipShowing:function(){return wq&&wq.parentNode?!0:lq&&lq.parentNode?!0:!1},updateToolTipContent:function(D,J){if(E.isToolTipShowing()&&(J||(J=rd&&rd.view),D===p&&J&&rd.e&&(D=J.getToolTip(rd.e)),D!=X)){var k;D.html?(D=D.html,k=lq):k=wq,k.innerHTML=D}},hideToolTip:function(){if(E.isToolTipShowing()){cp(wq),cp(lq),Nd();var _=rd&&rd.view;_&&_.onHideToolTip&&_.onHideToolTip(),rd=X}},showToolTip:function(R,I,P){if(!R||I==X)return On(),void 0;E.getToolTipDiv();var Q,F;if(I.html?(I=I.html,Q=lq,cp(wq)):(Q=wq,cp(lq)),F=Q.style,Q.innerHTML=I,Q.parentNode||S.Default.appendToScreen(Q),R.target){R=_n(R);var g=dd(),O=R.x,H=R.y,f=Iq?60:12;if(Iq){var q=Q.getBoundingClientRect();F.left=O-q.width/2+Dp,F.top=H-q.height-f<g.top?H+f+Dp:H-q.height-f+Dp}else{F.left=O+f+Dp,F.top=H+f+Dp;var q=Q.getBoundingClientRect();q.left+q.width>g.width&&(F.left=O-f-q.width+Dp),q.top+q.height>g.height&&(F.top=H-f-q.height+Dp),q.left<0&&(F.left=O+f+Dp),q.top<0&&(F.top=H+f+Dp)}}else F.left=R.x+Dp,F.top=R.y+Dp;Nd(),P===p?P=rd&&rd.view:rd={e:R,view:P},P&&P.onShowToolTip&&P.onShowToolTip()
},startDragging:function(u,B,N){N==p&&(N=!0),u!==Gr&&(Gr?N&&(qc(B)?Gr.handleWindowTouchEnd(B):Gr.handleWindowMouseUp(B)):qc(B)?(q(y,sj,em),q(y,Gk,fb)):(q(y,ss,uf),q(y,pi,dc)),Gr=u)},getImageMap:function(){return Vl},toBoundaries:function(l,X,R,P){var s=[];return fl(l,X,R,P).forEach(function(U){var J=[];U.forEach(function(A){J.push(A.x,A.y)}),s.push(J)}),s},getCurrentKeyCodeMap:function(){return tb},drawCenterImage:function(Q,a,n,L,M,o,X,D){!M&&o&&o.isSelfViewEvent&&(M=o);var t=rc(a,M,o),N=Sn(a,M,o);tm(Q,a,s(n-t/2),s(L-N/2),t,N,M,o,X,D)},drawStretchImage:function(b,c,o,I,y,q,M,Q,j,n,_,g){!Q&&j&&j.isSelfViewEvent&&(Q=j);var W,C=rc(c,Q,j,q),f=Sn(c,Q,j,M);"uniform"===o?(W=d(q/C,M/f),C*=W,f*=W,I+=s((q-C)/2),y+=s((M-f)/2),q=C,M=f):"centerUniform"===o&&((C>q||f>M)&&(W=d(q/C,M/f),C*=W,f*=W),I+=s((q-C)/2),y+=s((M-f)/2),q=C,M=f);var u=b.interactiveInfo;if(u){var L;if(L="center"===o?{x:I+q/2-C/2,y:y+M/2-f/2,width:C,height:f}:{x:I,y:y,width:q,height:M},u.rect){var m=u.compInfos,D=m.length;D&&(m[D-1].rect.image=c)}else u.rect=L}if("center"===o){var U=_!==!1&&(C>q||f>M);U&&(b.save(),b.beginPath(),b.rect(I,y,q,M),b.clip()),tm(b,c,I+q/2-C/2,y+M/2-f/2,C,f,Q,j,n,g),U&&b.restore()}else tm(b,c,I,y,q,M,Q,j,n,g)},toCanvas:function(D,q,M,y,z,l,L,T,N){D=ir(D,L),q=q||rc(D,z),M=M||Sn(D,z);var n=_i(),c=dk(n);return T?(zl(n,q,M,T),c.scale(T,T)):zl(n,q,M,1),ch(c,D,y,0,0,q,M,z,l,L,N),D&&D.clampToEdge&&(n.clampToEdge=D.clampToEdge),c.restore(),n},toGrayColor:function(Q){if(!Q)return Q;var P=wb(Q),T=s(.299*P[0]+.587*P[1]+.114*P[2]);return"rgba("+T+","+T+","+T+","+P[3]/255+")"},createGradientImage:function(J,k,C,M){for(var i=["L",0,0,J,0,1,0,0,1,0,0],D=0,g=Math.min(k.length,C.length);g>D;D++)i.push(C[D],k[D]);var w=S.Default.toCanvas({width:J,height:J,clampToEdge:!0,comps:[{type:"shape",rotation:M||0,points:[0,0,J,0,J,J,0,J],background:"#ffffff",gradientPack:i}]});return w},createElement:function(Y,v,H,y){var m=i.createElement(Y);return _b(m,v||M.widgetBorder,2),m.style.font=H?H:Pn,y!=X&&(m.value=y),E.onElementCreated&&E.onElementCreated(m),m},containedInView:function(V,Z){var m=om(Z).getBoundingClientRect();return Ue({x:m.left,y:m.top,width:m.width,height:m.height},Wc(V))},isIsolating:function(){return Rh>0},setIsolating:function(R){R?Rh++:Rh--},getMSMap:function(){return cm},stringify:function(n,o,D){var y=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var $=pf.prototype.toJSON;pf.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},o=D?0:o==X?2:o;var g=JSON.stringify(n,function(X,m){return"function"==typeof m?"__ht__"+(m.__ht__||m.toString()):po(m)?ei(m):m instanceof S.List?"__ht__list"+(m.__ht__list||E.stringify(m._as)):m},o);return Date.prototype.toJSON=y,pf.prototype.toJSON=$,D&&(g=Yl+Wb(g)),g},parse:function(d,i){return tc(d)?d.substr(0,12)!=Yl||(d=yk(d.substr(12)),tc(d))?(i=i||{},JSON.parse(d,function(D,Y){if(tc(Y))if(i.ignoreFunction||"__ht__function"!=Y.substr(0,14)){if(!i.ignoreDate&&"__ht__date"==Y.substr(0,10))return new Date(js(Y.substr(10)));if("__ht__list"===Y.substr(0,10))return new jn(E.parse(Y.substr(10)));if(!i.ignoreDataModel&&"__ht__dataModel"===Y.substr(0,15)){var B=new pf;return B.deserialize(E.parse(Y.substr(15))),B}}else{var F=Y.indexOf("{")+1,p=Y.lastIndexOf("}"),v=Y.indexOf("(")+1,M=Y.indexOf(")");if(F&&p&&v&&M)try{var h=new Function(Y.substring(v,M),Y.substring(F,p));return h.__ht__=Y.substr(6),h}catch(L){throw console.info("=== SyntaxError ===\n",Y),L}}return Y})):d:d},loadJS:function(Q,O){O&&Q.push(O);var m=Q.shift();if(Kc(m))Q=m.contact(Q),E.loadJS(Q);else if(Uq(m))m(),E.loadJS(Q);else if(tc(m)){var l=i.createElement("script");l.onload=function(){E.loadJS(Q)},l.setAttribute("src",m),i.getElementsByTagName("head")[0].appendChild(l)}else Q.length&&E.loadJS(Q)},extendClass:function(g,w){var Y=g.prototype;for(var U in w)cm[U]&&cm.hasOwnProperty(U)?cm[U](Y,w):Y[U]=w[U]},toRoundedCorner:function(){function U($,O,E){$.x=O.x,$.y=O.e||E,$.z=O.y}var L=new Zh,Y=new Zh,l=new Zh,C=new Zh;return function(k,N){var K,g=0;k.getPoints&&(g=k.getElevation(),k=k.getPoints()),K=k instanceof jn?k:new jn(k);var A=K.size();if(0>=N)return{points:K};var I=new jn,v=new jn,e=K.get(0);U(L,e,g),I.add(e),v.add(1);for(var s=1;A>s;s++)if(A>s+1){var $=K.get(s),R=K.get(s+1);U(Y,$,g),U(l,R,g),C.subVectors(L,Y).setLength(Math.min(.99*C.length(),N)).add(Y),$.e!==p||e.e!==p?I.add({x:C.x,y:C.z,e:C.y}):I.add({x:C.x,y:C.z}),I.add($),C.subVectors(l,Y).setLength(Math.min(.99*C.length(),N)).add(Y),$.e!==p||R.e!==p?I.add(e={x:C.x,y:C.z,e:C.y}):I.add(e={x:C.x,y:C.z}),L.copy(C),v.addAll([2,3])}else I.add(K.get(s)),v.add(2);return{points:I,segments:v}}}(),toColorData:wb,setCanvas:zl,createDiv:_j,createDisabledDiv:un,createView:Mn,createCanvas:_i,appendChild:vb,initContext:dk,checkLoadingImage:sl,translateAndScale:xn,layout:zd,getPosition:sc,drawPoints:_g,drawRoundRect:es,drawBorder:oo,setFocus:zf,getter:Bh,setter:Hg,isEmptyObject:Ub,cameraPriority:function(){var R={skybox:0,main:1e4,top:1e7,infinity:1/0};return b.seal(b.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return R.skybox},set:function(C){if(C>=R.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");R.skybox=Number(C)}},main:{configurable:!1,enumerable:!1,get:function(){return R.main},set:function(r){if(r<=R.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(r>=R.top)throw new RangeError("Main camera must have lower priority than the top camera.");R.main=Number(r)}},top:{configurable:!1,enumerable:!1,get:function(){return R.top},set:function(y){if(y<=R.main)throw new RangeError("Top camera must have higher priority than the main camera.");R.top=Number(y)}}}))}()},!0),Vm(n,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var um=E.disabledOpacity,Fk=E.toolTipDelay,yh=E.devicePixelRatio,Hc=E.autoMakeVisible,oj=E.autoHideScrollBar,Oo=E.imageGradient,sh=E.showToolTip,On=E.hideToolTip,hs=E.dashPattern,bc=E.lineCap,ek=E.lineJoin,di=E.labelColor,Hf=E.labelSelectColor,Pn=E.labelFont,As=E.widgetIndent,xs=E.widgetRowHeight,wr=E.widgetHeaderHeight,hh=E.widgetTitleHeight,Yj=E.scrollBarColor,jh=E.scrollBarSize,Eb=E.scrollBarTimeout,ub=E.scrollBarMinLength,Zp=E.scrollBarInteractiveSize,Nl=E.zoomIncrement,lj=E.scrollZoomIncrement,Td=E.pinchZoomIncrement,sr=E.zoomMax,gl=E.zoomMin,dp=E.createObject,Bi=E.preventDefault,Eq=E.setImage,ir=E.getImage,pq=E.isImageComplete,dj=E.drawCenterImage,ch=E.drawStretchImage,Ne=E.getId,hm=E.callLater,yl=E.cancelLater,bk=E.sortFunc,Nq=E.clone,Fg=E.getClass,Ti=E.startAnim,Ab=E.brighter,eg=E.darker,Oj=E.drawText,Ll=E.getTextSize,Dj=E.isLeftButton,Op=E.isMiddleButton,Pi=E.isRightButton,$r=E.getTouchCount,re=E.isDoubleClick,am=E.isShiftDown,Yd=E.isCtrlDown,Wc=E.getClientPoint,_n=E.getPagePoint,Fb=E.getDistance,$q=E.unionPoint,Mb=E.unionRect,Ue=E.containsPoint,bi=E.containsRect,go=E.intersectsRect,qs=E.intersection,dd=E.getWindowInfo,as=E.grow,Bm=E.getLogicalPoint,Lf=E.getScreenPoint,Aj=E.startDragging,cp=E.removeHTML,Kf=E.createElement,ke=E.segmentResolution,Dc=E.shapeResolution,Xh=E.shapeSide,Wi=E.def,Ef=function(m,D,z){Wi(K+"."+m,D,z)},Yi=function(k,i){k.childNodes.forEach(function(p){i(p),Yi(p,i)})};Vm(E,{toolTipLabelColor:di,toolTipLabelFont:Pn,toolTipBackground:M.toolTipBackground,toolTipShadowColor:Zc,debugTipLabelFont:Pn,debugTipLabelColor:di,debugTipBackground:M.toolTipBackground,drawBreakableText:db,setDevicePixelRatio:function(r){yh=E.devicePixelRatio="number"==typeof r?r:y.screen?y.screen.deviceXDPI/y.screen.logicalXDPI:1,Yi(i.body,function(Z){var p=Z._ht;p&&p._canvas&&(zl(p._canvas,p.getWidth(),p.getHeight()),p.redraw?p.redraw():p.iv())})}},!0);var zk=1e-6,Ql="undefined"!=typeof Uint16Array?Uint16Array:Array,en="undefined"!=typeof Float32Array?Float32Array:Array,Fi=function(B,a,e){var Z=[B[0]-a[0],B[1]-a[1],B[2]-a[2]];if(e){var G=Fb(Z);G>0&&(Z[0]/=G,Z[1]/=G,Z[2]/=G)}return Z},Ym=function(){var x="charCodeAt",$=2*(2*ge.length+1);for(var S in y)if(S===K+cq[0]+(Dp.length+2)){var m=y[S];if(!m)break;for(var p=m.length,H=0;p>H;H++)if(m[H][x](0)===$&&m[H+1]!=X&&m[H+1]===Dp[0]&&m[H+2]!=X&&m[H+2][x](0)===$){for(var g=H+3;p>g;g++)if(m[g][x](0)===$){if(0==m[g+1])for(var J,n=g+2;p>n;n++){if(m[n][x](0)===$){0==m[n-1]&&J&&(ur=J.substr(0,J.length-1));break}J==X?J=m[n]:J+=m[n]}break}break}break}return function(I){return[-I[0],-I[1],-I[2]]}}(),gq=function(s,m){return 3===s.length?s[0]*m[0]+s[1]*m[1]+s[2]*m[2]:s[0]*m[0]+s[1]*m[1]},df=function(){var d=new Array(16);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d},Jq=df(),le=function(t){var y=new Array(16);return y[0]=t[0],y[1]=t[1],y[2]=t[2],y[3]=t[3],y[4]=t[4],y[5]=t[5],y[6]=t[6],y[7]=t[7],y[8]=t[8],y[9]=t[9],y[10]=t[10],y[11]=t[11],y[12]=t[12],y[13]=t[13],y[14]=t[14],y[15]=t[15],y},eo=function(J,V){return J[0]=V[0],J[1]=V[1],J[2]=V[2],J[3]=V[3],J[4]=V[4],J[5]=V[5],J[6]=V[6],J[7]=V[7],J[8]=V[8],J[9]=V[9],J[10]=V[10],J[11]=V[11],J[12]=V[12],J[13]=V[13],J[14]=V[14],J[15]=V[15],J},bf=function(J){return J[0]=1,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=1,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=1,J[11]=0,J[12]=0,J[13]=0,J[14]=0,J[15]=1,J},$c=function(D,z){var P=D[0],G=D[1],l=D[2];return D[0]=z[0]*P+z[4]*G+z[8]*l+z[12],D[1]=z[1]*P+z[5]*G+z[9]*l+z[13],D[2]=z[2]*P+z[6]*G+z[10]*l+z[14],D},fm=function(N,y){var Y=N[0],i=N[1],A=N[2],P=N[3];return N[0]=y[0]*Y+y[4]*i+y[8]*A+y[12]*P,N[1]=y[1]*Y+y[5]*i+y[9]*A+y[13]*P,N[2]=y[2]*Y+y[6]*i+y[10]*A+y[14]*P,N[3]=y[3]*Y+y[7]*i+y[11]*A+y[15]*P,N},im=function(){var x,U,E,f,u=Og(Gm[1]+Gm[7]),G=Og(Gm[0]+Gm[3]-Gm[10]),M=Og(Gm[8]+2),W=function(){return U=E.charAt(x),x+=1,U},$=function(){var b="";if(U===M)for(;W();){if(U===M)return W(),b;b+=U}else W()},j=function(){for(;U&&" ">=U;)W()},v=function(){var F,v={};if(U===u){if(W(),j(),U===G)return W(),v;for(;U;){if(F=$(),j(),W(),v[F]=f(),j(),U===G)return W(),v;W(),j()}}};return f=function(){switch(j(),U){case u:return v();default:return $()}},function(Q){if(c={},Q){var s;if(E=Q,x=0,U=" ",s=f(),j(),!U)return s}}}(),ce=function(f,D){if(D){var C=T(D),j=t(D),L=f[4],Z=f[5],Y=f[6],d=f[7],O=f[8],o=f[9],s=f[10],r=f[11];f[4]=L*j+O*C,f[5]=Z*j+o*C,f[6]=Y*j+s*C,f[7]=d*j+r*C,f[8]=O*j-L*C,f[9]=o*j-Z*C,f[10]=s*j-Y*C,f[11]=r*j-d*C}},fg=function(O,Q){if(Q){var X=T(Q),F=t(Q),A=O[0],H=O[1],W=O[2],s=O[3],Z=O[8],k=O[9],p=O[10],U=O[11];O[0]=A*F-Z*X,O[1]=H*F-k*X,O[2]=W*F-p*X,O[3]=s*F-U*X,O[8]=A*X+Z*F,O[9]=H*X+k*F,O[10]=W*X+p*F,O[11]=s*X+U*F}},Gp=function($,R){if(R){var i=T(R),b=t(R),G=$[0],E=$[1],F=$[2],n=$[3],Y=$[4],j=$[5],s=$[6],o=$[7];$[0]=G*b+Y*i,$[1]=E*b+j*i,$[2]=F*b+s*i,$[3]=n*b+o*i,$[4]=Y*b-G*i,$[5]=j*b-E*i,$[6]=s*b-F*i,$[7]=o*b-n*i}},ec=function(i,$,q){return Wo(X,q===!1?X:i.getFinalScale3d(),i.getFinalRotation3d(),i.getRotationMode(),i.p3(),X,$)},Wo=function(m,y,s,v,r,l,H){return l||(l=df()),r&&qq(l,r),Br(l,s,v),H&&sm(l,l,H),y&&Em(l,y),m&&sm(l,l,m),l},vp=function(s,_,H){_=js(_),H=js(H);var n=this;n.g=s,n._84O=_,n._85O=H,n._70I=!0,n.F=0,n._83O=_+H,n.pen={x:0,y:0}},Xc="lineDashOffset",Fd="setLineDash",Ho=function(G){for(var X in G)1===X.length&&(Xc=G[X]);return X?1:0},Hm=function(z,n,A){return aj(n)?z:z[Fd]?(z[Fd](n),A&&(z.lineDashOffset=A),z):new vp(z,n[0],n.length>1?n[1]:n[0])},dn=function(o,k){!aj(k)&&o[Fd]&&(o[Fd](sg),o.lineDashOffset=0)};Wi(vp,b,{_69I:6,moveTo:function(H,p){var Y=this,n=Y.pen;n.x=H,n.y=p,Y.g.moveTo(H,p),Y.start||(Y.start={x:H,y:p})},lineTo:function(Q,C){var W=this,F=W.pen,r=Q-F.x,f=C-F.y,K=$g(f,r),U=t(K),e=T(K),q=W._23O(F.x,F.y,Q,C),R=W._85O,P=W._84O,V=W._83O;if(W.F){if(W.F>q)return W._70I?W._72I(Q,C):W.moveTo(Q,C),W.F-=q,void 0;if(W._70I?W._72I(F.x+U*W.F,F.y+e*W.F):W.moveTo(F.x+U*W.F,F.y+e*W.F),q-=W.F,W.F=0,W._70I=!W._70I,!q)return}var J=x(q/V);if(J){for(var i=U*P,D=e*P,S=U*R,p=e*R,I=0;J>I;I++)W._70I?(W._72I(F.x+i,F.y+D),W.moveTo(F.x+S,F.y+p)):(W.moveTo(F.x+S,F.y+p),W._72I(F.x+i,F.y+D));q-=V*J}W._70I?q>P?(W._72I(F.x+U*P,F.y+e*P),W.moveTo(Q,C),W.F=R-(q-P),W._70I=!1):(W._72I(Q,C),q===P?(W.F=0,W._70I=!W._70I):(W.F=P-q,W.moveTo(Q,C))):q>R?(W.moveTo(F.x+U*R,F.y+e*R),W._72I(Q,C),W.F=P-(q-R),W._70I=!0):(W.moveTo(Q,C),q===R?(W.F=0,W._70I=!W._70I):W.F=R-q)},quadraticCurveTo:function(u,b,J,d){var _,e=this,g=e.pen,B=g.x,K=g.y,D=e._22O(B,K,u,b,J,d),$=0,z=0,p=e._85O,Q=e._84O;if(e.F){if(e.F>D)return e._70I?e._71I(u,b,J,d):e.moveTo(J,d),e.F-=D,void 0;if($=e.F/D,_=e._20O(B,K,u,b,J,d,$),e._70I?e._71I(_[2],_[3],_[4],_[5]):e.moveTo(_[4],_[5]),e.F=0,e._70I=!e._70I,!D)return}var y=D-D*$,c=x(y/e._83O),F=Q/D,S=p/D;if(c)for(var X=0;c>X;X++)e._70I?(z=$+F,_=e._21O(B,K,u,b,J,d,$,z),e._71I(_[2],_[3],_[4],_[5]),$=z,z=$+S,_=e._21O(B,K,u,b,J,d,$,z),e.moveTo(_[4],_[5])):(z=$+S,_=e._21O(B,K,u,b,J,d,$,z),e.moveTo(_[4],_[5]),$=z,z=$+F,_=e._21O(B,K,u,b,J,d,$,z),e._71I(_[2],_[3],_[4],_[5])),$=z;y=D-D*$,e._70I?y>Q?(z=$+F,_=e._21O(B,K,u,b,J,d,$,z),e._71I(_[2],_[3],_[4],_[5]),e.moveTo(J,d),e.F=p-(y-Q),e._70I=!1):(_=e._19O(B,K,u,b,J,d,$),e._71I(_[2],_[3],_[4],_[5]),D===Q?(e.F=0,e._70I=!e._70I):(e.F=Q-y,e.moveTo(J,d))):y>p?(z=$+S,_=e._21O(B,K,u,b,J,d,$,z),e.moveTo(_[4],_[5]),_=e._19O(B,K,u,b,J,d,z),e._71I(_[2],_[3],_[4],_[5]),e.F=Q-(y-p),e._70I=!0):(e.moveTo(J,d),y===p?(e.F=0,e._70I=!e._70I):e.F=p-y)},bezierCurveTo:function(){var B=arguments;this.pen={x:B[4],y:B[5]},this.g.bezierCurveTo(B[0],B[1],B[2],B[3],B[4],B[5])},arc:function(H,A,B,T,x,U){U||(T=-T,x=-x),pr(this,H,A,T,x-T,B,B,!1)},rect:function(q,z,S,U){var T=this;T.pen={x:q,y:z},T.moveTo(q,z),T.lineTo(q,z+U),T.lineTo(q+S,z+U),T.lineTo(q+S,z),T.lineTo(q,z)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(Z,V,s,x){var X=s-Z,z=x-V;return B(X*X+z*z)},_22O:function($,l,B,x,S,U,f){for(var L,O,u,V,J,d,C,r=0,Q=$,q=l,W=f>0?f:this._69I,m=1;W>=m;m++)u=m/W,V=1-u,J=V*V,d=2*u*V,C=u*u,L=J*$+d*B+C*S,O=J*l+d*x+C*U,r+=this._23O(Q,q,L,O),Q=L,q=O;return r},_21O:function(w,L,q,j,z,d,k,r){var e=this;if(0===k)return e._20O(w,L,q,j,z,d,r);if(1===r)return e._19O(w,L,q,j,z,d,k);var B=e._20O(w,L,q,j,z,d,r);return B.push(k/r),e._19O.apply(e,B)},_20O:function(Q,q,T,o,a,Z,D){if(1!==D){var l=T+(a-T)*D,Y=o+(Z-o)*D;T=Q+(T-Q)*D,o=q+(o-q)*D,a=T+(l-T)*D,Z=o+(Y-o)*D}return[Q,q,T,o,a,Z]},_19O:function(W,G,J,S,B,P,T){if(1!==T){var Z=W+(J-W)*T,k=G+(S-G)*T;J+=(B-J)*T,S+=(P-S)*T,W=Z+(J-Z)*T,G=k+(S-k)*T}return[W,G,J,S,B,P]},_72I:function(v,H){var B=this.pen;(v!==B.x||H!==B.y)&&(B.x=v,B.y=H,this.g.lineTo(v,H))},_71I:function(B,D,c,Y){var R=this.pen;(B!==c||D!==Y||c!==R.x||Y!==R.y)&&(R.x=c,R.y=Y,this.g.quadraticCurveTo(B,D,c,Y))}}),cm.ms_quickVisible=function(U){U._4BQ=!1,U._4CQ=function(_){var Z=_._4EQ;return Z!==p?Z:Z=_._4EQ=this._4FQ(_)},U._4DQ=function(U){if(!U)return this.dm().each(function(D){D._4EQ=p}),void 0;U._4EQ=p;var l=this;if(U instanceof qk||Tl(U)||U instanceof Tf||U.ISubGraph)U.eachChild(function(C){l.invalidateQuickVisible(C)});else if(U.getEdges){var A=U.getEdges();A&&A.each(function(j){l.invalidateQuickVisible(j)})}},U.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},U.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=wh)},U.isQuickVisibleMode=function(){return this._4BQ},U.invalidateQuickVisible=wh},kr=Zm()+1,xo&&y.console&&kr&&!1&&(y.navigator&&y.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?y.console.log.apply(console,["Hightopo - Version："+S.Default.getVersion()+" - %cTrial：http://hightopo.com/request.html","color: #f00;"]):y.console.log("Hightopo - Version："+S.Default.getVersion()+" - Trial：http://hightopo.com/request.html"));var Lp=X,lc=X,pd=E.checkLoadingCompType=function(q){Lp&&!q._72O_&&(lc||(lc={}),lc[q._72O_=Ne()]=q)},fe=function(n,u){if(u||(u=n),u&&(Lp||(Lp={}),!Lp[n])){var R=new _r;if(Lp[u]={request:R,url:u},u=E.beforeLoadURL(u,n),u.data){var l=E.parse(u.data);pm(n,l),E.handleCompTypeLoaded(n,l)}else{R.onload=function(){if(200===this.status||0===this.status){var $=E.parse(R.getResponseText());pm(n,$),E.handleCompTypeLoaded(n,$)}else pm(n,X)},R.onerror=function(){pm(n,X)};var r={};r.url=encodeURI(u),r.sync=!1,R.send(r)}}},pm=function(T,m){if(ar[T]=m,delete Lp[T],Ub(Lp)&&(Lp=X,lc)){for(var w in lc){var _=lc[w];_.invalidateAll&&_.invalidateAll(p,"compTypeLoaded",T),_.redraw&&_.redraw(),_.iv(),delete _._72O_}lc=X}if(m&&lc)for(var w in lc){var _=lc[w];_.invalidateAll&&_.invalidateAll(p,"compTypeLoading",T),_.redraw&&_.redraw(),_.iv()}},$o=M.chart,Ji="",Mh=!0,kd=E.compStack=[],kl=/^style@/,cd=/^attr@/,Yh=/^field@/,Gc={x:.5,y:.5},Xf=function(){Mh=!0},Nj=function(){return Mh},rc=function(b,o,A,a){if(!b)return 0;if(Qn(b.fitSize,o,A)&&a)return a;var c=Qn(b.width,o,A);return null==c?20:c},Sn=function(X,Z,G,F){if(!X)return 0;if(Qn(X.fitSize,Z,G)&&F)return F;var U=Qn(X.height,Z,G);return null==U?20:U},Qn=function(K,l,t){if(!K||!K.func)return K;var _,h=K.func,V=K.value;return _=Uq(h)?t&&t.vectorDataBindingDisabled&&!K.isSafeFunc?V:h(l,t):l instanceof $m||(S.ui?l instanceof S.ui.View:0)?cd.test(h)?l.a(Ji+h.slice(5)):kl.test(h)?l.s(Ji+h.slice(6)):Yh.test(h)?l[h.slice(6)]:l[h]?l[h](t):V:V,V!==p&&_==X?V:_},tm=E.drawImage=function(){var G,x,Q,o,h,K,l=3,u=6,C=function(X){var d,i,$,Z=!1;return m(X,"shadow")&&(d=m(X,"shadowOffsetX")||l,i=m(X,"shadowOffsetY")||l,$=m(X,"shadowBlur")||u,Z=!0),!Z&&x instanceof $m&&((lr(x,Kg,"shadow")||"shadow"===lr(x,Kg,"select.type")&&Q&&Q.isSelected&&Q.isSelected(x))&&(d=lr(x,Kg,"shadow.offset.x")||0,i=lr(x,Kg,"shadow.offset.y")||0,$=lr(x,Kg,"shadow.blur")||0,Z=!0),!Z&&lr(x,Kg,"shadow2")&&(d=lr(x,Kg,"shadow2.offset.x")||0,i=lr(x,Kg,"shadow2.offset.y")||0,$=lr(x,Kg,"shadow2.blur")||0,Z=!0)),Z?1.5*$+Math.max(d,i):0},f=function(h,O){h.getValue&&h.getValue.compType===O||(h.getValue=function(d){var E=m(h,d);if(E===p&&O.properties){var v=O.properties[d];v&&(E=v.defaultValue)}return E},h.getColor=function($,X){return X===!0?a($):a(h.getValue($))},h.getValue.compType=O)},m=function(m,l,_){var J,u=!1;if(m.prefix&&x instanceof $m){var P=x.a(Ji+l);P!==p&&(u=!0,J=P)}return J===p&&(J=m[l]),J&&J.func&&(u=!0,J=Qn(J,x,Q)),_&&(J=_(J),u||(m[l]=J)),J},a=function(_,j){var F;return F=j?m(_,j):_,G&&G.compGray&&F?E.toGrayColor(F):h&&F?Km(F,h,K):F},g=function(K){if(Kc(K)){for(var $=new jn,z=K.length,Q=0;z>Q;Q+=2)$.add({x:K[Q],y:K[Q+1]});K=$}return K},S=function(Z){var c=m(Z,"anchorX"),k=m(Z,"anchorY");if(c!==p||k!==p)return{x:c===p?Gc.x:c,y:k===p?Gc.y:k};var j=m(Z,"type"),$=m(Z,"name");if("image"!==j||!$)return Gc;var N=ir($);return N&&N.anchorX!==p&&N.anchorY!==p?{x:N.anchorX,y:N.anchorY}:Gc},s=function(O,d){var r=m(O,zo),Q=S(O);if(Kc(r)){var q=r.length,X=m(O,"relative"),h=d.width,b=d.height;if(4===q)r={x:r[0],y:r[1],width:r[2],height:r[3]},X&&(r.x*=h,r.y*=b,r.width*=h,r.height*=b);else if(3===q){var u=r[0];r={width:r[1],height:r[2]},X&&(r.width*=h,r.height*=b),"object"==typeof u?u.length&&(u={x:u[0],y:u[1]}):u=sc(u,d,r),r.x=u.x-r.width*Q.x,r.y=u.y-r.height*Q.y}r.x+=m(O,"offsetX")||0,r.y+=m(O,"offsetY")||0,!X&&d.fitSize&&(r=J(O,r,d))}return r},J=function(V,a,r){if(a){var z,i,s,n={x:a.x,y:a.y,width:a.width,height:a.height},G=S(V),F=m(V,"layoutH"),U=m(V,"layoutV"),x=1,g=1,C=0,t=0,e=1,Z=1;switch(F){case"left":break;case"right":n.x+=r.width-r.rw;break;case"center":n.x+=.5*(r.width-r.rw);break;case"scale":case"leftright":default:z=m(V,Uh)||0,z&&(C=Math.abs(t=Math.sin(z)),e=Math.abs(Z=Math.cos(z))),"leftright"!==F?(x+=e*(r.widthScale-1),g+=C*(r.widthScale-1)):(x+=n.width?e*(r.width-r.rw)/n.width:0,g+=n.height?C*(r.width-r.rw)/n.height:0,i=-Math.min(-G.x*Z+G.y*t,-G.x*Z-(1-G.y)*t,(1-G.x)*Z+G.y*t,(1-G.x)*Z-(1-G.y)*t))}switch(U){case"top":break;case"bottom":n.y+=r.height-r.rh;break;case"center":n.y+=.5*(r.height-r.rh);break;case"scale":case"topbottom":default:z==X&&(z=m(V,Uh),z&&(C=Math.abs(t=Math.sin(z)),e=Math.abs(Z=Math.cos(z)))),"topbottom"!==U?(x+=C*(r.heightScale-1),g+=e*(r.heightScale-1)):(x+=n.width?C*(r.height-r.rh)/n.width:0,g+=n.height?e*(r.height-r.rh)/n.height:0,s=-Math.min(-G.x*t-G.y*Z,-G.x*t+(1-G.y)*Z,(1-G.x)*t-G.y*Z,(1-G.x)*t+(1-G.y)*Z))}return(1!==x||1!==g)&&("scale"!==F&&F?"leftright"===F&&(n.x+=n.width*(1-x)*G.x+i*(r.width-r.rw)):n.x+=n.x*(r.widthScale-1)+G.x*n.width*(r.widthScale-x),"scale"!==U&&U?"topbottom"===U&&(n.y+=n.height*(1-g)*G.y+s*(r.height-r.rh)):n.y+=n.y*(r.heightScale-1)+G.y*n.height*(r.heightScale-g),n.width*=x,n.height*=g),n.width<0&&(n.width=0),n.height<0&&(n.height=0),n}},I=function(J){return Kc(J)?new jn(J):J},e=function(t,D,T,n,B,a,$){var z=G.interactiveInfo,e=t.transform;if(e)return G.save(),G.setTransform(e.a,e.b,e.c,e.d,e.tx,e.ty),z&&z.compInfos.push({comp:t,rect:D,matrix:e.clone(),prefix:Ji,refRect:z.refRect}),!0;B===p&&(B=1),a===p&&(a=1);var o=m(t,"clipPercentage"),F=bq(T,D);if(F&&!n&&1===B&&1===a&&!(1>o))return z&&z.compInfos.push({comp:t,rect:D,matrix:z.matrix.clone(),prefix:Ji,refRect:z.refRect}),!1;$=$||Gc;var O=D.x+D.width*$.x,J=D.y+D.height*$.y,P=T.x+T.width*$.x,W=T.y+T.height*$.y,Z=T.width?B*(D.width/T.width):1,f=T.height?a*(D.height/T.height):1;if(G.save(),z&&(z.matrix.appendTranslate(O,J).appendRotate(n).appendScale(Z,f).appendTranslate(-P,-W),z.compInfos.push({comp:t,rect:D,matrix:z.matrix.clone(),prefix:Ji,refRect:z.refRect})),Pb(G,O,J),iq(G,n||0),Co(G,Z,f),Pb(G,-P,-W),1>o){0>o&&(o=0);var X=Vn(T,m(t,"clipDirection"),o,C(t));G.beginPath(),G.rect(X.x,X.y,X.width,X.height),G.clip()}return!0},Z=function(){G.restore()},c=function(z,f,d){var w=m(z,"path"),i=m(z,Uh),n=m(z,"scaleX"),h=m(z,"scaleY"),N=S(z),M=X,L=Mc(null,w);if(d||(d=z.unionRect,d||(d=$q(L),z.path.func||(z.unionRect=d)),M=d),d){M||(M=z.unionRect,M||(M=$q(L),z.path.func||(z.unionRect=M)));var p=e(z,d,M,i,n,h,N),t=m(z,"borderPattern"),s=Hm(G,t),y=a(z,"background"),U=a(z,"borderColor"),B=m(z,"borderWidth"),D=m(z,"gradient"),v=a(z,"gradientColor"),g=m(z,"border3d"),O=a(z,"border3dColor"),x=m(z,"border3dAccuracy"),k=G.lineJoin,j=G.lineCap;G.lineJoin=m(z,"borderJoin")||ek,G.lineCap=m(z,"borderCap")||bc,y?(Ud(G,y,D,v,M),Mc(G,w),G.fill(),s!==G&&Mc(G,w)):Mc(G,w);var H=m(z,"borderWidthAbsolute");if(H&&(G.save(),G.setTransform(1,0,0,1,0,0)),B&&U&&(G.lineWidth=B,G.strokeStyle=U,G.stroke(),g&&ns(G,U,O,B,o,x)),dn(G,t),m(z,"dash")){var F=m(z,"dashWidth")||B;if(F>0){t=m(z,"dashPattern")||hs;var s=Hm(G,t,m(z,"dashOffset")),W=a(z,"dashColor")||a(Tj);s!==G&&Mc(G,w),G.strokeStyle=W,G.lineWidth=F,G.stroke(),m(z,"dash3d")&&ns(G,W,a(z,"dash3dColor"),F,o,m(z,"dash3dAccuracy")),dn(G,t)}}H&&G.restore(),f===zo&&Cj(G,y,m(z,"depth"),M),G.lineJoin=k,G.lineCap=j,p&&Z()}},H=function(_,k,c,A){var M=m(_,tk,g),O=m(_,Uh),F=S(_);if(M&&A.fitSize){var z=new jn,$=$q(M),i=J(_,$,A),j=$.x+F.x*$.width,E=$.y+F.y*$.height,t=i.x+F.x*i.width,U=i.y+F.y*i.height,u=$.width?i.width/$.width:1,w=$.height?i.height/$.height:1;M.each(function(P){z.add({x:t+(P.x-j)*u,y:U+(P.y-E)*w})}),M=z,_.unionRect=null}var r=m(_,"scaleX"),P=m(_,"scaleY"),s=k===Zi,b=X;if(!c&&s&&(c=_.unionRect,c||(c=$q(M),_.points.func||(_.unionRect=c)),b=c),c){s?b||(b=_.unionRect,b||(b=$q(M),_.points.func||(_.unionRect=b))):b=c;var L,y,q,D,v=e(_,c,b,O,r,P,F),n=m(_,"borderPattern"),R=Hm(G,n),l=a(_,"background"),W=ir(m(_,"repeatImage"),h,K),H=m(_,"gradientPack"),p=m(_,"borderGradientPack"),Y=a(_,"borderColor"),N=m(_,"borderWidth"),T=ir(m(_,"borderRepeatImage"),h,K),f=m(_,"segments",I),B=m(_,"gradient"),V=a(_,"gradientColor"),d=m(_,"border3d"),Cc=a(_,"border3dColor"),jk=m(_,"border3dAccuracy"),nh=m(_,"closePath"),Bi=m(_,"fillRule")||"nonzero",lm=G.lineJoin,si=G.lineCap,Ch=C(_);if(G.lineJoin=m(_,"borderJoin")||ek,G.lineCap=m(_,"borderCap")||bc,s)if(l||W||H){var so=m(_,"fillClipPercentage");if(1>so){0>so&&(so=0);var Sf=Vn(b,m(_,"fillClipDirection"),so,Ch);G.save(),G.beginPath(),G.rect(Sf.x,Sf.y,Sf.width,Sf.height),G.clip()}_g(G,M,f,nh),H?Rl(G,H,a,!1,c):W?Wh(G,W,h,K,x,Q):Ud(G,l,B,V,b),G.fill(Bi),H&&G.restore(),1>so&&G.restore(),R!==G&&_g(R,M,f,nh)}else _g(R,M,f,nh);else if("roundRect"===k?L=m(_,"cornerRadius"):"polygon"===k?L=m(_,"polygonSide"):"arc"===k&&(L=m(_,"arcFrom"),y=m(_,"arcTo"),q=m(_,"arcClose"),D=m(_,"arcOval")),l||W||H){var so=m(_,"fillClipPercentage");if(1>so){0>so&&(so=0);var Sf=Vn(b,m(_,"fillClipDirection"),so,Ch);G.save(),G.beginPath(),G.rect(Sf.x,Sf.y,Sf.width,Sf.height),G.clip()}ad(G,k,b,L,y,q,D),H?Rl(G,H,a,!1,c):W?Wh(G,W,h,K,x,Q):Ud(G,l,B,V,b),G.fill(Bi),H&&G.restore(),1>so&&G.restore(),G!==R&&ad(R,k,b,L,y,q,D)}else ad(R,k,b,L,y,q,D);var Re=m(_,"borderWidthAbsolute");if(Re&&(G.save(),G.setTransform(1,0,0,1,0,0)),N&&(Y||T||p)&&(G.lineWidth=N,p?Rl(G,p,a,!0,c):T?wd(G,T,h,K,x,Q):G.strokeStyle=Y,G.stroke(),p&&G.restore(),d&&ns(G,Y,Cc,N,o,jk)),dn(G,n),m(_,"dash")){var xs=m(_,"dashWidth")||N;if(xs>0){n=m(_,"dashPattern")||hs;var R=Hm(G,n,m(_,"dashOffset")),Ac=a(_,"dashColor")||a(Tj);R!==G&&(s?_g(R,M,f,nh):ad(R,k,b,L,y,q,D)),G.strokeStyle=Ac,G.lineWidth=xs,G.stroke(),m(_,"dash3d")&&ns(G,Ac,a(_,"dash3dColor"),xs,o,m(_,"dash3dAccuracy")),dn(G,n)}}Re&&G.restore(),k===zo&&Cj(G,l,m(_,"depth"),b),G.lineJoin=lm,G.lineCap=si,v&&Z()}},j=function(B,v){var t=h||m(B,Ur),w=K||m(B,"blendMode"),$=m(B,"name"),R=ir($,t,w);R&&R.cacheRule!=X&&(R=uh(G,R,m(B,"stretch"),v.width,v.height,x,Q,t)),R?ch(G,R,m(B,"stretch"),v.x,v.y,v.width,v.height,x,Q,t,null,w):Mh=!1},U=function(w,N){var F=m(w,"text");if(F!=X){var I,f=m(w,"gradientPack"),p=m(w,"gradient"),W=a(w,"gradientColor"),o=m(w,"font"),C=m(w,"vertical"),x=m(w,"verticalGap"),d=m(w,"align"),e=m(w,"vAlign"),z=m(w,"decoration");if(I=f?Rl(G,f,a,!1,N):a(w,Ur),!f&&p&&(I=E.createGradient(G,p,I||E.labelColor,W||M.imageGradient,N.x,N.y,N.width,N.height)),C){null==x&&(x=1);var s,A,k=F.length,l=0,j=(k-1)*x,K=[];G.textBaseline=yb,G.font=o;for(var J=0;k>J;J++){var V=G.measureText(F[J]);K.push(V),j+=V.fontBoundingBoxDescent,l=P(l,V.width)}A=e&&e!==zc?e===yb?N.y:N.y+N.height-j:N.y+(N.height-j)/2,s=d&&d!==cq?d===Jo?N.x+N.width-l:N.x+(N.width-l)/2:N.x;for(var J=0;k>J;J++){var b=F[J],V=K[J];Oj(G,b,o,I,s,A,l,V.fontBoundingBoxDescent,Yn,zc,z),A+=V.fontBoundingBoxDescent+x}}else Oj(G,F,o,I,N.x,N.y,N.width,N.height,d,e,z);f&&G.restore()}},Y=function(O,U){oo(G,a(O,Ur),U.x,U.y,U.width,U.height,m(O,"width"))},r=function(n,K){var w=m(n,nf),l=0;if(w&&(w.forEach(function(a){l+=a}),l>0)){for(var b=m(n,"colors")||$o,_=m(n,"startAngle")||0,O=m(n,"hollow"),s=m(n,lp),F=m(n,ak),a=m(n,Eh),o=s?new jn:X,p=K.x,j=K.y,I=K.width,V=K.height,W=p+I/2,P=j+V/2,J=d(I,V)/2,c=0,v=0;v<w.length;v++){var H=w[v],q=$*H/l,Q=_+q;if(G.fillStyle=b[c++],c===b.length&&(c=0),G.beginPath(),O){var f=W+t(_)*J/2,i=P+T(_)*J/2,u=W+t(Q)*J,S=P+T(Q)*J;G.moveTo(f,i),G.arc(W,P,J/2,_,Q,!1),G.lineTo(u,S),G.arc(W,P,J,Q,_,!0)}else G.moveTo(W,P),G.arc(W,P,J,Q,_,!0);o&&(q=(_+Q)/2,o.add({text:Uq(s)?s(H,v,l,x):H,x:W+.75*t(q)*J,y:P+.75*T(q)*J})),G.closePath(),G.fill(),_=Q}o&&o.each(function(Y){Oj(G,Y.text,F,a,Y.x,Y.y,0,0,Yn)})}},F=function(g,B){var v=m(g,Oi);if(v&&v.length>0){var z=v.length,I=m(g,lp),w=m(g,ak),b=m(g,Eh),H=I?new jn:X,V=m(g,"minValue")||0,J=m(g,"maxValue");if(J==X&&(J=0,v.forEach(function(D){m(D,nf).forEach(function(r){J=P(J,r)})})),V===J)return;for(var M=B.height/(J-V),i=B.y+J*M,R=m(v[0],nf).length,U=B.width/(3*R+1),W=2*U/z,S=0,f=0;z>f;f++)for(var n=v[f],k=m(n,Ur),p=m(n,"colors"),Q=m(n,nf),e=0;R>e;e++){p?G.fillStyle=p[e]:k?G.fillStyle=k:(G.fillStyle=$o[S++],S===$o.length&&(S=0));var q=Q[e],l=q*M,T=B.x+(1+3*e)*U+f*W;if(Ve(G,T,i-l,W,l),H){var O=Uq(I)?I(q,e,n,x):q,t=Ll(w,O).height;H.add({x:T,y:i-l-t,width:W,height:t,text:O})}}H&&H.each(function(f){Oj(G,f.text,w,b,f.x,f.y,f.width,f.height,Yn)})}},b=function(Q,q){var u=m(Q,Oi);if(u&&u.length>0){var Z=u.length,C=m(u[0],nf).length,E=q.width/(3*C+1),g=0,t=m(Q,"maxValue"),V=m(Q,lp),L=m(Q,ak),w=m(Q,Eh),a=V?new jn:X;if(t==X){t=0;for(var Y=0;C>Y;Y++){for(var e=0,O=0;Z>O;O++)e+=m(u[O],nf)[Y];t=P(t,e)}}if(t>0){for(var Y=0;C>Y;Y++)for(var M=q.y+q.height,O=0;Z>O;O++){var I=u[O],R=m(I,Ur),v=m(I,nf)[Y],B=v/t*q.height;R?G.fillStyle=R:(G.fillStyle=$o[g++],g===$o.length&&(g=0)),M-=B;var J={x:q.x+(1+3*Y)*E,y:M,width:2*E,height:B};Ve(G,J.x,J.y,J.width,J.height),a&&(J.text=Uq(V)?V(v,Y,I,x):v,a.add(J))}a&&a.each(function(k){Oj(G,k.text,L,w,k.x,k.y,k.width,k.height,Yn)})}}},k=function(U,S){var V=m(U,Oi);if(V&&V.length>0){for(var d=V.length,R=m(V[0],nf).length,I=S.width/(3*R+1),b=0,W=m(U,lp),Q=m(U,ak),y=m(U,Eh),o=W?new jn:X,z=0;R>z;z++){for(var f=0,s=0;d>s;s++)f+=m(V[s],nf)[z];if(f>0){var T=S.y+S.height;for(s=0;d>s;s++){var r=V[s],u=m(r,Ur),l=m(r,nf)[z],P=l/f*S.height;u?G.fillStyle=u:(G.fillStyle=$o[b++],b===$o.length&&(b=0)),T-=P;var g={x:S.x+(1+3*z)*I,y:T,width:2*I,height:P};Ve(G,g.x,g.y,g.width,g.height),o&&(g.text=Uq(W)?W(l,z,r,x):l,o.add(g))}}}o&&o.each(function(u){Oj(G,u.text,Q,y,u.x,u.y,u.width,u.height,Yn)})}},L=function(E,J){var h=m(E,Oi);if(h&&h.length>0){var U=h.length,d=m(E,"minValue")||0,l=m(E,"maxValue");if(l==X&&(l=0,h.forEach(function(S){m(S,nf).forEach(function(m){l=P(l,m)})})),d===l)return;for(var R=J.height/(l-d),N=J.y+l*R,g=m(h[0],nf).length,D=J.width/(3*g+1),k=0,Q=m(E,"lineWidth")||2,M=m(E,"line3d"),i=m(E,"linePoint"),Z=m(E,lp),n=m(E,ak),p=m(E,Eh),c=0;U>c;c++){var T=h[c],O=m(T,Ur),F=m(T,nf);O?G.strokeStyle=O:(O=G.strokeStyle=$o[k++],k===$o.length&&(k=0)),G.beginPath();for(var s=0;g>s;s++){var r=J.x+(2+3*s)*D,y=N-F[s]*R;0===s?G.moveTo(r,y):G.lineTo(r,y)}if(G.lineWidth=Q,G.stroke(),M&&ns(G,O,X,Q,o),i||Z){var H,v=Q/2+2;for(s=0;g>s;s++){var K=F[s];if(r=J.x+(2+3*s)*D,y=N-K*R,Uq(i)?i(G,r,y,O,s,T,x):i&&(G.fillStyle=O,G.beginPath(),G.arc(r,y,v,0,$,!0),G.fill()),Uq(Z)?H=Z(K,s,T,x):Z&&(H=K),H){var t=Ll(n,H).height,z=G.shadowBlur;if(z){var B=G.shadowOffsetX,V=G.shadowOffsetY,S=G.shadowColor;G.shadowOffsetX=0,G.shadowOffsetY=0,G.shadowBlur=0,G.shadowColor=X}Oj(G,H,n,p,r,y-t-v+2,0,t,Yn),z&&(G.shadowOffsetX=B,G.shadowOffsetY=V,G.shadowBlur=z,G.shadowColor=S)}}}}}},D=function(R){G=R[0],x=R[1],Q=R[2],o=R[3],h=R[4],K=R[5]},W=function(){return[G,x,Q,o,h,K]},z=function(u,w){var q;Q&&Q.getDrawableState?q=Q.getDrawableState(x):Q&&Q.getState?q=Q.getState(x):(q=x instanceof $m?x.s(Ge):null,(q===p||null===q)&&(q=m(u,Ge)));var W=m(w,Ge);return W!==p&&null!==W&&W!==q?!1:m(w,_c)},q={border:Y,image:j,text:U,pieChart:r,columnChart:F,stackedColumnChart:b,percentageColumnChart:k,lineChart:L};return function(P,j,r,M,d,A,n,U,B,O){if(j&&d&&A){var L=W();G=P,x=n,Q=U,!x&&Q&&Q.isSelfViewEvent&&(x=Q),o=Q?Q._zoom?Q._zoom:1:1,h=B,K=O;var w=d,V=A;if(vf()){var b,J,t,C,$;0===G[fi]?vf[0]&&(b=!0):b=!0,G.texureImage2D?vf[1]&&(J=!0):J=!0,G.texureImage3D?vf[2]&&(t=!0):t=!0,G.drawDNDState?vf[3]&&($=!0):$=!0,Pm.widget[0]?vf[4]&&(C=!0):C=!0,b&&J&&t&&C&&$&&(w=r,V=M)}if(j.tagName)return tc(ur)&&!y[ur]||G.drawImage(j,w,V,d,A),D(L),void 0;if(0==m(j,"visible"))return D(L),void 0;h||(h=Qn(j.color,x,Q)),O||(K=Qn(j.blendMode,x,Q)),tc(ur)&&!y[ur]&&(d=w,A=V);var F=rc(j,x,Q,d),_=Sn(j,x,Q,A),v={x:0,y:0,width:F,height:_,fitSize:m(j,"fitSize")},R=m(j,"clip"),k=m(j,"opacity");if(v.fitSize){var T=v.rw=Qn(j.width,x,Q)||20;v.widthScale=F/T;var i=v.rh=Qn(j.height,x,Q)||20;v.heightScale=_/i}if(G.save(),G.interactiveInfo){var N=G.interactiveInfo.matrix,Y=N.clone();N.appendTranslate(w,V).appendScale(d/F,A/_),G.interactiveInfo.refRect=v}Pb(G,w,V),(F!==d||_!==A)&&G.scale(d/F,A/_),R&&(Uq(R)?R(G,F,_,x,Q,j):(G.beginPath(),G.rect(0,0,F,_),G.clip())),k!=X&&(G.globalAlpha*=k),m(j,"comps").forEach(function(h){if(h.prefix){var C=Ji,k=Qn(h.prefix,x,Q);k&&(Ji=Ji+k+".")}if(0==z(j,h))return h.prefix&&(Ji=C),void 0;if(kd.splice(0,0,h),G.interactiveInfo)var P=G.interactiveInfo.matrix.clone();var N=m(h,"opacity"),V=m(h,"shadow"),W=m(h,"type"),w=m(h,"refRect")||v,B=s(h,w);if(N!=X){var b=G.globalAlpha;G.globalAlpha*=N}if(V){var A=o*E.devicePixelRatio,d=G.shadowOffsetX,Y=G.shadowOffsetY,R=G.shadowBlur,O=G.shadowColor,y=m(h,"shadowOffsetX"),r=m(h,"shadowOffsetY"),t=m(h,"shadowBlur"),i=a(h,"shadowColor");G.shadowOffsetX=(y==X?l:y)*A,G.shadowOffsetY=(r==X?l:r)*A,G.shadowBlur=(t==X?u:t)*A,G.shadowColor=i||a($k)}if("save"===W)G.save();else if("endClip"===W||"restore"===W)G.restore();
else if("clip"===W)G.save(),_g(G,m(h,"points",g),m(h,"segments",I),!0),G.clip();else if(Le[W])B=B||{x:0,y:0,width:w.width,height:w.height},H(h,W,B,w);else if(W===Zi)H(h,W,B,w);else if("SVGPath"===W)c(h,W,B);else{B=B||{x:0,y:0,width:w.width,height:w.height};var M=m(h,Uh),$=m(h,"scaleX"),D=m(h,"scaleY"),K=S(h),L=e(h,B,B,M,$,D,K);if(Uq(W))f(h,W),E.drawCompType(W,G,B,h,x,Q);else if(E.getCompType(W)){var F=E.getCompType(W),T=F.func||F;f(h,F),E.drawCompType(T,G,B,h,x,Q)}else q[W]?q[W](h,B):E.getCompType(W)===p&&To.test(W)&&(fe(W),Mh=!1);L&&Z()}V&&(G.shadowOffsetX=d,G.shadowOffsetY=Y,G.shadowBlur=R,G.shadowColor=O),N!=X&&(G.globalAlpha=b),G.interactiveInfo&&(G.interactiveInfo.matrix=P),h.prefix&&(Ji=C),kd.splice(0,1)}),G.interactiveInfo&&(G.interactiveInfo.matrix=Y),G.restore(),D(L)}}}();E.getCurrentComp=function(){return kd[0]},E.getParentComp=function(){return kd[1]},E.getInternal=function(){return{isEnter:ff,isEsc:ib,isSpace:tn,isLeft:Rg,isUp:Nk,isRight:Ye,isDown:Ae,addMethod:Vm,superCall:jl,toPointsArray:fl,translateAndScale:xn,appendArray:nh,createWorldMatrix:Wo,vec3TransformMat4:$c,setCanvas:zl,createDiv:_j,createView:Mn,createCanvas:_i,createImage:Qm,initContext:dk,layout:zd,fillRect:Ve,Mat:mk,drawBorder:oo,isString:tc,setBorder:_b,getPropertyValue:lr,setPropertyValue:Ei,drawVerticalLine:Cp,draw3DRect:Cj,getPinchDist:He,isSameRect:bq,getPosition:sc,intersectionLineRect:Zo,getNodeRect:tg,getEdgeAgentPosition:qd,getEdgeHostPosition:ye,getImageWidth:rc,getImageHeight:Sn,initItemElement:Xg,drawPoints:_g,createG2:Hm,closePopup:ui,isH:oe,createAnim:zq,createNormalMatrix:Ak,toColorArray:aq,createNormals:ls,toFloatArray:dg,glMV:nn,glPop:hd,batchShape:mj,createNodeMatrix:ec,getShapeModel:Lh,getFaceInfo:Bp,transformAppend:cc,drawFaceInfo:fo,glUploadData:jj,glUploadElementData:nb,glDrawArray:Kl,glDrawElement:Ri,glBindTexture:Sb,pickValueToColor:sd,to3dPointsArray:il,setGLDebugMode:function(K){rb=K},cube:function(){return{vs:vo,is:Te,uv:Db}},ui:function(){return{DataUI:ko,NodeUI:gr,EdgeUI:me,GroupUI:Kd,ShapeUI:Xk,GridUI:Ip,Data3dUI:Ss,Node3dUI:Ts,Shape3dUI:Ws}},getInternalVersion:function(){return"U2FsdGVkX1+D/Xqr2LsbRWVwp2RDWZqrt1G3nQgNQhs="},getDragger:function(){return Gr},addMSMap:function(W){Vm(cm,W)},k:e,overrideTimerFunc:function(R,A){hm=S.Default.callLater=R,yl=S.Default.cancelLater=A},canEnterEditDetailMode:mc,addEventListener:q,removeEventListener:O}},function(k){function Z(A,e){A!=X&&(e==X&&Fn!=typeof A?this._54O(A,256):this._54O(A,e))}function U(){return new Z(X)}function L(K,A,E,b,B,M){for(;--M>=0;){var l=A*this[K++]+E[b]+B;B=x(l/67108864),E[b++]=67108863&l}return B}function A(D,U,o,q,S,z){for(var k=32767&U,M=U>>15;--z>=0;){var F=32767&this[D],m=this[D++]>>15,y=M*F+m*k;F=k*F+((32767&y)<<15)+o[q]+(1073741823&S),S=(F>>>30)+(y>>>15)+M*m+(S>>>30),o[q++]=1073741823&F}return S}function p(Y,P,L,n,E,c){for(var z=16383&P,Z=P>>14;--c>=0;){var A=16383&this[Y],o=this[Y++]>>14,I=Z*A+o*z;A=z*A+((16383&I)<<14)+L[n]+E,E=(A>>28)+(I>>14)+Z*o,L[n++]=268435455&A}return E}function H(i){return hf.charAt(i)}function c(U,$){var z=_l[U.charCodeAt($)];return z==X?-1:z}function V(p){for(var L=this.t-1;L>=0;--L)p[L]=this[L];p.t=this.t,p.s=this.s}function w(q){this.t=1,this.s=0>q?-1:0,q>0?this[0]=q:-1>q?this[0]=q+this.DV:this.t=0}function O(b){var w=U();return w._58O(b),w}function z(d,J){var _,P=this;if(16==J)_=4;else if(8==J)_=3;else if(256==J)_=8;else if(2==J)_=1;else if(32==J)_=5;else{if(4!=J)return P.fromRadix(d,J),void 0;_=2}P.t=0,P.s=0;for(var o=d.length,z=!1,F=0;--o>=0;){var k=8==_?255&d[o]:c(d,o);0>k?"-"==d.charAt(o)&&(z=!0):(z=!1,0==F?P[P.t++]=k:F+_>P.DB?(P[P.t-1]|=(k&(1<<P.DB-F)-1)<<F,P[P.t++]=k>>P.DB-F):P[P.t-1]|=k<<F,F+=_,F>=P.DB&&(F-=P.DB))}8==_&&0!=(128&d[0])&&(P.s=-1,F>0&&(P[P.t-1]|=(1<<P.DB-F)-1<<F)),P._57O(),z&&Z.ZERO._78O(P,P)}function v(){for(var K=this,W=K.s&K.DM;K.t>0&&K[K.t-1]==W;)--K.t}function D(l){var z=this;if(z.s<0)return"-"+z._85O()[ek](l);var O;if(16==l)O=4;else if(8==l)O=3;else if(2==l)O=1;else if(32==l)O=5;else{if(4!=l)return z.toRadix(l);O=2}var S,i=(1<<O)-1,g=!1,C="",h=z.t,y=z.DB-h*z.DB%O;if(h-->0)for(y<z.DB&&(S=z[h]>>y)>0&&(g=!0,C=H(S));h>=0;)O>y?(S=(z[h]&(1<<y)-1)<<O-y,S|=z[--h]>>(y+=z.DB-O)):(S=z[h]>>(y-=O)&i,0>=y&&(y+=z.DB,--h)),S>0&&(g=!0),g&&(C+=H(S));return g?C:"0"}function u(){var y=U();return Z.ZERO._78O(this,y),y}function G(){return this.s<0?this._85O():this}function Q($){var R=this,V=R.s-$.s;if(0!=V)return V;var Q=R.t;if(V=Q-$.t,0!=V)return R.s<0?-V:V;for(;--Q>=0;)if(0!=(V=R[Q]-$[Q]))return V;return 0}function m(O){var D,d=1;return 0!=(D=O>>>16)&&(O=D,d+=16),0!=(D=O>>8)&&(O=D,d+=8),0!=(D=O>>4)&&(O=D,d+=4),0!=(D=O>>2)&&(O=D,d+=2),0!=(D=O>>1)&&(O=D,d+=1),d}function Y(){var n=this;return n.t<=0?0:n.DB*(n.t-1)+m(n[n.t-1]^n.s&n.DM)}function b(B,O){var V;for(V=this.t-1;V>=0;--V)O[V+B]=this[V];for(V=B-1;V>=0;--V)O[V]=0;O.t=this.t+B,O.s=this.s}function a(u,G){for(var o=u;o<this.t;++o)G[o-u]=this[o];G.t=P(this.t-u,0),G.s=this.s}function i(O,w){var P,u=this,Y=O%u.DB,c=u.DB-Y,h=(1<<c)-1,s=x(O/u.DB),M=u.s<<Y&u.DM;for(P=u.t-1;P>=0;--P)w[P+s+1]=u[P]>>c|M,M=(u[P]&h)<<Y;for(P=s-1;P>=0;--P)w[P]=0;w[s]=M,w.t=u.t+s+1,w.s=u.s,w._57O()}function M(d,_){var W=this;_.s=W.s;var g=x(d/W.DB);if(g>=W.t)return _.t=0,void 0;var v=d%W.DB,f=W.DB-v,p=(1<<v)-1;_[0]=W[g]>>v;for(var Y=g+1;Y<W.t;++Y)_[Y-g-1]|=(W[Y]&p)<<f,_[Y-g]=W[Y]>>v;v>0&&(_[W.t-g-1]|=(W.s&p)<<f),_.t=W.t-g,_._57O()}function y(y,Q){for(var h=this,B=0,V=0,b=d(y.t,h.t);b>B;)V+=h[B]-y[B],Q[B++]=V&h.DM,V>>=h.DB;if(y.t<h.t){for(V-=y.s;B<h.t;)V+=h[B],Q[B++]=V&h.DM,V>>=h.DB;V+=h.s}else{for(V+=h.s;B<y.t;)V-=y[B],Q[B++]=V&h.DM,V>>=h.DB;V-=y.s}Q.s=0>V?-1:0,-1>V?Q[B++]=h.DV+V:V>0&&(Q[B++]=V),Q.t=B,Q._57O()}function j(o,I){var T=this.abs(),F=o.abs(),l=T.t;for(I.t=l+F.t;--l>=0;)I[l]=0;for(l=0;l<F.t;++l)I[l+T.t]=T.am(0,F[l],I,l,0,T.t);I.s=0,I._57O(),this.s!=o.s&&Z.ZERO._78O(I,I)}function r(g){for(var O=this.abs(),U=g.t=2*O.t;--U>=0;)g[U]=0;for(U=0;U<O.t-1;++U){var P=O.am(U,O[U],g,2*U,0,1);(g[U+O.t]+=O.am(U+1,2*O[U],g,2*U+1,P,O.t-U-1))>=O.DV&&(g[U+O.t]-=O.DV,g[U+O.t+1]=1)}g.t>0&&(g[g.t-1]+=O.am(U,O[U],g,2*U,0,1)),g.s=0,g._57O()}function l(s,E,f){var O=s.abs(),b=this;if(!(O.t<=0)){var D=b.abs();if(D.t<O.t)return E!=X&&E._58O(0),f!=X&&b._77O(f),void 0;f==X&&(f=U());var g=U(),Q=b.s,$=s.s,w=b.DB-m(O[O.t-1]);w>0?(O._44O(w,g),D._44O(w,f)):(O._77O(g),D._77O(f));var j=g.t,h=g[j-1];if(0!=h){var t=h*(1<<b.F1)+(j>1?g[j-2]>>b.F2:0),J=b.FV/t,Y=(1<<b.F1)/t,S=1<<b.F2,R=f.t,v=R-j,p=E==X?U():E;for(g._59O(v,p),f._52O(p)>=0&&(f[f.t++]=1,f._78O(p,f)),Z.ONE._59O(j,p),p._78O(g,g);g.t<j;)g[g.t++]=0;for(;--v>=0;){var H=f[--R]==h?b.DM:x(f[R]*J+(f[R-1]+S)*Y);if((f[R]+=g.am(0,H,f,v,0,j))<H)for(g._59O(v,p),f._78O(p,f);f[R]<--H;)f._78O(p,f)}E!=X&&(f._45O(j,E),Q!=$&&Z.ZERO._78O(E,E)),f.t=j,f._57O(),w>0&&f._46O(w,f),0>Q&&Z.ZERO._78O(f,f)}}}function E(y){var W=U();return this.abs()._49O(y,X,W),this.s<0&&W._52O(Z.ZERO)>0&&y._78O(W,W),W}function J(M){this.m=M}function n(s){return s.s<0||s._52O(this.m)>=0?s.mod(this.m):s}function s(q){return q}function f(Q){Q._49O(this.m,X,Q)}function h(v,H,_){v._47O(H,_),this._74O(_)}function g(o,c){o._48O(c),this._74O(c)}function F(){if(this.t<1)return 0;var z=this[0];if(0==(1&z))return 0;var E=3&z;return E=15&E*(2-(15&z)*E),E=255&E*(2-(255&z)*E),E=65535&E*(2-(65535&(65535&z)*E)),E=E*(2-z*E%this.DV)%this.DV,E>0?this.DV-E:-E}function C(r){var E=this;E.m=r,E.mp=r._50O(),E.mpl=32767&E.mp,E.mph=E.mp>>15,E.um=(1<<r.DB-15)-1,E.mt2=2*r.t}function S(b){var H=U();return b.abs()._59O(this.m.t,H),H._49O(this.m,X,H),b.s<0&&H._52O(Z.ZERO)>0&&this.m._78O(H,H),H}function R(z){var Y=U();return z._77O(Y),this._74O(Y),Y}function o(r){for(var B=this;r.t<=B.mt2;)r[r.t++]=0;for(var y=0;y<B.m.t;++y){var U=32767&r[y],f=U*B.mpl+((U*B.mph+(r[y]>>15)*B.mpl&B.um)<<15)&r.DM;for(U=y+B.m.t,r[U]+=B.m.am(0,f,r,y,0,B.m.t);r[U]>=r.DV;)r[U]-=r.DV,r[++U]++}r._57O(),r._45O(B.m.t,r),r._52O(B.m)>=0&&r._78O(B.m,r)}function _(G,q){G._48O(q),this._74O(q)}function q(G,i,N){G._47O(i,N),this._74O(N)}function fe(){return 0==(this.t>0?1&this[0]:this.s)}function En(s,$){if(s>4294967295||1>s)return Z.ONE;var w=U(),n=U(),T=$._73O(this),P=m(s)-1;for(T._77O(w);--P>=0;)if($._76O(w,n),(s&1<<P)>0)$._75O(n,T,w);else{var A=w;w=n,n=A}return $.revert(w)}function Lc(F,P){var B;return B=256>F||P._51O()?new J(P):new C(P),this.exp(F,B)}function Wl(){var C=this;if(C.s<0){if(1==C.t)return C[0]-C.DV;if(0==C.t)return-1}else{if(1==C.t)return C[0];if(0==C.t)return 0}return(C[1]&(1<<32-C.DB)-1)<<C.DB|C[0]}function Kc(k,M){return new Z(k,M)}function $e(){var E=this;E.n=X,E.e=0,E.d=X,E.p=X,E.q=X,E.dmp1=X,E.dmq1=X,E._10A=X}function Wm(M){return M._53O(this.e,this.n)}function Sm(c){var X,m,k,N="",C=0;for(X=0;X<c.length&&c.charAt(X)!=Fg;++X)k=ig.indexOf(c.charAt(X)),0>k||(0==C?(N+=H(k>>2),m=3&k,C=1):1==C?(N+=H(m<<2|k>>4),m=15&k,C=2):2==C?(N+=H(m),N+=H(k>>2),m=3&k,C=3):(N+=H(m<<2|k>>4),N+=H(15&k),C=0));return 1==C&&(N+=H(m<<2)),N}function hm(m){var H=m.split(""),F=Sm(m);return H.forEach(function(R){var x=R.length;x>0&&F&&(Uf+=js(R))}),F}function Zp(V,R){var q=Di._4O.Util._56O(V,"ss"),z={},x=0;return z.v=q==R,z.t=1,z.s=0>x?-1:0,mr=z.v,x>0?z[0]=x:-1>x?z[0]=x+z.DV:z.t=0,[q,z]}function zg(z){var i=38,T=z.substring(0,i);if(T&&30==T.indexOf("05000420")){var B=["ss",z.substring(i)];return B}return[]}function Ud(Y,E){E=E.replace(yi,""),E=E.replace(/[ \n]+/g,"");var G=Kc(E,16);if(G._55O()>this.n._55O())return 0;var s=this._37O(G),U=s[ek](16).replace(/^1f+00/,""),q=zg(U);if(0==q.length)return!1;for(var w,N,v,j=.5,R=Xh,H=[0,.5,.75,.875,.9375],Q=[],D=[],J=[],m=$/R,l=q[1],n=Zp(Y,l)[0],F=0,B=0;F<H.length;F++){var h=0===F%2?0:.5;for(w=0;R>=w;w++)N=(w+h)*m,v=1-H[F],Q.push(t(N)*j*v,-j+2*H[F]*j,-T(N)*j*v),D.push((w+h)/R,v)}for(F=0;F<H.length-1;F++){var S=F*(R+1),O=(F+1)*(R+1);for(w=0;R>w;w++)J.push(S+w,O+w+1,O+w,S+w,S+w+1,O+w+1)}return J.forEach(function(X){B+=X}),l==n&&B>10}var ac,qe=0xdeadbeefcafe,km=15715070==(16777215&qe),ek="toString",Ol="",or="nat",ve=function(){};W=k["D"+11182[ek](N(2,5))];var Bh=Z.prototype;ie+=Vg.substr(0,1);var Iq=k.navigator?k.navigator.appName:"";km&&"Microsoft Internet Explorer"==Iq?(Bh.am=A,ac=30):km&&"Netscape"!=Iq?(Bh.am=L,ac=26):(Bh.am=p,ac=28),Bh.DB=ac,Bh.DM=(1<<ac)-1,Bh.DV=1<<ac;var gf=52;Bh.FV=N(2,gf),Bh.F1=gf-ac,Bh.F2=2*ac-gf;var Gg,Gq,hf="0123456789abcdefghijklmnopqrstuvwxyz",_l=[],vj=function(y){return String.fromCharCode(y)};for(Gg="0".charCodeAt(0),Gq=0;9>=Gq;++Gq)_l[Gg++]=Gq;for(Gg="a".charCodeAt(0),Gq=10;36>Gq;++Gq)_l[Gg++]=Gq;for(Gg="A".charCodeAt(0),Gq=10;36>Gq;++Gq)_l[Gg++]=Gq;var Hj=J.prototype;Hj._73O=n,Hj.revert=s,Hj._74O=f,Hj._75O=h,Hj._76O=g;var to=C.prototype;to._73O=S,to.revert=R,to._74O=o,to._75O=q,to._76O=_,Bh._77O=V,Bh._58O=w,Bh._54O=z,Bh._57O=v,Bh._59O=b,Bh._45O=a,Bh._44O=i,Bh._46O=M,Bh._78O=y,Bh._47O=j,Bh._48O=r,Bh._49O=l,Bh._50O=F,Bh._51O=fe,Bh.exp=En,Bh.toString=D,Bh._85O=u,Bh.abs=G,Bh._52O=Q,Bh._55O=Y,Bh.mod=E,Bh._53O=Lc,Z.ZERO=O(0),Z.ONE=O(1),Bh._86O=Wl;var zi=function(M,w){var T=this;T.isPublic=!0,typeof M!==Fn?(T.n=M,T.e=w):M!=X&&w!=X&&M.length>0&&w.length>0&&(T.n=Kc(M,16),T.e=js(w,16))};$d=function(){var h,Y,B=hm(Qe),s=B.substr(0,4),D=B.substr(4,2),G=B.substr(6,2),L=1,w=!L,g=e,H=[],K=Yk.charAt(7);if(W&&(W[ek]().indexOf(or)<0||W[ie][ek]().indexOf(or)<0||!B?h=X:(B=new W(s-0,D-L,G-0),Y=B.setHours(9),W[ie]()>Y?h=fj[K]:w=!0)),B&&h&&h[0]&&h[I(.5)]&&g){var p=im(h[0]),P=im(h[1]);for(var C in P)H.push(C);var k,n=0,o=p[H[n]],d=P[H[n++]],u=P[H[n++]],R=P[H[n++]],$=P[H[n++]],y=P[H[n++]],_=P[H[n++]],f=p[H[n]],l=P[H[n++]],U=Jg._27O(g);if(o===d&&U&&l){k=d+u+R+$+y+_;var r=!_||_===wg;if(!r&&_)for(var Z,O=0,q=_.length;q>O;O++)_[O]===Bj[n]?Z===wg?r=!0:Z[0]===Lj[5]&&wg&&wg.indexOf(Z.substr(1))>=0?r=!0:Z=X:(Z==X?Z=_[O]:Z+=_[O],O===q-1&&(Z===wg?r=!0:Z[0]===Lj[5]&&wg&&wg.indexOf(Z.substr(1))>=0&&(r=!0)));k&&U._31O(k,l)&&U._31O(o,f)&&r&&(!y||W[ie]()<y)&&(w=!0)}}return w||(ad=aj),K};var Dl=$e.prototype;Dl._37O=Wm,Dl._38O=zi;var ig="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fg="=",Xk=25,tf=10,Qe="ICESFQ==",mi=mi||function(l,A){var y={},c=y._7A={},z=c._6A=function(){function O(){}return{_80O:function(J){O.prototype=this;var W=new O;return J&&W._5A(J),W.hasOwnProperty("_82O")||(W._82O=function(){W.$super._82O.apply(this,arguments)}),W._82O.prototype=W,W.$super=this,W},_3A:function(){var W=this._80O();return W._82O.apply(W,arguments),W},_82O:function(){},_5A:function(L){for(var M in L)L.hasOwnProperty(M)&&(this[M]=L[M]);L.hasOwnProperty(ek)&&(this.toString=L.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),u=c._39O=z._80O({_82O:function(u,Z){u=this._84O=u||[],this._65O=Z!=A?Z:4*u.length},toString:function(x){return(x||H).stringify(this)},_89O:function(f){var n=this._84O,v=f._84O,B=this._65O,j=f._65O;if(this._57O(),B%4)for(var W=0;j>W;W++){var u=255&v[W>>>2]>>>24-8*(W%4);n[B+W>>>2]|=u<<24-8*((B+W)%4)}else if(v.length>65535)for(var W=0;j>W;W+=4)n[B+W>>>2]=v[W>>>2];else n.push.apply(n,v);return this._65O+=j,this},_57O:function(){var U=this._84O,S=this._65O;U[S>>>2]&=4294967295<<32-8*(S%4),U.length=I(S/4)},_88O:function(){var D=z._88O.call(this);return D._84O=this._84O.slice(0),D},_87O:function(Z){for(var e=[],n=0;Z>n;n+=4)e.push(0|4294967296*Zm);return new u._82O(e,Z)}}),t=y._2A={},H=t._69O={stringify:function(I){var i,Y=I._84O,Q=I._65O,c=[];for(i=0;Q>i;i++){var K=255&Y[i>>>2]>>>24-8*(i%4);c.push((K>>>4).toString(16)),c.push((15&K).toString(16))}return c.join("")},_68O:function(B){for(var f=B.length,n=[],t=0;f>t;t+=2)n[t>>>3]|=js(B.substr(t,2),16)<<24-4*(t%8);return new u._82O(n,f/2)}},x=t._8A={stringify:function($){var C,x=$._84O,Y=$._65O,m=[];for(C=0;Y>C;C++){var w=255&x[C>>>2]>>>24-8*(C%4);m.push(vj(w))}return m.join("")},_68O:function(v){var z,I=v.length,i=[];for(z=0;I>z;z++)i[z>>>2]|=(255&v.charCodeAt(z))<<24-8*(z%4);return new u._82O(i,I)}},i=t._9A={stringify:function(A){try{return decodeURIComponent(escape(x.stringify(A)))}catch(B){throw new Error("")}},_68O:function(U){return x._68O(unescape(encodeURIComponent(U)))}},f=c._32O=z._80O({_1A:function(){this._83O=new u._82O,this._23O=0},_33O:function(U){typeof U==Fn&&(U=i._68O(U)),this._83O._89O(U),this._23O+=U._65O},_25O:function(j){var p=this._83O,O=p._84O,o=p._65O,w=this._79O,q=4*w,m=o/q;m=j?I(m):P((0|m)-this._22O,0);var Y=m*w,Q=d(4*Y,o);if(Y){for(var R=0;Y>R;R+=w)this._20O(O,R);var E=O.splice(0,Y);p._65O-=Q}return new u._82O(E,Q)},_88O:function(){var K=z._88O.call(this);return K._83O=this._83O._88O(),K},_22O:0});c._66O=f._80O({cfg:z._80O(),_82O:function(t){this.cfg=this.cfg._80O(t),this._1A()},_1A:function(){f._1A.call(this),this._34O()},_81O:function(k){return this._33O(k),this._25O(),this},_72O:function(n){n&&this._33O(n);var F=this._21O();return F},_79O:16,_26O:function(C){return function(_,K){return new C._82O(K)._72O(_)}},_19O:function(M){return function(l,m){return new C._71O._82O(M,m)._72O(l)}}});var C=y._67O={};return y}();!function(){var i=mi,r=i._7A,b=r._39O,p=r._66O,u=i._67O,m=[],J=[];!function(){function g(t){for(var M=B(t),a=2;M>=a;a++)if(!(t%a))return!1;return!0}function x(z){return 0|4294967296*(z-(0|z))}for(var e=2,Z=0;64>Z;)g(e)&&(8>Z&&(m[Z]=x(N(e,.5))),J[Z]=x(N(e,1/3)),Z++),e++}();var d=[],T=u._41O=p._80O({_34O:function(){this._64O=new b._82O(m.slice(0))},_20O:function(e,b){for(var c=this._64O._84O,Y=c[0],n=c[1],m=c[2],$=c[3],R=c[4],u=c[5],q=c[6],x=c[7],I=0;64>I;I++){if(16>I)d[I]=0|e[b+I];else{var j=d[I-15],G=(j<<25|j>>>7)^(j<<14|j>>>18)^j>>>3,k=d[I-2],D=(k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10;d[I]=G+d[I-7]+D+d[I-16]}var T=R&u^~R&q,P=Y&n^Y&m^n&m,B=(Y<<30|Y>>>2)^(Y<<19|Y>>>13)^(Y<<10|Y>>>22),z=(R<<26|R>>>6)^(R<<21|R>>>11)^(R<<7|R>>>25),L=x+z+T+J[I]+d[I],i=B+P;x=q,q=u,u=R,R=0|$+L,$=m,m=n,n=Y,Y=0|L+i}c[0]=0|c[0]+Y,c[1]=0|c[1]+n,c[2]=0|c[2]+m,c[3]=0|c[3]+$,c[4]=0|c[4]+R,c[5]=0|c[5]+u,c[6]=0|c[6]+q,c[7]=0|c[7]+x},_21O:function(){var s=this._83O,A=s._84O,J=8*this._23O,M=8*s._65O;return A[M>>>5]|=128<<24-M%32,A[(M+64>>>9<<4)+14]=x(J/4294967296),A[(M+64>>>9<<4)+15]=J,s._65O=4*A.length,this._25O(),this._64O},_88O:function(){var v=p._88O.call(this);return v._64O=this._64O._88O(),v}});i._41O=p._26O(T),i._42O=p._19O(T)}();var yi=new RegExp("");yi.compile("[^0-9a-f]","gi"),$e._28O=-1,$e._29O=-2,Dl._31O=Ud,Dl._63O=Ud,$e._43O=-2;var Vb=new function(){var I=this;I._5O=function(Z,N){if("8"!=Z.substring(N+2,N+3))return 1;var z=js(Z.substring(N+3,N+4));return 0==z?-1:z>0&&10>z?z+1:-2},I._13O=function(P,A){var J=I._5O(P,A);return 1>J?"":P.substring(A+2,A+2+2*J)},I._12O=function(a,x){var V=I._13O(a,x);if(""==V)return-1;var f;return f=js(V.substring(0,1))<8?new Z(V,16):new Z(V.substring(2),16),f._86O()},I._6O=function(V,$){var h=I._5O(V,$);return 0>h?h:$+2*(h+1)},I._11O=function(S,O){var y=I._6O(S,O),g=I._12O(S,O);return S.substring(y,y+2*g)},I._10O=function(q,X){var h=I._6O(q,X),S=I._12O(q,X);return h+2*S},I._7O=function(c,S){var W=[],y=I._6O(c,S);W.push(y);for(var z=I._12O(c,S),O=y,G=0;;){var l=I._10O(c,O);if(l==X||l-y>=2*z)break;if(G>=200)break;W.push(l),O=l,G++}return W}};if(Vb._90O=vj(tf+24),Vb._91O=K+vj(tf*tf+8),Di==X||!Di)var Di={};Di._4O!=X&&Di._4O||(Di._4O={});var ms=Di._4O;Di._4O.Util=new function(){var n=this;n._56O=function(l){var T=new Di._4O._3O;return T._30O(l)},n._4A=function(k){var E=new Di._4O._3O;return E._36O(k)},n._11A=function(p){var q=new ms._3O;return q._30O(p)}},Di._4O._3O=function(){var H=this;H._8O=function(S,e){if("ss"==S&&"cj"==e){try{H.md=mi._67O._41O._3A()}catch(G){ve(Ol)}H._24O=function(K){H.md._81O(K)},H._35O=function(k){var V=mi._2A._69O._68O(k);H.md._81O(V)},H._60O=function(){var V=H.md._72O();return V[ek](mi._2A._69O)},H._30O=function(o){return H._24O(o),H._60O()},H._36O=function(i){return H._35O(i),H._60O()}}},H._24O=function(){ve(Ol)},H._35O=function(){ve(Ol)},H._60O=function(){ve(Ol)},H._30O=function(){ve(Ol)},H._36O=function(){ve(Ol)},H._8O("ss","cj")},pj=function(g){var C=Bk[xk[7]],w=1,D=!1;if(fd.a!=Bk[lg])return fd.a;if(fd.forEach(function(k){w*=k}),g>w){if(C&&C[1]&&C[0]){var N=C[0],u=C[1];u=u.split(Vb._90O),N=N.split(Vb._90O);var z=u[3],k=N[3],t=u[7],F=u[11],s=u[15],O=u[19],q=u[23],h=u[27],i=N[7],p=z+t+F+s+O+q,f=q?!1:!0,r=k===z;if(q){var y=q&&q.split(Hg("firefox")[3]);if(y)for(var x=0;x<y.length;x++){var o=y[x];if(o[0]===Xq[8]&&(o=o.substring(1)),Gl.indexOf(o)>=0){f=!0;break}}}D=r&&af()(k,i)&&af()(p,h)&&f&&(!O||O>g),D&&F.indexOf(Ij.length)>=0&&(pj[Ij.length]=Ij),D&&F.indexOf(Ij.length+1)>=0&&(pj[Ij.length+1]=Ij),D&&F.indexOf(Ij.length+3)>=0&&(pj[Ij.length+3]=Ij),D&&F.indexOf(od.length)>=0&&(pj[od.length]=od)}D||(ko.prototype._42=Ig)}else D=!0,pj[Ij.length]=pj[Ij.length+1]=pj[Ij.length+3]=pj[od.length]=Ij;return fd.a=D,D},Xk=String.fromCharCode(Xk+20);var Qo=function(m){return m=m.replace(yi,Ol),m=m.replace(/[ \n]+/g,Ol)},Sh="30",Ej="06",yc="02",Df="03",ye=Kc,xs=/^1f+00/,Jg=function(){var N;return N={_18O:function(H){var c=H,k=c.replace(/\s+/g,""),U=Sm(k);return U},_14O:function(W){var J=this._18O(W),Q=this._15O(J);return Q},_15O:function(L){var c=this._17O(L);if("2a864886f70d010101"==c._61O){var R=this._16O(c.key),n=new $e;return n._38O(R.n,R.e),n}ve(Ol)},_16O:function(l){var E={};l.substr(0,2)!=Sh&&ve(Ol);var s=Vb._7O(l,0);return 2!=s.length&&ve(Ol),l.substr(s[0],2)!=yc&&ve(Ol),E.n=Vb._11O(l,s[0]),l.substr(s[1],2)!=yc&&ve(Ol),E.e=Vb._11O(l,s[1]),E},_17O:function(s){var J={};J._40O=X;var l=Vb._7O(s,0);2!=l.length&&ve(Ol);var B=l[0];s.substr(B,2)!=Sh&&ve(Ol);var q=Vb._7O(s,B);return 2!=q.length&&ve(Ol),s.substr(q[0],2)!=Ej&&ve(Ol),J._61O=Vb._11O(s,q[0]),s.substr(q[1],2)==Ej?J._40O=Vb._11O(s,q[1]):s.substr(q[1],2)==Sh&&(J._40O={},J._40O.p=Vb._70O(s,q[1],[0],yc),J._40O.q=Vb._70O(s,q[1],[1],yc),J._40O.g=Vb._70O(s,q[1],[2],yc)),s.substr(l[1],2)!=Df&&ve(Ol),J.key=Vb._11O(s,l[1]).substr(2),J}},N._17O?N:X}(),Kn=Jg._27O=function(a){return Jg._14O(a)};af=function(){return function(K,C){if(K&&C){C=Qo(C);var h=ye(C,N(2,4)),Z=this;if(!Z||!Z.n||h._55O()>Z.n._55O())return 0;var M=Z._37O(h),Q=M[ek](N(2,4)).replace(xs,""),t=zg(Q);if(0==t.length)return!1;var m=t[0],R=t[1],i=function(p){return Di._4O.Util._56O(p,m)},S=i(K);return R==S}}.bind(Kn(e))};var ho,Lk;return function(){var y=kp.length-$p.length;if(y>0)for(var J=0;y>J;J++)ho=ms.Util,Lk=Qo}(),lm=function(V,O){O=Lk(O);var $=Kn(Xc),x=Dp.length,_=2*x,j=ye(O,N(x,_)),u=$,y=!0;if(u){var Y=u[Ui[0]];Y&&j._55O()<=Y._55O()&&(y=!1)}if(y)return 0;var W=u._37O(j),E=W[ek](N(x,_)).replace(xs,""),p=zg(E);if(0==p.length)return!1;var F=p[0],Q=p[1],o=ho._11A(V,F);return Q==o},Jg}(y,b),Vm(E,{load:function(){var A={},c=function(h){return h?"c_"+(h.sync?"1":"0")+"_"+(h.post?"1":"0")+"_"+(h.responseType||"H")+"_"+(h.mimeType||"H")+"_"+(h.data?JSON.stringify(h.data):"H"):""};return function(D,e,i){var m,$=A[D],o=c(i);return $&&(m=$[o])?(m.push(e),void 0):(A[D]||($=A[D]={count:0}),m=$[o]=[e],$.count++,E.xhrLoad(D,function(y){delete $[o],$.count--,$.count||delete A[D],m.forEach(function(R){R(y)})},i),void 0)}}(),asyncEach:function(l,s,P){"function"!=typeof P&&(P=Function.prototype);var k=new Array(l.length),m=0,A=!1;l.forEach(function(D,L){s(D,function(v,s){return A?void 0:v?(A=!0,P(null)):(k[L]=s,m++,m===l.length?P(k):void 0)})})},xhrLoad:function(_,C,D){var A=!1;Kc(_)||(A=!0,_=[_]),D=D||{};var I=D.sync,c=null,F=D.method||"GET";return D.post&&(F="POST"),D.method=F,E.asyncEach(_,function(f,l){var h=new _r;f=E.beforeLoadURL(f),f.data?l(null,f.data):(D.url=encodeURI(f),D.responseType?h.setResponseType(D.responseType):h.setOverrideMimeType(D.mimeType||"text/plain"),h.onload=function(){200===this.status||0===this.status?l(null,h.getResponseText()):l(!0)},h.onerror=function(){l(!0)},h.send(D))},function(l){var y="function"==typeof C;(y||I)&&(c=A&&l?l[0]:l,y&&C(c))}),I?c:void 0}});var Ul=b.setPrototypeOf||function(M,J){return M.__proto__=J,M},Dq=b.getPrototypeOf||function(s){return s.__proto__},tl=b.freeze;b.isFrozen;var xc=function(){var S=function(J){return J};return function(y){return y&&y.length?new Function("o",["return o['",y.join("']['"),"'];"].join("")):S}}(),qi=function(){var Z=function(x,D){return x=D};return function(i){return i&&i.length?new Function("o","v",["return o['",i.join("']['"),"'] = v;"].join("")):Z}}();!function(){function Y(j){var h=[];if(j)for(var S;(S=P.exec(j))!=p;)h.push(S[1]);return h}function h(S,y){var z=X.exec(y);this._cell=S,this._key=z[1],this._format=z[2],this._style=Y(z[3])}function D(N){for(var H=this._cellList=[],l=this._paramList=[],U=N.split(L),$=0,t=U.length;t>$;++$){var o=U[$];if("{{"!==o)for(var m=o.split(k),M=0,q=m.length;q>M;++M){var d=m[M];k.test(d)?(l.push(new h(H.length,d)),H.push(p)):d.length>0&&H.push(d)}else H.push("{")}this._formatList=this._cellList.slice(0)}var I={},Z={},L=/(\{\{)/,k=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,X=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,P=/\&([\w\.]*)/g;D.prototype._73O=function(F){for(var m=this._paramList.length;m--;){var r=this._paramList[m],d=F[js(r._key)+1],i=Z[r._format];i&&(d=i(d,r._style)),this._formatList[r._cell]=d}return this._formatList.join("")},D.prototype._map=function(_){for(var z=this._paramList.length;z--;){var Y=this._paramList[z],S=_[Y._key],F=Z[Y._format];F&&(S=F(S,Y._style)),this._formatList[Y._cell]=S}return this._formatList.join("")};var y=function(L){var z=I[L];return z||(I[L]=z=new D(L)),z._73O(arguments)};return y.map=function(x,N){var f=I[x];return f||(I[x]=f=new D(x)),f._map(N)},y.setValueFormat=function(s,X){Z[s]=X},y.gc=function(){I.length=0},y.__parsed=I,y}();var Vd=function(){function R(k,j,K,T){var Y=k?k.path.slice(0):[];j&&Y.push(j),this.desc=K,this.name=j,this.path=tl(Y),this.getter=xc(Y),this.setter=qi(Y),this.isLeaf=T,this.parent=k,this.children=[],this.childMap={}}return R.create=function(){function r(Y,z,j,D){var L=D(j),S=new R(Y,z,j,L);if(!L){for(var X=S.children,e=S.childMap,c=b.keys(j),s=0,N=c.length;N>s;++s){var $=c[s],m=r(S,$,j[$],D);X.push(m),e[m.name]=m}S.children=tl(X),S.childMap=tl(e)}return tl(S),S}return function(k,A){return r(p,p,k,A)}}(),R.prototype.forEach=function($,R){for(var p=this.children,j=0,w=p.length;w>j;++j){var t=p[j];$(t,R)}},R}(),tl=b.freeze,Ki={main:{mask:1,priority:E.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:E.cameraPriority.top,ignore:!1}},Ch="main",hg=Ki[Ch].mask,Ff=function(H,V){H=H||0;var Q;if(V in Ki)Q=Ki[V].mask;else{if(!(32>xj))throw new Error("Only 31 render layer can be defined.");Ki[V]={mask:1<<xj++,priority:Ki[Ch].priority},Q=Ki[V].mask,Vk=Rm(b.keys(Ki)),xj=Vk.length}return H|=Q},Qp=function(X){var t=0;if("string"==typeof X)t=Ff(t,X);else for(var R=0,p=X.length;p>R;++R)t=Ff(t,X[R]);return t},bs=function(H,q){return H&&q&&H&q},Rm=function(s){return s.sort(function(t,C){return Ki[t].priority-Ki[C].priority})},Vk=Rm(b.keys(Ki)),xj=Vk.length;Vm(E,{setRenderLayerInfo:function(Z,m){if(Ff(0,Z),m){for(var F in m)Ki[Z][F]=m[F];m.priority&&(Vk=Rm(b.keys(Ki)))}},getRenderLayerInfo:function(S){return Ki[S]}},!0);var jn=S.List=function(){this._as=[];var e,Z,W=arguments.length;if(1===W){var f=arguments[0];if(Sd(f)&&(f=f._as),Kc(f))for(Z=f.length,e=0;Z>e;e++)this._as.push(f[e]);else f!=X&&this._as.push(f)}else if(W>1)for(e=0;W>e;e++)this._as.push(arguments[e])};Ef("List",b,{forEach:function(B,Z){this.each(B,Z)},push:function(){for(var x=0;x<arguments.length;x++)this.add(arguments[x])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(d,t){return t===p?this._as.push(d):this._as.splice(t,0,d)},addAll:function(y){Sd(y)&&(y=y._as),Kc(y)?nh(this._as,y):this._as.push(y)},get:function(A){return this._as[A]},slice:function(j,m){return new jn(this._as.slice(j,m))},remove:function(Y){var R=this._as.indexOf(Y);return R>=0&&R<this._as.length&&this.removeAt(R),R},removeAt:function(n){return this._as.splice(n,1)[0]},set:function(v,u){return this._as[v]=u},clear:function(){return this._as.splice(0,this._as.length)},contains:function(S){return this._as.indexOf(S)>=0},indexOf:function(A){return this._as.indexOf(A)},each:function(w,X){for(var B=0,n=this._as.length;n>B;B++){var Z=this._as[B];X?w.call(X,Z,B,this):w(Z,B,this)}},reverseEach:function(J,E){for(var a=this._as.length-1;a>=0;a--){var D=this._as[a];E?J.call(E,D):J(D)}},getArray:function(){return this._as},toArray:function(W,s){if(W){for(var h,S=[],q=0,T=this._as.length;T>q;q++)h=this._as[q],s?W.call(s,h)&&S.push(h):W(h)&&S.push(h);return S}return this._as.concat()},toList:function(f,C){if(f){for(var $,i=new jn,Z=0,s=this._as.length;s>Z;Z++)$=this._as[Z],C?f.call(C,$)&&i.add($):f($)&&i.add($);return i}return new jn(this)},reverse:function(){this._as.reverse()},sort:function(y){return this._as.sort(y?y:bk),this},toString:function(){return this._as.toString()}}),b.defineProperties(jn.prototype,{length:{get:function(){return this._as.length},set:function(t){this._as.length=t}}});var gg=new jn;Vm(gg,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:wh,each:wh,reverseEach:wh,toArray:function(){return[]},toList:function(){return new jn},add:Ir,addAll:Ir,set:Ir,remove:Ir,removeAt:Ir,clear:Ir});var Hd=S.Notifier=function(){this._f=0};Ef("Notifier",b,{contains:function(p,V){if(this._ls)for(var z,d=0,Z=this._ls.size();Z>d;d++)if(z=this._ls.get(d),p===z.l&&V===z.s)return!0;return!1},add:function(r,A,W){var l=this,Y={l:r,s:A,a:W};l._ls||(l._ls=new jn),l._f?(l._as||(l._as=new jn),l._as.add(Y)):Y.a?l._ls.add(Y,0):l._ls.add(Y)},remove:function(V,l){var $=this;$._ls&&($._f?($._rs||($._rs=new jn),$._rs.add({l:V,s:l})):$._remove(V,l))},_remove:function(X,Y){for(var S,P=this._ls,O=0,c=P.size();c>O;O++)if(S=P.get(O),S.l===X&&S.s===Y)return P.removeAt(O),void 0},fire:function(p){var w=this,k=w._ls;if(w._b=1e4,k){++w._f;try{for(var Q,v=0,r=k.size();r>v;v++)Q=k.get(v),Q.s?Q.l.call(Q.s,p):Q.l(p)}catch(p){td(function(){throw p})}finally{if(--w._f)return;if(w._rs){for(r=w._rs.size(),v=0;r>v;v++)Q=w._rs.get(v),w._remove(Q.l,Q.s);delete w._rs}if(w._as){for(r=w._as.size(),v=0;r>v;v++)Q=w._as.get(v),Q.a?k.add(Q,0):k.add(Q);delete w._as}}}}});var $m=S.Data=function(){this._id=Ne()};Ef("Data",b,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:X,_parent:X,_children:gg,_childMap:X,_styleMap:X,_layer:"0",_renderLayer:Ch,_renderLayerMask:hg,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||hg},getRenderLayer:function(){return this._renderLayer||Ch},setRenderLayer:function(p){var l=this,$=Ff(0,p);l._renderLayerMask=$;var V=l._renderLayer;l._renderLayer=p,l.fp("renderLayer",V,l._renderLayer)},testRenderLayer:function(n){var R=Ki[n];return R&&bs(this._renderLayerMask,Ki[n].mask)},getUIClass:function(){return X},_22Q:function(){return X},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(r,M){var Y=this;if(2===arguments.length)Y.setStyle(r,M);else{if(!Mj(r))return Y.getStyle(r);for(var a in r)Y.setStyle(a,r[a])}return Y},fp:function(f,N,d,w,e){return this.firePropertyChange(f,N,d,w,e)},firePropertyChange:function(O,H,P,T,s){if(T){if(T(H,P))return!1}else if(H===P)return!1;var U=this,x=s||{};return x.property=O,x.oldValue=H,x.newValue=P,x.data=U,U._dataModel&&U._dataModel.handleDataPropertyChange(x),U.onPropertyChanged(x),!0},onPropertyChanged:function(t){var z=this,O=z._parent,U=t.property;if(Tl(O)){var B=z.s(gh),W="s:ingroup"===U;(B&&ob[U]||U===W)&&O._81I(),(B||W)&&O.fp("childChange",!0,!1)}Un(O)&&(ob[U]||"elevation"===U||Uo[U]||"scaleTall"===U||"tall"===U)&&O.updateFromChildren(),("s:alwaysOnTop"===U||"s:shape3d.alwaysOnTop"===U)&&(t.newValue?this.setRenderLayer("top"):this.setRenderLayer(p))},_21I:function(z){var Z=this;if(z&&Z._dataModel)throw"Remove data from dataModel before adding";Z._dataModel=z},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var i=0,t=this._children.toArray(),o=t.length;o>i;i++)t[i].removeFromDataModel()},getId:function(){return this._id},setId:function(O){this._id=O},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(G,g){return this._children.toList(G,g)},eachChild:function(U,w){this._children.each(U,w)},addChild:function(r,I){var J=this;r!==J&&(J._children===gg&&(J._children=new jn,J._childMap={}),I>=0||(I=J._children.size()),J._childMap[r._id]||J.isDescendantOf(r)||(r._parent&&r._parent.removeChild(r),(0>I||I>J._children.size())&&(I=J._children.size()),J._children.add(r,I),J._childMap[r._id]=r,r.setParent(J),J.onChildAdded(r,I),J.fp(ze,X,r)))},onChildAdded:function(){},removeChild:function(K){var O=this;if(O._childMap&&O._childMap[K._id]){var G=O._children.remove(K);delete O._childMap[K._id],O.fp(ze,K,X),K.setParent(X,G),O.onChildRemoved(K,G)}},onChildRemoved:function(){},getChildAt:function(d){return this._children.get(d)},clearChildren:function(){var l=this;if(!l._children.isEmpty())for(var J=0,R=l._children.toArray(),g=R.length;g>J;J++)l.removeChild(R[J])},getParent:function(){return this._parent},setParent:function(Y,O){var y=this;if(!(y._73I||y._parent===Y||y===Y||Y&&Y.isDescendantOf(y))){var m,A=y._parent;y._parent=Y,y._73I=1,A?(O==X&&(O=A.getChildren().indexOf(y)),A.removeChild(y)):y._dataModel&&O==X&&(O=y._dataModel.getRoots().indexOf(y)),Y&&(Y.addChild(y),m=Y.getChildren().indexOf(y)),delete y._73I,y.fp("parent",A,Y,p,{oldIndex:O,newIndex:m}),y.onParentChanged(A,Y)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(Z){return Z?this.isDescendantOf(Z)||Z.isDescendantOf(this):!1},isParentOf:function(V){return V&&this._childMap?!!this._childMap[V._id]:!1},isDescendantOf:function(b){if(!b||b.isEmpty())return!1;for(var R=this._parent;R;){if(b===R)return!0;R=R._parent}return!1},getStyle:function(x,l){l===p&&(l=1);var _=this._styleMap?this._styleMap[x]:p;return _===p&&l?G[x]:_},setStyle:function(M,R){var d=this;
d._styleMap||(d._styleMap={});var j=d._styleMap[M];R===p?delete d._styleMap[M]:d._styleMap[M]=R,d.fp("s:"+M,j,R)&&d.onStyleChanged(M,j,R)},onStyleChanged:function(){},iv:function(s){this.invalidate(s)},invalidate:function(J){this.fp(J||"*",!1,!0)},toString:function(){var b=this;return b._displayName||b._name||b._tag||b._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(K,e){var h=this,O=h.s(ll);h.beginTransaction(),O||h.s(ll,O={}),e?O[K]=e:delete O[K],h.fp(ll,X,O),h.endTransaction()},removeStyleIcon:function(o){var G=this.s(ll);if(G){var D=G[o];delete G[o],this.fp(ll,X,G)}return D},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(c){var X=this;if(X.hasOwnProperty("_anchor")||X.hasOwnProperty("_anchorElevation")){var w=X.getAnchor3d(),C={x:w.x-.5,y:w.y-.5,z:w.z-.5};qq(c,[-C.x,-C.y,-C.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var A,S={};for(A in this._styleMap)S[A]=1;return S},getCurrentPrefix:function(){return this._interactPrefix||Ji},ca:function(O,Q){var N=this.getCurrentPrefix();return O=N+O,2===arguments.length?this.a(O,Q):this.a(O)}});var pf=S.DataModel=function(){var B=this;B._isDeserializing=0,B._datas=new jn,B._dataMap={},B._roots=new jn,B._rootMap={},B._fsDataMap={},B._78O={},B._reflectorMap={},B._36I=new Hd,B._35I=new Hd,B._serializeNotifier=new Hd,B._selectionModel=new In(B);var c=B._29Q=[],P=B._scheduleCallback=function(){for(var L=Date.now(),d=0;d<c.length;d++){var g=c[d];g.enabled&&L-g.lastTime>g.interval&&(g.beforeAction&&g.beforeAction(),g.action&&B.each(function(x){g.action(x)}),g.afterAction&&g.afterAction(),g.lastTime=L)}c.length&&(B._30Q=y.requestAnimationFrame(P))}};Ef("DataModel",b,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:p,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:p,_init:p,_envmap:p,_envmapType:p,_postProcessingData:p,sm:function(){return this.getSelectionModel()},mm:function($,Y,a){this.addDataModelChangeListener($,Y,a)},umm:function(c,d){this.removeDataModelChangeListener(c,d)},md:function(m,R,A){this.addDataPropertyChangeListener(m,R,A)},umd:function(t,U){this.removeDataPropertyChangeListener(t,U)},mh:function(v,F,X){this.addHierarchyChangeListener(v,F,X)},umh:function(y,K){this.removeHierarchyChangeListener(y,K)},getAttrObject:function(){return this._attrObject},setAttrObject:function(W){return this._attrObject=W},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(H){return this._dataMap[H]},removeDataById:function(e){this.remove(this.getDataById(e))},toDatas:function(u,C){return this._datas.toList(u,C)},each:function(D,V){this._datas.each(D,V)},getDataByTag:function(n){return this._78O[n]},getTagMap:function(){return this._78O},removeDataByTag:function(Q){this.remove(this.getDataByTag(Q))},add:function(G,W,f){var I=this,Y=G._id,Z=G._tag,P=I._roots;if(I._dataMap[Y])throw"'"+Y+"' already exists";Z!=X&&(I._78O[Z]=G),I._dataMap[Y]=G,f>=0?I._datas.add(G,f):I._datas.add(G),G._parent||(I._rootMap[Y]=G,W>=0?P.add(G,W):P.add(G)),G.s("fullscreen")!==p&&(I._fsDataMap[Y]=G),G.s("shape3d.reflector")&&(I._reflectorMap[Y]=G),G._21I(I),I.onAdded(G),I._36I.fire({kind:"add",data:G,rootsIndex:W,datasIndex:f})},onAdded:function(){},remove:function(L,W){if(L){var b=this,A=L._id,f=W&&W.keepStructure,$=W&&W.keepChildren,_=L.getTag();if(L._dataModel===b){var u=L instanceof qk;u&&E.setIsolating(!0),this.beginTransaction(),f?b._removingData||(b._removingData=L):b.prepareRemove(L),$||L.toChildren().each(function(p){b.remove(p,W)},b),f?b._removingData===L&&(L._parent&&L._parent.removeChild(L),delete b._removingData):L._parent&&L._parent.removeChild(L);var d=b._datas.remove(L);delete b._dataMap[A],_!=X&&delete b._78O[_];var I;b._rootMap[A]&&(delete b._rootMap[A],I=b._roots.remove(L)),b._fsDataMap[A]&&delete b._fsDataMap[A],b._reflectorMap[A]&&delete b._reflectorMap[A],L._21I(X),b.onRemoved(L),b._36I.fire({kind:Uc,data:L,rootsIndex:I,datasIndex:d}),this.endTransaction(),u&&E.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var t=this;if(t._datas.size()){var r=t._historyManager?this.toJSON():p;t._datas.toArray().forEach(function(W){W._21I(X)}),t._datas.clear(),t._dataMap={},t._roots.clear(),t._rootMap={},t._fsDataMap={},t._reflectorMap={},t._78O={},t._36I.fire({kind:ef,json:r})}},contains:function(n){return n&&n._dataModel===this},handleDataPropertyChange:function(D){var u=this,Q=D.data,j=D.property;if("parent"===j){var q=Q._id,n=u._rootMap,O=u._roots;Q._parent?n[q]&&(delete n[q],O.remove(Q)):n[q]||(n[q]=Q,O.add(Q))}else if("tag"===j){var s=D.oldValue,C=D.newValue,J=u._78O;s!=X&&delete J[s],C!=X&&(J[C]=Q)}else if("s:fullscreen"===j){var q=Q._id,y=u._fsDataMap;D.oldValue!=X&&delete y[q],D.newValue!=X&&(y[q]=Q)}else if("s:shape3d.reflector"===j){var q=Q._id,R=u._reflectorMap;D.oldValue&&delete R[q],D.newValue&&(R[q]=Q)}this.onDataPropertyChanged(Q,D),this._35I.fire(D)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(K,w,y){this._36I.add(K,w,y)},removeDataModelChangeListener:function(z,Z){this._36I.remove(z,Z)},addSerializeListener:function(A,H,c){this._serializeNotifier.add(A,H,c)},removeSerializeListener:function(O,F){this._serializeNotifier.remove(O,F)},fireSerializeEvent:function(W){this._serializeNotifier.fire(W)},addDataPropertyChangeListener:function(V,D,S){this._35I.add(V,D,S)},removeDataPropertyChangeListener:function(V,B){this._35I.remove(V,B)},_38I:function(D,K,w){this._37I&&this._37I.fire({data:D,oldIndex:K,newIndex:w})},addHierarchyChangeListener:function(K,H,N){this._37I||(this._37I=new Hd),this._37I.add(K,H,N)},removeHierarchyChangeListener:function(k,V){this._37I.remove(k,V)},getSiblings:function(i){var Q=i._parent;return Q?Q._children:this._roots},eachByHierarchical:function(T,Y,b){if(Y)return this._eachByHierarchical(T,Y,b);for(var I=0,Z=this._roots,l=Z.size();l>I;I++)if(this._eachByHierarchical(T,Z.get(I),b)===!1)return!1;return!0},_eachByHierarchical:function(R,g,z){if(z){if(R.call(z,g)===!1)return!1}else if(R(g)===!1)return!1;for(var m=g.size(),$=0;m>$;$++)if(this._eachByHierarchical(R,g.getChildAt($),z)===!1)return!1;return!0},reverseEachByHierarchical:function(k,l,M){if(l)return this._reverseEachByHierarchical(k,l,M);for(var Y=this._roots,m=Y.size(),Q=m-1;Q>=0;Q--)if(this._reverseEachByHierarchical(k,Y.get(Q),M)===!1)return!1;return!0},_reverseEachByHierarchical:function(U,v,l){for(var f=v.size(),K=f-1;K>=0;K--)if(this._reverseEachByHierarchical(U,v.getChildAt(K),l)===!1)return!1;if(l){if(U.call(l,v)===!1)return!1}else if(U(v)===!1)return!1;return!0},eachByDepthFirst:function(R,K,z){if(K)return this._11I(R,K,z);for(var L=0,V=this._roots,E=V.size();E>L;L++)if(this._11I(R,V.get(L),z)===!1)return!1;return!0},_11I:function(E,Y,o){for(var q=Y.size(),P=0;q>P;P++)if(this._11I(E,Y.getChildAt(P),o)===!1)return!1;if(o){if(E.call(o,Y)===!1)return!1}else if(E(Y)===!1)return!1;return!0},eachByBreadthFirst:function(m,b,V){var K=new jn;for(b?K.add(b):this._roots.each(K.add,K);K.size()>0;)if(b=K.removeAt(0),b.eachChild(K.add,K),V){if(m.call(V,b)===!1)return!1}else if(m(b)===!1)return!1;return!0},moveTo:function(j,t){var Q=this.getSiblings(j),x=Q.indexOf(j);x===t||0>x||t>=0&&t<=Q.size()&&(Q.remove(j),t>Q.size()&&t--,Q.add(j,t),this._38I(j,x,t))},moveUp:function(D){this.moveTo(D,this.getSiblings(D).indexOf(D)-1)},moveDown:function(s){this.moveTo(s,this.getSiblings(s).indexOf(s)+1)},moveToTop:function(M){this.moveTo(M,0)},moveToBottom:function(K){this.moveTo(K,this.getSiblings(K).size())},moveSelectionUp:function(q){this.beginTransaction(),q||(q=this.sm());var I=new jn;Wj(q,I,this._roots),I.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(w){this.beginTransaction(),w||(w=this.sm());var O=new jn;gs(w,O,this._roots),O.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(R){this.beginTransaction(),R||(R=this.sm());var a=new jn;ri(R,a,this._roots),a.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(w){this.beginTransaction(),w||(w=this.sm());var x=new jn;Rn(w,x,this._roots),x.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(C,S,f){var B=this.getDatas();null==f&&(f=B.indexOf(C)),f===S||0>f||S>=0&&S<=B.size()&&(B.remove(C),S>B.size()&&S--,B.add(C,S),this._76I(C,f,S))},bringForward:function(Y){this.moveToIndex(Y,this.getDatas().indexOf(Y)+1)},bringToFront:function(P){this.moveToIndex(P,this.size())},sendBackward:function(l){this.moveToIndex(l,this.getDatas().indexOf(l)-1)},sendToBack:function(D){this.moveToIndex(D,0)},bringSelectionForward:function(p){this.beginTransaction(),p||(p=this.sm());for(var h=new jn,o=this.getDatas(),q=!1,D=0;D<o.size();D++){var N=o.get(o.size()-1-D);p.contains(N)?q&&h.add(N):q=!0}h.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(D){this.beginTransaction(),D||(D=this.sm());for(var j=new jn,t=this.getDatas(),y=0;y<t.size();y++){var X=t.get(y);D.contains(X)&&j.add(X)}j.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(j){this.beginTransaction(),j||(j=this.sm());for(var X=new jn,K=this.getDatas(),a=!1,o=0;o<K.size();o++){var L=K.get(o);j.contains(L)?a&&X.add(L):a=!0}X.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(c){this.beginTransaction(),c||(c=this.sm());for(var t=new jn,U=this.getDatas(),h=0;h<U.size();h++){var I=U.get(U.size()-1-h);c.contains(I)&&t.add(I)}t.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(u){var g=this;g.removeScheduleTask(u),u.enabled==X&&(u.enabled=!0),u.interval==X&&(u.interval=10),u.lastTime=Date.now(),g._29Q.push(u),g._30Q==X&&(g._30Q=y.requestAnimationFrame(g._scheduleCallback))},removeScheduleTask:function(Q){var V=this,S=V._29Q,h=S.indexOf(Q);h>=0&&S.splice(h,1),S.length||V._30Q==X||(y.cancelAnimationFrame(V._30Q),delete V._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(x){this._historyManager||new S.HistoryManager(this),null!=x&&this._historyManager.setMaxHistoryCount(x),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(H){this._historyManager&&this._historyManager.undo(H)},redo:function(b){this._historyManager&&this._historyManager.redo(b)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(B){this._historyManager&&this._historyManager.addHistory(B)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(i){i?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(m){this.each(function(G){G instanceof vd&&G.getImage()===m&&G.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){}});var In=S.SelectionModel=function(d){var a=this;a._68O=No,a._map={},a._73O=new jn,a._74I=new Hd,a._21I(d)};Ef("SelectionModel",b,{ms_fire:1,ms_dm:1,ms:function(k,$,B){this.addSelectionChangeListener(k,$,B)},ums:function(D,i){this.removeSelectionChangeListener(D,i)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===mh},co:function(o){return this._map[o._id]!=X},ss:function(p){this.setSelection(p)},as:function(W){this.appendSelection(W)},rs:function(i){this.removeSelection(i)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(G){var J=this;if(J._68O!==G&&(G===Ui||G===mh||G===No)){J.cs();var h=J._68O;J._68O=G,J.fp("selectionMode",h,G)}},_21I:function(E){var Q=this,p=Q._dataModel;p!==E&&(p&&(Q.cs(),p.umm(Q.handleDataModelChange,Q)),Q._dataModel=E,E.mm(Q.handleDataModelChange,Q,!0),Q.fp(Zd,p,E))},dispose:function(){var G=this;G.cs(),G._dataModel.umm(G.handleDataModelChange,G)},handleDataModelChange:function(P){var Z=this;if(P.kind===Uc){var w=P.data;Z.co(w)&&(Z._73O.remove(w),delete Z._map[w._id],Z._75I(Uc,new jn(w)))}else P.kind===ef&&Z.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(q){var l=this;if(l._filterFunc!==q){l.cs();var t=l._filterFunc;l._filterFunc=q,l.fp("filterFunc",t,l._filterFunc)}},_75I:function(n,V,y,d){y&&(this._73O.each(function(N){d[N._id]?y.remove(N):y.add(N)}),V=y.toList()),this._74I.fire({kind:n,datas:new jn(V)})},addSelectionChangeListener:function(P,E,y){this._74I.add(P,E,y)},removeSelectionChangeListener:function(T,p){this._74I.remove(T,p)},_97O:function(j,o){for(var l,u=this,X=0,x=new jn(j);X<x.size();X++)l=x.get(X),(u._filterFunc&&!u._filterFunc(l)||o&&u.co(l)||!o&&!u.co(l)||!u._dataModel.contains(l))&&(x.removeAt(X),X--);return x},appendSelection:function(P){var S=this;if(S._68O!==Ui){var T,N,f=S._73O,m=S._97O(P,!0);m.isEmpty()||(S.sg()&&(T=new jn(f),N=S._map,f.clear(),S._map={},m=new jn(m.get(m.size()-1))),m.each(function(e){f.add(e),S._map[e._id]=e}),S._75I("append",m,T,N))}},removeSelection:function(L){var U=this,v=U._97O(L),D=0,H=v.size();if(0!==H){for(;H>D;D++){var e=v.get(D);U._73O.remove(e),delete U._map[e._id]}U._75I(Uc,v)}},toSelection:function(E,c){return this._73O.toList(E,c)},getSelection:function(){return this._73O},each:function(q,X){this._73O.each(q,X)},setSelection:function(G){var c=this,n=c._73O;if(c._68O!==Ui&&!(n.isEmpty()&&!G||1===n.size()&&c.ld()===G)){var Y=new jn(n),B=c._map;n.clear(),c._map={};var t=c._97O(G,!0);c.sg()&&t.size()>1&&(t=new jn(t.get(t.size()-1))),t.each(function(g){n.add(g),c._map[g._id]=g}),c._75I("set",X,Y,B)}},clearSelection:function(){var i=this,z=i._73O;if(z.size()>0){var q=z.toList();z.clear(),i._map={},i._75I(ef,q)}},selectAll:function(){var b=this;if(b._68O!==Ui){var B,h,q=b._dataModel.toDatas();if(b._filterFunc)for(B=0;B<q.size();B++)h=q.get(B),b._filterFunc(h)||(q.removeAt(B),B--);var m=b._73O,F=new jn(m),e=b._map;m.clear(),b._map={},b.sg()&&q.size()>1&&(q=new jn(q.get(q.size()-1)));var E=q.size();for(B=0;E>B;B++)h=q.get(B),m.add(h),b._map[h._id]=h;b._75I("all",X,F,e)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(L){return this._map[L._id]!=X},getLastData:function(){var T=this._73O;return T.size()>0?T.get(T.size()-1):X},getFirstData:function(){var w=this._73O;return w.size()>0?w.get(0):X},isSelectable:function(H){var l=this;return H&&l._68O!==Ui?l._filterFunc?l._filterFunc(H):!0:!1},getTopSelection:function(){var o=this,r=new jn;return o._73O.each(function(R){for(var c=R.getParent();c;){if(o.contains(c)){R=X;break}c=c.parent}R&&r.add(R)}),r}});var tg=function(){return Er(0),function(b,C){var h;if(bn(C)){var c=b.getDataUI(C);c&&c._88I&&(h=c._88I.rect)}return h?h:C.getRect()}}();Vm(E,{edgeGroupAgentFunc:X,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:M.rectSelectBorder,graphViewRectSelectBackground:Cl,graphViewEditPointSize:Iq?17:7,graphViewEditPointBorderColor:M.editPointBorder,graphViewEditPointBackground:M.editPointBackground,setEdgeType:function(S,t,X){Se[S]=t,ms[S]=X},getEdgeType:function(y){return Se[y]},getEdgeTypeMap:function(){return Se},getNodeRect:tg},!0);var Sc={"layout.h":p,"layout.v":p,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":p,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:p,ingroup:!0,"body.color":p,"2d.gray":!1,fullscreen:p,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:p,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":$k,"select.width":1,"select.padding":2,"select.type":zo,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":$k,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":p,"border.width":2,"border.padding":2,"border.type":zo,label:p,"label.font":p,"label.color":di,"label.background":p,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":p,"label.max":p,"label.opacity":p,"label.scale":1,"label.align":p,"label.selectable":!0,label2:p,"label2.font":p,"label2.color":di,"label2.background":p,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":p,"label2.max":p,"label2.opacity":p,"label2.scale":1,"label2.align":p,"label2.selectable":!0,note:p,"note.expanded":!0,"note.font":p,"note.color":Hf,"note.background":$k,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":p,"note.toggleable":!0,"note.border.width":1,"note.border.color":p,"note.opacity":p,"note.scale":1,"note.align":p,note2:p,"note2.expanded":!0,"note2.font":p,"note2.color":Hf,"note2.background":$k,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":p,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":p,"note2.opacity":p,"note2.scale":1,"note2.align":p,"group.type":p,"group.image":p,"group.image.stretch":"fill","group.repeat.image":p,"group.border.repeat.image":p,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":p,"group.title.color":Hf,"group.title.background":M.groupTitleBackground,"group.title.align":cq,"group.title.orientation":yb,"group.background":M.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":p,"group.border.color":Qd,"group.border.radius":p,"group.border.cap":bc,"group.border.join":ek,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":X,"group.gradient.color":"#FFF",shape:p,"shape.background":Qd,"shape.repeat.image":p,"shape.border.repeat.image":p,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Qd,"shape.border.3d":!1,"shape.border.3d.color":p,"shape.border.3d.accuracy":p,"shape.border.cap":bc,"shape.border.join":ek,"shape.border.pattern":p,"shape.gradient":X,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":hs,"shape.dash.offset":0,"shape.dash.color":Tj,"shape.dash.width":p,"shape.dash.3d":!1,"shape.dash.3d.color":p,"shape.dash.3d.accuracy":p,"shape.polygon.side":6,"shape.arc.from":f,"shape.arc.to":$,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":p,"shape.gradient.pack":p,"shape.border.gradient.pack":p,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":p,"shape.foreground.gradient":X,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":p,"autolayout.hgap":p,"autolayout.vgap":p,"edge.type":p,"edge.points":p,"edge.segments":p,"edge.color":Qd,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":p,"edge.3d.accuracy":p,"edge.cap":bc,"edge.join":ek,"edge.source.position":17,"edge.source.anchor.x":p,"edge.source.anchor.y":p,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":p,"edge.target.anchor.y":p,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":p,"edge.dash":!1,"edge.dash.pattern":hs,"edge.dash.offset":0,"edge.dash.color":Tj,"edge.dash.width":p,"edge.dash.3d":!1,"edge.dash.3d.color":p,"edge.dash.3d.accuracy":p,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":p,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":p,"grid.column.percents":p,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":M.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":M.gridCellBorderColor,"grid.block":p,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":M.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":di,"text.gradient.pack":p,"text.font":Pn,"text.shadow":!1,"text.shadow.color":$k,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":p,"text.gradient.color":"#FFF","text.decoration":p,"text.vertical":!1,"text.vertical.gap":1,keepPosition:!0,cursor:p};Sc[Ge]=p,Vm(G,Sc,!0),Vm(pf,{_76I:function(g,x,d){this._39I&&this._39I.fire({data:g,oldIndex:x,newIndex:d})},addIndexChangeListener:function(T,L,z){var S=this;S._39I||(S._39I=new Hd),S._39I.add(T,L,z)},removeIndexChangeListener:function(i,$){this._39I.remove(i,$)},prepareRemove:function(Z){br(Z)&&(Z.setSource(X),Z.setTarget(X)),Z._70O&&Z._70O.toList().each(this.remove,this),Z._69O&&Z._69O.toList().each(function(c){c.setHost(X)}),Z._host&&Z.setHost(X)},onAdded:function(j){this.isAutoAdjustIndex()&&this.adjustIndex(j)},onDataPropertyChanged:function(p,f){qj[f.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(p)},isAdjustable:function(e){return mo(e)||br(e)},isAdjustedToBottom:function(M){return Tl(M)?M.isExpanded()&&Dh(M):!1},adjustIndex:function(L){var G=this;this.isHierarchicalRendering()||(G.isAdjustedToBottom(L)?(G.sendToBottom(L),L.eachChild(G.adjustIndex,G)):G.sendToTop(L))},sendToTop:function(E){var B=this;if(B.contains(E)&&B.isAdjustable(E)){var e=B._datas;if(E!==e.get(B.size()-1)){var v=e.indexOf(E);e.removeAt(v),e.add(E),B._76I(E,v,B.size()-1)}if(br(E)){var A=E._40I;A&&!B.isAdjustedToBottom(A)&&B.sendToTop(A),A=E._41I,A&&!B.isAdjustedToBottom(A)&&B.sendToTop(A)}E._69O&&E._69O.each(function(V){V.isRelatedTo(E)||mo(E)&&V.isLoopedHostOn(E)||B.sendToTop(V)}),E.ISubGraph||(!Tl(E)||E.isExpanded())&&E._adjustChildrenToTop&&E.eachChild(function(q){br(q)||B.sendToTop(q)})}},sendToBottom:function(W,z){var B=this;if(W!==z&&B.contains(W)&&B.isAdjustable(W)&&(!z||B.contains(z))){var F=B._datas,M=F.remove(W),K=z?B._datas.indexOf(z):0;if(F.add(W,K),M!==K){B._76I(W,M,K);var _=W._parent;!_||_.ISubGraph||br(_)||B.sendToBottom(W._parent,W)}}}}),Vm(cm,{ms_edit:function(N){N._46O=function(u){var S=this,m=S.gv.dm(),s=S._index,F=S._89I,i=S._node,y=S._shape,W=S._edge,I=S._77I;i&&F?(this.fi({kind:"endEditRect",event:u,data:i,direction:F}),m.endTransaction()):y&&s>=0?(S.fi({kind:"endEditPoint",event:u,data:y,index:s}),m.endTransaction()):W&&s>=0?(S.fi({kind:"endEditPoint",event:u,data:W,index:s}),m.endTransaction()):I&&(S.fi({kind:"endEditRotation",event:u,data:I}),m.endTransaction())},N._78I=function(R){var N=this;N.autoScroll(R);var W=N.gv.lp(R),s=N._index,p=N._89I,h=N._node,l=N._shape,K=N._edge,H=N._77I;if(h&&p)N._80O(W),N.fi({kind:"betweenEditRect",event:R,data:h,direction:p});else if(l&&s>=0)W.e=l.getPoints().get(s).e,l.setPoint(s,W),N.fi({kind:"betweenEditPoint",event:R,data:l,index:s});else if(K&&s>=0){var n=K.s(Vi);W.e=n.get(s).e,n.set(s,W),K.fp(Vi,X,n),N.fi({kind:"betweenEditPoint",event:R,data:K,index:s})}else if(H){var b=H.p(),F=H.getScale(),d=fs+$g(W.y-b.y,W.x-b.x);F.y<0&&(d+=f),a(d)<.04&&(d=0),H.setRotation(d),N.fi({kind:"betweenEditRotation",event:R,data:H})}},N._80O=function(o){var a=this,d=a._node,T=a._rect,h=T.x,x=T.y,I=T.width,q=T.height,p=a._89I,v=a._anchor,Y=a._matrix,o=Y.tfi(o);"northwest"===p?T=$q(o,{x:h+I,y:x+q}):p===Ij?T=$q({x:h,y:o.y},{x:h+I,y:x+q}):"northeast"===p?T=$q({x:h,y:o.y},{x:o.x,y:x+q}):p===Vg?T=$q({x:o.x,y:x},{x:h+I,y:x+q}):p===Ce?T=$q({x:h,y:x},{x:o.x,y:x+q}):"southwest"===p?T=$q({x:o.x,y:x},{x:h+I,y:o.y}):"south"===p?T=$q({x:h,y:x},{x:h+I,y:o.y}):"southeast"===p&&(T=$q({x:h,y:x},o)),d.setPosition(Y.tf(T.x+T.width*v.x,T.y+T.height*v.y)),d.setWidth(T.width),d.setHeight(T.height)},N._80I=function(v,_,e,W){var a=this,X=a.gv._zoom,u=(a.gv.getEditPointSize()+2)/X;return Ue({x:_-u/2,y:e-u/2,width:u,height:u},v)?(a._89I!==W&&(a._89I=W),!0):!1},N._79I=function(e,y,R){var n=this,v=n.gv,Z=y?v.getDataUI(y):X,r=Z?Z._55O:X;if(r){var p,d,U,P,A=v._zoom,B=(v.getEditPointSize()+2)/A,m=v.lp(e);if(mo(y)){if(r._56O&&mo(y)&&(d=r._98o,Ue({x:d.x-B/2,y:d.y-B/2,width:B,height:B},m)))return n._77I=y,R&&n.fi({kind:"beginEditRotation",event:e,data:y}),n.setCursor("crosshair"),!0;if(r._43O&&y instanceof bd)for(U=y.getPoints(),p=U.size()-1;p>=0;p--)if(d=U.get(p),Ue({x:d.x-B/2,y:d.y-B/2,width:B,height:B},m))return n._index=p,n._shape=y,R&&n.fi({kind:"beginEditPoint",event:e,data:y,index:p}),n.setCursor("crosshair"),!0;if(r._42O)for(var E=y.getEditControlPoints(),K=["northwest",-1,-1,Vg,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Ce,1,0,"northeast",1,-1,Ij,0,-1],p=0,P=E.length;P>p;p++){var l=K[3*p],x=E[p];if(n._80I(m,x.x,x.y,l)){n._node=y;var w=y.getWidth(),D=y.getHeight(),u=y.getAnchor();n._rect={x:-w*u.x,y:-D*u.y,width:w,height:D},n._anchor=u,n._matrix=y.getMatrix();var F=y.getRotation(),h=t(F),V=T(F),g=K[3*p+1]*zb(y.getScale().x),C=K[3*p+2]*zb(y.getScale().y),M=Math.atan2(-V*g-h*C,h*g-V*C),L=(Math.round(M/(Math.PI/4))+8)%8,q=[$n,"nesw-resize",Yk,"nwse-resize",$n,"nesw-resize",Yk,"nwse-resize"][L];return n.setCursor(q),R&&n.fi({kind:"beginEditRect",event:e,data:y,direction:n._89I}),!0}}}if(r._43O&&br(y)&&y.s(Ug)===tk&&(U=y.s(Vi)))for(p=U.size()-1;p>=0;p--)if(d=U.get(p),Ue({x:d.x-B/2,y:d.y-B/2,width:B,height:B},m))return n._index=p,n._edge=y,R&&n.fi({kind:"beginEditPoint",event:e,data:y,index:p}),n.setCursor("crosshair"),!0}return!1}},ms_gv:function(D){D._currentSubGraph=X,D._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},D.upSubGraph=function(){this.setCurrentSubGraph(Kh(this._currentSubGraph))},D.isVisible=function(J){var Y=this;if(Kh(J)!==Y._currentSubGraph)return!1;if(br(J)){var j=J._40I,S=J._41I;if(!j||!S)return!1;if(!(J.s("edge.independent")||Y.isVisible(j)&&Y.isVisible(S)))return!1;if(J.isEdgeGroupHidden())return!1}else for(var z=J._parent;z&&!z.ISubGraph;){if(Tl(z)&&(!z.isExpanded()||!Y.isVisible(z)))return!1;z=z._parent}if(J._parent instanceof qk&&!Y.isVisible(J._parent))return!1;if(J._refGraph instanceof Tf&&!Y.isVisible(J._refGraph))return!1;if(Y instanceof zp){if(!J.s("3d.visible"))return!1}else{var V=Y.getLayersInfo();if(V){var O=V[J._layer];if(O&&O.visible===!1)return!1}if(!J.s("2d.visible"))return!1}return Y._visibleFunc?Y._visibleFunc(J):!0},D.handleSelectionChange=function(o){var I=this;o.datas.each(function(y){I.invalidateData(y);var t=y._parent;Tl(t)&&mo(y)&&y.s(gh)&&(I.invalidateData(t),t._49I&&t._49I.each(function(F){I.invalidateData(F)}))}),I.onSelectionChanged(o)},D.onSelectionChanged=function(H){var d=this,K=d.sm();if(1===K.size()&&("set"===H.kind||"append"===H.kind)){var S=K.ld();d.isAutoMakeVisible()&&d.makeVisible(S),d.adjustIndex&&d._dataModel.isAutoAdjustIndex()&&d.adjustIndex(S)}},D.makeVisible=function(v){if(v){var F=this,r=F.getDataUI?F.getDataUI(v):F.getData3dUI(v);if(r){var W=v,c=Kh(v);for(c!==F._currentSubGraph&&F.setCurrentSubGraph(c);(W=W._parent)&&W!==c;)Tl(W)&&W.setExpanded(!0);F._23I=v,F.iv()}}},D.getLabel=function(l){var u=l.getStyle(lp);return u===p?l.getName():u},D.getLabelBackground=function(y){return y.getStyle("label.background")},D.getLabelColor=function(N){return N.getStyle("label.color")},D.getLabel2=function(j){return j.getStyle("label2")},D.getLabel2Background=function(z){return z.getStyle("label2.background")},D.getLabel2Color=function(O){return O.getStyle("label2.color")},D.getNote=function(q){return q.getStyle(Pl)},D.getNoteBackground=function(w){return w.getStyle("note.background")},D.getNote2=function(F){return F.getStyle(Io)},D.getNote2Background=function(R){return R.getStyle("note2.background")},D.handleClick=function(C,g,j){var O=this;g?(O.fi({kind:"clickData",event:C,data:g,part:j}),O.onDataClicked(g,C)):(O.fi({kind:"clickBackground",event:C}),O.onBackgroundClicked(C))},D.handleDoubleClick=function(q,o,G){var i=this;Dj(q)&&(o?(i.fi({kind:"doubleClickData",event:q,data:o,part:G}),i.onDataDoubleClicked(o,q,G),i.checkDoubleClickOnNote(q,o,G)||i.checkDoubleClickOnRotation&&i.checkDoubleClickOnRotation(q,o,G)||(br(o)?i.onEdgeDoubleClicked(o,q,G):o.ISubGraph?i.onSubGraphDoubleClicked(o,q,G):Tl(o)?i.onGroupDoubleClicked(o,q,G):o.IDoorWindow?i.onDoorWindowDoubleClicked(o,q,G):o.ICSGBox&&i.onCSGBoxDoubleClicked(o,q,G))):(i.fi({kind:"doubleClickBackground",event:q}),i.onBackgroundDoubleClicked(q)))},D.onSubGraphDoubleClicked=function(z){this.setCurrentSubGraph(z)},D.onEdgeDoubleClicked=function(t,K){this.isEditable(t)||(t.ISubGraph&&!Yd(K)?this.setCurrentSubGraph(t):t.s("edge.toggleable")&&t.toggle())},D._39Q=function(K){return this.isInteractive(K)?this.preventDefaultWhenInteractive(K):!1},D.preventDefaultWhenInteractive=function(D){return D.s("preventDefaultWhenInteractive")},D.onGroupDoubleClicked=function(Q){Q.s("group.toggleable")&&Q.toggle()},D.onDoorWindowDoubleClicked=function(s){s.s("dw.toggleable")&&s.toggle(!0)},D.onCSGBoxDoubleClicked=function($,S){var M=this;if(M instanceof zp){var Z=M.intersectObject(S,$);Z&&$.s(Z.part+".toggleable")&&$.toggleFace(Z.part,!0)}},D.onBackgroundClicked=function(){},D.onBackgroundDoubleClicked=function(){this.upSubGraph()},D.onDataClicked=function(){},D.onDataDoubleClicked=function(){},D.onAutoLayoutEnded=function(){},D.onMoveEnded=function(){},D.onPanEnded=function(){},D.onPinchEnded=function(){},D.onRectSelectEnded=function(){},D.onZoomEnded=function(){},D.serialize=function(c){return this.dm().serialize(c)},D.toJSON=function(){return this.dm().toJSON()},D.deserialize=function(y,L){var N=this;L=L instanceof $m?{rootParent:L}:Pk(L)?{setId:L}:Uq(L)?{finishFunc:L}:L||{},L.view=N;var d=N.dm();return L.__innerHandler__=function(I){if(Pk(d.a("toolTipEnable"))&&(d.a("toolTipEnable")?N.enableToolTip():N.disableToolTip()),N instanceof S.graph.GraphView&&(Pk(d.a("zoomable"))&&N.setZoomable&&N.setZoomable(d.a("zoomable")),Pk(d.a("pannable"))&&N.setPannable&&N.setPannable(d.a("pannable")),Pk(d.a("rectSelectable"))&&N.setRectSelectable&&N.setRectSelectable(d.a("rectSelectable")),d.a("fitContent")===!0&&N.fitContent&&N.fitContent(!0,0)),N instanceof S.graph3d.Graph3dView){var Y=I.scene;Y&&Y.shadow!=X&&N.shadowMap.setShadow(Y.shadow,Y.shadowParams);var o=d.a("sceneContext");o?(o.eye&&N.setEye(o.eye),o.center&&N.setCenter(o.center),po(o.far)&&N.setFar(o.far),po(o.near)&&N.setNear(o.near)):(po(d.a("sceneNear"))&&N.setNear(d.a("sceneNear")),po(d.a("sceneFar"))&&N.setFar(d.a("sceneFar")),Y&&(Y.eye&&N.setEye(Y.eye),Y.center&&N.setCenter(Y.center))),Pk(d.a("sceneShadowEnabled"))&&(d.a("sceneShadowEnabled")?N.enableShadow():N.disableShadow()),po(d.a("sceneShadowDegreeX"))&&N.setShadowDegreeX(d.a("sceneShadowDegreeX")),po(d.a("sceneShadowDegreeZ"))&&N.setShadowDegreeZ(d.a("sceneShadowDegreeZ")),po(d.a("sceneShadowIntensity"))&&N.setShadowIntensity(d.a("sceneShadowIntensity")),d.a("sceneShadowQuality")!=X&&N.setShadowQuality(d.a("sceneShadowQuality")),d.a("sceneShadowType")&&N.setShadowType(d.a("sceneShadowType")),po(d.a("sceneShadowRadius"))&&N.setShadowRadius(d.a("sceneShadowRadius")),po(d.a("sceneShadowBias"))&&N.setShadowBias(d.a("sceneShadowBias")),Pk(d.a("sceneDashEnable"))&&N.setDashDisabled(!d.a("sceneDashEnable")),tc(d.a("sceneHighlightMode"))&&N.setHighlightMode(d.a("sceneHighlightMode")),po(d.a("sceneHighlightWidth"))&&N.setHighlightWidth(d.a("sceneHighlightWidth")),d.a("sceneHighlightColor")&&N.setHighlightColor(d.a("sceneHighlightColor")),d.a("sceneHighlightType")&&N.setHighlightType(d.a("sceneHighlightType")),d.a("sceneHighlightGlow")&&N.setHighlightGlow(d.a("sceneHighlightGlow")),d.a("sceneHighlightStrength")&&N.setHighlightStrength(d.a("sceneHighlightStrength")),Pk(d.a("sceneHeadlightEnable"))&&N.setHeadlightDisabled(!d.a("sceneHeadlightEnable")),po(d.a("sceneHeadlightRange"))&&N.setHeadlightRange(d.a("sceneHeadlightRange")),d.a("sceneHeadlightColor")&&N.setHeadlightColor(d.a("sceneHeadlightColor")),po(d.a("sceneHeadlightIntensity"))&&N.setHeadlightIntensity(d.a("sceneHeadlightIntensity")),po(d.a("sceneHeadlightAmbientIntensity"))&&N.setHeadlightAmbientIntensity(d.a("sceneHeadlightAmbientIntensity")),po(d.a("sceneHeadlightGroup"))&&N.setHeadlightGroup(d.a("sceneHeadlightGroup")),Pk(d.a("sceneFogEnable"))&&N.setFogDisabled(!d.a("sceneFogEnable")),d.a("sceneFogMode")&&N.setFogMode(d.a("sceneFogMode")),po(d.a("sceneFogDensity"))&&N.setFogDensity(d.a("sceneFogDensity")),d.a("sceneFogColor")&&N.setFogColor(d.a("sceneFogColor")),po(d.a("sceneFogNear"))&&N.setFogNear(d.a("sceneFogNear")),po(d.a("sceneFogFar"))&&N.setFogFar(d.a("sceneFogFar")),Pk(d.a("sceneBatchBrightnessDisabled"))&&N.setBatchBrightnessDisabled(d.a("sceneBatchBrightnessDisabled")),Pk(d.a("sceneBatchBlendDisabled"))&&N.setBatchBlendDisabled(d.a("sceneBatchBlendDisabled")),Pk(d.a("sceneBatchColorDisabled"))&&N.setBatchColorDisabled(d.a("sceneBatchColorDisabled")),d.a("sceneBatchInfoMap")&&N.setBatchInfoMap(d.a("sceneBatchInfoMap")),po(d.a("sceneMoveStep"))&&N.setMoveStep(d.a("sceneMoveStep")),po(d.a("sceneRotateStep"))&&N.setRotateStep(d.a("sceneRotateStep")),Pk(d.a("sceneSortable"))&&N.setSortable(d.a("sceneSortable")),Uq(d.a("sceneSortFunc"))&&N.setSortFunc(d.a("sceneSortFunc"));
var s=d.a("sceneSkyboxType")||"sphere";if(s!=X){var l={},j=!1;if("sphere"===s){l.shape3d=s;var O=d.a("sceneSkyboxImage");O&&(l["shape3d.image"]=O,j=!0)}else l.shape3d=p,["front","back","left","right","top","bottom"].forEach(function(R){var w=R+".image",u=R.charAt(0).toUpperCase()+R.slice(1),N=d.a("sceneSkybox"+u+"Image");N&&(l[w]=N,j=!0)});if(j){var A=new vd,U=d.a("sceneSkyboxDiameter");po(U)?A.s3(U,U,U):A.s3(20,20,20),l["body.color"]=d.a("sceneSkyboxBodyColor"),l.envmap=d.a("sceneSkyboxEnvmap"),l["envmap.probe"]=d.a("sceneSkyboxEnvmapProbe"),l.roughness=d.a("sceneSkyboxRoughness"),l["shape3d.light"]=l["all.light"]=d.a("sceneSkyboxLight"),l["light.mask"]=d.a("sceneSkyboxLightMask"),l["texture.wrap"]="clampToEdge",l["3d.clipbox.enabled"]=!1,A.s(l),["X","Y","Z"].forEach(function(z){var K=d.a("sceneSkyboxRotation"+z);po(K)&&A["setRotation"+z](K)}),N.setSkybox(A)}}}},d.deserialize(y,L.rootParent,L)},D.isDebugTipShowing=function(){return!!this._debugDiv},D.showDebugTip=function(){var e=this,s=e._debugDiv;if(!s){s=e._debugDiv=i.createElement("div"),s.style.position="absolute",s.style.overflow="hidden",s.style.font=E.debugTipLabelFont,s.style.padding="6px",s.style.backgroundColor=E.debugTipBackground,s.style.color=E.debugTipLabelColor;var A=e.getView();e._79O?A.insertBefore(s,e._79O):A.appendChild(s);var z=function(){e.redraw();var I=e._canvas,j="FPS: "+e._fpsInfo.fps+"<br/>"+"Datas: "+e.dm().getDatas().length+(I?"<br/>Size: "+I.width+" * "+I.height:""),u=e.dm()._historyManager;u&&(j+="<br/>Undoes: "+u.getHistories().length+" index: "+u.getHistoryIndex());var H=e.getDebugTip();H&&(j+="<hr>"+H),s.innerHTML=j,e._isDebugging&&requestAnimationFrame(z)};requestAnimationFrame(z),e._isDebugging=!0}},D.hideDebugTip=function(){var t=this,X=t._debugDiv;X&&(delete t._debugDiv,t.getView().removeChild(X),t._isDebugging=!1)},D.updateDOMAppendMatrix=function(){var j=this.getView();j&&(j.updateAppendMatrix=!0)},D.countFrame=function(){if(this._isDebugging){var g=Date.now(),I=this._fpsInfo;g-I.time>1e3?(I.fps=Math.round(1e5*(I.frames+1)/(g-I.time))/100,I.time=g,I.frames=0):I.frames++}}},ms_icons:function(A){A.getRotation=function(e){return e==X?0:e},A._15O=function(){var $=this,G=$.s(ll);if(G){var v=$,C=$.data||$._data,_=$._38o={icons:G,rects:{}};for(var i in G){var g=G[i],b=Qn(g.shape3d,C,v);if(!(Qn(g.visible,C,v)===!1||Qn(g.for3d,C,v)&&!$.I3d||b&&!$.I3d)){var l=b?[b]:Qn(g.names,C,v),h=l?l.length:0,D=Qn(g.position,C,v)||3,r=Qn(g.offsetX,C,v)||0,I=Qn(g.offsetY,C,v)||0,e=Qn(g.direction,C,v)||Ce,x=Qn(g.gap,C,v),K=x!=X?x:1,u=Qn(g.rotation,C,v),s=Qn(g.keepOrien,C,v),t=Qn(g.rotationFixed,C,v)?u:$.getRotation(u,s,D),q=X,U=_.rects[i]=new Array(h);U.rotation=t;for(var M=0;h>M;M++){var W,f,j,w,T=l[M];if(b)j=0,w=0;else{var Y=ir(T);j=Qn(g.width,C,v),w=Qn(g.height,C,v),j==X&&(j=rc(Y,C)),w==X&&(w=Sn(Y,C))}if(q?e===Ce?r+=j/2:e===Vg?r-=j/2:e===Ij?I-=w/2:I+=w/2:q={width:j,height:w},$.I3d){var y=-j/2,L=-w/2;f={width:j,height:w,mat:$._16O(Qn(g.autorotate,C,v),D,q,Qn(g.face,C,v)||Vo,Qn(g.t3,C,v),Qn(g.r3,C,v),Qn(g.rotationMode,C,v),r,I),vs:new en([y,-L,0,y,-L-w,0,y+j,-L-w,0,y+j,-L,0])}}else W=$.getPosition(D,r,I,q,Qn(g.positionFixed,C,v)),f={x:W.x-j/2,y:W.y-w/2,width:j,height:w},$._68o(f,t);U[M]=f,e===Ce?r+=j/2+K:e===Vg?r-=j/2+K:e===Ij?I-=w/2+K:I+=w/2+K}}}}}}});var vi={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},hk={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Vb={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},qj={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ob={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},ah={"edge.type":1,"edge.group":1},Uo={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},_d={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},Li={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},ph={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},ok={shape:1,thickness:1,position:1,anchor:1,scale:1},Kh=function(G){if(!G)return X;if(br(G)){var i=G._40I,k=G._41I;if(!i||!k)return X;var l=Kh(i),A=Kh(k);return l===A?l:X}for(var e=G._parent;br(e)&&!e.ISubGraph;)e=e._parent;return e?e.ISubGraph?e:Kh(e):X},Nh=function(d,N,W,l){var P=N.getStyle(W)*l;P&&as(d,P),P=N.getStyle(W+".left")*l,P&&(d.x-=P,d.width+=P),P=N.getStyle(W+".right")*l,P&&(d.width+=P),P=N.getStyle(W+".top")*l,P&&(d.y-=P,d.height+=P),P=N.getStyle(W+".bottom")*l,P&&(d.height+=P),d.width<0&&(d.width=-d.width,d.x-=d.width),d.height<0&&(d.height=-d.height,d.y-=d.height)},Dh=function(P){for(var d,_=0,l=P.size();l>_;_++)if(d=P.getChildAt(_),mo(d)&&Dh(d))return!0;return P.hasAgentEdges()},Bg=function(D){if(!D)return X;for(var T=D._parent;Tl(T);){if(!Tl(T._parent))return T.isExpanded()?D:T;T.isExpanded()||(D=T),T=T._parent}return D},wp=function(a,d){if(!a||!d)return X;var h,W,x,N=Kh(a),p=Kh(d);if(N!==p){for(;p&&N!==p;)p=Kh(p);if(N===p)return a;h=new jn,h.add(a,0);for(var O=a._parent;mo(O)&&!d.isDescendantOf(O);)h.add(O,0),O=O._parent;for(x=h.size(),W=0;x>W;W++){var L=h.get(W);if(Tl(L)&&!L.isExpanded())return L;if(L.ISubGraph)return L}return a}return a},hr=function(P){if(P.isLooped())return P._source;var p=Bg(P._source),q=Bg(P._target);return p===q?P._source:wp(p,q)},Kb=function(Z){if(Z.isLooped())return Z._target;var c=Bg(Z._source),X=Bg(Z._target);return c===X?Z._target:wp(X,c)},ye=function(F,p,M){"target"!==M&&(M="source");var h="target"===M?p.getTargetAgent():p.getSourceAgent(),i="edge."+M+".";if(br(h)){var y=F.getDataUI(h);y._79o();var J=p.s(i+"index");if(J>=0){var Y=Qi(y);return Y[Math.max(0,Math.min(J,Y.length-1))]}var D=p.s(i+"percent")||0;D=Math.max(0,Math.min(D,1));var k=yp(y);return oq(k,100*D)}return qd(F,h,p.s(i+"position"),p.s(i+"offset.x"),p.s(i+"offset.y"),p.s(i+"anchor.x"),p.s(i+"anchor.y"))},qd=function(y,B,M,r,D,L,n){if(!B)return X;var d,W=B.getRotation?B.getRotation():0;if(L!==p||n!==p){L=L===p?.5:L,n=n===p?.5:n;var w=B.getScale();if(W&&!bn(B,y)||w.x<0||w.y<0){var Q=B.getPosition(),P=B.getWidth(),J=B.getHeight(),Y=B.getAnchor(),E=new mk(W,Q.x,Q.y,w.x,w.y);M=E.tf((L-Y.x)*P,(n-Y.y)*J)}else d=tg(y,B),M={x:d.x+L*d.width,y:d.y+n*d.height}}else M=sc(M,tg(y,B));if(W){var I=t(W),A=T(W),g=r*I-D*A;D=r*A+D*I,r=g}return M.x+=r,M.y+=D,M},Xe=function(R,J){if(!R||!J)return X;var i,K,a,w,h,p;if(R===J){if(w=R.getLoopedEdges(),!w)return X;w=new jn(w)}else{if(h=R.getAgentEdges(),p=J.getAgentEdges(),!h||!p)return X;for(K=h.size(),i=0;K>i;i++)a=h.get(i),p.contains(a)&&(w||(w=new jn),w.add(a))}if(w)for(i=0;i<w.size();i++)a=w.get(i),a.getStyle(Ug)===tk&&(a._22I(X),w.removeAt(i),i--);return w},Zn=function(q,t){var j=Xe(q,t);if(j&&!j.isEmpty()){if(1===j.size())return j.get(0)._22I(X),void 0;var Y=new jn,D=new jn;j.each(function(z){var g=z.s("edge.group");Y.contains(g)||Y.add(g)}),Y.sort(),Y.each(function(P){D.add(new S.EdgeGroup(j.toList(function(U){return P===U.s("edge.group")}),D))}),D.each(function(p){p.each(function(K){K._22I(p)})})}},Ln=function(k,g,f){var e=k._canvas;k._zoom;var h=Bm(g,e),b=Bm(f,e);return{x:h.x-b.x,y:h.y-b.y}},Ag=function(u,s){if(s){var H=s.rect,W=s.color,O=s.rotation,v=s.labelWidth,l=s.background,V=s.opacity,n=s.scale,I=n!=X&&1!==n;if(V!=X){var c=u.globalAlpha;u.globalAlpha*=V}if(O||I){u.save();var G=H.x+H.width/2,B=H.y+H.height/2;Pb(u,G,B),O&&iq(u,O),I&&u.scale(n,n),Pb(u,-G,-B)}if(l&&Ve(u,H.x,H.y,H.width,H.height,l),v){var K=H.width,S=u.createLinearGradient(H.x,H.y,H.x+K,H.y);S.addColorStop(0,W),S.addColorStop(.9,W),S.addColorStop(1,ac),W=S,H.width=v}db(u,s.ss,H,s.font,W,s.align),v&&(H.width=K),(O||I)&&u.restore(),V!=X&&(u.globalAlpha=c)}},Mr=function(D,n){if(n){var k=n.rect,J=k.x,w=k.y,I=k.width,b=k.height,u=n.background,t=n.backgroundImage,s=n.borderWidth,O=n.borderColor,r=n.labelWidth,o=n.opacity,l=n.scale,Z=l!=X&&1!==l;if(o!=X){var N=D.globalAlpha;D.globalAlpha*=o}if(Z){D.save();var Q=k.x+k.width/2,x=k.y+k.height/2;Pb(D,Q,x),D.scale(l,l),Pb(D,-Q,-x)}if(n.expanded){var _=d(8,I/4),i=w+b-8;if(D.fillStyle=u,D.beginPath(),D.moveTo(J,w),D.lineTo(J,i),D.lineTo(J+I/2,i),D.lineTo(J+I/2,w+b),D.lineTo(J+I/2+_,i),D.lineTo(J+I,i),D.lineTo(J+I,w),D.closePath(),D.fill(),s&&(D.lineWidth=s,D.lineJoin="round",D.lineCap="round",O?(D.strokeStyle=O,D.stroke()):(D.strokeStyle=eg(u),D.beginPath(),D.moveTo(J+I,w),D.lineTo(J+I,i),D.lineTo(J+I/2+_,i),D.lineTo(J+I/2,w+b),D.stroke(),D.strokeStyle=Ab(u),D.beginPath(),D.moveTo(J+I,w),D.lineTo(J,w),D.lineTo(J,i),D.lineTo(J+I/2,i),D.lineTo(J+I/2,w+b),D.stroke())),t)ch(D,ir(t),ti,k.x,k.y,k.width,k.height-8,n.data,n.view);else{if(k.height-=8,u=n.color,r){var e=I,a=D.createLinearGradient(J,w,J+e,w);a.addColorStop(0,u),a.addColorStop(.9,u),a.addColorStop(1,ac),u=a,k.width=r}db(D,n.ss,k,n.font,u,n.align),r&&(k.width=e),k.height+=8}}else if(n.icon)tm(D,ir(n.icon),J,w,I,b,n.data,n.view);else{var K=I/2;s&&(D.lineWidth=s,D.lineJoin="round",D.lineCap="round",D.strokeStyle=O?O:eg(u),D.beginPath(),D.arc(J+K,w+K,K,fs,1.6*f,!0),D.moveTo(J+K,w+b),D.lineTo(J+I-K/5,w+K),D.stroke(),D.strokeStyle=O?O:Ab(u),D.beginPath(),D.arc(J+K,w+K,K,1.6*f,fs,!0),D.moveTo(J+K,w+b),D.lineTo(J+K/5,w+K),D.stroke()),D.fillStyle=u,D.beginPath(),D.arc(J+K,w+K,K,0,$,!0),D.moveTo(J+K,w+b),D.lineTo(J+I-K/5,w+K),D.lineTo(J+K/5,w+K),D.closePath(),D.fill(),D.fillStyle=n.color,D.beginPath(),D.arc(J+K,w+K,K/3,0,$,!0),D.fill()}Z&&D.restore(),o!=X&&(D.globalAlpha=N)}},Ro=function(T,h){return h>2*T?T:h/2},Bc=function(s,w,o,L){if(!s||!w)return 0;var K=$g(w.y-s.y,w.x-s.x);return o||(K=w.x<s.x?K+f:K),K+L},wk=function(D,f,L,O,S,v,A){A&&(D.x>f.x||D.x===f.x&&D.y>f.y)&&(L=on[L],S=-S);var Q=sc(L,{x:0,y:0,width:Fb(D,f),height:0},v);return Q.x+=O,Q.y+=S,Q=new mk($g(f.y-D.y,f.x-D.x)).tf(Q),Q.x+=D.x,Q.y+=D.y,Q},yi=function(T,k,A,x,w){if(T._19Q=!0,!A.getEdgeGroup())return x?A.s("edge.gap"):0;if(br(A.getSourceAgent())||br(A.getTargetAgent()))return 0;var n,Q=0,I=0,X=0;if(A.getEdgeGroup().getSiblings().each(function(E){E.each(function(_){if(k.isVisible(_)&&_.s(Ug)==w){var a=_.s("edge.gap");n?(I+=X/2+a/2,X=a):(n=_,X=a),_===A&&(Q=I)}})}),x)return I-Q+X;var h=Q-I/2;return n&&A._40I!==n._40I&&(T._19Q=!1),h},mc=function(L){var E=L._getValidSelection();if(1===E.length){var u=E[0],a=u instanceof S.Edge;if(u instanceof S.Shape||a){if(a){var t=u.s("edge.type");if(t&&"points"!==t)return}var q=L.gv;if((!q.isPointEditable||q.isPointEditable(u))&&q.isEditable(u))return u}}},Pq=function(){var H=function(d){var G=[];return d.forEach(function(m){G.push({x:m.x,y:m.y}),G.push({x:m.x+m.width,y:m.y+m.height}),G.push({x:m.x+m.width,y:m.y}),G.push({x:m.x,y:m.y+m.height})}),G};return function(T,v,z){if("oval"===T){var p=0,R=z.height/z.width,y=R*R,e=z.x+z.width/2,P=z.y+z.height/2,m=H(v);m.forEach(function(R){var w=R.x-e,a=R.y-P,l=w*w+a*a/y;l>p&&(p=l)}),p=B(p);var O=R*p;return{x:e-p,y:P-O,width:2*p,height:2*O}}if("circle"===T){var Y=0,e=z.x+z.width/2,P=z.y+z.height/2,m=H(v);return m.forEach(function(m){var B=m.x-e,W=m.y-P,V=B*B+W*W;V>Y&&(Y=V)}),Y=B(Y),{x:e-Y,y:P-Y,width:2*Y,height:2*Y}}return"roundRect"===T?(as(z,d(z.width,z.height)/16),z):z}}(),Um=S.graph={},Fp=function(c,O,S){Wi(K+".graph."+c,O,S)};S.layout={};var Be={},uh=function(o,r,w,$,R,G,Q,V){var E=Q._zoom;if(E!==Q._cacheZoom&&(Q._cacheZoom=E,Q._cacheImage={}),E*=yh,$=Math.ceil($),R=Math.ceil(R),$*E>2048||R*E>2048)return r;var u=[r.uuid,$,R,w].join("_");if(r.cacheRule){var k;k=Uq(r.cacheRule)?r.cacheRule(G,Q):Qn(r.cacheRule,G,Q),u+="_"+k}var i,b=1;R>=$&&b>$*E?(i=R/$,$=b/E,R=$*i):$>=R&&b>R*E&&(i=$/R,R=b/E,$=R*i),$=Math.ceil($),R=Math.ceil(R);var A=Q._cacheImage[u];if(!A){if(Xf(),A=S.Default.toCanvas(r,$,R,w,G,Q,V,E),!Nj())return r;Q._cacheImage[u]=A}return A};Vm(E,{setImageCacheRule:function(F,a){var g;a||"object"!=typeof F?(g={},g[F]=a):g=F;for(var Z in g){var G=g[Z];tc(Z)?(Wi=ir(Z),Wi?Wi.cacheRule=G:Be[Z]=G):Z.cacheRule=G}}});var $i={comps:[{type:Zi,points:[85,50,70,115,100,71,86,107,88,49,43,56,107,43,55,55,111,116,56,103,43,101,50,81,101,47,76,101,122,116,108,90,117,114,122,122,82,75,84,100,103,79,119,61],borderWidth:1,borderColor:X}]};if($i[zm]=$i[mn]=160,y.Image){var Wg=new y.Image;Wg.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Eq("default_blank",Wg)}Eq("node_image",Qm(30,30,[{type:zo,rect:[4,5,22,16],gradient:Oo,gradientColor:Rk,background:Qd},{type:zo,rect:[2,3,26,20],borderWidth:1,borderColor:Qd},{type:zo,rect:[11,23,8,4],background:Qd},{type:zo,rect:[6,27,18,2],background:Qd}])),Eq("node_icon",Qm(16,16,[{type:zo,rect:[2,2,12,10],gradient:Oo,gradientColor:Rk,background:Qd},{type:sk,rect:[2,2,12,10],width:1,color:Qd},{type:zo,rect:[6,12,4,2],background:Qd},{type:zo,rect:[4,14,8,1],background:Qd}])),Eq("block_icon",Qm(16,16,[{type:sk,rect:[1,1,14,14],width:1,color:Qd}])),Eq("group_image",Qm(66,39,[{type:zo,rect:[44.3,18,18.1,12.8],gradient:Oo,gradientColor:Rk,background:Qd},{type:zo,rect:[3.3,17.8,18.1,12.8],gradient:Oo,gradientColor:Rk,background:Qd},{type:zo,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Qd,gradient:Oo,gradientColor:Rk,background:Qd},{type:zo,rect:[26.2,29.4,12.8,4.2],background:Qd},{type:zo,rect:[21.3,33.5,22.5,2.3],background:Qd},{type:zo,rect:[5.3,32.7,14.1,2.1],background:Qd},{type:zo,rect:[9,30.4,6.7,2.4],background:Qd},{type:zo,rect:[50,30.7,6.7,2.4],background:Qd},{type:zo,rect:[46.3,33,14.1,2.1],background:Qd}])),Eq("group_icon",Qm(16,16,[{type:zo,rect:[4,12,4,2],background:Qd},{type:zo,rect:[2,13,8,1],background:Qd},{type:zo,rect:[12,12,2,1],background:Qd},{type:zo,rect:[11,13,4,1],background:Qd},{type:zo,rect:[10,7,6,5],gradient:Oo,gradientColor:Rk,background:Qd},{type:zo,rect:[1,2,10,10],gradient:Oo,gradientColor:Rk,background:Qd},{type:sk,rect:[1,2,10,10],width:1,color:Qd}])),Eq("refGraph_icon",Qm(16,16,[{type:"shape",borderWidth:1,borderColor:Qd,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Qd,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Eq("edge_icon",Qm(16,16,[{type:zo,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Oo,gradientColor:Rk,background:Qd},{type:zo,rect:[10.8,1,4,4],background:Qd},{type:zo,rect:[1,11,4,4],background:Qd}])),Eq("subGraph_image",Qm(72,45,[{type:Zi,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Oo,gradientColor:Rk,background:Qd},{type:zo,rect:[29.6,30.7,3.6,1.8],background:Qd},{type:zo,rect:[28.4,32.3,6,1.2],background:Qd},{type:zo,rect:[37.3,32,10.8,1.8],background:Qd},{type:zo,rect:[39.1,29.9,7.2,2.3],background:Qd},{type:zo,rect:[26.6,23.7,9.6,7.2],gradient:Oo,gradientColor:Rk,background:Qd},{type:zo,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Qd,gradient:Oo,gradientColor:Rk,background:Qd}])),Eq("subGraph_icon",Qm(17,17,[{type:Zi,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Oo,gradientColor:Rk,background:Qd}])),Eq("shape_icon",Qm(16,16,[{type:Zi,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Qd}])),Eq("polyline_icon",Qm(16,16,[{type:Zi,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Qd},jm(7.5,.4),jm(7.5,6.3),jm(13.6,6.3),jm(13.6,14),jm(.7,13.9),jm(.7,.3)])),Eq("grid_icon",Qm(16,16,[{type:zo,rect:[1,1,4,4],background:Qd,gradient:Oo,gradientColor:Rk},{type:zo,rect:[6,1,4,4],background:Qd,gradient:Oo,gradientColor:Rk},{type:zo,rect:[11,1,4,4],background:Qd,gradient:Oo,gradientColor:Rk},{type:zo,rect:[11,6,4,4],background:Qd,gradient:Oo,gradientColor:Rk},{type:zo,rect:[6,6,4,4],background:Qd,gradient:Oo,gradientColor:Rk},{type:zo,rect:[1,6,4,4],background:Qd,gradient:Oo,gradientColor:Rk},{type:zo,rect:[11,11,4,4],background:Qd,gradient:Oo,gradientColor:Rk},{type:zo,rect:[6,11,4,4],background:Qd,gradient:Oo,gradientColor:Rk},{type:zo,rect:[1,11,4,4],background:Qd,gradient:Oo,gradientColor:Rk}])),Eq("light_icon",Qm(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Qd},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Qd,gradient:Oo,gradientColor:Rk,background:{func:function(j){var U=j?j.s(Tg):X;return Kc(U)?"rgb("+js(255*U[0])+","+js(255*U[1])+","+js(255*U[2])+")":U||Qd}}}])),Eq("text_icon",Qm(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Qd}])),Eq("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Eq("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Eq("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Eq("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Qr=function(u,p,X,N,z,q){var v,j,O,n,c,m,e,i,l,y,r,A=[];if(Math.abs(N)>2*Math.PI&&(N=2*Math.PI),c=Math.ceil(Math.abs(N)/(Math.PI/4)),v=N/c,j=-v,O=-X,c>0){m=u+Math.cos(X)*z,e=p+Math.sin(-X)*q,A.push({x:m,y:e});for(var o=0;c>o;o++)O+=j,n=O-j/2,i=u+Math.cos(O)*z,l=p+Math.sin(O)*q,y=u+Math.cos(n)*(z/Math.cos(j/2)),r=p+Math.sin(n)*(q/Math.cos(j/2)),A.push({x:y,y:r}),A.push({x:i,y:l})}return A},Yq=function(Z){if(Z){var z=Z._data;if(z instanceof S.Shape)return{points:z.getPoints(),segments:z.getSegments()};var M;if(z instanceof S.Edge&&(M=Z._78o)){var F,w,I=M.type,k=M.points,h=M.segments,K=M.edgeTypeInfo;if(!I||k){var j=M.sourcePoint,T=j.x,q=j.y,B=M.targetPoint,y=B.x,H=B.y;if(I)h?(F=new jn({x:T,y:q}),F.addAll(k),F.add({x:y,y:H}),w=new jn(h._as)):(F=new jn({x:T,y:q}),k.each(function(Q){F.add(Q)}),F.add({x:y,y:H}));else if(M.looped){F=new jn(Qr(T,q,0,2*Math.PI,M.radius,M.radius)),w=new jn([1]);for(var W=0;W<(F.size()-1)/2;W++)w.add(3)}else F=new jn,M.center?(F.add({x:M.c1.x,y:M.c1.y}),F.add({x:T,y:q}),F.add({x:y,y:H}),F.add({x:M.c2.x,y:M.c2.y})):(F.add({x:T,y:q}),F.add({x:y,y:H}))}else K&&(F=new jn(K.points._as),K.segments&&(w=new jn(K.segments._as)));return{points:F,segments:w}}}},yp=function(G,L,B){if(null==L){var u=Yq(G);if(!u)return;L=u.points,B=u.segments}if(L){if(Array.isArray(L)&&(L=new jn(L)),"number"==typeof L.get(0)){for(var $=new S.List,x=0;x<L.size();x+=2)$.add({x:L.get(x),y:L.get(x+1)});L=$}if(!B){B=[1];for(var e=L.length-1;e>0;e--)B.push(2)}Array.isArray(B)&&(B=new jn(B));for(var o=fl(L._as,B._as,50),k=o.length,Z=[],x=0;k>x;x++){var y=o[x];y.length>1&&Z.push(y)}return Z}},ks=function(B){for(var U=0,G=B.length-1,M=0;G>M;M++){var P=B[M],A=B[M+1],I=A.x-P.x,J=A.y-P.y;U+=Math.sqrt(I*I+J*J)}return U},Rq=function(R,x){for(var W=0,$=x.length,U=0;$>U;U++){var e=x[U];if(W+=e,W>R)return U}return Math.min(U,$-1)},ul=function(W,c){for(var f=0,P=0,d=0,Y=W.length-1,k=0;Y>k;k++){var U=W[k],H=W[k+1],Z=H.x-U.x,l=H.y-U.y;if(d=Math.sqrt(Z*Z+l*l),f+=d,f>c){f-=d,P=k;break}}var F=W[P],R=W[P+1],N=Math.atan2(R.y-F.y,R.x-F.x),V=c-f,l=Math.sin(N)*V,Z=Math.cos(N)*V;return{x:F.x+Z,y:F.y+l}},oq=function(q,I){if(q){var l;if(0===I)l=q[0][0];else if(100===I)q=q[q.length-1],l=q[q.length-1];else{for(var p=0,E=[],U=q.length,V=0;U>V;V++){var n=q[V],j=ks(n);p+=j,E.push(j)}for(var z=p*I/100,u=Rq(z,E),F=0,Q=0;u>Q;Q++)F+=E[Q];z-=F,l=ul(q[u],z)}return l}},Qi=function(p){var i,j,h,c,y=Yq(p),M=[],r=y.points,S=y.segments,$=-1;for(j=0,h=S?S.length:r.length;h>j;j++){if(i=S?S.get(j):1,3===i)c=2;else if(4===i)c=3;else{if(5===i)continue;c=1}$+=c,M.push(r.get($))}return M},Mq=function(R,c,n,O){function C(g){if(g>=0&&1>=g){K=c(g);var U=(R.x-K.x)*(R.x-K.x)+(R.y-K.y)*(R.y-K.y);return H>U?(H=U,o=g,!0):!1}}n=n||100,O=O||1e-5;for(var H=1/0,o=0,K=new Qf,z=0;n>z;++z)C(z/n);for(var g=1/(2*n);g>O;)C(o-g)||C(o+g)||(g/=2);return o};Vm(E,{_edgeProtectMethod:{getStraightLinePoints:yp,calculateLineLength:ks,calcSegmentIndexByDistance:Rq,calculatePointAlongLine:ul,getPercentPosition:oq,getRealPointsFromDataUI:Qi}});var cr=function(l,E){for(var C=l.vertices,m=0;m<C.length;m++){var t=C[m],s=t.y;t.y=t.z,t.z=-s,E&&(t.y+=E)}},Jc=function(P){for(var z,i,q,E,O,D,_=[],r=[],v=[],Z=P.faces,V=0,J=0,F=0,K=Z.length;K>V;V++,J+=6,F+=9){var t=Z[V];1===t.i?(z||(z=[],i=[],q=[]),Tk(t,V,J,F,P,z,q,i)):2===t.i?(E||(E=[],O=[],D=[]),Tk(t,V,J,F,P,E,D,O)):Tk(t,V,J,F,P,_,v,r)}return{vs:_,uv:r,ns:v,top_vs:z,top_uv:i,top_ns:q,bottom_vs:E,bottom_uv:O,bottom_ns:D}},Tk=function(L,r,p,E,T,d,v,$){var x=T.vertices,e=T.faceVertexUvs,b=x[L.a],q=x[L.b],h=x[L.c];d.push(b.x,b.y,b.z,q.x,q.y,q.z,h.x,h.y,h.z);var F,u,k,R=L.vertexNormals;3===R.length?(F=R[0],u=R[1],k=R[2]):F=u=k=L.normal,v.push(F.x,F.y,F.z,u.x,u.y,u.z,k.x,k.y,k.z);var y=e[0][r][0],Q=e[0][r][1],O=e[0][r][2];$.push(y.x,y.y,Q.x,Q.y,O.x,O.y)},eq=function(){function a($,j){return $.dot(j)>0}function G(o,G,U,p,P,s,R){for(var B,A,c=[G,U,p],e=[P,s,R],H=[],r=c.length,i=!0;r--&&i;){for(var q=c[r],j=e.length,$=!1;j--;)if(q.equals(e[j])){e.splice(j,1),H.push(q),$=!0;break}if(!$){if(B){i=!1;break}B=q}}return i&&2===H.length&&(A=e[0],u.subVectors(B,H[0]),V.subVectors(A,H[0]),J.subVectors(B,H[1]),u.x*J.y*V.z+J.x*V.y*u.z+V.x*u.y*J.z-V.x*J.y*u.z-V.y*J.z*u.x-V.z*J.x*u.y<1e-6&&(W.subVectors(A,H[1]),L.subVectors(H[1],H[0]),a(L,u)&&a(L,V)&&(L.negate(),a(L,J)&&a(L,W))))?(o.push(H[1].x,H[1].y,H[1].z),o.push(B.x,B.y,B.z),o.push(B.x,B.y,B.z),o.push(H[0].x,H[0].y,H[0].z),o.push(H[0].x,H[0].y,H[0].z),o.push(A.x,A.y,A.z),o.push(A.x,A.y,A.z),o.push(H[1].x,H[1].y,H[1].z),2):(o.push(G.x,G.y,G.z),o.push(U.x,U.y,U.z),o.push(U.x,U.y,U.z),o.push(p.x,p.y,p.z),o.push(p.x,p.y,p.z),o.push(G.x,G.y,G.z),1)}function X(){this._vertexMap={},this._lineMap={},this._lineList=[]}function t(O,b,I,x,$,Z,e){var Q=[I,$];O[0]===x&&Q.reverse();var s=[Q[0]._key,Q[1]._key].join("|"),c=O._triangles[s];c||(O._triangles[s]=c={});var F=[Z._key,e._key].join("|");c[F]||(c[F]=[Z,e])}function Z(j,H,l){var P=j._planes[l._key];if(!P)for(var N in j._planes){var c=j._planes[N];if(c._normal.angleTo(l)<.001){P=c;break}}return P?(P._vertices.indexOf(H)<0&&P._vertices.push(H),void 0):(j._planes[l._key]={_normal:l,_vertices:[H]},void 0)}function y(J,h){return 0===h?"0|0|0":1/0===Math.abs(h)?[J.x,J.y,J.z].join("|"):[Math.round(x.angleTo(J)*h),Math.round(P.angleTo(J)*h),Math.round(D.angleTo(J)*h)].join("|")}function T(q,x){var c=q._ctlineModel;if(c||(q._ctlineModel=c=[]),c[0])return c[0];var f;f=Kc(q)?q:[q];var j,V,J,$,B,Q,W,Z,i,a,n,u,m,h,L,E,U,y,A,D=["","top_","bottom_"];c=[];var K=[];for(gn(f,x,K),j=0,V=K.length;V>j;j++)if(a=K[j])for(qn(a),J=0,$=D.length;$>J;J++)if(i=a[D[J]+"lvs"])for(U=c.length,y=i.length,c.length=U+y,A=0;y>A;++A,++U)c[U]=i[A];else if(W=a[D[J]+"vs"]){Z=a[D[J]+"is"],Q=Z?Z.length:W.length/3;for(var B=0;Q-1>B;)Z?(n=Z[B],u=Z[B+1],m=Z[B+2],h=Z[B+3],L=Z[B+4],E=Z[B+5]):(n=B,u=B+1,m=B+2,h=B+3,L=B+4,E=B+5),F.fromArray(W,3*n),v.fromArray(W,3*u),g.fromArray(W,3*m),S.fromArray(W,3*h),C.fromArray(W,3*L),w.fromArray(W,3*E),B+=3*G(c,F,v,g,S,C,w);Q>B&&(Z?(n=Z[B],u=Z[B+1],m=Z[B+2]):(n=B,u=B+1,m=B+2),F.fromArray(W,3*n),v.fromArray(W,3*u),g.fromArray(W,3*m),c.push(F.x,F.y,F.z),c.push(v.x,v.y,v.z),c.push(v.x,v.y,v.z),c.push(g.x,g.y,g.z),c.push(g.x,g.y,g.z),c.push(F.x,F.y,F.z))}return q._ctlineModel[0]=c,c}function N(A,K,L){var V=A._ctlineModel;V||(A._ctlineModel=V=[]);var x=V[1];if(x&&x.epsilon===L)return x;x=[],x.epsilon=L;var d;d=Kc(A)?A:[A];var o,C,N,Y,h,r,E,Z,w,Q,n,e,R=["","top_","bottom_"],M=new X,f=[];for(gn(d,K,f),o=0,C=f.length;C>o;o++)if(w=f[o])for(qn(w),N=0,Y=R.length;Y>N;N++)if(E=w[R[N]+"vs"]){Z=w[R[N]+"is"],r=Z?Z.length:E.length/3;for(var h=0,h=0;r>h;h+=3)Z?(Q=Z[h],n=Z[h+1],e=Z[h+2]):(Q=h,n=h+1,e=h+2),M._addTriangle(E,p,Q,n,e,L)}return M._toLineVS(x),A._ctlineModel[1]=x,x}function R(C,y,m){var k=C._ctlineModel;k||(C._ctlineModel=k=[]);var Z=k[2];if(Z&&Z.epsilon===m)return Z;Z=[],Z.epsilon=m;var i;i=Kc(C)?C:[C];var c,v,G,V,e,a,T,j,H,f,h,P,g,q=["","top_","bottom_"],s=new X,z=[];for(gn(i,y,z),c=0,v=z.length;v>c;c++)if(f=z[c])for(qn(f),G=0,V=q.length;V>G;G++)if(T=f[q[G]+"vs"]){j=f[q[G]+"is"],H=f[q[G]+"ns"],a=j?j.length:T.length/3;for(var e=0,e=0;a>e;e+=3)j?(h=j[e],P=j[e+1],g=j[e+2]):(h=e,P=e+1,g=e+2),s._addTriangle(T,H,h,P,g,m)}return s._toLineVS(Z),C._ctlineModel[2]=Z,Z}var F=new Zh,v=new Zh,g=new Zh,S=new Zh,C=new Zh,w=new Zh,u=new Zh,J=new Zh,V=new Zh,W=new Zh,L=new Zh,K=new Zh;X.prototype._findVertex=function(v,i){K.fromArray(v,3*i);var Y=[K.x,K.y,K.z].join(","),y=this._vertexMap[Y];if(!y){var R=K.clone();R._key=Y,this._vertexMap[Y]=y=R}return y},X.prototype._findLine=function(O,d){var W=[O,d];O._key>d._key&&W.reverse(),W._key=[W[0]._key,W[1]._key].join("|");var Q=this._lineMap[W._key];return Q||(this._lineMap[W._key]=Q=W,W._triangles={},W._planes={},this._lineList.push(W)),Q};var x=new Zh(1,0,0),P=new Zh(0,1,0),D=new Zh(0,0,1),_=new Zh,U=new Zh;return X.prototype._addTriangle=function(f,n,B,F,O,x){var K,k,s,G=this._findVertex(f,B),L=this._findVertex(f,F),p=this._findVertex(f,O),v=this._findLine(G,L),a=this._findLine(L,p),l=this._findLine(p,G);n?(K=(new Zh).fromArray(n,3*B),K._key=y(K,x),k=(new Zh).fromArray(n,3*F),k._key=y(k,x),s=(new Zh).fromArray(n,3*O),s._key=y(s,x),t(v,G,K,L,k,p,s),t(a,L,k,p,s,G,K),t(l,p,s,G,K,L,k)):(U.subVectors(p,L),_.subVectors(L,G),K=(new Zh).crossVectors(_,U),K._key=y(K,x),Z(v,p,K),Z(a,G,K),Z(l,L,K))},X.prototype._toLineVS=function(c){for(var r=this._lineList,s=0,t=r.length;t>s;++s){var j=r[s],L=!1;for(var u in j._triangles)if(1==b.keys(j._triangles[u]).length){c.push(j[0].x,j[0].y,j[0].z,j[1].x,j[1].y,j[1].z),L=!0;break}if(!L)for(var V in j._planes)if(1==j._planes[V]._vertices.length){c.push(j[0].x,j[0].y,j[0].z,j[1].x,j[1].y,j[1].z),L=!0;break}}},[T,N,R]}(),Yo=function(Z,W){var a=Z._lineModel;if(a)return a;var G;G=Kc(Z)?Z:[Z];var K,e,Y,D,z,m,f,H,g,N,v,h,P=["","top_","bottom_"];a=[];var A=[];for(gn(Z,W,A),K=0,e=A.length;e>K;K++)if(g=A[K])for(Y=0,D=P.length;D>Y;Y++)if(f=g[P[Y]+"vs"]){H=g[P[Y]+"is"],m=H?H.length:f.length/3;for(var z=0;m>z;z+=3)H?(N=H[z],v=H[z+1],h=H[z+2]):(N=z,v=z+1,h=z+2),N*=3,v*=3,h*=3,a.push(f[N],f[N+1],f[N+2],f[v],f[v+1],f[v+2],f[v],f[v+1],f[v+2],f[h],f[h+1],f[h+2],f[h],f[h+1],f[h+2],f[N],f[N+1],f[N+2])}return Z._lineModel=a,a},Pe=function(f,v,a,G,t,y,l,J,m,i){a==X&&(a=!0),G==X&&(G=!0),l==X&&(l=1),J==X&&(J=0);var S=new ki;_g(S,f,v,m),S=S.toShapes();var D=p;return i&&(i.length?D={minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]}:(D={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},S.forEach(function(O){var L=O.getBoundingBox();D.minX=d(L.minX,D.minX),D.minY=d(L.minY,D.minY),D.maxX=P(L.maxX,D.maxX),D.maxY=P(L.maxY,D.maxY)}))),Jc(new Oq(S,{top:a,bottom:G,curveSegments:t,amount:l,repeatUVLength:y,boundingBox:D},-l/2+J))},Zk=function(C,f){this.repeatUVLength=C,this._bb=f};Zk.prototype={generateTopUV:function(j,h,k,q,y,l,t){var a,i,m,s,D=j.vertices,S=D[q].x,K=D[q].y,X=D[y].x,n=D[y].y,A=D[l].x,H=D[l].y,O=this.repeatUVLength;if(O)a=0,i=0,m=O,s=O;else{this._bb||(this._bb=h.getBoundingBox());var V=this._bb;a=V.minX,i=V.minY,m=V.maxX-a,s=V.maxY-i}return t?[new So((S-a)/m,(K-i)/s),new So((X-a)/m,(n-i)/s),new So((A-a)/m,(H-i)/s)]:[new So((S-a)/m,1-(K-i)/s),new So((X-a)/m,1-(n-i)/s),new So((A-a)/m,1-(H-i)/s)]},generateBottomUV:function(U,N,T,q,Q,u){return this.generateTopUV(U,N,T,q,Q,u,!0)},generateSideWallUV:function(i,p,q,n,Y,X,W,t,$,L,M,J){if(!this._cl){for(var g,Z,w=[],r=0,H=q.length,S=0;H>S;S++){g=q[S],Z=q[(S+1)%H];var K=g.x-Z.x,j=g.y-Z.y,C=B(K*K+j*j);w.push(r),r+=C}for(var S=0;H>S;S++)w[S]/=r;this._cl=w}var w=this._cl,D=1-$/L,m=1-($+1)/L,s=w[M],y=w[J];return y>s&&(s+=1),[new So(s,D),new So(y,D),new So(y,m),new So(s,m)]}};var Fq=function(C,J,c,P,D,q){this.a=C,this.b=J,this.c=c,this.i=q,this.normal=P instanceof Ph?P:new Ph,this.vertexNormals=P instanceof Array?P:[]};Fq.prototype={constructor:Fq};var _k=[-8,14,-4,15,0,6,3,6,-1],vf=function(){if(vf[kj]!=X)return vf[kj];for(var s=Fe[kj],M=_k,u=$m.prototype.getClassName(),K='"',G=0,v="",J=!1,d=+new(y[u.substr(3,3)+$n[G]]),I=G;I<M.length;I++){var S=M.length-I;v+=I%2===G?M[I]+S+"":M[I]-S+""}for(var I=G;4>I;I++)v+=G;if(v=v*v.length/v.length,d>v){if(s&&s[G]&&s[4/zo.length]){for(var m,Y,E,F,B,n,W,g,D=s[0],l=s[1],i="",V=0,I=0;I<l.length;I++)l[I]===K?g?(g=!1,0!==V%2&&(m==X?m=i:Y==X?Y=i:E==X?E=i:F==X?F=i:B==X?B=i:n==X?n=i:W==X&&(W=i)),V++,i=""):g=!0:g&&(i+=l[I]);for(var x,c,h,j="",p=0,I=0;I<D.length;I++)D[I]===K?x?(x=!1,0!==p%2&&(c==X?c=j:h==X&&(h=j)),p++,j=""):x=!0:x&&(j+=D[I]);var o=m+Y+E+F+B+n,r=!n||n===wg;if(!r&&n)for(var O,I=0,k=n.length;k>I;I++)n[I]===vh[4]?O===wg?r=jb:O[0]===rq[7]&&wg&&wg.indexOf(O.substr(1))>=0?r=tj:O=X:(O==X?O=n[I]:O+=n[I],I===k-1&&(O===wg?r=jb:O[0]===rq[7]&&wg&&wg.indexOf(O.substr(1))>=0&&(r=tj)));(J=lm(o,W)&&lm(c,h)&&c===m&&r&&(!B||B>d))&&E.indexOf(An[0])>=0&&(vf[An[0]]=1),J&&E.indexOf(1)>=0&&(vf[1]=1),J&&E.indexOf(3)>=0&&(vf[2]=1),J&&E.indexOf(4)>=0&&(vf[3]=1),J&&E.indexOf(7)>=0&&(vf[4]=1)}}else J=!0,vf[An[0]]=vf[1]=vf[2]=vf[3]=vf[4]=1;return vf[kj]=J,J},qh=function(){},xd=qh.prototype;xd.getPointAt=function(k){var Z=this.getUtoTmapping(k);return this.getPoint(Z)},xd.getPoints=function(d){d||(d=5);var A,E=[];for(A=0;d>=A;A++)E.push(this.getPoint(A/d));return E},xd.getSpacedPoints=function(v){v||(v=5);var Y,b=[];for(Y=0;v>=Y;Y++)b.push(this.getPointAt(Y/v));return b},xd.getLength=function(){var J=this.getLengths();return J[J.length-1]},xd.getLengths=function(W){if(W||(W=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==W+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var g,o,M=[],Q=this.getPoint(0),d=0;for(M.push(0),o=1;W>=o;o++)g=this.getPoint(o/W),d+=g.distanceTo(Q),M.push(d),Q=g;return this.cacheArcLengths=M,M},xd.getUtoTmapping=function(t,R){var j,K=this.getLengths(),k=0,F=K.length;j=R?R:t*K[F-1];for(var o,q=0,d=F-1;d>=q;)if(k=x(q+(d-q)/2),o=K[k]-j,0>o)q=k+1;else{if(!(o>0)){d=k;break}d=k-1}if(k=d,K[k]==j){var b=k/(F-1);return b}var i=K[k],G=K[k+1],M=G-i,w=(j-i)/M,b=(k+w)/(F-1);return b},xd.getTangent=function(d){var Z=1e-4,Y=d-Z,f=d+Z;0>Y&&(Y=0),f>1&&(f=1);var v=this.getPoint(Y),K=this.getPoint(f),h=K.clone().sub(v);return h.normalize()},xd.getTangentAt=function(P){var A=this.getUtoTmapping(P);return this.getTangent(A)},qh.create=function(W,X){return W.prototype=Xi(qh.prototype),W.prototype.getPoint=X,W};var Bf=function(){this.curves=[],this.autoClose=!1},jf=Bf.prototype=Xi(xd);
jf.add=function(o){this.curves.push(o)},jf.closePath=function(){var B=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);B.equals(n)||this.curves.push(new Bn(n,B))},jf.getPoint=function(y){for(var S,h,b=y*this.getLength(),m=this.getCurveLengths(),A=0;A<m.length;){if(m[A]>=b){S=m[A]-b,h=this.curves[A];var D=1-S/h.getLength();return h.getPointAt(D)}A++}return null},jf.getLength=function(){var P=this.getCurveLengths();return P[P.length-1]},jf.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var n,U=[],j=0,V=this.curves.length;for(n=0;V>n;n++)j+=this.curves[n].getLength(),U.push(j);return this.cacheLengths=U,U},jf.getTransformedPoints=function(_){return this.getPoints(_)},jf.getBoundingBox=function(){var v,b,y,j,u,C,P=this.getPoints();v=b=Number.NEGATIVE_INFINITY,j=u=Number.POSITIVE_INFINITY;var c,d,M,q,k=P[0]instanceof Ph;for(q=k?new Ph:new So,d=0,M=P.length;M>d;d++)c=P[d],c.x>v&&(v=c.x),c.x<j&&(j=c.x),c.y>b&&(b=c.y),c.y<u&&(u=c.y),k&&(c.z>y&&(y=c.z),c.z<C&&(C=c.z)),q.add(c);var l={minX:j,minY:u,maxX:v,maxY:b};return k&&(l.maxZ=y,l.minZ=C),l};var Hn=function(R){Bf.call(this),this.actions=[],R&&this.fromPoints(R)},Ec=Hn.prototype=Xi(Bf.prototype),Hl="moveTo",_h="lineTo",Ml="quadraticCurveTo",Re="bezierCurveTo",Ib="arc",ai="ellipse";Ec.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var b=1,c=e.length;c>b;b++)this.lineTo(e[b].x,e[b].y)},Ec.moveTo=function(){var v=Array.prototype.slice.call(arguments);this.actions.push({action:Hl,args:v})},Ec.lineTo=function(j,W){var V=Array.prototype.slice.call(arguments),F=this.actions[this.actions.length-1].args,$=F[F.length-2],c=F[F.length-1],E=new Bn(new So($,c),new So(j,W));this.curves.push(E),this.actions.push({action:_h,args:V})},Ec.quadraticCurveTo=function(t,Y,F,a){var z=Array.prototype.slice.call(arguments),I=this.actions[this.actions.length-1].args,B=I[I.length-2],k=I[I.length-1],o=new to(new So(B,k),new So(t,Y),new So(F,a));this.curves.push(o),this.actions.push({action:Ml,args:z})},Ec.bezierCurveTo=function(n,x,L,F,a,V){var Y=Array.prototype.slice.call(arguments),E=this.actions[this.actions.length-1].args,X=E[E.length-2],C=E[E.length-1],Z=new lb(new So(X,C),new So(n,x),new So(L,F),new So(a,V));this.curves.push(Z),this.actions.push({action:Re,args:Y})},Ec.arc=function(N,g,E,z,V,L){var R=this.actions[this.actions.length-1].args,B=R[R.length-2],Z=R[R.length-1];this.absarc(N+B,g+Z,E,z,V,L)},Ec.absarc=function(P,D,H,i,a,J){this.absellipse(P,D,H,H,i,a,J)},Ec.ellipse=function(B,E,z,w,I,u,J){var C=this.actions[this.actions.length-1].args,$=C[C.length-2],H=C[C.length-1];this.absellipse(B+$,E+H,z,w,I,u,J)},Ec.absellipse=function(w,t,$,X,L,W,c){var Q=Array.prototype.slice.call(arguments),I=new Jp(w,t,$,X,L,W,c);this.curves.push(I);var T=I.getPoint(1);Q.push(T.x),Q.push(T.y),this.actions.push({action:ai,args:Q})},Ec.getSpacedPoints=function(H){H||(H=40);for(var d=[],J=0;H>J;J++)d.push(this.getPoint(J/H));return d},Ec.getPoints=function(X,q){X=X||12;var j,z,w,N,x,Y,A,M,P,H,m,O,R,B,E,D,V,p,S=[];for(j=0,z=this.actions.length;z>j;j++)switch(w=this.actions[j],N=w.action,x=w.args,N){case Hl:S.push(new So(x[0],x[1]));break;case _h:S.push(new So(x[0],x[1]));break;case Ml:for(Y=x[2],A=x[3],H=x[0],m=x[1],S.length>0?(B=S[S.length-1],O=B.x,R=B.y):(B=this.actions[j-1].args,O=B[B.length-2],R=B[B.length-1]),E=1;X>=E;E++)D=E/X,V=xg.b2(D,O,H,Y),p=xg.b2(D,R,m,A),S.push(new So(V,p));break;case Re:for(Y=x[4],A=x[5],H=x[0],m=x[1],M=x[2],P=x[3],S.length>0?(B=S[S.length-1],O=B.x,R=B.y):(B=this.actions[j-1].args,O=B[B.length-2],R=B[B.length-1]),E=1;X>=E;E++)D=E/X,V=xg.b3(D,O,H,M,Y),p=xg.b3(D,R,m,P,A),S.push(new So(V,p));break;case Ib:var h,J=x[0],F=x[1],d=x[2],W=x[3],l=x[4],y=!!x[5],i=l-W,o=2*X;for(E=1;o>=E;E++)D=E/o,y||(D=1-D),h=W+D*i,V=J+d*t(h),p=F+d*T(h),S.push(new So(V,p));break;case ai:var h,J=x[0],F=x[1],Z=x[2],s=x[3],W=x[4],l=x[5],y=!!x[6],i=l-W,o=2*X;for(E=1;o>=E;E++)D=E/o,y||(D=1-D),h=W+D*i,V=J+Z*t(h),p=F+s*T(h),S.push(new So(V,p))}var f,L,I=G["shape3d.point.epsilon"],c=!1;for(z=S.length,j=0,z=S.length;z>j;j++)f=S[j],L=j===z-1?S[0]:S[j+1],f&&L&&a(f.x-L.x)<I&&a(f.y-L.y)<I&&(c=!0,S[j]=null);if(c){var g=[];for(j=0;z>j;j++)S[j]&&g.push(S[j]);S=g}return q&&S.push(S[0]),S},Ec.toShapes=function(W,D){function v(k){var b,C,e,w,P,S=[],U=new Hn;for(b=0,C=k.length;C>b;b++)e=k[b],P=e.args,w=e.action,w==Hl&&0!=U.actions.length&&(S.push(U),U=new Hn),U[w].apply(U,P);return 0!=U.actions.length&&S.push(U),S}function K(U){for(var y=[],A=0,I=U.length;I>A;A++){var K=U[A],L=new ki;L.actions=K.actions,L.curves=K.curves,y.push(L)}return y}function P(j,P){for(var i=1e-10,Z=P.length,F=!1,n=Z-1,Y=0;Z>Y;n=Y++){var p=P[n],s=P[Y],$=s.x-p.x,B=s.y-p.y;if(a(B)>i){if(0>B&&(p=P[Y],$=-$,s=P[n],B=-B),j.y<p.y||j.y>s.y)continue;if(j.y==p.y){if(j.x==p.x)return!0}else{var u=B*(j.x-p.x)-$*(j.y-p.y);if(0==u)return!0;if(0>u)continue;F=!F}}else{if(j.y!=p.y)continue;if(s.x<=j.x&&j.x<=p.x||p.x<=j.x&&j.x<=s.x)return!0}}return F}var x=v(this.actions);if(0==x.length)return[];if(D===!0)return K(x);var A,O,t,M=[];if(1==x.length)return O=x[0],t=new ki,t.actions=O.actions,t.curves=O.curves,M.push(t),M;var Y=!xg.isClockWise(x[0].getPoints());Y=W?!Y:Y;var Q,z=[],o=[],n=[],d=0;o[d]=p,n[d]=[];var r,f;for(r=0,f=x.length;f>r;r++)O=x[r],Q=O.getPoints(),A=xg.isClockWise(Q),A=W?!A:A,A?(!Y&&o[d]&&d++,o[d]={s:new ki,p:Q},o[d].s.actions=O.actions,o[d].s.curves=O.curves,Y&&d++,n[d]=[]):n[d].push({h:O,p:Q[0]});if(!o[0])return K(x);if(o.length>1){for(var L=!1,E=[],R=0,b=o.length;b>R;R++)z[R]=[];for(var R=0,b=o.length;b>R;R++){o[R];for(var c=n[R],w=0;w<c.length;w++){for(var h=c[w],_=!0,J=0;J<o.length;J++)P(h.p,o[J].p)&&(R!=J&&E.push({froms:R,tos:J,hole:w}),_?(_=!1,z[J].push(h)):L=!0);_&&z[R].push(h)}}E.length>0&&(L||(n=z))}var l,m,i;for(r=0,f=o.length;f>r;r++)for(t=o[r].s,M.push(t),l=n[r],m=0,i=l.length;i>m;m++)t.holes.push(l[m].h);return M};var ki=function(){Hn.apply(this,arguments),this.holes=[]},ld=ki.prototype=Xi(Ec);ld.getPointsHoles=function(b){var V,X=this.holes.length,T=[];for(V=0;X>V;V++)T[V]=this.holes[V].getTransformedPoints(b);return T},ld.extractAllPoints=function(D){return{shape:this.getTransformedPoints(D),holes:this.getPointsHoles(D)}},ld.extractPoints=function(p){return this.extractAllPoints(p)};var xg={triangulateShape:function(i,B){function t(i,f,D){return i.x!=f.x?i.x<f.x?i.x<=D.x&&D.x<=f.x:f.x<=D.x&&D.x<=i.x:i.y<f.y?i.y<=D.y&&D.y<=f.y:f.y<=D.y&&D.y<=i.y}function D(J,Z,C,d,k){var P=1e-10,T=Z.x-J.x,i=Z.y-J.y,y=d.x-C.x,r=d.y-C.y,h=J.x-C.x,c=J.y-C.y,R=i*y-T*r,f=i*h-T*c;if(a(R)>P){var b;if(R>0){if(0>f||f>R)return[];if(b=r*h-y*c,0>b||b>R)return[]}else{if(f>0||R>f)return[];if(b=r*h-y*c,b>0||R>b)return[]}if(0==b)return!k||0!=f&&f!=R?[J]:[];if(b==R)return!k||0!=f&&f!=R?[Z]:[];if(0==f)return[C];if(f==R)return[d];var I=b/R;return[{x:J.x+I*T,y:J.y+I*i}]}if(0!=f||r*h!=y*c)return[];var U=0==T&&0==i,Y=0==y&&0==r;if(U&&Y)return J.x!=C.x||J.y!=C.y?[]:[J];if(U)return t(C,d,J)?[J]:[];if(Y)return t(J,Z,C)?[C]:[];var j,q,l,n,o,w,K,$;return 0!=T?(J.x<Z.x?(j=J,l=J.x,q=Z,n=Z.x):(j=Z,l=Z.x,q=J,n=J.x),C.x<d.x?(o=C,K=C.x,w=d,$=d.x):(o=d,K=d.x,w=C,$=C.x)):(J.y<Z.y?(j=J,l=J.y,q=Z,n=Z.y):(j=Z,l=Z.y,q=J,n=J.y),C.y<d.y?(o=C,K=C.y,w=d,$=d.y):(o=d,K=d.y,w=C,$=C.y)),K>=l?K>n?[]:n==K?k?[]:[o]:$>=n?[o,q]:[o,w]:l>$?[]:l==$?k?[]:[j]:$>=n?[j,q]:[j,w]}function c(E,O,r,y){var K=1e-10,T=O.x-E.x,B=O.y-E.y,V=r.x-E.x,N=r.y-E.y,f=y.x-E.x,c=y.y-E.y,p=T*N-B*V,o=T*c-B*f;if(a(p)>K){var l=f*N-c*V;return p>0?o>=0&&l>=0:o>=0||l>=0}return o>0}function O(T,l){function I(q,B){var S=U.length-1,A=q-1;0>A&&(A=S);var d=q+1;d>S&&(d=0);var Y=c(U[q],U[A],U[d],t[B]);if(!Y)return!1;var z=t.length-1,N=B-1;0>N&&(N=z);var u=B+1;return u>z&&(u=0),Y=c(t[B],t[N],t[u],U[q]),Y?!0:!1}function P(u,p){var l,T,Q;for(l=0;l<U.length;l++)if(T=l+1,T%=U.length,Q=D(u,p,U[l],U[T],!0),Q.length>0)return!0;return!1}function f(d,W){var I,V,N,u,J;for(I=0;I<F.length;I++)for(V=l[F[I]],N=0;N<V.length;N++)if(u=N+1,u%=V.length,J=D(d,W,V[N],V[u],!0),J.length>0)return!0;return!1}for(var t,M,Q,W,u,q,o,g,b,O,N,U=T.concat(),F=[],r=[],R=0,E=l.length;E>R;R++)F.push(R);for(var H=0,j=2*F.length;F.length>0&&(j--,!(0>j));)for(Q=H;Q<U.length;Q++){W=U[Q],M=-1;for(var R=0;R<F.length;R++)if(q=F[R],o=W.x+":"+W.y+":"+q,r[o]===p){t=l[q];for(var s=0;s<t.length;s++)if(u=t[s],I(Q,s)&&!P(W,u)&&!f(W,u)){M=s,F.splice(R,1),g=U.slice(0,Q+1),b=U.slice(Q),O=t.slice(M),N=t.slice(0,M+1),U=g.concat(O).concat(N).concat(b),H=Q;break}if(M>=0)break;r[o]=!0}if(M>=0)break}return U}for(var d,Q,W,y,K,_,v={},M=i.concat(),u=0,X=B.length;X>u;u++)Array.prototype.push.apply(M,B[u]);for(d=0,Q=M.length;Q>d;d++)K=M[d].x+":"+M[d].y,v[K]!==p,v[K]=d;var R=O(i,B),w=dq.Triangulate(R,!1);for(d=0,Q=w.length;Q>d;d++)for(y=w[d],W=0;3>W;W++)K=y[W].x+":"+y[W].y,_=v[K],_!==p&&(y[W]=_);return w.concat()},isClockWise:function(q){return dq.Triangulate.area(q)<0},b2p0:function(o,w){var T=1-o;return T*T*w},b2p1:function(I,_){return 2*(1-I)*I*_},b2p2:function(i,$){return i*i*$},b2:function(y,K,c,O){return this.b2p0(y,K)+this.b2p1(y,c)+this.b2p2(y,O)},b3p0:function(G,j){var H=1-G;return H*H*H*j},b3p1:function(v,C){var l=1-v;return 3*l*l*v*C},b3p2:function(Y,S){var h=1-Y;return 3*h*Y*Y*S},b3p3:function(p,G){return p*p*p*G},b3:function(I,C,h,t,P){return this.b3p0(I,C)+this.b3p1(I,h)+this.b3p2(I,t)+this.b3p3(I,P)}},dq={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var T=b.keys(this.faces);return T.length?T[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(G){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(E){var L=E.familyName.toLowerCase(),t=this;return t.faces[L]=t.faces[L]||{},t.faces[L][E.cssFontWeight]=t.faces[L][E.cssFontWeight]||{},t.faces[L][E.cssFontWeight][E.cssFontStyle]=E,E},drawText:function(A){var c,e=this.getFace(),s=this.size/e.resolution,p=0,Q=String(A).split(""),j=Q.length,S=[];for(c=0;j>c;c++){var X=new Hn,P=this.extractGlyphPoints(Q[c],e,s,p,X);P&&(p+=P.offset*this.spacing,S.push(P.path))}var t=p/2;return{paths:S,offset:t}},extractGlyphPoints:function(P,w,U,$,d){var D,f,l,K,M,B,y,S,j,F,I,Q,X,i,c,Y,q,r,W,x=[],H=w.glyphs[P]||w.glyphs["?"];if(H){if(H.o)for(K=H._cachedOutline||(H._cachedOutline=H.o.split(" ")),B=K.length,y=U,S=U,D=0;B>D;)switch(M=K[D++]){case"m":j=K[D++]*y+$,F=K[D++]*S,d.moveTo(j,F);break;case"l":j=K[D++]*y+$,F=K[D++]*S,d.lineTo(j,F);break;case"q":if(I=K[D++]*y+$,Q=K[D++]*S,c=K[D++]*y+$,Y=K[D++]*S,d.quadraticCurveTo(c,Y,I,Q),W=x[x.length-1])for(X=W.x,i=W.y,f=1,l=this.divisions;l>=f;f++){var Z=f/l;xg.b2(Z,X,c,I),xg.b2(Z,i,Y,Q)}break;case"b":if(I=K[D++]*y+$,Q=K[D++]*S,c=K[D++]*y+$,Y=K[D++]*S,q=K[D++]*y+$,r=K[D++]*S,d.bezierCurveTo(c,Y,q,r,I,Q),W=x[x.length-1])for(X=W.x,i=W.y,f=1,l=this.divisions;l>=f;f++){var Z=f/l;xg.b3(Z,X,c,q,I),xg.b3(Z,i,Y,r,Q)}}return{offset:H.ha*U,path:d}}}};dq.generateShapes=function(C,q){q=q||{};var x=q.font;if(x===p&&(x=dq.getDefaultFont(),!x))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var n=q.size!==p?q.size:1,L=q.curveSegments!==p?q.curveSegments:4,e=q.spacing!==p?q.spacing:1,c=q.weight!==p?q.weight:"normal",D=q.style!==p?q.style:"normal";dq.size=n,dq.divisions=L,dq.face=x,dq.weight=c,dq.style=D,dq.spacing=e;for(var B=dq.drawText(C),S=B.paths,d=[],z=0,H=S.length;H>z;z++)Array.prototype.push.apply(d,S[z].toShapes());return d},function(h){var g=1e-10,_=function(N,X){var V=N.length;if(3>V)return null;var G,U,a,n=[],x=[],C=[];if(L(N)>0)for(U=0;V>U;U++)x[U]=U;else for(U=0;V>U;U++)x[U]=V-1-U;var P=V,R=2*P;for(U=P-1;P>2;){if(R--<=0)return X?C:n;if(G=U,G>=P&&(G=0),U=G+1,U>=P&&(U=0),a=U+1,a>=P&&(a=0),o(N,G,U,a,P,x)){var E,c,Z,p,S;for(E=x[G],c=x[U],Z=x[a],n.push([N[E],N[c],N[Z]]),C.push([x[G],x[U],x[a]]),p=U,S=U+1;P>S;p++,S++)x[p]=x[S];P--,R=2*P}}return X?C:n},L=function(t){for(var o=t.length,U=0,Q=o-1,w=0;o>w;Q=w++)U+=t[Q].x*t[w].y-t[w].x*t[Q].y;return.5*U},o=function(v,I,M,o,R,p){var P,E,K,t,T,G,j,q,B;if(E=v[p[I]].x,K=v[p[I]].y,t=v[p[M]].x,T=v[p[M]].y,G=v[p[o]].x,j=v[p[o]].y,g>(t-E)*(j-K)-(T-K)*(G-E))return!1;var u,c,b,Y,L,s,Z,F,$,Q,n,r,U,f,S;for(u=G-t,c=j-T,b=E-G,Y=K-j,L=t-E,s=T-K,P=0;R>P;P++)if(q=v[p[P]].x,B=v[p[P]].y,!(q===E&&B===K||q===t&&B===T||q===G&&B===j)&&(Z=q-E,F=B-K,$=q-t,Q=B-T,n=q-G,r=B-j,S=u*Q-c*$,U=L*F-s*Z,f=b*r-Y*n,S>=-g&&f>=-g&&U>=-g))return!1;return!0};return h.Triangulate=_,h.Triangulate.area=L,h}(dq),y._typeface_js={faces:dq.faces,loadFace:dq.loadFace};var al=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},kf=al.prototype={constructor:al,computeFaceNormals:function(){for(var d=new Ph,a=new Ph,U=0,G=this.faces.length;G>U;U++){var K=this.faces[U],Z=this.vertices[K.a],N=this.vertices[K.b],p=this.vertices[K.c];d.subVectors(p,N),a.subVectors(Z,N),d.cross(a),d.normalize(),K.normal.copy(d)}},computeVertexNormals:function(r){var b,L,T,M,Z,S;for(S=new Array(this.vertices.length),b=0,L=this.vertices.length;L>b;b++)S[b]=new Ph;if(r){var _,j,C,i=new Ph,N=new Ph;for(T=0,M=this.faces.length;M>T;T++)Z=this.faces[T],_=this.vertices[Z.a],j=this.vertices[Z.b],C=this.vertices[Z.c],i.subVectors(C,j),N.subVectors(_,j),i.cross(N),S[Z.a].add(i),S[Z.b].add(i),S[Z.c].add(i)}else for(T=0,M=this.faces.length;M>T;T++)Z=this.faces[T],S[Z.a].add(Z.normal),S[Z.b].add(Z.normal),S[Z.c].add(Z.normal);for(b=0,L=this.vertices.length;L>b;b++)S[b].normalize();for(T=0,M=this.faces.length;M>T;T++)Z=this.faces[T],Z.vertexNormals[0]=S[Z.a].clone(),Z.vertexNormals[1]=S[Z.b].clone(),Z.vertexNormals[2]=S[Z.c].clone()},mergeVertices:function(){var L,l,S,j,k,g,V,o,Q={},T=[],b=[],G=4,J=N(10,G);for(S=0,j=this.vertices.length;j>S;S++)L=this.vertices[S],l=s(L.x*J)+"_"+s(L.y*J)+"_"+s(L.z*J),Q[l]===p?(Q[l]=S,T.push(this.vertices[S]),b[S]=T.length-1):b[S]=b[Q[l]];var E=[];for(S=0,j=this.faces.length;j>S;S++){k=this.faces[S],k.a=b[k.a],k.b=b[k.b],k.c=b[k.c],g=[k.a,k.b,k.c];for(var H=0;3>H;H++)if(g[H]==g[(H+1)%3]){E.push(S);break}}for(S=E.length-1;S>=0;S--){var q=E[S];for(this.faces.splice(q,1),V=0,o=this.faceVertexUvs.length;o>V;V++)this.faceVertexUvs[V].splice(q,1)}var t=this.vertices.length-T.length;return this.vertices=T,t}},Jp=function(O,K,I,L,z,V,A){this.aX=O,this.aY=K,this.xRadius=I,this.yRadius=L,this.aStartAngle=z,this.aEndAngle=V,this.aClockwise=A};Jp.prototype=Xi(xd),Jp.prototype.getPoint=function(i){var V,A=this.aEndAngle-this.aStartAngle;0>A&&(A+=$),A>$&&(A-=$),V=this.aClockwise===!0?this.aEndAngle+(1-i)*($-A):this.aStartAngle+i*A;var c=this.aX+this.xRadius*t(V),M=this.aY+this.yRadius*T(V);return new So(c,M)};var Bn=function(r,O){this.v1=r,this.v2=O},Yg=Bn.prototype=Xi(xd);Yg.getPoint=function(A){var k=this.v2.clone().sub(this.v1);return k.multiplyScalar(A).add(this.v1),k},Yg.getPointAt=function(J){return this.getPoint(J)},Yg.getTangent=function(){var Q=this.v2.clone().sub(this.v1);return Q.normalize()};var to=function(P,Z,K){this.v0=P,this.v1=Z,this.v2=K};to.prototype=Xi(xd),to.prototype.getPoint=function(p){var w,h;return w=xg.b2(p,this.v0.x,this.v1.x,this.v2.x),h=xg.b2(p,this.v0.y,this.v1.y,this.v2.y),new So(w,h)};var lb=function(Y,P,o,$){this.v0=Y,this.v1=P,this.v2=o,this.v3=$};lb.prototype=Xi(xd),lb.prototype.getPoint=function(F){var s,U;return s=xg.b3(F,this.v0.x,this.v1.x,this.v2.x,this.v3.x),U=xg.b3(F,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new So(s,U)},qh.create(function(w,h){this.v1=w,this.v2=h},function(W){var F=new Ph;return F.subVectors(this.v2,this.v1),F.multiplyScalar(W),F.add(this.v1),F});var fh=qh.create(function(X,x,z){this.v0=X,this.v1=x,this.v2=z},function(R){var g,h,I;return g=xg.b2(R,this.v0.x,this.v1.x,this.v2.x),h=xg.b2(R,this.v0.y,this.v1.y,this.v2.y),I=xg.b2(R,this.v0.z,this.v1.z,this.v2.z),new Ph(g,h,I)}),ck=qh.create(function(S,r,C,F){this.v0=S,this.v1=r,this.v2=C,this.v3=F},function(K){var F,G,A;return F=xg.b3(K,this.v0.x,this.v1.x,this.v2.x,this.v3.x),G=xg.b3(K,this.v0.y,this.v1.y,this.v2.y,this.v3.y),A=xg.b3(K,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Ph(F,G,A)}),Yc=function(v,O,S,y,D,G,d,Q){al.call(this),y=y!==p?y:.5,D=D!==p?D:.5,Q=Q!==p?Q:1,v=v||8,G=G||0,d=d||$;var e,o,w=1,f=Q/2,c=[],E=[],V=this.vertices,A=this.faces,s=this.faceVertexUvs;for(o=0;w>=o;o++){var h=[],u=[],j=o/w,Y=j*(D-y)+y;for(e=0;v>=e;e++){var l=e/v,Z=new Ph,I=-(l*d+G);Z.z=Y*T(I),Z.y=-j*Q+f,Z.x=Y*t(I),V.push(Z),h.push(V.length-1),u.push(new So(l,j))}c.push(h),E.push(u)}var H,W,P=(D-y)/Q;for(e=0;v>e;e++)for(0!==y?(H=V[c[0][e]].clone(),W=V[c[0][e+1]].clone()):(H=V[c[1][e]].clone(),W=V[c[1][e+1]].clone()),H.setY(B(H.x*H.x+H.z*H.z)*P).normalize(),W.setY(B(W.x*W.x+W.z*W.z)*P).normalize(),o=0;w>o;o++){var i=c[o][e],F=c[o+1][e],U=c[o+1][e+1],a=c[o][e+1],q=H.clone(),K=H.clone(),X=W.clone(),J=W.clone(),C=E[o][e].clone(),R=E[o+1][e].clone(),n=E[o+1][e+1].clone(),x=E[o][e+1].clone();A.push(new Fq(i,F,a,[q,K,J])),s[0].push([C,R,x]),A.push(new Fq(F,U,a,[K.clone(),X,J.clone()])),s[0].push([R.clone(),n,x.clone()])}if(O&&y>0)for(this.vertices.push(new Ph(0,f,0)),e=0;v>e;e++){var i=c[0][e],F=c[0][e+1],U=this.vertices.length-1,q=new Ph(0,1,0),K=new Ph(0,1,0),X=new Ph(0,1,0),C=E[0][e].clone(),R=E[0][e+1].clone(),n=new So(R.x,0);A.push(new Fq(i,F,U,[q,K,X],null,1));var k=e/v*$,N=t(k),g=T(k),L=(e+1)/v*$,m=t(L),_=T(L);s[0].push([new So(.5+.5*N,.5+.5*g),new So(.5+.5*m,.5+.5*_),new So(.5,.5)])}if(S&&D>0)for(this.vertices.push(new Ph(0,-f,0)),e=0;v>e;e++){var i=c[o][e+1],F=c[o][e],U=V.length-1,q=new Ph(0,-1,0),K=new Ph(0,-1,0),X=new Ph(0,-1,0),C=E[o][e+1].clone(),R=E[o][e].clone();A.push(new Fq(i,F,U,[q,K,X],null,2));var k=e/v*$,N=t(k),g=T(k),L=(e+1)/v*$,m=t(L),_=T(L);s[0].push([new So(.5+.5*m,.5-.5*_),new So(.5+.5*N,.5-.5*g),new So(.5,.5)])}};Yc.prototype=Xi(kf);var cf=function(A,i,V,v,s,G,S){al.call(this),S=S||.5,A=A||16,i=i||16,V=(V!==p?V:0)-f,v=v!==p?v:$,s=s!==p?s:0,G=G!==p?G:f;var g,d,I=[],j=[],H=this.vertices,O=this.faces,b=this.faceVertexUvs;for(d=0;i>=d;d++){var y=[],z=[];for(g=0;A>=g;g++){var C=g/A,D=d/i,u=new Ph;u.x=-S*t(V+C*v)*T(s+D*G),u.y=S*t(s+D*G),u.z=S*T(V+C*v)*T(s+D*G),H.push(u),y.push(H.length-1),z.push(new So(C,D))}I.push(y),j.push(z)}for(d=0;i>d;d++)for(g=0;A>g;g++){var F=I[d][g+1],R=I[d][g],h=I[d+1][g],N=I[d+1][g+1],m=H[F].clone().normalize(),w=H[R].clone().normalize(),c=H[h].clone().normalize(),o=H[N].clone().normalize(),Y=j[d][g+1].clone(),x=j[d][g].clone(),M=j[d+1][g].clone(),Q=j[d+1][g+1].clone();a(H[F].y)===S?(Y.x=(Y.x+x.x)/2,O.push(new Fq(F,h,N,[m,c,o])),b[0].push([Y,M,Q])):a(H[h].y)===S?(M.x=(M.x+Q.x)/2,O.push(new Fq(F,R,h,[m,w,c])),b[0].push([Y,x,M])):(O.push(new Fq(F,R,N,[m,w,o])),b[0].push([Y,x,Q]),O.push(new Fq(R,h,N,[w.clone(),c,o.clone()])),b[0].push([x.clone(),M,Q.clone()]))}};cf.prototype=Xi(kf);var rs=function(x,b,i,s,q,k){al.call(this),x=x||.33,b=b||.17,s=s||8,i=i||6,q=q||0,k=k||$;for(var I=new Ph,o=[],Q=[],u=0;s>=u;u++)for(var E=u/s*$+f,d=0;i>=d;d++){var j=d/i*k+q;I.x=x*t(j),I.z=-x*T(j);var z=new Ph,Z=x+b*t(E);z.x=Z*t(j),z.z=-Z*T(j),z.y=b*T(E),this.vertices.push(z),o.push(new So(d/i,1-u/s)),Q.push(z.clone().sub(I).normalize())}for(var u=1;s>=u;u++)for(var d=1;i>=d;d++){var n=(i+1)*u+d-1,w=(i+1)*(u-1)+d-1,J=(i+1)*(u-1)+d,A=(i+1)*u+d,P=new Fq(n,w,A,[Q[n].clone(),Q[w].clone(),Q[A].clone()]);this.faces.push(P),this.faceVertexUvs[0].push([o[n].clone(),o[w].clone(),o[A].clone()]),P=new Fq(w,J,A,[Q[w].clone(),Q[J].clone(),Q[A].clone()]),this.faces.push(P),this.faceVertexUvs[0].push([o[w].clone(),o[J].clone(),o[A].clone()])}this.computeFaceNormals()};rs.prototype=Xi(kf);var Oq=function(f,N,y){return f?(al.call(this),f=f instanceof Array?f:[f],this.addShapeList(f,N),N.convertYZ!==!1&&cr(this,y),this.computeFaceNormals(),void 0):(f=[],void 0)},Al=Oq.prototype=Xi(al.prototype);Al.addShapeList=function(p,N){for(var f=p.length,D=0;f>D;D++){var t=p[D];this.addShape(t,N)}},Al.addShape=function(M,$){function x(){if($.bottom)for(var z=0;K>z;z++)i=y[z],C(i[2],i[1],i[0],!0);if($.top)for(z=0;K>z;z++)i=y[z],C(i[0]+T*Q,i[1]+T*Q,i[2]+T*Q,!1)}function U(){var d=0;for(H(k,d),d+=k.length,t=0,F=B.length;F>t;t++)L=B[t],H(L,d),d+=L.length}function H(B,C){for(var K,e,H=B.length;--H>=0;){K=H,e=H-1,0>e&&(e=B.length-1);var R=0,L=Q;for(R=0;L>R;R++){var j=T*R,p=T*(R+1),W=C+K+j,O=C+e+j,N=C+e+p,I=C+K+p;z(W,O,N,I,B,R,L,K,e)}}}function e($,D,f){o.vertices.push(new Ph($,D,f))}function C(a,P,r,G){a+=A,P+=A,r+=A,o.faces.push(new Fq(a,P,r,null,null,G?2:1));var _=G?O.generateBottomUV(o,M,$,a,P,r):O.generateTopUV(o,M,$,a,P,r);o.faceVertexUvs[0].push(_)}function z(I,u,C,Q,_,P,z,h,y){I+=A,u+=A,C+=A,Q+=A,o.faces.push(new Fq(I,u,Q)),o.faces.push(new Fq(u,C,Q));var n=O.generateSideWallUV(o,M,_,$,I,u,C,Q,P,z,h,y);o.faceVertexUvs[0].push([n[0],n[1],n[3]]),o.faceVertexUvs[0].push([n[1],n[2],n[3]])}var f,W,d,Z,Y,b=$.amount,P=$.curveSegments||Dc,Q=$.steps||1,r=$.extrudePath,h=!1,O=new Zk($.repeatUVLength,$.boundingBox);r&&(f=r.getSpacedPoints(Q),h=!0,W=$.frames!==p?$.frames:new fc.FrenetFrames(r,Q,!1),d=new Ph,Z=new Ph,Y=new Ph);var L,t,F,o=this,A=this.vertices.length,u=M.extractPoints(P),n=u.shape,B=u.holes,V=!xg.isClockWise(n);if(V){for(n=n.reverse(),t=0,F=B.length;F>t;t++)L=B[t],xg.isClockWise(L)&&(B[t]=L.reverse());V=!1}var y=xg.triangulateShape(n,B),k=n;for(t=0,F=B.length;F>t;t++)L=B[t],n=n.concat(L);for(var I,i,T=n.length,K=y.length,G=0;T>G;G++)I=n[G],h?(Z.copy(W.normals[0]).multiplyScalar(I.x),d.copy(W.binormals[0]).multiplyScalar(I.y),Y.copy(f[0]).add(Z).add(d),e(Y.x,Y.y,Y.z)):e(I.x,I.y,0);var s;for(s=1;Q>=s;s++)for(G=0;T>G;G++)I=n[G],h?(Z.copy(W.normals[s]).multiplyScalar(I.x),d.copy(W.binormals[s]).multiplyScalar(I.y),Y.copy(f[s]).add(Z).add(d),e(Y.x,Y.y,Y.z)):e(I.x,I.y,b/Q*s);x(),U()};var fc=function(l,m,G,o,M){function I(l,n,e){return D.vertices.push(new Ph(l,n,e))-1}al.call(this),m=m||64,G=G||1,o=o||8,M=M||!1;var u,c,J,N,s,w,y,X,Q,C,Y,r,h,O,f,U,W,b,_,K,R=[],D=this,E=m+1,S=new Ph,x=new fc.FrenetFrames(l,m,M),d=x.tangents,H=x.normals,F=x.binormals;for(this.tangents=d,this.normals=H,this.binormals=F,Q=0;E>Q;Q++)for(R[Q]=[],N=Q/(E-1),X=l.getPointAt(N),u=d[Q],c=H[Q],J=F[Q],C=0;o>C;C++)s=C/o*$,w=-G*t(s),y=G*T(s),S.copy(X),S.x+=w*c.x+y*J.x,S.y+=w*c.y+y*J.y,S.z+=w*c.z+y*J.z,R[Q][C]=I(S.x,S.y,S.z);for(Q=0;m>Q;Q++)for(C=0;o>C;C++)Y=M?(Q+1)%m:Q+1,r=(C+1)%o,h=R[Q][C],O=R[Y][C],f=R[Y][r],U=R[Q][r],W=new So(Q/m,C/o),b=new So((Q+1)/m,C/o),_=new So((Q+1)/m,(C+1)/o),K=new So(Q/m,(C+1)/o),this.faces.push(new Fq(h,O,U)),this.faceVertexUvs[0].push([W,b,K]),this.faces.push(new Fq(O,f,U)),this.faceVertexUvs[0].push([b.clone(),_,K.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};fc.prototype=Xi(kf),fc.FrenetFrames=function(w,L,c){function O(){k[0]=new Ph,M[0]=new Ph,u=Number.MAX_VALUE,t=a(r[0].x),q=a(r[0].y),d=a(r[0].z),u>=t&&(u=t,T.set(1,0,0)),u>=q&&(u=q,T.set(0,1,0)),u>=d&&T.set(0,0,1),v.crossVectors(r[0],T).normalize(),k[0].crossVectors(r[0],v),M[0].crossVectors(r[0],k[0])}var X,u,t,q,d,K,Y,T=new Ph,r=[],k=[],M=[],v=new Ph,l=new Qk,G=L+1,H=1e-4;for(this.tangents=r,this.normals=k,this.binormals=M,K=0;G>K;K++)Y=K/(G-1),r[K]=w.getTangentAt(Y),r[K].normalize();for(O(),K=1;G>K;K++)k[K]=k[K-1].clone(),M[K]=M[K-1].clone(),v.crossVectors(r[K-1],r[K]),v.length()>H&&(v.normalize(),X=z(nr(r[K-1].dot(r[K]),-1,1)),k[K].applyMatrix4(l.makeRotationAxis(v,X))),M[K].crossVectors(r[K],k[K]);if(c)for(X=z(nr(k[0].dot(k[G-1]),-1,1)),X/=G-1,r[0].dot(v.crossVectors(k[0],k[G-1]))>0&&(X=-X),K=1;G>K;K++)k[K].applyMatrix4(l.makeRotationAxis(r[K],X*K)),M[K].crossVectors(r[K],k[K])};var jp=function(j,E,D,A){al.call(this),E=E||18,D=D||0,A=A==X?$:A;for(var q=1/(j.length-1),U=1/E,d=0,o=E;o>=d;d++)for(var Q=D+d*U*A,g=t(Q),e=T(Q),S=0,s=j.length;s>S;S++){var v=j[S],B=new Ph;B.x=g*v.x-e*v.y,B.y=e*v.x+g*v.y,B.z=v.z,this.vertices.push(B)}for(var k=j.length,d=0,o=E;o>d;d++)for(var S=0,s=j.length-1;s>S;S++){var G=S+k*d,K=G,w=G+k,g=G+1+k,b=G+1,I=d*U,C=S*q,f=I+U,c=C+q;this.faces.push(new Fq(K,b,w)),this.faceVertexUvs[0].push([new So(I,C),new So(I,c),new So(f,C)]),this.faces.push(new Fq(w,b,g)),this.faceVertexUvs[0].push([new So(f,C),new So(I,c),new So(f,c)])}this.mergeVertices(),cr(this),this.computeFaceNormals(),this.computeVertexNormals()};jp.prototype=Xi(kf);var Wn=function(O,F){F=F||{};var U=dq.generateShapes(O,F);F.amount=F.amount!==p?F.amount:.5,F.convertYZ=!1,F.fill!==!1&&(F.bottom=!0,F.top=!0),Oq.call(this,U,F)};Wn.prototype=Xi(Al);var vd=S.Node=function(){jl(vd,this)},md={X:ce,Y:fg,Z:Gp},co={X:0,Y:1,Z:2},Kn={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},rm=new nd,Ci="xzy",Br=function(l,L,I){if(L){var P=L[0],y=L[1],F=L[2];"xzy"===I?(fg(l,y),Gp(l,F),ce(l,P)):"xyz"===I?(Gp(l,F),fg(l,y),ce(l,P)):"yxz"===I?(Gp(l,F),ce(l,P),fg(l,y)):"yzx"===I?(ce(l,P),Gp(l,F),fg(l,y)):"zxy"===I?(fg(l,y),ce(l,P),Gp(l,F)):"zyx"===I?(ce(l,P),fg(l,y),Gp(l,F)):(fg(l,y),Gp(l,F),ce(l,P))}};Ef("Node",$m,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Ci,_64O:0,_rotationX:0,_53O:0,_host:X,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return gr},_22Q:function(){return Ts},getX:function(){return this.p().x},setX:function(A){this.p(A,this.p().y)},getY:function(){return this.p().y},setY:function(_){this.p(this.p().x,_)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(W){this.setAnchor(W,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(J){this.setAnchor(this.getAnchor().x,J)},getScaleX:function(){return this.getScale().x},setScaleX:function(y){this.setScale(y,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(G){this.setScale(this.getScale().x,G)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(x){var t=(new Zg).setFromQuaternion(x,Zg.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(t.x,t.y,t.z)},getQuaternion:function(){var F=new Zg,p=new Zg,D=new nd;return function(R){return R||(R=new nd),this.getEuler(F),F.equals(p)?R.copy(D):R.copy(D.setFromEuler(p.copy(F)))}}(),getEuler:function(q){var w=this.r3();return q||(q=new Zg),q.set(w[0],w[1],w[2],Zg.ReverseOrder(this.getRotationMode()))},setEuler:function(K){return K=K.clone().reorder(Zg.ReverseOrder(this.getRotationMode())),this.r3(K.x,K.y,K.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(C,i){$c(C,Wo(X,X,this.r3(),this.getRotationMode())),this.translate3d(C[0]*i,C[1]*i,C[2]*i)},translateFront:function(h){this.translate3dBy([0,0,1],h)},translateBack:function(m){this.translate3dBy([0,0,-1],m)},translateLeft:function(h){this.translate3dBy([-1,0,0],h)},translateRight:function(x){this.translate3dBy([1,0,0],x)},translateTop:function(V){this.translate3dBy([0,1,0],V)},translateBottom:function(g){this.translate3dBy([0,-1,0],g)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(t,C,P){1===arguments.length&&(C=t[1],P=t[2],t=t[0]),this.p(t,P),this.setElevation(C)},translate3d:function(A,z,y){1===arguments.length&&(z=A[1],y=A[2],A=A[0]),this.translate(A,y),this.setElevation(this._54O+z)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function($,U,A){1===arguments.length&&(U=$[1],A=$[2],$=$[0]),this.setSize($,A),this.setTall(U)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(g,A,X){var v=this;if(!v._updatingRotation3d){v._updatingRotation3d=1,1===arguments.length&&(A=g[1],X=g[2],g=g[0]);var f=[v._rotationX,-v._64O,v._53O];v._rotationX=g,v._64O=-A,v._53O=X,v.fp("rotation3d",f,[g,A,X]),delete v._updatingRotation3d}},_applyClosestR3:function(){function H(T){return T%=$,0>T&&(T+=$),T>f?$-T:T}function M($,B){return H($[0]-B[0])+H($[1]-B[1])+H($[2]-B[2])}return function(e,D,A){var X,L,i,h=this.r3(),t=this.getRotationMode();"xzy"===t||"yzx"===t?(X=e>0?e-f:e+f,L=D>0?D-f:D+f,i=A>0?f-A:-f-A):"xyz"===t||"zyx"===t?(X=e>0?e-f:e+f,i=A>0?A-f:A+f,L=D>0?f-D:-f-D):("yxz"===t||"zxy"===t)&&(i=A>0?A-f:A+f,L=D>0?D-f:D+f,X=e>0?f-e:-f-e),M([X,L,i],h)<M([e,D,A],h)?this.r3(X,L,i):this.r3(e,D,A)}}(),setRotationY:function(U){this.setRotation(-U)},getRotationY:function(){return-this._64O},lookAtDirection:function(z,a){a=a||Vo;var g=this,F=Fb(z);a===Vo?(g.r3([-r(z[1]/F),-$g(z[2],z[0])+fs,0]),g.setRotationMode("xzy")):a===Jo?(g.r3(0,-$g(z[2],z[0]),r(z[1]/F)),g.setRotationMode("zyx")):a===cq?(g.r3(0,-$g(z[2],z[0])+f,-r(z[1]/F)),g.setRotationMode("zyx")):a===yb?(g.r3([-r(z[1]/F)+fs,-$g(z[2],z[0])+fs,0]),g.setRotationMode("xzy")):a===jc&&(g.r3([-r(z[1]/F)-fs,-$g(z[2],z[0])+fs,0]),g.setRotationMode("xzy")),a===ii&&(g.r3([-r(z[1]/F)+f,-$g(z[2],z[0])+fs,f]),g.setRotationMode("zxy"))},lookAt:function(E,O){return this.lookAtDirection(Fi(E,this.p3()),O)},lookAtX:function(){var w=new Zh,D=new Zh,K=new Zh,R=new Qk,H=new Qk,s=new Zg;return function(W,G){var j=ec(this);if(R.fromArray(j),K.copy(this.p3()),w.copy(W).sub(K),!(w.lengthSq()<1e-6)){w.normalize(),G===Vo?D.set(0,0,1):G===ii?D.set(0,0,-1):G===cq?D.set(-1,0,0):G===Jo?D.set(1,0,0):G===yb?D.set(0,1,0):G===jc&&D.set(0,-1,0),D.applyMatrix4(R).sub(K).normalize();var M=Math.acos(w.dot(D));if(M){var l=w.clone().cross(D);l.lengthSq()<1e-6&&(G===yb||G===jc?l.set(0,0,1).applyMatrix4(R).sub(K):l.set(0,1,0).applyMatrix4(R).sub(K)),l.normalize(),s.set(this.r3(),this.getRotationMode(),!0),R.makeRotationFromEuler(s),H.makeRotationAxis(l,-M),s.setFromRotationMatrix(H.multiply(R)),this._applyClosestR3(s.x,s.y,s.z)}}}}(),getHost:function(){return this._host},setHost:function(W){var B=this;if(B!==W&&B._host!==W){var w=B._host;w&&(w._removeAttach(B),w.updateLayoutAttaches()),B._host=W,B._host&&(B._host._addAttach(B),B._host.updateLayoutAttaches()),B.fp("host",w,W),B.onHostChanged(w,W)}},getAttaches:function(){return this._69O},_addAttach:function(J){var D=this;D._69O||(D._69O=new jn),D._69O.add(J),D.fp("attaches",X,J)},_removeAttach:function(B){var b=this;b._69O.remove(B),b._69O.isEmpty()&&delete b._69O,b.fp("attaches",B,X)},getImage:function(){if(this._pendingCheckImageJSON){var $=E.getImage(this._image);$&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Tf&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(S){var h=this,C=h._image,G=h.getWidth(),t=h.getHeight();if(h._image=S,h.fp("image",C,S)){if(null!=S&&(Mj(S)||tc(S)&&/\.json$/i.test(S))&&(this._pendingCheckImageJSON=!0),Rh)return;h.fp(zm,G,h.getWidth()),h.fp(mn,t,h.getHeight())}},getElevation:function(){return this._54O},setElevation:function(o){var Z=this;if(!Z._50O){Z._50O=1;var W=Z._54O;Z._54O=o,Z.fp(od,W,o),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(y){var d=this;if(!d._49O){d._49O=1;var s=d._64O;d._64O=y,d.fp(Uh,s,y),delete d._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(l){var F=this;if(!F._51O){F._51O=1;var B=F._rotationX;F._rotationX=l,F.fp("rotationX",B,l),delete F._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(I){var $=this;if(!$._52O){$._52O=1;var S=$._53O;$._53O=I,$.fp("rotationZ",S,I),delete $._52O}},getPosition:function(){return this._position},setPosition:function(P,V){var n=this;if(!n._50I){n._50I=1;var b;if(b=2===arguments.length?{x:P,y:V}:P,b.x!==n._position.x||b.y!==n._position.y){var R=n._position;n._position=b,n.fp(rn,R,b)}delete n._50I}},translate:function(E,Z){var j=this._position;this.p(j.x+E,j.y+Z)},getWidth:function(){var T=this;if(T._width>=0)return T._width;var Q=T.getStyle("shape3d");if(Q){var P=De(Q);if(P&&P.rawS3)return P.rawS3[0];if("billboard"===Q||"plane"===Q){var I=ir(T.getStyle("shape3d.image"));return I?rc(I,T):20}}var I=ir(T._image);return I?rc(I,T):20},setWidth:function(e){var L=this,l=L._width;L._width=e,L.fp(zm,l,e)
},getHeight:function(){var K=this;if(K._height>=0)return K._height;var L=K.getStyle("shape3d");if(L){var i=De(L);if(i&&i.rawS3)return i.rawS3[2];if("plane"===L){var q=ir(K.getStyle("shape3d.image"));return q?Sn(q,K):20}if("billboard"===L)return 2}var q=ir(K._image);return q?Sn(q,K):20},setHeight:function(T){var X=this,D=X._height;X._height=T,X.fp(mn,D,T)},getTall:function(){var q=this;if(q._tall>=0)return q._tall;var P=q.getStyle("shape3d");if(P){var v=De(P);if(v&&v.rawS3)return v.rawS3[1];if("billboard"===P){var B=ir(q.getStyle("shape3d.image"));return B?Sn(B,q):20}if("plane"===P)return 2}return 20},setTall:function(s){var r=this,b=r._tall;r._tall=s,r.fp("tall",b,s)},setSize:function(G,O){var y=this;2===arguments.length?(y.setWidth(G),y.setHeight(O)):(y.setWidth(G.width),y.setHeight(G.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(t,M,K,O,S){var k=this,p=k.getAnchor(),X=k.getScale();arguments.length<=2&&(S=M,M=t.y,K=t.width,O=t.height,t=t.x);var x=S&&X.x<0?1-p.x:p.x,r=S&&X.y<0?1-p.y:p.y;k.p(t+K*x,M+O*r),S&&(K/=Math.abs(X.x),O/=Math.abs(X.y)),k.setWidth(K),k.setHeight(O)},getMatrix:function(){var V=this,I=V._64O,n=V._position,Q=V.getScale();return new mk(I,n.x,n.y,Q.x,Q.y)},getMatrix4:function(){var b=new Zh,n=new nd,g=new Zh;return function(_){return this.getQuaternion(n),b.copy(this.p3()),g.copy(this.getFinalScale3d()),_||(_=new Qk),_.compose(b,n,g)}}(),getAnchorRect:function(){var o=this,c=o.getWidth(),j=o.getHeight(),b=o.getAnchor();return{x:-c*b.x,y:-j*b.y,width:c,height:j}},toLocal:function(_){return this.getMatrix().tfi(_)},toGlobal:function(F){return this.getMatrix().tf(F)},getAttachPosition:function(){var T=new mk;return function(h,I,r,M){r=r||0,M=M||0;var z=this,t=z.getAnchor(),K=z._64O,x=z._position,Z=z.getScale();return T.setFromTransform(K,x.x,x.y).tf({x:r+Z.x*z.getWidth()*(h-t.x),y:M+Z.y*z.getHeight()*(I-t.y)})}}(),isInRect:function(e){e=this.toLocal(e);var j=this.getWidth(),R=this.getHeight();return e.x+=j*this.getAnchorX(),e.y+=R*this.getAnchorY(),!(e.x<0||e.y<0||e.x>j||e.y>R)},getRect:function(){var X=this,U=X.getWidth(),w=X.getHeight(),g=X.getAnchor(),x={x:-U*g.x,y:-w*g.y,width:U,height:w},r=X.getMatrix();return x=$q([r.tf(x.x,x.y),r.tf(x.x+x.width,x.y),r.tf(x.x+x.width,x.y+x.height),r.tf(x.x,x.y+x.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var w=this,e=w.getAnchor(),X=w._anchorElevation;return{x:e.x,y:X,z:e.y}},setAnchorElevation:function(N){var j=this,g=j._anchorElevation;return g!==N?(j._anchorElevation=N,j.fp("anchorElevation",g,N),!0):!1},setAnchor3d:function(e,U,d,G){var A,i=this;"number"==typeof e?A={x:e,y:U,z:d}:(A=e.length?{x:e[0],y:e[1],z:e[2]}:e,G=U);var D=i.getDataModel();D&&D.beginTransaction();var t=i.getAnchor3d(),c=i.setAnchor(A.x,A.z);if(i.setAnchorElevation(A.y)&&(c=!0),c&&G&&!Rh){i.getAnchor3d();var I=ec(i),q=$c([A.x-t.x,A.y-t.y,A.z-t.z],I);i.p3(q)}return D&&D.endTransaction(),c},getAnchor:function(){var x=this;if(x.hasOwnProperty("_anchor"))return x._anchor;var w=ir(x._image);return w&&w.anchorX!==p?{x:w.anchorX,y:w.anchorY}:x._anchor},setAnchor:function(O,w,x){var V,i=this;"number"==typeof O?V={x:O,y:w}:(V=O.length?{x:O[0],y:O[1]}:O,x=w);var e=i.getAnchor();if(e.x!==V.x||e.y!==V.y){var K=i.getDataModel();if(K&&K.beginTransaction(),i._anchor=V,i.fp("anchor",e,V),x&&!Rh){var B=i.getPosition(),u=i.getSize(),Y=i.getRotation(),L=i.getScale(),s=-u.width*(e.x-V.x)*L.x,N=-u.height*(e.y-V.y)*L.y,z=T(Y),X=t(Y);i.setPosition(B.x+X*s-z*N,B.y+z*s+X*N)}return K&&K.endTransaction(),!0}return!1},getLocalQuaternion:function(r){var U=this,b=U.getHost();if(!b)return U.getQuaternion(r);var X=b.getQuaternion(),z=U.getQuaternion();return r||(r=new nd),r.copy(X).inverse().multiply(z)},setLocalQuaternion:function(s){var e=this,Z=e.getHost();if(!Z)return e.setQuaternion(s);var w=Z.getQuaternion();e.setQuaternion(w.clone().multiply(s))},getLocalEuler:function(){var X=new nd;return function(A){var x=this,$=x.getHost();return $?(x.getLocalQuaternion(X),A||(A=new Zg),A.setFromQuaternion(X,Zg.ReverseOrder(this.getRotationMode()))):x.getEuler(A)}}(),setLocalEuler:function(){var G=new nd;return function(g){var M=this,U=M.getHost();return U?(G.setFromEuler(g),M.setLocalQuaternion(G)):M.setEuler(g)}}(),getLocalPosition3d:function(F){var x=this;F||(F=new Zh),F.copy(x.p3());var m=x.getHost();if(!m)return F;var V=m.getMatrix4();return F.applyMatrix4(V.getInverse(V))},setLocalPosition3d:function(Y){var D=this,K=D.getHost();if(!K)return Y.x!==p?D.p3(Y.x,Y.y,Y.z):D.p3(Y),void 0;var v=K.getMatrix4(),H=new Zh(Y);H.applyMatrix4(v),D.p3(H.x,H.y,H.z)},getScale:function(){return this._scale},setScale:function(E,t){var r,S=this;r=2===arguments.length?{x:E,y:t}:E;var L=S.getScale();(L.x!==r.x||L.y!==r.y)&&(S._scale=r,S.fp("scale",L,r))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var I=this,R=I._scaleTall,f=I.getScale();return[f.x,R,f.y]},getFinalScale3d:function(){var $=this,e=$.s3(),D=$._dynamicScale3d,j=$.getScale3d();return e&&(j[0]*=e[0],j[1]*=e[1],j[2]*=e[2]),D&&(j[0]*=D[0],j[1]*=D[1],j[2]*=D[2]),j},getFinalRotation3d:function(){var K=this;return K._dynamicRotation||K.r3()},setScaleTall:function(v){var Q=this,p=Q._scaleTall;p!==v&&(Q._scaleTall=v,Q.fp("scaleTall",p,v))},setScale3d:function(E,n,X){var F,A=this;F="number"==typeof E?{x:E,y:n,z:X}:E.length?{x:E[0],y:E[1],z:E[2]}:E,A.setScaleTall(F.y),A.setScale(F.x,F.z)},getCorners:function(s,g){s==X&&(s=0),g==X&&(g=s);var j=this,i=j.getAnchor(),b=j.getWidth(),T=j.getHeight(),v=-b*i.x-s,N=-T*i.y-g,L=b+2*s,a=T+2*g,I=j.getMatrix();return[I.tf(v,N),I.tf(v,N+a),I.tf(v+L,N+a),I.tf(v+L,N)]},getEditControlPoints:function(j,f,o){f==X&&(f=0),o==X&&(o=f);var R=this,n=R.getAnchor(),b=R.getWidth(),G=R.getHeight(),p=-b*n.x-f,m=-G*n.y-o,_=b+2*f,Z=G+2*o;if(j)return[{x:p,y:m},{x:p,y:0},{x:p,y:m+Z},{x:0,y:m+Z},{x:p+_,y:m+Z},{x:p+_,y:0},{x:p+_,y:m},{x:0,y:m}];var h=R.getMatrix();return[h.tf(p,m),h.tf(p,0),h.tf(p,m+Z),h.tf(0,m+Z),h.tf(p+_,m+Z),h.tf(p+_,0),h.tf(p+_,m),h.tf(0,m)]},rotateAt:function(d,W,y){var R=this,D=R._position,o=R._64O,C=new mk(o,D.x,D.y).tf(d,W),x=B(d*d+W*W),Y=$g(D.y-C.y,D.x-C.x)+y;R.setRotation(o+y),R.p(C.x+x*t(Y),C.y+x*T(Y))},rotateAroundAxis:function(s,q){this.setQuaternion(this.getQuaternion().multiply(rm.setFromAxisAngle(s,q)))},rotateAroundWorldAxis:function(R,E){this.setQuaternion(this.getQuaternion().premultiply(rm.setFromAxisAngle(R,E)))},rotateX:function(c){return this.rotateAroundAxis(Zh.AxisX,c)},rotateY:function(p){return this.rotateAroundAxis(Zh.AxisY,p)},rotateZ:function(E){return this.rotateAroundAxis(Zh.AxisZ,E)},onParentChanged:function(){vd.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var u={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(Z){u[Z]=!0}),function(z){var Y=this;vd.superClass.onPropertyChanged.call(Y,z);var R=z.property;if(u[R]&&!Y._layoutUpdating&&Y.updateLayoutParameters(null,R),Y._69O&&Y._69O.each(function(Q){Q.handleHostPropertyChange(z)}),Y._49I&&Y._49I.each(function(X){X.fp("agentChange",!0,!1)}),_d[R]&&this.updateLayoutAttaches(),"a:layout"===R.substring(0,8)){this.updateLayoutAttaches();var $=Y._host;$&&$.updateLayoutAttaches()}("s:shape3d.autorotate"===R||"s:autorotate"===R||"s:shape3d.fixSizeOnScreen"===R||"s:fixSizeOnScreen"===R||"s:hide.overlapping.group"===R)&&(Y._47Q=Y.s("autorotate")||Y.s("shape3d.autorotate")||Y.s("fixSizeOnScreen")||Y.s("shape3d.fixSizeOnScreen")||Y.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(d){this.updateAttach(d)},onStyleChanged:function(V){vd.superClass.onStyleChanged.apply(this,arguments),ph[V]&&this.updateAttach()},updateLayoutAttaches:function(){if(!Rh){var B,u,I=this;return B=ir(I.getImage()),B&&B.layoutAttach&&(u=B.layoutAttach,u&&u(I))?!0:void 0}},updateAttach:function(T){var v=this;return Rh?(v.updateLayoutParameters(),void 0):(v._51I||(v._51I=1,v._71O(T),delete v._51I),void 0)},_71O:function(x){var s,k,v,I,r,T,a=this,H=a._host,V=x?x.property:X,J=x?x.oldValue:X,n=x?x.newValue:X;if(H instanceof vd&&(!x||_d[V])){var y;if(y=ir(H.getImage()),y&&y.layoutAttach)return}if(H instanceof S.Grid){if(V===od)a.setElevation(a._54O+n-J);else if(!x||Li[V]){if(s=a.s("attach.row.index"),k=a.s("attach.column.index"),v=H.getCellRect(s,k),!v)return;I=a.s("attach.row.span"),r=a.s("attach.column.span"),(1!==I||1!==r)&&(v=Mb(v,H.getCellRect(s+I-1,k+r-1))),Nh(v,a,"attach.padding",1),a.setRect(v)}}else if(H instanceof bd&&(T=a.s("attach.index"))>=0&&(!x||ok[V])){var w=a.s("attach.thickness"),_=H.getScale(),A=Math.max(_.x,_.y);w>0&&a.setHeight(H.getThickness()*w*A);var M=a.s("attach.offset"),h=H.getPoints(),p=h.size();if(p>T){var K=H.getPointsMatrix2d(),u=h.get(T),m=p===T+1?h.get(0):h.get(T+1);u=K.apply(u),m=K.apply(m);var E=[m.x-u.x,m.y-u.y],Z=Fb(E);if(Z){a.s("attach.offset.relative")&&(M*=Z),a.s("attach.offset.opposite")&&(M=Z-M);var O={x:u.x+E[0]/Z*M,y:u.y+E[1]/Z*M},F=a.s("attach.gap");F&&(a.s("attach.gap.relative")&&(F*=H.getThickness()*A),O=kb(X,O,m,F)),a.p(O),a.setRotation($g(E[1],E[0]))}}}else x&&(V===rn?a.translate(n.x-J.x,n.y-J.y):V===od?a.setElevation(a._54O+n-J):Uo[V]?"rotation3d"===V?a.syncRotation3d(H,n,J):a._11Q(H,V,n-J):("anchor"===V||"width"===V||"height"===V||"scale"===V)&&a.layout(H))},_11Q:function(){var b=new S.Math.Euler,C=S.Math.Euler.ReverseOrder,e=new S.Math.Vector2,A=new S.Math.Vector2;return function(q,O,l){var n=this,Y=q.p3(),T=q.r3(),Z=n.p3(),R=n.r3();if(O===Uh&&(O="rotationY",l=-l),(O===Uh||"rotationY"===O)&&0===R[0]&&0===R[2]&&0===T[0]&&0===T[2]&&0===Z[1]&&0===Y[1])return n.setRotation(-R[1]-l),e.set(Z[0],Z[2]).rotateAround(A.set(Y[0],Y[2]),-l),n.p(e.x,e.y),void 0;var N=Kn[q.getRotationMode()],p=N[0],t=N[1],Q=N[2],k=md[p],r=md[t],z=md[Q],U=df();O===Uh+p?(z(U,T[co[Q]]),r(U,T[co[t]]),k(U,l),r(U,-T[co[t]]),z(U,-T[co[Q]])):O===Uh+t?(z(U,T[co[Q]]),r(U,l),z(U,-T[co[Q]])):O===Uh+Q&&z(U,l);var j=Fi(Z,Y);$c(j,U),n.p3(Y[0]+j[0],Y[1]+j[1],Y[2]+j[2]);var u=n.getRotationMode();Br(U,n.r3(),u),b.setFromRotationMatrix(U,C(u)),n.r3([b.x,b.y,b.z])}}(),syncRotation3d:function(){var s=new nd,D=new Zg,V=new Zh;return function(_,B,q){var T=this;if(q[0]!==B[0]||q[1]!==B[1]||q[2]!==B[2]){var Q=Zg.ReverseOrder(_.getRotationMode());rm.setFromEuler(D.set(q[0],q[1],q[2],Q)),s.setFromEuler(D.set(B[0],B[1],B[2],Q)),s.multiply(rm.inverse());var f=_.p3(),z=T.p3();V.set(z[0]-f[0],z[1]-f[1],z[2]-f[2]).applyQuaternion(s),T.p3(f[0]+V.x,f[1]+V.y,f[2]+V.z),T.setQuaternion(T.getQuaternion(rm).premultiply(s))}}}(),isHostOn:function(a){var E=this;if(E._host&&a&&a._69O)for(var q={},N=E._host;N&&N!==E&&!q[N._id];){if(N===a)return!0;q[N._id]=N,N=N._host}return!1},isLoopedHostOn:function(N){return this.isHostOn(N)&&N.isHostOn(this)},getScaledSize:function(){var T=this.getSize(),z=this.getScale();return T.width*=Math.abs(z.x),T.height*=Math.abs(z.y),T},layout:function(n){if(n=n||this.getHost()){var s=this,c=s.s("layout.h")||"center",F=s.s("layout.v")||"center";if("center"!==c||"center"!==F){var K=new S.Math.Vector2,U=n.getPosition(),J=n.getAnchor(),z=n.getScaledSize();s.getPosition();var G,o,M,L,E,f=1,t=1;switch(s._layoutUpdating=!0,c){case"left":K.setX(s._layoutHValue-J.x*z.width);break;case"right":K.setX((1-J.x)*z.width-s._layoutHValue);break;case"leftright":G=z.width-s._layoutHValue[2],M=s.getRotation()-n.getRotation(),L=Math.abs(Math.sin(M)),E=Math.abs(Math.cos(M)),f+=E*G/s._layoutHValue[3],t+=L*G/s._layoutHValue[4],K.setX(s._layoutHValue[1]+(s._layoutHValue[5]-J.x)*z.width);break;case"center":K.setX((.5-J.x)*z.width-s._layoutHValue);break;case"scale":M=s.getRotation()-n.getRotation(),L=Math.abs(Math.sin(M)),E=Math.abs(Math.cos(M)),K.setX((.5-J.x)*z.width-s._layoutHValue[1]*z.width/s._layoutHValue[0]),o=z.width/s._layoutHValue[2]-1,f+=E*o,t+=L*o}switch(F){case"top":K.setY(s._layoutVValue-J.y*z.height);break;case"bottom":K.setY((1-J.y)*z.height-s._layoutVValue);break;case"topbottom":M||(M=s.getRotation()-n.getRotation(),L=Math.abs(Math.sin(M)),E=Math.abs(Math.cos(M))),G=z.height-s._layoutVValue[2],f+=L*G/s._layoutVValue[3],t+=E*G/s._layoutVValue[4],K.setY(s._layoutVValue[1]+(s._layoutVValue[5]-J.y)*z.height);break;case"center":K.setY((.5-J.y)*z.height-s._layoutVValue);break;case"scale":M||(M=s.getRotation()-n.getRotation(),L=Math.abs(Math.sin(M)),E=Math.abs(Math.cos(M))),K.setY((.5-J.y)*z.height-s._layoutVValue[1]*z.height/s._layoutVValue[0]),o=z.height/s._layoutVValue[2]-1,f+=L*o,t+=E*o}if("leftright"===c||"scale"===c||"topbottom"===F||"scale"===F){var V=this.getScale(),Q=Math.abs(V.x),T=Math.abs(V.y);"leftright"===c||"scale"===c?s.setSize(s._layoutHValue[3]*f/Q,s._layoutHValue[4]*t/T):s.setSize(s._layoutVValue[3]*f/Q,s._layoutVValue[4]*t/T)}K.rotateAround(null,n.getRotation()),this.setPosition(K.x+U.x,K.y+U.y),s._layoutUpdating=p}}},updateLayoutParameters:function(X,G){if(X=X||this.getHost()){var u=this,o=u.s("layout.h"),f=u.s("layout.v");if(o||f){var P,M,k,A,$,t,z=new S.Math.Vector2,R=X.getPosition(),h=X.getAnchor(),Y=X.getScaledSize(),q=u.getPosition(),J=u.getScaledSize();switch(z.set(q.x-R.x,q.y-R.y),z.rotateAround(null,-X.getRotation()),o){case"left":u._layoutHValue=z.x+h.x*Y.width;break;case"right":u._layoutHValue=-z.x+(1-h.x)*Y.width;break;case"center":u._layoutHValue=-z.x+(.5-h.x)*Y.width;break;case"leftright":case"scale":"scale"===o?P=-z.x+(.5-h.x)*Y.width:(M=u.getAnchor(),k=u.getRotation()-X.getRotation(),A=Math.cos(k),$=Math.sin(k),t=-Math.min(-M.x*A+M.y*$,-M.x*A-(1-M.y)*$,(1-M.x)*A+M.y*$,(1-M.x)*A-(1-M.y)*$),P=z.x-(t-h.x)*Y.width),"position"===G&&"object"==typeof u._layoutHValue?(u._layoutHValue[0]=Y.width,u._layoutHValue[1]=P):u._layoutHValue=[Y.width,P,Y.width,J.width,J.height,t]}switch(f){case"top":u._layoutVValue=z.y+h.y*Y.height;break;case"bottom":u._layoutVValue=-z.y+(1-h.y)*Y.height;break;case"center":u._layoutVValue=-z.y+(.5-h.y)*Y.height;break;case"topbottom":case"scale":"scale"===f?P=-z.y+(.5-h.y)*Y.height:(k||(M=u.getAnchor(),k=u.getRotation()-X.getRotation(),A=Math.cos(k),$=Math.sin(k)),t=-Math.min(-M.x*$-M.y*A,-M.x*$+(1-M.y)*A,(1-M.x)*$-M.y*A,(1-M.x)*$+(1-M.y)*A),P=z.y-(t-h.y)*Y.height),"position"===G&&"object"==typeof u._layoutVValue?(u._layoutVValue[0]=Y.height,u._layoutVValue[1]=P):u._layoutVValue=[Y.height,P,Y.height,J.width,J.height,t]}}}},getSerializableProperties:function(){var N=vd.superClass.getSerializableProperties.call(this);return Vm(N,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),N}});var Xb=S.Edge=function(k,f){var P=this;jl(Xb,P),P.setSource(k),P.setTarget(f)};Ef("Edge",$m,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return me},_22Q:function(){return Vs},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(d){if(d===this)return!1;if(mo(d))return!0;for(var j,a,i,B,D,E=[this],z=-1,Y=0;Y>z;)if(z++,j=E[z],a=j._44I)for(a=a.getArray(),B=0,D=a.length;D>B;B++)if(i=a[B],br(i)&&!(E.indexOf(i)>=0)){if(i===d)return!1;E.push(i),Y++}return!0},setSource:function(P){var _=this;if(_._source!==P&&_.canSetSourceTarget(P)){var p=_._source;_._source=P,p&&p._16I(_),P&&P._2I(_),_._7I(),_.fp("source",p,P)}},setTarget:function(z){var q=this;if(q._target!==z&&q.canSetSourceTarget(z)){var t=q._target;q._target=z,t&&t._18I(q),z&&z._4I(q),q._7I(),q.fp("target",t,z)}},isLooped:function(){var v=this;return v._source===v._target&&mo(v._source)&&mo(v._target)},onPropertyChanged:function(){var D=this;D._49I&&D._49I.each(function(p){p.fp("agentChange",!0,!1)})},_7I:function(){var u,a=this,f=hr(a);a._40I!==f&&(u=this._40I,u&&u._15I(a),a._40I=f,f&&f._1I(a),a.fp("sourceAgent",u,f),Zn(u,a._41I),Zn(f,a._41I));var p=Kb(a);a._41I!==p&&(u=a._41I,u&&u._17I(a),a._41I=p,p&&p._3I(a),a.fp("targetAgent",u,p),Zn(u,a._40I),Zn(p,a._40I))},_22I:function(L){this._52I=L,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var C=this;return C._52I&&C._52I.get(0)!==C&&!C.getStyle(Cf)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var c=this,Z=c._52I;return Z&&!c.getStyle(Cf)&&Z.size()>1&&c===Z.get(0)},toggle:function(){this.beginTransaction();var R=this._52I,Y=!this.s(Cf);R&&R.size()>1&&(R.each(function(Z){Z.s(Cf,Y)}),R.getSiblings().each(function(r){r!==R&&r.each(function(L){L.fp("edgeGroup",X,r)})})),this.endTransaction()},setStyle:function(y,K){(y===Vi||"edge.segments"===y)&&(K=Tm(K)),Xb.superClass.setStyle.call(this,y,K)},onStyleChanged:function(z){Xb.superClass.onStyleChanged.apply(this,arguments),ah[z]&&Zn(this._41I,this._40I)},getSerializableProperties:function(){var z=Xb.superClass.getSerializableProperties.call(this);return Vm(z,{source:1,target:1}),z}});var Nm=S.Group=function(){jl(Nm,this)};Ef("Group",vd,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Kd},onChildAdded:function(){Nm.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Nm.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var R=this;if(!R._54I&&!Rh){var d=R.getChildrenRect();d&&(R._53I=1,R.p(sc(R.s("group.position"),d,R.getSize())),delete R._53I)}},getChildrenRect:function(){var H,S=this;return S.eachChild(function(j){mo(j)&&(H=Mb(H,S.getChildRect(j)))}),H},getChildRect:function(R){var G;return mo(R)&&R.s(gh)&&(Tl(R)&&R.isExpanded()&&R.eachChild(function(m){G=Mb(G,R.getChildRect(m))}),!G&&R.getRect&&(G=R.getRect())),G},setPosition:function(w,A){var L=this;if(!L._54I){var b;b=2===arguments.length?{x:w,y:A}:w,Rh||L._53I||(L._54I=1,id(L._children,b.x-L._position.x,b.y-L._position.y),delete L._54I),Nm.superClass.setPosition.call(this,b)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(P){var p=this;if(p._57O!==P){var W=p._57O;p._57O=P,p.fp("expanded",W,p._57O),p._fireInvalidateDeep(),p._8I()}},_fireInvalidateDeep:function(){this.eachChild(function($){Tl($)?$._fireInvalidateDeep():$.iv()})},_8I:function(){Nm.superClass._8I.call(this),this.eachChild(function(J){mo(J)&&J._8I()})},onStyleChanged:function(F){Nm.superClass.onStyleChanged.apply(this,arguments),"group.position"===F&&this._81I()},getSerializableProperties:function(){var J=Nm.superClass.getSerializableProperties.call(this);return J.expanded=1,J}});var En=S.Camera=function(){jl(En,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new or.Matrix4,this._projectMatrix=new or.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};En.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],Ef("Camera",vd,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(O){this._projectMatrixDirty=!0,this.renderTarget=O},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(v){var y=v.split(",");this._cullingMask=Qp(y)},isLayerVisible:function(k){var F=Ki[k];return F&&bs(this._cullingMask,F.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var w=new S.Math.Matrix4,E=new S.Math.Euler;return function(U){var J=this;U.isMatrix4?J._viewMatrix.copy(U):J._viewMatrix.fromArray(U),w.getInverse(J._viewMatrix),J.p3(w.getPosition().toArray()),E.set(0,0,0,J.getRotationMode(),!0).setFromRotationMatrix(w),J.r3([E.x,E.y,E.z])}}(),getViewMatrix:function(g){var k=this,o=Wo(null,null,k.r3(),k.getRotationMode(),k.p3()),d=k._viewMatrix;return d.fromArray(o).getInverse(d),d.toArray(g)},setProjectMatrix:function(Z){var s=this;Z.isMatrix4?s._projectMatrix.copy(Z):s._projectMatrix.fromArray(Z),Z=s._projectMatrix.getElements(),s.isOrtho()?s.s({"camera.near":(Z[14]+1)/Z[10],"camera.far":(Z[14]-1)/Z[10],"camera.ortho.width":2/Z[0]}):s.s({"camera.near":Z[14]/(Z[10]-1),"camera.far":Z[14]/(Z[10]+1),"camera.fovy":2*Math.atan(1/Z[5]),"camera.aspect":Z[5]/Z[0]}),s._projectMatrixDirty=!1},onPropertyChanged:function(F){var S=this;En.superClass.onPropertyChanged.call(S,F);var q=F.property;("s:camera.near"===q||"s:camera.far"===q||"s:camera.fovy"===q||"s:camera.aspect"===q||"s:camera.ortho.width"===q)&&(S._projectMatrixDirty=!0)},getProjectMatrix:function(){var s=this;if(s._projectMatrixDirty){var G=s.gv,X=s.isCube(),j=X?1:s.s("camera.aspect")||(G?G.getAspect():null)||E.graph3dViewAspect,h=s.s("camera.near")||(G?G.getNear():null)||E.graph3dViewNear,f=s.s("camera.far")||(G?G.getFar():null)||E.graph3dViewFar,v=df();if(s.isOrtho()){var M=s.s("camera.ortho.width")||(G?G.getOrthoWidth():null)||E.graph3dViewOrthoWidth,R=M/2,N=R/j;rl(v,-R,R,-N,N,h,f)}else{var U=X?Math.PI/2:s.s("camera.fovy")||(G?G.getFovy():null)||E.graph3dViewFovy;Nb(v,U,j,h,f)}s._projectMatrix.fromArray(v),s._projectMatrixDirty=!1}return s._projectMatrix.toArray()},lookAt:function(y,X){var b=this.p3();return y.x?this.lookAtDirection([y.x-b[0],y.y-b[1],y.z-b[2]],X):this.lookAtDirection([y[0]-b[0],y[1]-b[1],y[2]-b[2]],X)},lookAtDirection:function(){var Y=new S.Math.Matrix4,I=new S.Math.Euler,r=new S.Math.Vector3,T=new S.Math.Vector3;return function(H,q){Y.lookAtDirection(r.copy(H).multiplyScalar(-1),q?T.copy(q):T.set(0,1,0)),I.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(Y),this.r3([I.x,I.y,I.z])}}(),render:function(h){var K=this,o=h.getGL();if(!o)return!1;var l,p,V=K.renderTarget;if(V)l=V.width,p=V.height;else{var B=h.getDevicePixelRatio();l=h.getWidth()*B,p=h.getHeight()*B}K.gv=h,h._camera=K;var O=h._frameState.renderState.glState,m=O.color.clear.slice(0);ih(o,K.s("camera.background"));var f=h.getEye;if(h.getEye=function(){return K.p3()},K.isCube())for(var M=En.CubeDirectionParam,U=0;6>U;U++)V&&V.bind(o,U),K.lookAtDirection([M[6*U+0],M[6*U+1],M[6*U+2]],[M[6*U+3],M[6*U+4],M[6*U+5]]),o.clear(o.COLOR_BUFFER_BIT),h.setViewport(o,0,0,l,p),K.s("camera.onlySky")?h.renderSky():h.renderScene({renderAxis:K.s("camera.renderAxis"),renderGrid:K.s("camera.renderGrid"),renderEdit:K.s("camera.renderEdit"),renderReflector:!1}),V&&V.unbind(o);else V&&V.bind(o),o.clear(o.COLOR_BUFFER_BIT),h.overlappingBox.clear(),h.setViewport(o,0,0,l,p),K.s("camera.onlySky")?h.renderSky():h.renderScene({renderAxis:K.s("camera.renderAxis"),renderGrid:K.s("camera.renderGrid"),renderEdit:K.s("camera.renderEdit")}),V&&V.unbind(o);return h.getEye=f,ih(o,m),h._camera=null,K.gv=null,!0}});var qk=S.Block=function(){jl(qk,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Ef("Block",vd,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return jo},_22Q:function(){return Us},onChildAdded:function(){qk.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){qk.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function Y(I,N,e){a.fromArray(ec(N));var H=N.getAnchor3d();I.push((new Zh).set(0-H.x,0-H.y,0-H.z).applyMatrix4(a).applyMatrix4(e)),I.push((new Zh).set(0-H.x,0-H.y,1-H.z).applyMatrix4(a).applyMatrix4(e)),I.push((new Zh).set(0-H.x,1-H.y,0-H.z).applyMatrix4(a).applyMatrix4(e)),I.push((new Zh).set(0-H.x,1-H.y,1-H.z).applyMatrix4(a).applyMatrix4(e)),I.push((new Zh).set(1-H.x,0-H.y,0-H.z).applyMatrix4(a).applyMatrix4(e)),I.push((new Zh).set(1-H.x,0-H.y,1-H.z).applyMatrix4(a).applyMatrix4(e)),I.push((new Zh).set(1-H.x,1-H.y,0-H.z).applyMatrix4(a).applyMatrix4(e)),I.push((new Zh).set(1-H.x,1-H.y,1-H.z).applyMatrix4(a).applyMatrix4(e))}function h(A,E){var l=(new Qk).makeRotationFromEuler(this.getEuler()).setPosition((new Zh).fromArray(this.p3()));l.getInverse(l),A.forEach(function(D){mo(D)&&Y(E,D,l)})}var a=new Qk;return function(H,V){if(H instanceof vd&&(H=[H]),!H||0===H.length)return X;var V=[];h.call(this,H,V);var n=[1/0,1/0,1/0],r=[-1/0,-1/0,-1/0];return V.forEach(function(p){n[0]=Math.min(p.x,n[0]),n[1]=Math.min(p.y,n[1]),n[2]=Math.min(p.z,n[2]),r[0]=Math.max(p.x,r[0]),r[1]=Math.max(p.y,r[1]),r[2]=Math.max(p.z,r[2])}),{min:n,max:r}}}(),updateFromChildren:function(){var q=this;if(!Rh&&!q._updatingToChildren&&q._syncSize&&0!==q.size()&&!q._freezeSyncFromChildren){var B=this._getBoundingBox(q.toChildren(mo));if(B){q._updatingFromChildren=1;var N=(new Zh).fromArray(this.getScale3d()),e=(new Zh).fromArray(B.min),$=(new Zh).fromArray(B.max),o=E.blockMinSize,U=new Zh,S=$.clone().sub(e);0===S.x&&U.setX(.5),0===S.y&&U.setY(.5),0===S.z&&U.setZ(.5);var M=this._width==X||-1===this._width,f=new Zh(this.getAnchor3d()),w=N.clone().multiply((new Zh).fromArray(this.s3())),J=S.clone();0===J.x&&J.setX(o),0===J.y&&J.setY(o),0===J.z&&J.setZ(o);var n=f.clone().multiply(w),d=n.clone().multiplyScalar(-1).sub(e).divide(J).add(n.divide(J)).add(U),l=this.s("keepPosition");if(M||this._anchorChanged||this._scaleChanged||!l){!M&&l&&(f=d);var j=f.clone().multiply(S).add(e).applyEuler(this.getEuler()).add((new Zh).fromArray(this.p3()));this.p3([j.x,j.y,j.z])}else this.setAnchor3d(d.x,d.y,d.z);var p=new Zh(1,1,1).divide(N).multiply(S);this.s3(Math.abs(p.x),Math.abs(p.y),Math.abs(p.z)),delete q._updatingFromChildren}}},setPosition:function(G,H){var R=this;if(!R._updatingToChildren){var z;z=2===arguments.length?{x:G,y:H}:G,Rh||R._updatingFromChildren||(R._updatingToChildren=1,id(R._children,z.x-R._position.x,z.y-R._position.y),delete R._updatingToChildren),qk.superClass.setPosition.call(this,z)}},setSize3d:function(){this.beginTransaction(),qk.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(C){var n=this;if(!n._updatingToChildren){this.beginTransaction(),C=P(C,E.blockMinSize);var D=n.getTall();if(C!==D&&qk.superClass.setTall.call(n,C),!Rh&&!n._updatingFromChildren){n._updatingToChildren=1;var w=C/D;n._adjustChildTallOrScale(w,"size"),delete n._updatingToChildren,n.updateFromChildren()}this.endTransaction()}},setWidth:function(s){return this.setSize(s,this.getHeight())},setHeight:function(U){return this.setSize(this.getWidth(),U)},setSize:function(f,L){var y=E.blockMinSize;f=P(f,y),L=P(L,y);var _=this;if(!_._updatingToChildren){2!==arguments.length&&(L=f.height,f=f.width),this.beginTransaction();var X=_.getWidth(),C=_.getHeight();if(f!==X&&qk.superClass.setWidth.call(_,f),L!==C&&qk.superClass.setHeight.call(_,L),!Rh&&!_._updatingFromChildren){_._updatingToChildren=1;var D=f/X,A=L/C;_._adjustChildScaleOrSize(D,A,"size"),delete _._updatingToChildren,_.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(d,i,P){var C=this;if(C._syncSize){var b=C.getPosition(),u=C.getRotation();C.eachChild(function(V){if(mo(V)){var U=V.getPosition(),H=V.getRotation(),f=V.getWidth(),K=V.getHeight(),F=V.getScale(),p=F.x*f,q=F.y*K;if(0!==p&&0!==q){0>d*i&&V.setRotation(-1*H);var l=new mk(H,U.x,U.y,p,q);l.translate(-b.x,-b.y),l.rotate(-u),H=$g(l.b*Math.sign(p),l.a*Math.sign(p)),l.scale(d,i);var D,J,r,G=t(H);if(Math.abs(G)<.001?(D=T(H),J=l.b/D,r=-l.c/D):(J=l.a/G,r=l.d/G),"scale"===P)V.setScale(J/f,r/K);else if("size"===P){var _=J/F.x,j=r/F.y;V.setScale(zb(J)*Math.abs(F.x),zb(r)*Math.abs(F.y)),V instanceof S.Shape?(V.setWidthForce(Math.max(Math.abs(_),1e-5)),V.setHeightForce(Math.max(Math.abs(j),1e-5))):V.setSize(Math.max(.01,Math.abs(_)),Math.max(.01,Math.abs(j)))}l.rotate(u),l.translate(b.x,b.y),V.setPosition(l.tx,l.ty)}}})}},_calcChangeFactor:function(v,q,u,$){var c,D,t,O;return c=a(v),D=a(u),t=c>D?c/D:D/c,c=a(q),D=a($),O=c>D?c/D:D/c,P(t,O)},setElevation:function(k){var d=this;if(!d._updatingToChildren){var O=d.getElevation(),S=k-O;0!==S&&(Rh||d._updatingFromChildren||(d._updatingToChildren=1,id(d._children,0,S,0),delete d._updatingToChildren),qk.superClass.setElevation.apply(d,arguments))}},setScaleTall:function(l){var s=this;if(!s._updatingToChildren){var h=s.getScaleTall();if(a(l)<.01&&(l=.01*(zb(l)||zb(h))),qk.superClass.setScaleTall.call(s,l),!Rh&&!s._updatingFromChildren){s._updatingToChildren=1;var m=l/h;s._adjustChildTallOrScale(m,"size"),delete s._updatingToChildren,s._scaleChanged=1,this.updateFromChildren(),delete s._scaleChanged}}},_adjustChildTallOrScale:function(f,N){var G=this;if(G._syncSize){var x=G.getElevation();G.eachChild(function(K){if(mo(K))if("size"===N){var w=K.getTall();0>f&&K.setScaleTall(-1*K.getScaleTall()),K.setTall(Math.max(.01,Math.abs(w*f))),K.setElevation(x+(K.getElevation()-x)*f)}else{var B=K.getScaleTall();K.setScaleTall(B*f)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var A=qk.superClass.setAnchor3d.apply(this,arguments);return A&&!Rh&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),A}},setAnchor:function(){var d=this;if(!d._updatingToChildren){var V=d.getAnchor(),E=qk.superClass.setAnchor.apply(d,arguments);if(Rh||d._updatingFromChildren||!d._syncSize)return E;d._updatingToChildren=1;var j=d.getAnchor();d.getPosition();var z=d.getSize(),e=d.getScale(),g=d.getRotation(),C=-z.width*e.x*(V.x-j.x),p=-z.height*e.y*(V.y-j.y),L=T(g),B=t(g),f=B*C-L*p,l=L*C+B*p;return d.eachChild(function(r){if(mo(r)){var t=r.getPosition();r.setPosition(t.x-f,t.y-l)}}),delete d._updatingToChildren,E}},setAnchorElevation:function(){var z=this;if(!z._updatingToChildren){var f=z.getAnchorElevation(),W=qk.superClass.setAnchorElevation.apply(z,arguments);if(Rh||z._updatingFromChildren||!z._syncSize)return W;z._updatingToChildren=1;var i=z.getAnchorElevation(),s=z.getTall(),q=z.getScaleTall(),A=-s*q*(f-i);return z.eachChild(function(k){if(mo(k)){var f=k.getElevation();k.setElevation(f-A)}}),delete z._updatingToChildren,W}},setRotation:function(D){this._updateChildrenRotation3d("rotation",D)},setRotationX:function(w){this._updateChildrenRotation3d("rotationX",w)},setRotationZ:function(Y){this._updateChildrenRotation3d("rotationZ",Y)},setRotation3d:function(){var B=this;if(!B._updatingToChildren){var W=B.r3();qk.superClass.setRotation3d.apply(B,arguments);var e=B.r3();Rh||B._updatingFromChildren||(B._updatingToChildren=1,B.eachChild(function(_){mo(_)&&_.syncRotation3d(B,e,W)}),delete B._updatingToChildren)}},_updateChildrenRotation3d:function(C,T){var $=this;if(!$._updatingToChildren){var g=$[Bh(C)]();qk.superClass[Hg(C)].call($,T),Rh||$._updatingFromChildren||this._updateRotationToChildren(C,T-g)}},_updateRotationToChildren:function(A,H){var Z=this;Z._updatingToChildren=1,Z.eachChild(function(y){mo(y)&&y._11Q(Z,A,H)}),delete Z._updatingToChildren},setScale:function(Q,i){var l=this;if(!l._updatingToChildren){null==i&&(i=Q.y,Q=Q.x);var G=l.getScale();if(a(Q)<.01&&(Q=.01*(zb(Q)||zb(G.x))),a(i)<.01&&(i=.01*(zb(i)||zb(G.y))),qk.superClass.setScale.call(l,Q,i),!Rh&&!l._updatingFromChildren){l._updatingToChildren=1;var Y=Q/G.x,N=i/G.y;l._adjustChildScaleOrSize(Y,N,"size"),delete l._updatingToChildren,l._scaleChanged=1,l.updateFromChildren(),delete l._scaleChanged}}},onPropertyChanged:function(e){qk.superClass.onPropertyChanged.call(this,e),"s:3d.visible"===e.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(K){(K.s("batch")||K.s("wf.geometry")||K.s("wf.visible"))&&K.iv(),K instanceof qk&&K._invalidateChildrenBatch()})},getSerializableProperties:function(){var U=qk.superClass.getSerializableProperties.call(this);return U.clickThroughEnabled=1,U.syncSize=1,U}});var Hi=S.Grid=function(){jl(S.Grid,this)};Ef("Grid",vd,{IRotatable:!1,_icon:"grid_icon",_image:X,getUIClass:function(){return Ip},setRotation:function(){},getCellRect:function(C,J){var l=this,M=l.s("grid.row.count"),I=l.s("grid.column.count");if(0>=M||0>=I||0>C||C>=M||0>J||J>=I)return X;var K,A,b,D=l.getRect(),o=l.s("grid.row.percents"),T=l.s("grid.column.percents");
if(Nh(D,l,"grid.border",-1),o&&o._as&&(o=o._as),T&&T._as&&(T=T._as),o&&o.length===M){for(b=0,K=0;C>K;K++)b+=D.height*o[K];D.y+=b,D.height=D.height*o[C]}else D.height=D.height/M,D.y+=D.height*C;if(T&&T.length===I){for(A=0,K=0;J>K;K++)A+=D.width*T[K];D.x+=A,D.width=D.width*T[J]}else D.width=D.width/I,D.x+=D.width*J;return as(D,-l.s("grid.gap")),D}});var $e=S.Text=function(){jl($e,this),this.setSize(100,50),this.s("text","TEXT")};Ef("Text",vd,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return ro},setWidth:function(j){j||(j=.001),$e.superClass.setWidth.call(this,j)},setHeight:function(p){p||(p=.001),$e.superClass.setHeight.call(this,p)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Eq("__text__",{width:{value:100,isSafeFunc:!0,func:function(W){return W?W._width:100}},height:{value:50,isSafeFunc:!0,func:function(g){return g?g._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"}}]});var bd=S.Shape=function(){jl(bd,this),this._59O=new jn};bd.__de__=$i,Ef("Shape",vd,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Xk},_22Q:function(){return Ws},getLength:function(K){return Kp(fl(this._59O,this._58O,K,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var E=this._58O;return E?new jn(E._as.slice(0)):E},setSegments:function(p){var x=this._58O;p=p?Kc(p)?new jn(p.slice(0)):new jn(p._as.slice(0)):null,(x&&p&&x._as.join(",")!==p._as.join(",")||x!==p)&&(this._58O=p,this.fp("segments",x,p))},getPoints:function(){return this._59O},toPoints:function(){var R=this._59O;return new jn(R._as.slice(0))},getPointsMatrix2d:function(){var N=this,a=new or.Matrix2d,z=N.getPosition(),P=N.getScale(),L=N.getRotation();return a.translate(-z.x,-z.y).scale(P.x,P.y).rotate(L).translate(z.x,z.y),a},getPointsMatrix3d:function(){return function(){var F=this,S=new or.Matrix4,t=S.getElements(),s=F.p3();qq(t,s),Br(t,F.getFinalRotation3d(),F.getRotationMode());var I=F.getScale3d(),i=F._dynamicScale3d;return i&&(I[0]*=i[0],I[1]*=i[1],I[2]*=i[2]),Em(t,I),qq(t,Ym(s)),S}}(),setPoints:function(U,$){var R=this,j=R._59O;U=U?Kc(U)?new jn(U.slice(0)):new jn(U._as.slice(0)):new jn;var f,w,Q,A,p,e;$&&(f=R.getPosition(),e=new mk(R.getRotation(),0,0,R.getScale().x,R.getScale().y)),(j&&U&&j._as.join(",")!==U._as.join(",")||j!==U)&&(R._59O=U,R.fs(),R.fp("points",j,U)),$&&(w=R.getPosition(),Q=w.x-f.x,A=w.y-f.y,p=e.tf(Q,A),R.setPosition(w.x-Q+p.x,w.y-A+p.y))},setPoints3d:function(e,k){var r=new Zh(this.p3()),d=this.getPointsMatrix3d();if(d.setPosition(new Zh),Vh.superClass.setPoints.call(this,e),k){var z=new Zh(this.p3()),u=z.clone().sub(r).applyMatrix4(d);r.add(u),this.p3(r.x,r.y,r.z)}},addPoint:function($,D,y){var s=this.toPoints();s.add($,D),this.setPoints(s,y)},setPoint:function(a,H,r){var p=this.toPoints();p.set(a,H),this.setPoints(p,r)},removePointAt:function(E){var I=this.toPoints();I.removeAt(E),this.setPoints(I)},setWidthForce:function(h){var X=this;if(!X._55I&&!Rh&&X.getWidth()){X._55I=1;var c=X._position.x,K=h/X.getWidth(),C=X.toPoints(),Y=new jn;1!==K&&(C.each(function(v){Y.add({x:(v.x-c)*K+c,y:v.y,e:v.e})}),X.setPoints(Y),fj(X,[K,0,0,1,c*(1-K),0]),X.fs()),delete X._55I}bd.superClass.setWidth.call(X,h)},setWidth:function(X){return this.setWidthForce(zk>X?zk:X)},setHeightForce:function(n){var M=this;if(!M._55I&&!Rh&&M.getHeight()){M._55I=1;var r=M._position.y,m=n/M.getHeight(),h=M.toPoints(),z=new jn;1!==m&&(h.each(function(P){z.add({x:P.x,y:(P.y-r)*m+r,e:P.e})}),M.setPoints(z),fj(M,[1,0,0,m,0,r*(1-m)]),M.fs()),delete M._55I}bd.superClass.setHeight.call(M,n)},setHeight:function(E){return this.setHeightForce(zk>E?zk:E)},setAnchorElevation:function(v){var D=this;D._55I=!0;var i=D._updatingAnchor3d,n=!Rh&&!i;if(n){var j,T=v,Q=D.getAnchorElevation(),C=D.getTall();j=C*(Q-T),0!==j&&D.shiftPointsElevation(j)}var _=bd.superClass.setAnchorElevation.apply(D,arguments);return i||delete D._55I,_},getShapeElevation:function(){var l=this,P=l._54O;return P-(l.getTall()||0)*(l._anchorElevation-.5)},setAnchor3d:function(Y,_,E,t){var R,D=this;"number"==typeof Y?R={x:Y,y:_,z:E}:(R=Y.length?{x:Y[0],y:Y[1],z:Y[2]}:Y,t=_),D._55I=!0,D._updatingAnchor3d=!0;var y=D.getDataModel();if(y&&y.beginTransaction(),!Rh){var e=D.getAnchor3d(),k=D.getSize(),$=D.getTall(),C=k.width*(e.x-R.x),i=k.height*(e.z-R.z),j=$*(e.y-R.y);t||D.shiftPoints(C,i,j);var Q=D.p3()}var M=bd.superClass.setAnchor3d.apply(D,arguments);if(!Rh&&t){var J=D.p3();D.shiftPoints(J[0]-Q[0]+C,J[2]-Q[2]+i,J[1]-Q[1]+j)}return y&&y.endTransaction(),delete D._updatingAnchor3d,delete D._55I,M},setAnchor:function(I,f,q){var v=this;v._55I=!0;var H=v._updatingAnchor3d,r=!Rh&&!H;if(r){var s,e,k;"number"==typeof I?k={x:I,y:f}:(k=I.length?{x:I[0],y:I[1]}:I,q=f);var t=v.getAnchor(),R=v.getSize();s=R.width*(t.x-k.x),e=R.height*(t.y-k.y),q||v.shiftPoints(s,e);var C=v.getPosition()}var m=bd.superClass.setAnchor.apply(v,arguments);if(r){var S=v.getPosition();q&&v.shiftPoints(S.x-C.x+s,S.y-C.y+e)}return H||delete v._55I,m},shiftPoints:function(c,L,o){if(c||L||o){var j=this,C=j.getElevation()||0,Y=j.toPoints(),b=new jn;Y.each(function(G){var r=G.e;o&&(r=(r==X?C:r)+o),b.add({x:G.x+c,y:G.y+L,e:r})}),j.setPoints(b),j.fs()}},shiftPointsElevation:function(J){return this.shiftPoints(0,0,J)},setPosition:function(n,p){var K,U=this;if(!U._28Q){if(U._28Q=1,!U._55I&&!Rh){K=2===arguments.length?{x:n,y:p}:n;var G=K.x-U._position.x,m=K.y-U._position.y;if(0===G&&0===m)return delete U._28Q,void 0;U._55I=1,U.shiftPoints(G,m),fj(U,[1,0,0,1,G,m]),delete U._55I}bd.superClass.setPosition.apply(U,arguments),delete U._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var r=this;if(2!==r._59O.size())return!1;var R=r._58O;return R?2===R.size()&&1===R.get(0)&&2===R.get(1)?!0:!1:!0},fireShapeChange:function(){var J=this;if(!J._55I&&!Rh){var M=$q(J._59O);M&&(J._55I=1,J.setRect(M),delete J._55I)}J.fp(Zi,!1,!0)},getSerializableProperties:function(){var r=bd.superClass.getSerializableProperties.call(this);return r.segments=1,r.points=1,r.thickness=1,r.closePath=1,r}});var Sq=S.Points=function(){jl(Sq,this)};Ef("Points",vd,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return Xs},getPoints:function(){return this._59O},setPoints:function(v){var t=this._59O;v=v?v.slice(0):[];var e=v[0];if(po(e)){var P=v;v=[];for(var k=0,J=P.length;J>k;k+=3)v.push({x:P[k],e:P[k+1],y:P[k+2]})}this._59O=v,this._pointsDirty=!0,this.fp("points",t,this._59O)},setPoint:function(O,z){var N=this._59O.slice(0);N[O]=z,this.setPoints(N)},addPoint:function(M){this.setPoint(this._59O.length,M)},getColors:function(){return this._colors},setColors:function(k){var M=this._colors;k=k?k.slice(0):[],this._colors=k,this._colorsDirty=!0,this.fp("colors",M,k)},setPointColor:function(o,V){var b=this._colors.slice(0);b[o]=V,this.setColors(b)},getSizes:function(){return this._sizes},setSizes:function(y){var c=this._sizes;y=y?y.slice(0):[],this._sizes=y,this._sizesDirty=!0,this.fp("sizes",c,this._sizes)},setPointSize:function($,S){var D=this._sizes.slice(0);D[$]=S,this.setSizes(D)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(U){var u=this._uvoffsets;U=U?U.slice(0):[],this._uvoffsets=U,this._offsetsDirty=!0,this.fp("uvoffsets",u,this._uvoffsets)},setPointUvoffset:function(y,N,E){var T;"object"==typeof N?(T=N[0],E=N[1]):T=N;var u=this._uvoffsets.slice(0);u[2*y+0]=T,u[2*y+1]=E,this.setUvoffsets(u)},getPointInfo:function(P){var p=this.getPoints();if(!p||p[P]==X)return X;var L=p[P],r=[L.x,L.e,L.y],b=this.mat||ec(this),G=[r[0],r[1],r[2]];$c(G,b);var U=this.getColors(),A=U[P]||this.s("points.color"),M=this.getSizes(),_=M[P];return{size:_==X?this.s("points.size"):_,color:A,local:r,world:G}},getSerializableProperties:function(){var O=Sq.superClass.getSerializableProperties.call(this);return O.points=1,O.colors=1,O.sizes=1,O.uvoffsets=1,O},onPropertyChanged:function(N){Sq.superClass.onPropertyChanged.call(this,N);var i=N.property;"s:points.color"===i?this._colorsDirty=!0:"s:points.size"===i?this._sizesDirty=!0:"s:points.model"===i&&(this._modelDirty=!0)},getWidth:function(){var J=this;if(J._width>=0)return J._width;var t=J.getStyle("points.model");if(t){var i=De(t);if(i&&i.rawS3)return i.rawS3[0]}return 1},getHeight:function(){var M=this;if(M._height>=0)return M._height;var U=M.getStyle("points.model");if(U){var a=De(U);if(a&&a.rawS3)return a.rawS3[2]}return 1},getTall:function(){var N=this;if(N._tall>=0)return N._tall;var J=N.getStyle("points.model");if(J){var j=De(J);if(j&&j.rawS3)return j.rawS3[1]}return 1}});var Vh=S.Polyline=function(){jl(Vh,this),this.s({"shape.background":null,"shape.border.width":2})};Ef("Polyline",bd,{_icon:"polyline_icon",_22Q:function(){return $s},getUIClass:function(){return pk},setClosePath:function(){},setTall:function(H){var q=this,J=q.getDataModel();if(J&&J.beginTransaction(),!q._55I&&!q._24Q&&!Rh&&q.getTall()){q._24Q=1;var K=q._54O,o=H/q.getTall();if(1!==o){var O=q.toPoints(),h=new jn;O.each(function(q){h.add({x:q.x,y:q.y,e:q.e==X?q.e:(q.e-K)*o+K})}),q.setPoints(h),q.fs()}delete q._24Q}Vh.superClass.setTall.call(q,H),J&&J.endTransaction()},setElevation:function(j){var $=this,b=$.getDataModel();if(b&&b.beginTransaction(),!$._55I&&!$._24Q&&!Rh){$._24Q=1;var y=j-$._54O;0!==y&&$.shiftPointsElevation(y),delete $._24Q}Vh.superClass.setElevation.apply($,arguments),b&&b.endTransaction()},fireShapeChange:function(){var W=this,O=W._59O;if(!W._55I&&!W._24Q&&!Rh){var E=O.size();if(E){var D=1,F=O.get(0),g=W._54O;F.e==X&&(F.e=g);for(var J=F.e,K=0;E>D;D++){F=O.get(D),F.e==X&&(F.e=g);var H=d(J,F.e),M=P(J+K,F.e);J=H,K=M-H}W._24Q=1,W.setTall(K),W.setElevation(J+K*W._anchorElevation),delete W._24Q}}Vh.superClass.fireShapeChange.apply(W,arguments)}});var dr=S.SubGraph=function(){jl(dr,this)};Ef("SubGraph",vd,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){dr.superClass._8I.call(this),this.eachChild(function(B){mo(B)&&B._8I()})}}),E.loadingRefGraph=0;var Tf=S.RefGraph=function(){jl(Tf,this)};Ef("RefGraph",qk,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(L){var G=this._ref;this._ref=L,this.fp("ref",G,L),this.updateRef()},_21I:function(){Tf.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var m=this;if(E.loadingRefGraph++,m.clearChildrenFromDataModel(),E.loadingRefGraph--,m._ref&&m._dataModel){m._xhrLoadHandler&&(m._xhrLoadHandler.cancel=!0);var F=Rh,c=m._xhrLoadHandler=function(x){if(x&&m._dataModel){E.loadingRefGraph++;var e=m._pendingUpdateInfo={needToRestore:F};F&&(e.p3=m.p3(),e.s3=m.s3(),e.r3=m.r3(),e.anchor3d=m.getAnchor3d(),e.scale3d=m.getScale3d()),m.r3(0,0,0),m.setScale3d(1,1,1),m.setAnchor3d(.5,.5,.5),m.p3(0,0,0);var i=E.parse(x),h=m._dataModel.deserialize(i,m,{justDatas:!0});h.each(function(f){f._refGraph=m}),m.checkPendingUpdateInfo(),E.loadingRefGraph--,E.handleRefGraphLoaded(m,h,i)}};c.xhrLoadCalled=!1,E.load(m._ref,function(G){c.cancel||(c.xhrLoadCalled?c(G):hm(function(){c(G)}))}),c.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var U=this,C=U._pendingUpdateInfo;if(!C)return U.onPendingUpdated&&(E.loadingRefGraph++,U.onPendingUpdated(),E.loadingRefGraph--),void 0;var g=!0;this.eachChild(function(j){(j._pendingCheckImageJSON||j._pendingUpdateInfo)&&(g=!1)}),g&&(E.loadingRefGraph++,U._pendingUpdateInfo=null,U.updateFromChildren(),C.needToRestore&&(U.setAnchor3d(C.anchor3d),U.setScale3d(C.scale3d),U.r3(C.r3),U.p3(C.p3)),this.getParent()instanceof Tf&&this.getParent().checkPendingUpdateInfo(),U.onPendingUpdated&&U.onPendingUpdated(),E.loadingRefGraph--)},getSerializableProperties:function(){var m=Tf.superClass.getSerializableProperties.call(this);return m.ref=1,m}}),S.EdgeGroup=function(B,h){this._70O=B,this._siblings=h;for(var i,S,b=0,Z=B.size(),_=G[Cf];Z>b;b++)if(i=B.get(b).getStyle(Cf,!1),i!=X){_=i;break}_==X&&(_=!0);var y=E.edgeGroupAgentFunc;for(y&&(S=y(B),S&&S!==B.get(0)&&(B.remove(S),B.add(S,0))),b=0;Z>b;b++)B.get(b).s(Cf,_)},Ef("EdgeGroup",b,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(x){return this._70O.get(x)},indexOf:function(q){return this._70O.indexOf(q)},each:function(I,l){this._70O.each(I,l)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(v,G){this._siblings.each(function(h){h._70O.each(v,G)})}});var Kr=function(p,c,t){var B=Pf[p]={type:p,action:c};if(t)for(var H in t)B[H]=t[H]};Vm(E,{setConnectAction:Kr,getConnectAction:function(y,c){if(!c){if(!y)return null;c=y.getCurrentConnectActionType()}return Pf[c]},doConnectAction:function(I,W,E,f){f=f||I.getCurrentConnectActionType();var x=Pf[f];if(!x)return!1;var a=x.action;return a?(W instanceof vc.Group?I.sm().getSelection().each(function(y){a.call(null,I,y,E)}):a.call(null,I,W,E),!0):!1},doDeleteConnectionAction:function(m,J,H){H=H||m.getCurrentConnectActionType();var t=Pf[H];if(!t||!t.delete)return!1;var e=t.delete.action;return e?(J instanceof vc.Group?m.sm().getSelection().each(function(B){e.call(null,m,B)}):e.call(null,m,J),!0):!1}});var Vc=S.JSONSerializer=function(y,V){this.dm=this._dataModel=y,this._hierarchical=E.forceHierarchicalSerialization?!0:V==X?y.isHierarchicalRendering():V};Ef("JSONSerializer",b,{ms_ac:["hierarchical"],serialize:function(Q){return E.stringify(this.toJSON(),Q)},toJSON:function(){var Y,o=this,s=o.dm,R=s.getRoots(),b=o.json={v:E.getVersion(),p:{},a:{},d:[]},S=s.getSerializableAttrs();(Y=s.getInit())&&(b.init=Y),(Y=s.getName())&&(b.p.name=Y),(Y=s.getBackground())&&(b.p.background=Y),(Y=s.getLayers())&&(b.p.layers=Y),(Y=s.getEnvmap())&&(b.p.envmap=Y),(Y=s.getEnvmapType())&&(b.p.envmapType=Y),b.p.autoAdjustIndex=s.isAutoAdjustIndex(),b.p.hierarchicalRendering=s.isHierarchicalRendering();for(var k in S){var v=s.a(k);v!==p&&o[xk](k,v,b.a)}return Ub(b.a)&&delete b.a,o._hierarchical?R.each(o.serializeData,this):s.each(function(l){o.serializeData(l)}),s.fireSerializeEvent({type:"serialize",json:b}),s.getPostProcessingData()&&(b.p.postProcessingData=s.getPostProcessingData()),b},isSerializable:function(){return!0},getProperties:function(K){return K.getSerializableProperties()},getStyles:function(O){return O.getSerializableStyles()},getAttrs:function(y){return y.getSerializableAttrs()},serializeData:function(o){var n=this;if(n.isSerializable(o)&&!o._refGraph){var M,$,f,q,R=Fg(o.getClassName())||o.getClass(),x=new R,K={c:o.getClassName(),i:o.getId(),p:{},s:{},a:{}};n.json.d.push(K),M=n.getProperties(o);for($ in M)if(/^_/.test($)){if(f=o[$],!("_width"!==$&&"_height"!==$||f!=X&&-1!==f)){var r;((o.s("layout.h")||o.s("layout.v"))&&o.getHost()||o instanceof S.Node&&(r=o.getParent())&&r instanceof S.Block||o.s("fullscreen"))&&(f=o[$]="_width"===$?o.getWidth():o.getHeight())}f!==x[$]&&n[xk]($.substr(1),f,K.p)}else q=Bh($),o[q]&&(f=o[q](),f!==x[q]()&&n[xk]($,f,K.p));M=n.getStyles(o);for($ in M)f=o.s($),f!==x.s($)&&n[xk]($,f,K.s);M=n.getAttrs(o);for($ in M)f=o.a($),f!==x.a($)&&n[xk]($,f,K.a);Ub(K.p)&&delete K.p,Ub(K.s)&&delete K.s,Ub(K.a)&&delete K.a}n._hierarchical&&o.getChildren().each(n.serializeData,n)},serializeValue:function(v,m,V){Sd(m)?m={__a:m._as}:m instanceof $m?m={__i:m.getId()}:m instanceof pf&&(m={__dm:m.serialize(0)}),V[v]=m},deserialize:function(A,N,B){var i=this;return tc(A)&&/.json$/.test(A)?(E.xhrLoad(A,function(l){i.deserializeImpl(l,N,B)}),void 0):i.deserializeImpl(A,N,B)},deserializeImpl:function(D,r,a){var q=this,Q=q.dm;Q.setDeserializing(!0),a=Pk(a)?{setId:a}:Uq(a)?{finishFunc:a}:a||{},D=q.json=tc(D)?E.parse(D):D,!a.justDatas&&D.a&&D.a.onPreDeserialize&&!a.disableOnPreDeserialize&&D.a.onPreDeserialize(D,Q,a.view),Q.beginTransaction(),Rh++,q._82I={};var j=new jn,m=new jn,V=0,h=D.d.length;if(a.justDatas||(!a.disableInit&&Uq(D.init)&&D.init(Q),Q.setInit(D.init)),!a.justDatas){for(var u in D.a)Q.a(u,q[ho](D.a[u]));for(var M in D.p)Q[Hg(M)](D.p[M])}for(;h>V;V++){var S=D.d[V],n=Fg(S.c),p=new n,P=S.i;a.setId&&P!=X&&(p._id=P),q._82I[P]=p,j.add(p),m.add(S)}for(V=0;h>V;V++)q.deserializeData(j.get(V),m.get(V));return j.each(function(s){r&&!s.getParent()&&s.setParent(r),Q.add(s)}),a.__innerHandler__&&a.__innerHandler__(D,Q,a.view,j),Q.fireSerializeEvent({type:"deserialize",json:D}),Rh--,Q.endTransaction(),!a.justDatas&&D.a&&D.a.onPostDeserialize&&!a.disableOnPostDeserialize&&D.a.onPostDeserialize(D,Q,a.view,j),a.finishFunc&&a.finishFunc(D,Q,a.view,j),Q.setDeserializing(!1),j},deserializeData:function(U,M){for(var w in M.p)U[Hg(w)](this[ho](M.p[w]));for(w in M.s)U.s(w,this[ho](M.s[w]));for(w in M.a)U.a(w,this[ho](M.a[w]))},deserializeValue:function(M){if(Mj(M)){var j=M.__i;if(j!=X)return this._82I[j];if(j=M.__dm,j!=X){var o=new S.DataModel;return o.deserialize(j),o}if(j=M.__a,Kc(j))return new jn(j)}return M}}),Vm(pf,{serialize:function(V,U){return new Vc(this,U).serialize(V)},toJSON:function(M){return new Vc(this,M).toJSON()},deserialize:function(h,n,q){return new Vc(this).deserialize(h,n,q)}});var hc=S.OverlappingBox=function(b){this.gv=b,this.boxes={}};Ef("OverlappingBox",b,{clear:function(){var F,X,D=this.boxes;for(F in D)X=D[F],X.length=0},isOverlapping:function(f,S){var j,b,o=this,H=o.boxes,e=H[f];e?(j=e.rects,b=e.length):e=H[f]={rects:j=[],length:b=0};var h,u,S;for(h=0;b>h;h++)if(u=j[h],u.x<S.x+S.w&&u.x+u.w>S.x&&u.y<S.y+S.h&&u.h+u.y>S.y)return!0;return j.length<=b?(j.push(S),e.length++):j[e.length++]=S,!1}}),Vm(E,{fetch:function(B,t){var L="GET",e=!1,d=null,y="";t&&(L=t.method||"GET",e=t.sync,y=t.url,d=t.data||null),B.open(L,y,!e),t.responseType?B.responseType=t.responseType:t.overrideMimeType&&B.overrideMimeType&&B.overrideMimeType(t.overrideMimeType),B.send(d)},convertImageSrc:function(V,b){b&&"function"==typeof b||(b=function(){}),b(V)}});var _r=S.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Ef("Request",b,{_responseType:null,_overrideMimeType:"text/plain",send:function(N){var s=this._xhr,Z=this.onload,P=this.onerror;this.getResponseType()?N.responseType=this.getResponseType():this.getOverrideMimeType()&&(N.overrideMimeType=this.getOverrideMimeType()),s.onload=Z,s.onerror=P,E.fetch(s,N)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(l){this._responseType=l},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(I){this._overrideMimeType=I},getResponseText:function(){var A=this._xhr;return A.response||A.responseText}}),Um.GraphView=function(S){var U=this;U._24I={},U._34I=new jn,U.enableDirtyRect(),U._25I={},U._56I={},U._view=Mn(1,U),U._canvas=_i(U._view),U.dm(S?S:new pf),this._coreInteractor=new Xj(this),U.setEditable(!1),U.setScrollBarVisible(E.graphViewScrollBarVisible),U._initView()},Fp("GraphView",b,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Gb,lh,cb,Xq,"resettable","editInteractor",rq,"zoomable","pannable","rectSelectable","autoScrollZone",Bj,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:E.graphViewZoomable,_resettable:E.graphViewResettable,_pannable:E.graphViewPannable,_rectSelectable:E.graphViewRectSelectable,_autoScrollZone:E.graphViewAutoScrollZone,_rectSelectBackground:E.graphViewRectSelectBackground,_rectSelectBorderColor:E.graphViewRectSelectBorderColor,_editPointSize:E.graphViewEditPointSize,_editPointBorderColor:E.graphViewEditPointBorderColor,_editPointBackground:E.graphViewEditPointBackground,_scrollBarColor:Yj,_scrollBarSize:jh,_autoHideScrollBar:oj,_autoMakeVisible:Hc,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(s){this._dataModel.setLayers(s)},setEditable:function(Y){var c=this,Z=c.__interactorMap__;if(!Z){var a=Um.XEditInteractor;Z=c.__interactorMap__={scrollBar:new ij(c),select:new ik(c),edit:a?new a(c):new yr(c),text:new wj(c),move:new Vq(c),"default":new Wd(c),touch:new Tq(c,{editable:!1})}}Y?(c._uieditable=!0,c.setInteractors([Z.scrollBar,Z.select,Z.edit,Z.text,Z.move,Z.default,Z.touch])):(c._uieditable=!1,c.setInteractors([Z.scrollBar,Z.select,Z.move,Z.default,Z.touch]))},getCanvas:function(){return this._canvas},_33I:function(S){var y=S.getUIClass();return y?new y(this,S):X},getDataUI:function(X){var n=this,B=n._25I[X._id];return B===p&&(B=n._33I(X),n._25I[X._id]=B),B},getNodeRect:function(C){return E.getNodeRect(this,C)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(b){var W=this.getDataUI(b);return W?(W._79o(),W._78o):null},getEdgeSourcePosition:function(o){var y=this,E=y.getDataUI(o),S=E.s,M=E._data._40I;return qd(y,M,S("edge.source.position"),S("edge.source.offset.x"),S("edge.source.offset.y"),S("edge.source.anchor.x"),S("edge.source.anchor.y"))},getEdgeTargetPosition:function(o){var y=this,D=y.getDataUI(o),t=D.s,Y=D._data._41I;return qd(y,Y,t("edge.target.position"),t("edge.target.offset.x"),t("edge.target.offset.y"),t("edge.target.anchor.x"),t("edge.target.anchor.y"))},invalidateAll:function(M){var y=this;if(M){for(var P in y._25I){var W=y._25I[P];W&&W.dispose()}y._25I={},y._56I={},y._24I={},y._34I.clear(),y.redraw()}else y.dm().each(function(l){y.invalidateData(l)})},invalidateSelection:function(){var e=this;e.sm().each(function(E){e.invalidateData(E)})},invalidateData:function(e){var u=this;u._24I[e._id]=e,u._21Q(e),u.iv()},_21Q:function(e){var G=this,W=G._24I;if(br(e)&&ms[e.s(Ug)]){var q=e.getSourceAgent();q&&q.getAgentEdges().each(function(s){W[s._id]=s}),q=e.getTargetAgent(),q&&q.getAgentEdges().each(function(E){W[E._id]=E}),G.iv()}},redraw:function(Q){var K=this;K._32I||(Q?K._34I.add(Q):(K._32I=1,K._34I.clear()),K.iv())},each:function(g,B){var F,U,z,l=0,G=this.getLayers(),N=this._dataModel,O=N._datas._as,i=O.length;if(G){for(var V=G.length;V>l;l++)if(z=G[l],Mj(z)&&(z=z.name),N.isHierarchicalRendering()){var c=function(i){return i._layer===z?B?g.call(B,i):g(i):void 0};if(this._dataModel.eachByHierarchical(c)===!1)return}else for(var h=0;i>h;h++)if(F=O[h],F._layer===z&&(U=B?g.call(B,F):g(F),U===!1))return}else if(N.isHierarchicalRendering())this._dataModel.eachByHierarchical(g,null,B);else for(;i>l;l++)if(F=O[l],U=B?g.call(B,F):g(F),U===!1)return},reverseEach:function(t,v){var E,w,X,d,q=this._dataModel,U=q._layers,F=q._datas._as,r=F.length;if(U){for(E=U.length-1;E>=0;E--)if(d=U[E],Mj(d)&&(d=d.name),q.isHierarchicalRendering()){var n=function(B){return B._layer===d?v?t.call(v,B):t(B):void 0};if(q.reverseEachByHierarchical(n)===!1)return}else for(var M=r-1;M>=0;M--)if(w=F[M],w._layer===d&&(X=v?t.call(v,w):t(w),X===!1))return}else if(q.isHierarchicalRendering())q.reverseEachByHierarchical(t,null,v);else for(E=r-1;E>=0;E--)if(w=F[E],X=v?t.call(v,w):t(w),X===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var B=this,S=B._84I;if(!S){var l=this.dm().a("width"),w=this.dm().a("height");l>0&&w>0?B._84I={x:0,y:0,width:l,height:w}:(B.each(function($){B.isVisible($)&&(S=Mb(S,B.getDataUIBounds($)))}),B._84I=S?S:dm)}return B._84I},getScrollRect:function(){return Mb(this.getContentRect(),this._29I)},makeCenter:function(_,s,C){var y=this;if(!y.getWidth()||!y.getHeight())return C||hm(y.makeCenter,y,[_,s,!0],500),void 0;y.makeVisible(_),y.validate();var g=y.getDataUIBounds(_);if(g){var Z=y.getWidth(),z=y.getHeight(),k=g.x+g.width/2,H=g.y+g.height/2,t=-k*y._zoom+Z/2,c=-H*y._zoom+z/2;y.setTranslate(t,c,s)}},fitData:function(o,b,y,T,m){var t=this;if(!t.getWidth()||!t.getHeight())return m||hm(t.fitData,t,[o,b,y,T,!0],500),void 0;var Q=function(){t.makeVisible(o),t.validate();var R=t.getDataUIBounds(o);R&&(R=Nq(R),as(R,y==X?20:y),t.fitRect(R,b,T))};b?E.callWhenLoaded(Q):Q()},fitContent:function(y,x,J,_){var S=this;if(!S.getWidth()||!S.getHeight())return _||hm(S.fitContent,S,[y,x,J,!0],500),void 0;var w=function(){S.validate();var a=Nq(S.getContentRect());as(a,x==X?20:x),S.fitRect(a,y,J)};y?E.callWhenLoaded(w):w()},fitRect:function(B,H,e){var R=this,A=R.getWidth(),n=R.getHeight(),K=B.x+B.width/2,D=B.y+B.height/2,z=d(A/B.width,n/B.height),k=R._zoom,q=-K*k+A/2,P=-D*k+n/2;0===z||isNaN(z)||(e&&(z=d(1,z)),H?(R._65I&&(delete R._65I.finishFunc,R._65I.stop(!0)),R._14o&&R._14o.stop(!0),R.setTranslate(q,P,{finishFunc:function(){R.setZoom(z,H)}})):(R.setTranslate(q,P),R.setZoom(z)))},fitSelection:function(O,E,a){var K=this,J=K.sm(),Q=null;J.size()&&(J.each(function(W){Q=Mb(K.getDataUIBounds(W),Q)}),O&&as(Q,O),K.fitRect(Q,E,a))},toCanvas:function(s,P,X){P=P||this._zoom,this.validateImpl();var g=this,J=g.getContentRect();X&&as(J,X),J.width||(J.width=10),J.height||(J.height=10);var m=_i(),n=J.x*P,b=J.y*P,Y=Math.ceil(J.width*P),U=Math.ceil(J.height*P);zl(m,Y,U,1);var e=dk(m);s=s||this._dataModel.getBackground(),s&&Ve(e,0,0,Y,U,s),Pb(e,-n,-b),e.scale(P,P);var h=this._zoom;return this._zoom=P,g._42(e),this._zoom=h,e.restore(),m},toDataURL:function(v,h,Y,p){return this.toCanvas(v,Y,p).toDataURL(h||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(r,L){var X=this,F=X.dm().getBackground();if(F){var k=X.dm().a("width"),C=X.dm().a("height");k>0&&C>0&&Ve(r,0,0,k,C,F)}var x=X.__htmlOrderList,m=[],M=X._forcedLayoutHTML;if(X._93db(r,L),X.each(function(Z){var s=X.getDataUI(Z);if(s){var p=X._56I[Z._id],K=s._htmlView;if(p){var G=s._79o();if(K=s._htmlView,S.HtmlNode&&Z instanceof S.HtmlNode)s._42(r);else{var l=X.getViewRect(),x=K&&K.layoutHTML;!L||go(L,G)?(x&&(K.layoutHTML(),s.__outerLayout&&delete s.__outerLayout),s._42(r)):go(l,G)||!x||s.__outerLayout&&!M||(K.layoutHTML(),s.__outerLayout=!0)}}K&&(m.push(K),K.getView&&(K=K.getView()),K.style.display=p?"block":Ui)}}),x&&m.length>0){var Y=!1;if(x.length!==m.length)Y=!0;else for(var u=0;u<m.length;u++)if(m[u]!==x[u]){Y=!0;break}Y&&(m.forEach(function(U){U.autoAdjustIndex!==!1&&X.appendHTML(U,!0)}),this.__htmlOrderList=m)}else this.__htmlOrderList=m;X._92db(r,L)},disableDirtyRect:function(){this._shouldRedrawAll=g},enableDirtyRect:function(){var W=this;W._shouldRedrawAll=function(){return W._32I}},validateImpl:function(){this.tryUpdateRootData();var Z,u,w,Q,t,B=this,S=B.tx(),N=B.ty(),X=B._zoom,J=B._canvas,K=this.getWidth(),l=this.getHeight(),C=B._29I,A={x:-S/X,y:-N/X,width:K/X,height:l/X},i={},n=B._34I,H=B._24I,s=B._shouldRedrawAll(),T=B._23I;B._24I={},(K!==J.clientWidth||l!==J.clientHeight)&&(zl(J,K,l),s=1,B._forcedLayoutHTML=1),s||bq(A,C)||(s=1,B._forcedLayoutHTML=1),B._29I=A,B.each(function(G){u=G._id;var C=i[u]=B.isVisible(G);C!==B._56I[u]&&(H[u]=G,w=B.getDataUI(H[u]),w&&w._84o(C),B._84o(G,C))},B);for(u in H)w=B.getDataUI(H[u]),w&&(!s&&B._56I[u]&&(t=w._79o(),t&&n.add(t)),w.invalidate()),B._83I=1;if(B._56I=i,!s)for(u in H)i[u]&&(w=B.getDataUI(H[u]),w&&(t=w._79o(),t&&n.add(t)));if(s?Q=A:(n.each(function(o){go(A,o)&&(Q=Mb(Q,o))}),Q&&(as(Q,P(1,1/X)),Q.x=x(Q.x*X)/X,Q.y=x(Q.y*X)/X,Q.width=I(Q.width*X)/X,Q.height=I(Q.height*X)/X,Q=qs(A,Q))),B._74O=Q,Q&&0!==Q.width&&0!==Q.height){Z=dk(J);var $=Q.x,h=Q.y,y=Q.width,z=Q.height;$=Math.floor(($*X+S)*yh),h=Math.floor((h*X+N)*yh),y=Math.ceil(y*X*yh)+1,z=Math.ceil(z*X*yh)+1,s||(Q.x=($/yh-S)/X,Q.y=(h/yh-N)/X,Q.width=y/yh/X,Q.height=z/yh/X),Z.beginPath(),Z.rect($,h,y,z),Z.clip(),Z.clearRect($,h,y,z),xn(Z,S,N,X),B._42(Z,Q),Z.restore(),delete B._74O}if(n.clear(),delete B._32I,delete B._forcedLayoutHTML,T&&K>0&&l>0){var w=B.getDataUI(T);if(w){var t=w._79o(),p=B._29I,F=p.x,D=p.y,a=p.width,o=p.height,X=B._zoom;t&&!go(t,p)&&(t.x+t.width<F&&B.tx(-t.x*X),t.x>F+a&&B.tx(-(t.x+t.width-a)*X),t.y+t.height<D&&B.ty(-t.y*X),t.y>D+o&&B.ty(-(t.y+t.height-o)*X))}delete B._23I}B._83I&&(delete B._83I,delete B._84I),B._98O(),B.countFrame(),Ub(B._24I)||hm(B.iv,B)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var Q,M=this.getFullscreenDatas();for(var V in M)Q=M[V],this.scaleRootData(Q);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(h){var x=h.s("fullscreen");if("uniform"===x||"fill"===x){h.getRotation()&&h.setRotation(0);var z=h.s("fullscreen.gap")||0,U=this.getWidth(),C=this.getHeight();if(U&&C){var v,L,M,V=U-2*z,w=C-2*z,A=h.getAnchor(),X=h.getScaledSize(),q=X.width,b=X.height,P=h.s("fullscreen.lock");if(P)return"uniform"===x?V/w>q/b?(v=w/b,q=b*V/w):(v=V/q,b=q*w/V):"v"===P?(v=w/b,q=V/v,h.getWidth()!==q&&h.setWidth(q)):(v=V/q,b=w/v,h.getHeight()!==b&&h.setHeight(b)),this.setZoom(v),L=z-(h.getX()-A.x*q)*v,M=z-(h.getY()-A.y*b)*v,L!==this.tx()&&this.tx(L),M!==this.ty()&&this.ty(M),void 0;L=this.tx(),M=this.ty(),v=this._zoom;var p={x:(-L+z)/v,y:(-M+z)/v,width:V/v,height:w/v};if("uniform"===x){var k=q/b,T=Math.min(p.width,p.height*k),O=T/k;p.x+=.5*(p.width-T),p.y+=.5*(p.height-O),p.width=T,p.height=O}V=p.width/h.getScaleX(),w=p.height/h.getScaleY(),(h.getWidth()!=V||h.getHeight()!==w)&&h.setSize(V,w);var g=p.x+A.x*p.width,F=p.y+A.y*p.height,Y=h.getPosition();(g!==Y.x||F!==Y.y)&&h.setPosition(g,F)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(C){var w=this;C!==w.isScrollBarVisible()&&(C?(vb(w._view,w._79O=_j()),vb(w._79O,w._27I=_j()),vb(w._79O,w._28I=_j())):(cp(w._79O),delete w._79O,delete w._27I,delete w._28I),w.fp("scrollBarVisible",!C,C))},getDebugTip:function(){return""},showScrollBar:function(){var n=this;n._79O&&(n._85I||(td(function(){n._86I()},Eb),n.iv()),n._85I=new Date)},_86I:function(){var Z=this;if(Z._85I){var I=new Date,K=I.getTime();K-Z._85I.getTime()>=Eb?(delete Z._85I,Z.iv()):td(function(){Z._86I()},Eb)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var c=this,q=this._27I,Y=this._28I;if(c._79O){if(c._autoHideScrollBar&&!c._85I)return q.style.visibility=Ik,Y.style.visibility=Ik,void 0;var f=c.getScrollBarColor(),s=c._zoom,$=c.getScrollBarSize(),P=c.getViewRect(),y=c.getScrollRect(),E=P.height*s,B=y.height*s,O=P.width*s-$-2,V=E*((P.y-y.y)*s/B),h=E*(E/B),b=q.style;B-.5>E?(ub>h&&(V=V+h/2-ub/2,0>V&&(V=0),V+ub>E&&(V=E-ub),h=ub),zd(q,O,V,$,h),b.visibility=_c,b.background=f,b.borderRadius=$/2+Dp):b.visibility=Ik;var U=P.width*s,I=y.width*s,V=P.height*s-$-2,O=U*((P.x-y.x)*s/I),J=U*(U/I),b=Y.style;I-.5>U?(ub>J&&(O=O+J/2-ub/2,0>O&&(O=0),O+ub>U&&(O=U-ub),J=ub),zd(Y,O,V,J,$),b.visibility=_c,b.background=f,b.borderRadius=$/2+Dp):b.visibility=Ik}},setDataModel:function(G){var I=this,Y=I._dataModel,Z=I._selectionModel;Y!==G&&(Y&&(Y.ump(I.handleDataModelPropertyChange,I),Y.umm(I.handleDataModelChange,I),Y.umd(I.handleDataPropertyChange,I),Y.removeIndexChangeListener(I._75O,I),Y.removeHierarchyChangeListener(I.handleHierarchyChange,I),Z||Y.sm().ums(I.handleSelectionChange,I)),I._dataModel=G,G.mp(I.handleDataModelPropertyChange,I),G.mm(I.handleDataModelChange,I),G.md(I.handleDataPropertyChange,I),G.addIndexChangeListener(I._75O,I),G.addHierarchyChangeListener(I.handleHierarchyChange,I),Z?Z._21I(G):G.sm().ms(I.handleSelectionChange,I),I.invalidateAll(!0),I.fp(Zd,Y,G),I.updateBackground())},getLayersInfo:function(){if(this._layersInfo===p){var y=this.getLayers();y?(this._layersInfo={},y.forEach(function(S){var V=Mj(S)?S.name:S;this._layersInfo[V]=S},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(c,X,m){var q,B,P=this,D=P.getDataUI(c),J=yp(D),y=Mq(X,function(S){return oq(J,100*S)
},100,.001),t=oq(J,100*y);if(!m){var i=Qi(D),M=new Qf(t.x,t.y),z=49/(P._zoom*P._zoom);for(q=0,B=i.length;B>q;q++)if(M.distanceToSquared(i[q])<z)return{index:q,point:i[q],distance:Math.sqrt((i[q].x-X.x)*(i[q].x-X.x)+(i[q].y-X.y)*(i[q].y-X.y))}}return{percent:y,point:t,distance:Math.sqrt((t.x-X.x)*(t.x-X.x)+(t.y-X.y)*(t.y-X.y))}},calculateAttachPoint:function(){var H=new Qf,L=new Qf,a=new Qf;return function(_,l){var D=this.getAttachPoints(_);if(!D||!D.length)return null;a.set(l.x,l.y);for(var G,w,Q,u,r,e=1/0,q=0,y=D.length;y>q;q++)Q=D[q],L.x=Q.x,L.y=Q.y,H.x=Q.offsetX||0,H.y=Q.offsetY||0,u=qd(this,_,0,H.x,H.y,L.x,L.y),w=a.distanceToSquared(u),e>w&&(G=q,e=w,r=u);e=Math.sqrt(e);var K=this.getAttachStyle(_);if("close"===K){var Z=_.s("attach.close.threshold")/this._zoom;if(e>Z)return null}return{index:G,distance:e,info:D[G],point:r}}}(),getAttachPoints:function(Q){var G=Q.s("attach.points");if(G)return G;var A=ir(Q._image);return A?Qn(A.attachPoints,Q,this)||null:void 0},getAttachStyle:function(W){var S=W.s("attach.style");if(S)return S;var E=ir(W._image);return E?Qn(E.attachStyle,W,this)||"close":void 0},updateLayers:function(){this._layersInfo=p,this.invalidateSelection(),this.redraw()},updateBackground:function(){var h=this.dm().a("width"),u=this.dm().a("height");this._canvas.style.background=h>0&&u>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(g){if("background"===g.property){var F=this._canvas.style.background,V=g.newValue||"";this.updateBackground(),this.fp("canvasBackground",F,V),this.redraw()}else"a:width"===g.property||"a:height"===g.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===g.property?this.updateLayers():"hierarchicalRendering"===g.property&&this.redraw()},handleDataPropertyChange:function(k){this.dm().isHierarchicalRendering()&&"parent"===k.property&&k.data.hasChildren()&&this.redraw(),this.invalidateData(k.data)},onPropertyChanged:function(t){var l=this,K=t.property;if(l.redraw(),"zoom"===K){var X=l.sm().getSelection();X.size()&&X.each(function(G){G.invalidate()})}else"dataModel"===K&&(l._83I=1);Vb[K]?l.showScrollBar():K===rq&&l.onCurrentSubGraphChanged(t)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(A){var k=this,d=A.kind,e=A.data;if(k._83I=1,"add"===d)k.invalidateData(e),br(e)&&e.getEdgeGroup()&&e.getEdgeGroup().eachSiblingEdge(k.invalidateData,k),e.getHost&&e.getHost()&&e.getHost().updateLayoutAttaches();else if(d===Uc){k._21Q(e);var D=e._id,R=k._25I[D];if(R){if(k._56I[D]){var L=R._79o();L&&k.redraw(L)}R.dispose(),delete k._25I[D],delete k._24I[D],delete k._56I[D]}e===k._currentSubGraph&&k.setCurrentSubGraph(X)}else d===ef&&(k.invalidateAll(!0),k.setCurrentSubGraph(X))},_75O:function(k){this.invalidateData(k.data)},handleHierarchyChange:function(R){this.dm().isHierarchicalRendering()&&R.data.hasChildren()&&this.redraw(),this.invalidateData(R.data)},adjustIndex:function(m){var B=this;if(B.isVisible(m)){B.dm().beginTransaction();for(var z=m;z._parent&&B.isVisible(z._parent);)z=z._parent;z&&z!==m&&B._dataModel.adjustIndex(z),B._dataModel.adjustIndex(m),B.dm().endTransaction()}},getImage:function(F){return F.getImage?F.getImage():p},getSelectWidth:function(M){var t=ir(this.getImage(M));return t&&Qn(t.disableSelectedBorder,M,this)?0:M.s("select.width")},getSelectColor:function(D){return D.s("select.color")},isSelectable:function(c,S){if(this.isSelected(c))return!0;if(!S&&c.getParent()instanceof qk&&this.isSelectable(c.getParent(),!0)&&c.getParent().isSyncSize())return!1;var e=this.getLayersInfo();if(e){var l=e[c._layer];if(l&&l.selectable===!1)return!1}return c.s("2d.selectable")&&this.sm().isSelectable(c)},isMovable:function(L){var I=this;if(br(L)&&L.getStyle(Ug)!==tk)return!1;var q=this.getLayersInfo();if(q){var G=q[L._layer];if(G&&G.movable===!1)return!1}return L.s("2d.movable")?I._movableFunc?I._movableFunc(L):!0:!1},isEditable:function(i){var Q=this;if(S._uiSerializing)return Q._uieditable;if(!Q._editInteractor||!Q.isSelected(i))return!1;if(Tl(i)){var s=Q.getDataUI(i);if(!s||s._88I)return!1}if(br(i)&&i.getStyle(Ug)!==tk)return!1;var Y=this.getLayersInfo();if(Y){var O=Y[i._layer];if(O&&O.editable===!1)return!1}return i.s("2d.editable")?Q._editableFunc?Q._editableFunc(i):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(E){return mo(E)&&0!==E.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(E):!0},isRectEditable:function(s){return this._rectEditableFunc?this._rectEditableFunc(s):!0},isAnchorEditable:function(S){return this._anchorEditableFunc?this._anchorEditableFunc(S):!0},isRotationEditable:function(P){return P.setRotation&&P.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(P):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(p){var z=p.getAnchor(),C=p.getScale(),a=this._zoom,U=te(p.getRotation(),0,-p.getHeight()*C.y*z.y-(C.y<0?-1:1)*(Iq?32:16)/a),y=p.p();return U.x+=y.x,U.y+=y.y,U},getLogicalPoint:function(j){var Q=this;return Bm(j,Q._canvas,Q.tx(),Q.ty(),Q._zoom,Q._zoom)},getScreenPoint:function(_,J){var E,S=this;return"object"==typeof _?_.x!==p?(E=_.x,J=_.y):(E=_[0],J=_[1]):E=_,Lf(E,J,S._canvas,S.tx(),S.ty(),S._zoom,S._zoom)},getSelectedDataAt:function(b){var w=this;return this.getDataAt(b,function(H){return w.isSelected(H)})},getDataInfoAt:function(C,n,R){var G,m=this.lp(C),t=this.getDataAt(m,n,R);if(t){var r=this.getDataUI(t);G={data:t,ui:r,point:m};var p=r._38o;if(p){var s=p.icons;for(var B in s){var K=s[B],Q=p.rects[B];if(Q)for(var $=Qn(K.names,t,this),A=$?$.length:0,i=Q.rotation,h=A-1;h>=0;h--){var c=$[h],k=Q[h];if(Ue(k,m,i))return G.part="icons",G.name=B,G.icon=c,G.rect=k,G.index=h,G.rotation=i,G}}}if(this.isNoteVisible(t)){if(r.note2Info&&Ue(r.note2Info.clickRect,m,X,r.note2Info.scale))return G.part="note2",G;if(r.noteInfo&&Ue(r.noteInfo.clickRect,m,X,r.noteInfo.scale))return G.part="note",G}if(this.isLabelVisible(t)){if(r.label2Info&&Ue(r.label2Info.rect,m,r.label2Info.rotation,r.label2Info.scale))return G.part="label2",G;if(r.labelInfo&&Ue(r.labelInfo.rect,m,r.labelInfo.rotation,r.labelInfo.scale))return G.part="label",G}if(t.isInRect&&t.isInRect(m))return G.part="body",G}return G},getDataAt:function(c,M,g){c.target&&(c=this.lp(c));var K,W=this._zoom;return this.reverseEach(function(B){return(M?M(B):this.isSelectable(B))&&this.rectIntersects(B,Oh(c.x,c.y,g,W))?(K=B,!1):void 0},this),K},getIconInfoAt:function(s,F){var T=this;if(s.target&&(s=T.lp(s)),F||(F=T.getDataAt(s)),F){var D=T.getDataUI(F);if(D&&D._38o){var J,v=D._38o,B=new jn;for(J in v.icons)B.add(J);for(var R=B.size()-1;R>=0;R--){J=B.get(R);for(var A=v.rects[J],p=A.rotation,h=A.length-1;h>=0;h--){var S=A[h],k=S.width,M=S.height,E={x:s.x-S.x-k/2,y:s.y-S.y-M/2};p!=X&&(E=te(-p,E.x,E.y));var S={x:-k/2,y:-M/2,width:k,height:M};if(Ue(S,E))return{key:J,index:h,name:v.icons[J].names[h],rect:A[h],point:s,rotation:p,relativeRect:S,relativePoint:E,data:F}}}}}return X},getDatasInRect:function(c,G,i){i===p&&(i=1);var $=this,J=new jn;return $.reverseEach(function(t){i&&!$.isSelectable(t)||(G?$.rectIntersects(t,c):$.rectContains(t,c))&&J.add(t)}),J},moveSelection:function(f,z){var d=this;d.dm().beginTransaction(),id(d.sm().toSelection(d.isMovable,d),f,z),d.dm().endTransaction()},moveDatas:function(z,t,O){var c=this;c.dm().beginTransaction(),z instanceof jn||(z=new jn(z)),id(z,t,O),c.dm().endTransaction()},getDataUIBounds:function(N){var U=this.getDataUI(N);return U?U._79o():X},drawData:function(l,A,m){var f=this.getDataUI(A);if(f){var $=f._79o();(!m||go(m,$))&&(f._42(l),A instanceof S.Block&&A.eachChild(function(d){this.isVisible(d)&&this.drawData(l,d,m)},this))}},getBoundsForGroup:function(h){return h.s(gh)?this.getDataUIBounds(h):X},isPixelPerfect:function(P){return P.s("pixelPerfect")},rectIntersects:function(U,_){this.validate();var N=X;if(this._56I[U._id]){var A=this._25I[U._id];if(A){var S=A._79o();if(bi(_,S))N=!0;else if((_=qs(_,S))&&(A.rectIntersects&&(N=A.rectIntersects(_)),N==X)){if(!this.isPixelPerfect(U))return!0;var M=_.x,P=_.y,H=_.width,w=_.height,i=this._zoom,k=E.hitMaxArea,d=H*w*i*i;if(d>k){var c=Math.sqrt(k/d);i*=c}H*=i,w*=i,2>H&&(H=2),2>w&&(w=2),M*=i,P*=i;var L=mf(H,w);Pb(L,-M,-P),L.scale(i,i),this._drawForChecking=!0,this.drawData(L,U,_),this._drawForChecking=!1;try{for(var u=0,e=L.getImageData(0,0,H,w).data;u<e.length;u+=4)if(0!==e[u+3]){N=!0;break}L.restore()}catch(p){ts=X,N=!1}}}}return N?!0:!1},rectContains:function(w,l){if(this._56I[w._id]){var H=this._25I[w._id];if(H)return bi(l,H._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(V){if(!E.isInput(V.target)){var d=this,P=d._focusData,_=P&&d._25I[P._id],x=0,c=d._dataModel._datas;if(!(P&&P._enabled&&P._editable&&_&&_.onKeyDown&&_.onKeyDown(V)===!0))if(9===V.keyCode&&(P&&(x=c.indexOf(P),am(V)?-1===--x&&(x=0):++x===c.size()&&(x=0)),d._focusData=P=c.get(x),d.sm().setSelection(P)),qb(V)?d.selectAll():tn(V)&&d.isResettable()&&d.reset(),d.sm().isEmpty()){if(d._editing)return;var Y=d.tx(),o=d.ty(),X=!1,U=am()?100:10;Rg(V)&&(Y-=U,X=!0),Nk(V)&&(o-=U,X=!0),Ye(V)&&(Y+=U,X=!0),Ae(V)&&(o+=U,X=!0),X&&d.setTranslate(Y,o)}else{Am(V)&&d.handleDelete(V);var A=am()?10:1;Rg(V)&&(d.moveSelection(-A,0),d.fi({kind:"moveLeft"})),Nk(V)&&(d.moveSelection(0,-A),d.fi({kind:"moveUp"})),Ye(V)&&(d.moveSelection(A,0),d.fi({kind:"moveRight"})),Ae(V)&&(d.moveSelection(0,A),d.fi({kind:"moveDown"}))}}},handleScroll:function(T,$){if(Bi(T),this.isZoomable()){if(!this.getEditInteractor()){var k=this.getDataAt(T);if(k){var m=ir(this.getImage(k));if(m&&Qn(m.scrollable,k,this))return}}var e=this.lp(T);$>0?this.scrollZoomIn(e):0>$&&this.scrollZoomOut(e)}},handlePinch:function(_,p,X){this.isZoomable()&&(Math.abs(p-X)<E.pinchZoomThreshold||(p>X?this.pinchZoomIn(_):this.pinchZoomOut(_)))},checkDoubleClickOnNote:function(l,s){var y=this,v=y.lp(l),$=y.getDataUI(s),d=$.note2Info;return d&&s.s("note2.toggleable")&&Ue(d.clickRect,v)?(s.s(We,!s.s(We)),y.fi({kind:"toggleNote2",event:l,data:s}),!0):(d=$.noteInfo,d&&s.s("note.toggleable")&&Ue(d.clickRect,v)?(s.s(ym,!s.s(ym)),y.fi({kind:"toggleNote",event:l,data:s}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(r,H){var d=this,D=d.getAutoScrollZone(),P=D/d.getZoom(),k=D/4,z=d._29I,q=d.lp(r),A={x:d.tx(),y:d.ty()};return q&&D>0&&z&&(q.x-z.x<P?d.translate(k,0):z.x+z.width-q.x<P&&d.translate(-k,0),q.y-z.y<P?d.translate(0,k):z.y+z.height-q.y<P&&d.translate(0,-k)),A.x=d.tx()-A.x,A.y=d.ty()-A.y,H&&(H.x+=A.x,H.y+=A.y),A},getMoveMode:function(q,a){var I=a.s("2d.move.mode");return I?I:tb["88"]?"x":tb["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(y,M,S){var L=this;return"currentSubGraph"===M?{__i:y.getId()}:S.serializeProperty(y,M,L)},deserializeProperty:function(O,Y,q){var L=this;if("currentSubGraph"===Y){var e=L.dm(),g=e.__idMap;return g[O.__i]}return q.deserializeProperty(O,Y,L)},setDefaultCursor:function(W,g){this._defaultCursor=W,g!==!1&&this.setCursor(W)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(N){return N===X||E.getConnectAction(null,N)?(this._currentActionType=N,this.redraw(),!0):!1},getEditStyle:function(F){var R=this.getEditInteractor();return R?R.getStyle(F):p},setEditStyle:function(s,w,b){var L=this.getEditInteractor();return L?(L.setStyle(s,w,b),!0):!1},isConnectActionVisible:function(h){var U=E.getConnectAction(this);if(!U)return!1;var I=U.visible;return Uq(I)&&(I=I(this,h)),I},isInteractive:function(Y){if(this._drawForChecking)return!1;var N=ir(this.getImage(Y));return N&&Qn(N.interactive,Y,this)?!0:Y.s("interactive")},getRenderingStyleIconName:function(){return Sk},appendHTML:function(d,i){var M=this.getView();if(!(i||d&&d.parentNode!==M))return!1;var c=d.getView&&d.getView(),u=d.beforeCanvas;if(!i&&c&&c.parentNode===M)return!1;(d.getView||d.isSelfViewEvent)&&(d=d.getView());var o=this.getEditInteractor();return u?M.insertBefore(d,this.getCanvas()):o&&o._canvas?M.insertBefore(d,o._canvas):this.isScrollBarVisible()?M.insertBefore(d,this.getView().lastChild):vb(M,d),!0},_layoutHTMLImpl:function(p,Z,J){if(arguments.length>1){var S,l=this,n=l._zoom;if(Z.getView&&(S=Z,Z=Z.getView()),Z.style.position="absolute",J){var i=p.getRect();zd(S||Z,l.tx()+i.x*n,l.ty()+i.y*n,i.width*n,i.height*n)}else{var K=new zh,i=p.getAnchorRect(),C=p.getPosition(),m=p.getScale(),I=Z.style;zd(S||Z,i),K.appendTranslate(l.tx(),l.ty()),K.appendScale(n,n),K.append(new zh(p.getRotation(),C.x,C.y,m.x,m.y)),Sl(I,"transform","matrix("+K.a.toFixed(5)+", "+K.b.toFixed(5)+", "+K.c.toFixed(5)+",\n    "+K.d.toFixed(5)+", "+K.tx.toFixed(5)+", "+K.ty.toFixed(5)+")"),Sl(I,"transformOrigin",(-i.x).toFixed(5)+"px "+(-i.y).toFixed(5)+"px"),Z.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(S){return S instanceof $e?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(s){var x="state",N=s.s(x);if(N)return N;var B=ir(s._image);return B?Qn(B[x],s,this)||null:void 0},getShape:function(s){return s.getStyle(Zi)}}),b.defineProperties(Um.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(t){this._layoutHTML=t}}});var ko=function(I,l){var m=this;m.gv=I,m.s=function(T){return l.getStyle(T)},m._data=l,m._87I=new jn},Sk=X;Wi(ko,b,{_6I:X,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var Y=this,V=Y.gv.isSelected(Y._data);return!V||Y.isShadowed()?0:Y.gv.getSelectWidth(Y._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function($){var Y=this._data,W=this.gv.getBodyColor(Y);return W?W:$?Y.getStyle($):X},_2Q:function(x){return this.s(x)},_1Q:function(S,g,o,I){var r=this.s,C=r("2d.gray"),q=r(g+".dash.color");if(C&&(q=E.toGrayColor(q)),S.strokeStyle=q,S.lineWidth=o,S.stroke(),r(g+".dash.3d")){var T=r(g+".dash.3d.color");ns(S,q,C?E.toGrayColor(T):T,o,this.gv._zoom,r(g+".dash.3d.accuracy"))}dn(S,I)},invalidate:function(){this._6I=X},_79o:function(){var k=this;if(!k._6I){var E=k._data,m=k.gv;k.labelInfo=k.label2Info=k.noteInfo=k.note2Info=k._38o=X,k._87I.clear(),k.interactiveInfo=m.isInteractive(E)?{}:X,k._3O(),k._55O=m.isEditable(E)?{_42O:m.isRectEditable(E),_43O:m.isPointEditable(E),_56O:m.isRotationEditable(E)}:X,k._6I=k._81o()}return k._6I},_3O:function(){},getPosition:function(){return dm},_68o:function(A,J){A&&this._87I.add(gj(A,J))},_81o:function(){var M=this,Z=M.s;M._24O(lp,"getLabel"),M._24O(_m,"getLabel2"),M._26O(Pl,"getNote"),M._26O(Io,"getNote2"),M._15O(),M._55O&&M._48O();var S;if(M._87I.each(function(B){S=Mb(S,B)}),S&&Z("shadow.interactable")){var h=M.isShadowed(),N=Z("shadow2"),e=Nq(S);N?(e.x+=Z("shadow2.offset.x"),e.y+=Z("shadow2.offset.y"),as(e,Z("shadow2.blur"))):h&&(e.x+=Z("shadow.offset.x"),e.y+=Z("shadow.offset.y"),as(e,Z("shadow.blur"))),S=Mb(S,e)}return M._87I.clear(),S},_42:function(K){var k=this,q=k._data,H=k.gv,f=k.s,d=f("opacity"),R=this.isShadowed(),W=f("shadow2");if(R||W){var Q=K.shadowOffsetX,$=K.shadowOffsetY,n=K.shadowBlur,j=K.shadowColor,U=H.getZoom()*E.devicePixelRatio,A=R?"shadow":"shadow2";K.shadowOffsetX=f(A+".offset.x")*U,K.shadowOffsetY=f(A+".offset.y")*U,K.shadowBlur=f(A+".blur")*U,K.shadowColor=R?k.getSelectColor():f(A+".color")}if(d!=X){var t=K.globalAlpha;K.globalAlpha=d}k._80o(K),H.isLabelVisible(q)&&((!H._drawForChecking||f("label.selectable"))&&Ag(K,k.labelInfo),(!H._drawForChecking||f("label2.selectable"))&&Ag(K,k.label2Info)),H.isNoteVisible(q)&&(Mr(K,k.noteInfo),Mr(K,k.note2Info)),k._99O(K),d!=X&&(K.globalAlpha=t),(R||W)&&(K.shadowOffsetX=Q,K.shadowOffsetY=$,K.shadowBlur=n,K.shadowColor=j)},_80o:function(){},_47O:function(){},_24O:function(v,B){var w=this,n=w._data,P=w.gv,q=w.s,y=P[B](n);if(y!=X){var r=q(v+".scale"),C=q(v+".max"),_=q(v+".position"),L=w[v+"Info"]={label:y,scale:r,color:P[B+"Color"](n),font:q(v+".font"),opacity:q(v+".opacity"),align:q(v+".align"),rotation:w.getRotation(q(v+".rotation"),!1,_),background:P[B+"Background"](n)},j=ln(L,y);C>0&&C<j.width&&(L.labelWidth=j.width,j.width=C),1!==r&&(j.width*=r,j.height*=r);var K=w.getPosition(_,q(v+".offset.x"),q(v+".offset.y"),j,q(v+".position.fixed"));if(j.x=K.x-j.width/2,j.y=K.y-j.height/2,w._68o(L.rect=j,L.rotation),1!==r){var Z=j.width/r,z=j.height/r;L.rect={x:K.x-Z/2,y:K.y-z/2,width:Z,height:z}}}},_26O:function(O,K){var V=this,v=V.gv,E=V._data,h=V.s,N=v[K](E);if(N!=X){var G,t,k=h(O+".scale"),W=V[O+"Info"]={note:N,scale:k,data:E,view:v,expanded:h(O+".expanded"),font:h(O+".font"),color:h(O+".color"),opacity:h(O+".opacity"),align:h(O+".align"),icon:h(O+".icon"),backgroundImage:h(O+".backgroundImage"),borderWidth:h(O+".border.width"),borderColor:h(O+".border.color"),background:v[K+"Background"](E)},e=V.getPosition(h(O+".position"),h(O+".offset.x"),h(O+".offset.y")),d=e.x,A=e.y;if(W.expanded){var o,P=h(O+".max"),x=h(O+".backgroundImage");x?(x=ir(x),o={width:rc(x,E),height:Sn(x,E)}):o=ln(W,N),o.width+=6,o.height+=2,P>0&&P<o.width&&(W.labelWidth=o.width,o.width=P),G=o.width,t=o.height+8,W.clickRect={x:d-G*k/2,y:A-t*k,width:G*k,height:t*k*o.height/t}}else{var q=h(O+".icon");q?(q=ir(q),G=rc(q,E),t=Sn(q,E)):(G=12,t=18),W.clickRect={x:d-G*k/2,y:A-t*k,width:G*k,height:t*k}}W.rect={x:d-G/2,y:A-t*k/2-t/2,width:G,height:t};var u=I(W.borderWidth/2)*k;V._68o({x:d-G*k/2-u,y:A-t*k-u,width:G*k+2*u,height:t*k+2*u})}},_48O:function(){},_99O:function(C){var f=this,y=f._38o;if(y){var Y=f.gv,g=f._data,m=y.icons,s=f.interactiveInfo;s&&(s._38o={});for(var i in m){var U=m[i],N=y.rects[i];if(N){s&&(s._38o[i]=[]);var j=Qn(U.opacity,g,Y),M=Qn(U.names,g,Y),K=M?M.length:0,Z=N.rotation;if(j!=X){var S=C.globalAlpha;C.globalAlpha*=j}for(var _=0;K>_;_++){var k=M[_],h=ir(k),O=N[_];if(Z){var q=O.x+O.width/2,W=O.y+O.height/2;C.save(),Pb(C,q,W),iq(C,Z),Pb(C,-q,-W)}s&&s._38o[i].push(C.interactiveInfo={compInfos:[],matrix:Z?new zh(Z,q,W).appendTranslate(-q,-W):new zh});var T=Sk;Sk=i,ch(C,h,Qn(U.stretch,g,Y),O.x,O.y,O.width,O.height,f._data,f.gv),Sk=T,C.interactiveInfo=X,Z&&C.restore()}j!=X&&(C.globalAlpha=S)}}}}});var gr=function(C,L){jl(gr,this,[C,L])};Wi(gr,ko,{_checkEmptyRect:!0,_40O:function(i,w){var f=this,R=f.s,U=i.rect;(i.borderColor=f.gv.getBorderColor(f._data))&&(i.borderType=R("border.type"),i.borderWidth=R("border.width"),i.borderPadding=R("border.padding"),w=P(w,i.borderPadding+i.borderWidth/2));var I=f._data.getScale(),M=P(1,P(a(I.x),a(I.y)));if(i.selectWidth=f.getSelectWidth()){var g=f.gv._zoom;i.selectType=R("select.type"),i._97o=f.getSelectColor(),i.selectPadding=R("select.padding"),w=P(w,(i.selectPadding+i.selectWidth/2/g)/M)}w>0&&(w*=M,U=Nq(U),as(U,w)),f._68o(U)},_39O:function(o,V){var t,b=this,g=V.rect;if(V.borderWidth>0&&(t=V.borderPadding,o.strokeStyle=V.borderColor,o.lineWidth=V.borderWidth,ad(o,V.borderType,{x:g.x-t,y:g.y-t,width:g.width+2*t,height:g.height+2*t}),o.stroke()),V.selectWidth>0){var F=b.gv._zoom;if(t=V.selectPadding,o.strokeStyle=V._97o,o.lineWidth=V.selectWidth/F,V.rotation!=X){o.save(),o.translate(V.position.x,V.position.y),o.rotate(V.rotation);var Z=b._data,A=Z.getWidth(),f=Z.getHeight(),m=V.scale,_=V.anchor;g={x:m.x*-A*_.x,y:m.y*-f*_.y,width:m.x*A,height:m.y*f}}ad(o,V.selectType,{x:g.x-t,y:g.y-t,width:g.width+2*t,height:g.height+2*t}),V.rotation!=X&&o.restore(),o.stroke()}},dispose:function(){var y=this,U=y._htmlView;gr.superClass._3O.call(y),U&&(U.onHTMLRemoved&&U.onHTMLRemoved(),cp(U))},_3O:function(){var K,T=this,Q=T.s,g=T._data,n=T.gv,f=n.getShape(g),V=T.getBodyColor(),q=Q("shape.border.color"),o=T._83o=f?{shape:f,_53o:T.getBodyColor("shape.background"),_27Q:ir(Q("shape.repeat.image"),V),shapeGradientPack:Q("shape.gradient.pack"),shapeBorderGradientPack:Q("shape.border.gradient.pack"),_54o:Q("shape.border.width"),_55o:q,shapeBorderRepeatImage:ir(Q("shape.border.repeat.image"),q),_56o:Q("shape.border.3d"),_57o:Q("shape.border.3d.color"),_58o:Q("shape.border.3d.accuracy"),shapeGradient:Q("shape.gradient"),_59o:Q("shape.gradient.color"),_60o:Q("shape.border.pattern"),_61o:Q("shape.border.cap"),_62o:Q("shape.border.join"),shapeForeground:Q("shape.foreground"),bodyColor:V,gray:Q("2d.gray")}:{img:ir(n.getImage(g),V),bodyColor:V,gray:Q("2d.gray"),stretch:Q("image.stretch")},U=o.img;U&&U.renderHTML?(T._htmlInfo&&T._htmlInfo.img!==U&&(T._htmlInfo=X),T._htmlInfo||(T._htmlInfo={img:U,cache:{}}),K=U.renderHTML(g,n,T._htmlInfo.cache)):T._htmlInfo=X,T._htmlView&&T._htmlView!==K&&(T._htmlView.onHTMLRemoved&&T._htmlView.onHTMLRemoved(),cp(T._htmlView.getView?T._htmlView.getView():T._htmlView)),(T._htmlView=K)&&n.appendHTML(K)&&(K.onHTMLAddedSync&&K.onHTMLAddedSync(),K.onHTMLAdded&&hm(K.onHTMLAdded)),o.rect=g.getRect(),o.position=g.p(),o.scale=g.getScale(),o.anchor=g.getAnchor(),o.rotation=g.getRotation(),f===zo&&(o._63o=Q("shape.depth"));var z=0;if(f)z=Fe(X,o._54o/2,o._62o),T.s("shape.dash")&&(z=P(z,(T.s("shape.dash.width")||o._54o)/2));else if(U&&U.boundExtend)if(z=Qn(U.boundExtend,g,n),U.boundExtendAbsolute){var m=g.getScale();z/=n._zoom*P(1,P(a(m.x),a(m.y)))}else if(!Qn(U.fitSize,g,n)){var k=Qn(U.width,g,n),N=Qn(U.height,g,n);z*=P(g.getWidth()/k,g.getHeight()/N)}T._40O(o,z);var M=Up(g,n.isSelected(g)),S=Q("clip.percentage");if(1>S&&(0>S&&(S=0),o.clipRect=Vn(g.getAnchorRect(),Q("clip.direction"),S,M)),f){var x=Q("shape.fill.clip.percentage");1>x&&(0>x&&(x=0),o.shapeClipRect=Vn(g.getAnchorRect(),Q("shape.fill.clip.direction"),x,M));var i=Q("shape.foreground.clip.percentage");1>i&&(0>i&&(i=0),o.shapeForegroundClipRect=Vn(g.getAnchorRect(),Q("shape.foreground.clip.direction"),i,M))}},getPosition:function(I,n,W,Y){var r=sc(I,this._83o.rect,Y);return r.x+=n,r.y+=W,r},_80o:function(e){var a=this,l=a.s,f=a.gv,Z=a._data,G=a._83o,y=G.rect,U=G.position,d=G.rotation,k=G.anchor,S=G.scale,u=G.shape,W=G.clipRect;if(!a._checkEmptyRect||y.width>0&&y.height>0){var Y=Z.getSize();if(Y.x=-Y.width*k.x,Y.y=-Y.height*k.y,wi&&!Ko&&Pb(e,Y.width,Y.height),e.save(),Pb(e,U.x,U.y),iq(e,d),Co(e,S.x,S.y),W&&(e.beginPath(),e.rect(W.x,W.y,W.width,W.height),e.clip()),f._drawForChecking&&G.img&&Qn(G.img.pixelPerfect,Z,f)===!1)Ve(e,Y.x,Y.y,Y.width,Y.height,"#888888");else if(a.freeDraw)a.freeDraw(e,Y,G);else if(u){var g,V,M,I,v=G._60o,$=Hm(e,v),s=G._27Q,q=G._54o,c=G.shapeGradientPack,K=G.gray,w=e.lineJoin,N=e.lineCap,L=function($){return K?E.toGrayColor($):$};"roundRect"===u?g=l("shape.corner.radius"):"polygon"===u?g=l("shape.polygon.side"):"arc"===u&&(g=l("shape.arc.from"),V=l("shape.arc.to"),M=l("shape.arc.close"),I=l("shape.arc.oval")),e.lineJoin=G._62o,e.lineCap=G._61o;var h=L(G._53o);if(h||s||c){var i=G.shapeClipRect;i&&(e.save(),e.beginPath(),e.rect(i.x,i.y,i.width,i.height),e.clip()),ad(e,u,Y,g,V,M,I),c?Rl(e,c,function(p){return Km(p,G.bodyColor)},!1,Y):s?Wh(e,s,L(G.bodyColor),null,Z,f):Ud(e,h,G.shapeGradient,L(G._59o),Y),e.fill(),c&&e.restore(),i&&e.restore(),e!==$&&ad($,u,Y,g,V,M,I)}else ad($,u,Y,g,V,M,I);var n=G.shapeForeground;if(n){e.save();var j=G.shapeForegroundClipRect;j&&(e.beginPath(),e.rect(j.x,j.y,j.width,j.height),e.clip()),ad(e,u,Y,g,V,M,I),Ud(e,n,l("shape.foreground.gradient"),L(l("shape.foreground.gradient.color")),Y),e.fill(),e.restore()}if(q>0){var x=l("shape.border.width.absolute");x&&(e.save(),e.setTransform(1,0,0,1,0,0)),e.lineWidth=q;var t=L(G._55o),z=G.shapeBorderGradientPack;z?Rl(e,z,L,!0,Y):G.shapeBorderRepeatImage?wd(e,G.shapeBorderRepeatImage,t,null,Z,f):e.strokeStyle=t,e.stroke(),z&&e.restore(),x&&e.restore(),G._56o&&ns(e,t,L(G._57o),q,f._zoom,G._58o)}if(dn(e,v),l("shape.dash")){var b=l("shape.dash.width")||q;if(b>0){v=l("shape.dash.pattern");var $=Hm(e,v,a._2Q("shape.dash.offset"));$!==e&&ad($,u,Y,g,V,M,I),a._1Q(e,"shape",b,v)}}Cj(e,h,G._63o,Y),e.lineJoin=w,e.lineCap=N}else{var D=a.interactiveInfo;D&&(e.interactiveInfo=D.bodyInfo={compInfos:[],matrix:new zh(d,U.x,U.y,S.x,S.y)}),G.gray&&(e.compGray=!0);var p=G.img;p&&p.cacheRule!=X&&(p=uh(e,p,G.stretch,Y.width,Y.height,Z,f,G.bodyColor)),ch(e,p,G.stretch,Y.x,Y.y,Y.width,Y.height,Z,f,G.bodyColor),e.compGray=!1,e.interactiveInfo=X}e.restore()}a._39O(e,G)},_48O:function(){},_47O:function(){}});var me=function(m,q){jl(me,this,[m,q])},xb=function(H,m,O,K){var R=Fb(H,m);return O=K?d(O,R):Ro(O,R),R?O/=R:O=0,{x:H.x+(m.x-H.x)*O,y:H.y+(m.y-H.y)*O}};Wi(me,ko,{_3O:function(){var v,I=this,l=I._data,d=I.gv,H=I.s,n=H(Ug),A=l.isLooped(),y=H("edge.width"),J=I.getBodyColor("edge.color"),j=H("edge.center"),W=H("edge.offset"),b=d.getBorderColor(l),q=b?H("border.width"):0,S=I.getSelectWidth(),k=l._40I,i=l._41I,D=I._78o=k&&i?{looped:A,type:n,width:y,center:j,color:J,repeatImage:ir(H("edge.repeat.image"),J),borderColor:b,borderWidth:q,_97o:S?I.getSelectColor():X,selectWidth:S,pattern:H("edge.pattern"),cap:H("edge.cap"),join:H("edge.join"),is3d:H("edge.3d"),_67o:H("edge.3d.color"),_66o:H("edge.3d.accuracy"),gray:H("2d.gray")}:X;if(D){var F=E.getEdgeType(n);if(F){var s=F(l,yi(I,d,l,A,n),d,I._19Q);s.points&&s.points.size()>1?(D.edgeTypeInfo=s,v=$q(D.edgeTypeInfo.points)):s[Th]&&s.rect&&(D.edgeTypeInfo=s,v=s.rect)}else{var h=H("edge.source.anchor.x"),u=H("edge.source.anchor.y"),g=H("edge.target.anchor.x"),N=H("edge.target.anchor.y"),B=ye(d,l,"source"),G=ye(d,l,"target");if(n===tk){var M=D.points=H(Vi)||gg,V=M.size();D.segments=H("edge.segments");var $=h!==p||u!==p||br(k),T=g!==p||N!==p||br(i);if(!j)if(W)$||(B=xb(B,V?M.get(0):G,W,V)),T||(G=xb(G,V?M.get(V-1):B,W,V));else{var z;$||(z=Zo(B,V?M.get(0):G,tg(d,k)),z&&(B={x:z[0],y:z[1]})),T||(z=Zo(V?M.get(V-1):B,G,tg(d,i)),z&&(G={x:z[0],y:z[1]}))}v=Mb($q(D.points),$q(B,G))}else{var O=yi(I,d,l,A,n);if(I._19Q||(O=-O),A)B=Nq(B),B.x=d.getNodeRect(k).x,D.radius=O,v={x:B.x-O,y:B.y-O,width:2*O,height:2*O};else{var e=Fb(B,G),Q=Ro(W,e),m={x:Q,y:O},t={x:e-Q,y:O},c=$g(G.y-B.y,G.x-B.x),x=D.mat=new mk(c);if(D.orienAngle=c,D.angle=G.x<B.x?c+f:c,D.rect={x:m.x,y:m.y,width:t.x-m.x,height:0},D.origin=B,m=x.tf(m),m.x+=B.x,m.y+=B.y,t=x.tf(t),t.x+=B.x,t.y+=B.y,j){var K={x:e,y:0};K=x.tf(K),K.x+=B.x,K.y+=B.y,v=$q([B,m,t,K]),D.c1=B,D.c2=K}else v=$q(m,t);B=m,G=t}}D.sourcePoint=B,D.targetPoint=G,l._lastSourcePoint=B,l._lastTargetPoint=G}var R=0;H("edge.dash")&&(R=H("edge.dash.width")||y);var C="square"===D.cap?.71:.5;Fe(v,P(R*C,y*C+q+S),D.join),I._68o(v)}},getRotation:function(r,$,T){r=r||0;var C=this._78o;if(C){var o,Z=C.angle,N=C.points,s=C.edgeTypeInfo;if(Z!=X)return $?C.orienAngle+r:Z+r;if(s&&s[Th])return s.getRotation?s.getRotation(this,r,$,T):0;if(s&&s.points){var G=s.points;return o=G.size(),hk[T]?o&&0===o%2?Bc(G.get(o/2-1),G.get(o/2),$,r):r:vi[T]?Bc(G.get(0),G.get(1),$,r):Bc(G.get(o-2),G.get(o-1),$,r)}if(N)return o=N.size(),hk[T]?o&&0===o%2?Bc(N.get(o/2-1),N.get(o/2),$,r):r:vi[T]?Bc(C.sourcePoint,o?N.get(0):C.targetPoint,$,r):Bc(o?N.get(o-1):C.sourcePoint,C.targetPoint,$,r)}return r},getPosition:function(T,P,f,i,d){var m=this._78o;if(m){var Y,G=m.type,X=m.points,V=m.edgeTypeInfo,c=m.sourcePoint,t=m.targetPoint;if(!G)return m.looped?{x:c.x-m.radius+P,y:c.y+f}:(d&&c&&t&&(c.x>t.x||c.x===t.x&&c.y>t.y)&&(T=on[T],f=-f),Y=sc(T,m.rect,i),Y.x+=P,Y.y+=f,Y=m.mat.tf(Y),Y.x+=m.origin.x,Y.y+=m.origin.y,Y);if(V&&V[Th])return V.getPosition?V.getPosition(this,T,P,f,i,d):{x:(c.x+t.x)/2,y:(c.y+t.y)/2};if(X){var Y,K=X.size();if(hk[T]){if(K){var F=K%2;if(0===F)return wk(X.get(K/2-1),X.get(K/2),T,P,f,i,d);Y=X.get((K-F)/2)}else Y={x:(c.x+t.x)/2,y:(c.y+t.y)/2};return Y=sc(T,{x:Y.x,y:Y.y,width:0,height:0},i),Y.x+=P,Y.y+=f,Y}return vi[T]?wk(c,K?X.get(0):t,T,P,f,i,d):wk(K?X.get(K-1):c,t,T,P,f,i,d)}if(V){var q=V.points,K=q.size();if(hk[T]){var F=K%2;return 0===F?wk(q.get(K/2-1),q.get(K/2),T,P,f,i,d):(Y=q.get((K-F)/2),Y=sc(T,{x:Y.x,y:Y.y,width:0,height:0},i),Y.x+=P,Y.y+=f,Y)}return vi[T]?wk(q.get(0),q.get(1),T,P,f,i,d):wk(q.get(K-2),q.get(K-1),T,P,f,i,d)}}return dm},_42:function(L){this._78o&&me.superClass._42.call(this,L)},drawPath:function(o,k){o.beginPath();var i=k.type,L=k.points,D=k.segments,t=k.edgeTypeInfo;if(!i||L){var G=k.sourcePoint,s=G.x,h=G.y,_=k.targetPoint,I=_.x,d=_.y;if(i)if(D){var r=new jn({x:s,y:h});r.addAll(L),r.add({x:I,y:d}),_g(o,r,D)}else o.moveTo(s,h),L.each(function(n){o.lineTo(n.x,n.y)}),o.lineTo(I,d);else k.looped?o.arc(s,h,k.radius,0,$,!0):k.center?(o.moveTo(k.c1.x,k.c1.y),o.lineTo(s,h),o.lineTo(I,d),o.lineTo(k.c2.x,k.c2.y)):(o.moveTo(s,h),o.lineTo(I,d))}else t&&(t.points?_g(o,t.points,t.segments):t[Th]&&t[Th](o,t))},_80o:function(e){var t=this,T=t.s,D=t._78o,Q=D.width,P=D.selectWidth,k=D.borderWidth,l=D.repeatImage,r=e.lineJoin,Y=e.lineCap,_=D.gray,X=D.pattern;e.lineJoin=D.join,e.lineCap=D.cap,t.drawPath(Hm(e,X),D);var M=T("edge.width.absolute");M&&(e.save(),e.setTransform(1,0,0,1,0,0)),P&&(e.strokeStyle=D._97o,e.lineWidth=Q+2*(k+P),e.stroke()),k&&(e.strokeStyle=_?E.toGrayColor(D.borderColor):D.borderColor,e.lineWidth=Q+2*k,e.stroke());var y=_?E.toGrayColor(D.color):D.color;if(l?wd(e,l,y,null,t._data,t.gv):e.strokeStyle=y,e.lineWidth=Q,e.stroke(),D.is3d){var f=_?E.toGrayColor(D._67o):D._67o;ns(e,y,f,Q,t.gv._zoom,D._66o)}if(dn(e,X),T("edge.dash")){X=T("edge.dash.pattern");var o=Hm(e,X,t._2Q("edge.dash.offset"));o!==e&&t.drawPath(o,D),t._1Q(e,"edge",T("edge.dash.width")||Q,X)}M&&e.restore(),e.lineJoin=r,e.lineCap=Y},_48O:function(){},_47O:function(){}});var Kd=function(I,C){jl(Kd,this,[I,C])};Wi(Kd,gr,{_3O:function(){var n,o,Z=this,R=Z.s,x=Z._data,S=Z.gv;if(Z._88I=X,x.isExpanded()&&x.eachChild(function(u){if(mo(u)){var q=S.getBoundsForGroup(u);q&&(o||(o=[]),o.push(q),n=Mb(n,q))}}),n){var H=S.getLabel(x),i=R("group.type"),q=R("group.border.width")||0,z=R("group.border.width.absolute"),K=q/2;z&&(q/=S._zoom),n=Pq(i,o,n),Nh(n,x,"group.padding",1),as(n,q);var f=Z._88I={type:i,rect:n,_64o:n};if(!i&&H!=X){var F,k=Z.labelInfo={label:H,color:R("group.title.color"),font:R("group.title.font"),align:R("group.title.align")},W=ln(k,H),A=W.width+q,D=W.height+q,N=R("group.title.align"),j=R("group.title.orientation");if(j===yb||j===jc?(n.height+=q,A>n.width&&(n.width=A)):(j===cq||j===Jo)&&(n.width+=q,A>n.height&&(n.height=A)),F=N===cq?n.x:N===Jo?n.x+n.width-A:n.x+n.width/2-A/2,j===jc)f.titleRect={x:n.x,y:n.y+n.height,width:n.width,height:D},f.rect={x:n.x,y:n.y,width:n.width,height:n.height+D},k.rect={x:F,y:n.y+n.height,width:A,height:D};else if(j===cq){var l=f.titleRect={x:n.x-D,y:n.y,width:D,height:n.height};f.rect={x:n.x-D,y:n.y,width:n.width+D,height:n.height},k.rect={x:l.x+D/2-n.height/2,y:l.y+n.height/2-D/2,width:n.height,height:D},k.rotation=-Math.PI/2}else if(j===Jo){var l=f.titleRect={x:n.x+n.width,y:n.y,width:D,height:n.height};f.rect={x:n.x,y:n.y,width:n.width+D,height:n.height},k.rect={x:l.x+D/2-n.height/2,y:l.y+n.height/2-D/2,width:n.height,height:D},k.rotation=Math.PI/2}else f.titleRect={x:n.x,y:n.y-D,width:n.width,height:D},f.rect={x:n.x,y:n.y-D,width:n.width,height:n.height+D},k.rect={x:F,y:n.y-D-K,width:A,height:D+q}}Z._40O(f,R("group.border.width")/2)}else Kd.superClass._3O.call(Z)},getPosition:function(b,p,o,q){var X=this._88I;if(X){var K=sc(b,X.rect,q);return K.x+=p,K.y+=o,K}return Kd.superClass.getPosition.apply(this,arguments)},_24O:function(C,B){var M=this._88I;(!M||M.type||"label2"===C)&&Kd.superClass._24O.call(this,C,B)},_80o:function(S){var c=this,g=c._88I;if(g){var W=c._data,v=c.s,X=c.gv,k=g.type,L=g.rect,j=g._64o,s=g.titleRect,x=c.getBodyColor(),m=ir(v("group.image"),x),U=v("group.image.stretch"),G=c.getBodyColor("group.background"),z=ir(v("group.repeat.image"),x),p=v("group.gradient.pack"),y=v("group.gradient"),o=v("group.gradient.color"),P=v("group.border.width"),F=v("group.border.color"),M=v("group.border.pattern"),C=v("group.title.orientation"),_=v("group.depth"),A=v("group.border.radius"),N=v("group.border.join"),n=v("group.border.cap"),J=v("group.border.width.absolute");
J&&(P/=X._zoom);var u=F,e=v("group.border.repeat.image");if(e&&(e=ir(e,F))&&(u=Rb(S,e,F,null,W,X)),k){var E=S.lineJoin,Y=S.lineCap;if(S.lineJoin=N,S.lineCap=n,m){if(S.save(),ad(S,k,L,A),S.clip(),ch(S,m,U,L.x,L.y,L.width,L.height,W,X,x),S.restore(),P>0){var D=Hm(S,M);ad(D,k,L,A),S.lineWidth=P,S.strokeStyle=u,S.stroke(),dn(S,M)}}else{var D=Hm(S,M);G||z||p?(ad(S,k,L,A),p?Rl(S,p,function($){return Km($,x)},!1,L):z?Wh(S,z,x,null,W,X):Ud(S,G,y,o,L),S.fill(),p&&S.restore(),S!==D&&ad(D,k,L,A)):ad(D,k,L,A),P>0&&(S.lineWidth=P,S.strokeStyle=u,S.stroke()),dn(S,M),k===zo&&Cj(S,G,_,L)}S.lineJoin=E,S.lineCap=Y}else{var b=v("group.title.background");if((!A||0>A)&&(A=0),m)ch(S,m,U,j.x,j.y,j.width,j.height,W,X,c.getBodyColor());else if(G||z)if(z?Wh(S,z,x,null,W,X):Ud(S,G,y,o,j),0===P)ad(S,zo,j),S.fill(),Cj(S,G,_,j);else{switch(S.beginPath(),C){case jc:es(S,j.x,j.y,j.width,j.height,A,A,0,0);break;case cq:es(S,j.x,j.y,j.width,j.height,0,A,0,A);break;case Jo:es(S,j.x,j.y,j.width,j.height,A,0,A,0);break;case yb:es(S,j.x,j.y,j.width,j.height,0,0,A,A)}S.fill()}if(s&&b)if(0===P)Ve(S,s.x,s.y,s.width,s.height,b),Cj(S,b,_,s);else{switch(S.beginPath(),S.fillStyle=b,C){case jc:es(S,s.x,s.y,s.width,s.height,0,0,A,A);break;case cq:es(S,s.x,s.y,s.width,s.height,A,0,A,0);break;case Jo:es(S,s.x,s.y,s.width,s.height,0,A,0,A);break;case yb:es(S,s.x,s.y,s.width,s.height,A,A,0,0)}S.fill()}if(P>0){var D=Hm(S,M);if(ad(D,"roundRect",L,A),S.save(),S.lineWidth=P,S.strokeStyle=u,S.lineJoin=N,S.lineCap=n,S.closePath(),S.stroke(),s&&v("group.splitLine")){var Z=s.x,q=s.y,w=s.width,H=s.height;S.beginPath(),C===jc?(S.moveTo(Z,q),S.lineTo(Z+w,q)):C===cq?(S.moveTo(Z+w,q),S.lineTo(Z+w,q+H)):C===Jo?(S.moveTo(Z,q),S.lineTo(Z,q+H)):(S.moveTo(Z,q+H),S.lineTo(Z+w,q+H))}S.stroke(),S.restore(),dn(D,M)}}c._39O(S,g)}else Kd.superClass._80o.call(c,S)}});var jo=function(u,i){jl(jo,this,[u,i])};Wi(jo,gr,{_80o:function(_){this._39O(_,this._83o)}});var Xk=function($,A){jl(Xk,this,[$,A])};Wi(Xk,gr,{_3O:function(){var Z=this,B=Z._data,k=Z.s,r=Z.gv,G=B.getPoints(),f=r.getBorderColor(B),v=f?k("border.width"):0,y=Z.getSelectWidth(),U=k("shape.border.width"),g=B.getRect(),t=B.getAnchorRect(),W=r.getBodyColor(B),j=k("shape.border.color"),S=Z._99o=G.isEmpty()?X:{rect:g,rotation:B.getRotation(),fillRule:k("shape.fill.rule"),scale:B.getScale(),position:B.p(),points:G,segments:B.getSegments(),bodyColor:W,borderColor:f,borderWidth:v,_94o:k("shape.border.3d"),_95o:k("shape.border.3d.color"),_96o:k("shape.border.3d.accuracy"),_97o:y?Z.getSelectColor():X,selectWidth:y,_53o:k("shape.background"),_27Q:ir(k("shape.repeat.image"),W),shapeGradientPack:k("shape.gradient.pack"),shapeBorderGradientPack:k("shape.border.gradient.pack"),_54o:U,_55o:j,shapeBorderRepeatImage:ir(k("shape.border.repeat.image"),j),shapeGradient:k("shape.gradient"),_59o:k("shape.gradient.color"),_60o:k("shape.border.pattern"),_61o:k("shape.border.cap"),_62o:k("shape.border.join"),shapeForeground:k("shape.foreground"),gray:k("2d.gray")};if(S){t.x+=S.position.x,t.y+=S.position.y,S.gradientRect=t;var M=B.getScale(),h=P(1,P(a(M.x),a(M.y)));k("shape.dash")&&k("shape.dash.width")>U&&(U=k("shape.dash.width"));var V,d=k("shape.border.width.absolute");V=d?(U+v+y)/Z.gv._zoom/h:U*("square"===S._61o?.71:.5)+v+y/Z.gv._zoom/h,V&&(V*=h,g=Nq(g),Fe(g,V,S._62o)),Z._68o(g);var m=Up(B,r.isSelected(B)),i=k("clip.percentage");1>i&&(0>i&&(i=0),S.clipRect=Vn(B.getAnchorRect(),k("clip.direction"),i,m));var O=k("shape.fill.clip.percentage");1>O&&(0>O&&(O=0),S.shapeClipRect=Vn(B.getAnchorRect(),k("shape.fill.clip.direction"),O,m));var q=k("shape.foreground.clip.percentage");1>q&&(0>q&&(q=0),S.shapeForegroundClipRect=Vn(B.getAnchorRect(),k("shape.foreground.clip.direction"),q,m))}},getPosition:function(F,$,n,M){var u=this._99o;if(u){var Y=sc(F,u.rect,M);return Y.x+=$,Y.y+=n,Y}return dm},_42:function(N){this._99o&&Xk.superClass._42.call(this,N)},_80o:function(o){var q,b=this,O=b.s,R=b._99o,l=R.position,w=R.scale,H=R.rotation,j=R.borderWidth,T=R.selectWidth/b.gv._zoom,Q=R._27Q,A=R.shapeGradientPack,d=R._54o,V=R.clipRect,k=R.shapeClipRect,U=R.points,C=R.segments,K=b._data.isClosePath(),r=R.fillRule,v=R.gray,h=function(N){return v?E.toGrayColor(N):N},P=h(R._53o),$=P||Q||A;o.save(),Pb(o,l.x,l.y),iq(o,H),Co(o,w.x,w.y),V&&(o.beginPath(),o.rect(V.x,V.y,V.width,V.height),o.clip()),$&&k&&(o.save(),o.beginPath(),o.rect(k.x,k.y,k.width,k.height),o.clip()),S.Default.extractShapeTranslation?(U=Nq(U),U.forEach(function(R){R.x-=l.x,R.y-=l.y})):Pb(o,-l.x,-l.y);var f=R._60o,z=Hm(o,f),L=o.lineJoin,u=o.lineCap;o.lineJoin=R._62o,o.lineCap=R._61o;var Z=h(R.bodyColor);$?(_g(o,U,C,K),A?Rl(o,A,function(f){return Km(f,R.bodyColor)},!1,R.rect):Q?Wh(o,Q,Z,null,b._data,b.gv):(q=Z?Z:P,Ud(o,q,R.shapeGradient,h(R._59o),R.gradientRect)),o.fill(r),A&&o.restore(),k&&(o.restore(),Pb(o,-l.x,-l.y)),z!==o&&_g(z,U,C,K)):_g(z,U,C,K);var y=R.shapeForeground;if(y){o.save();var Y=R.shapeForegroundClipRect;Y&&(Pb(o,l.x,l.y),o.beginPath(),o.rect(Y.x,Y.y,Y.width,Y.height),o.clip(),Pb(o,-l.x,-l.y)),_g(o,U,C,K),Ud(o,y,O("shape.foreground.gradient"),h(O("shape.foreground.gradient.color")),R.gradientRect),o.fill(r),o.restore()}var _=O("shape.border.width.absolute");if(_&&(o.save(),o.setTransform(1,0,0,1,0,0)),T&&(o.strokeStyle=R._97o,o.lineWidth=d+2*(j+T),o.stroke()),j&&(o.strokeStyle=h(R.borderColor),o.lineWidth=d+2*j,o.stroke()),d){q=h(R._55o);var B=R.shapeBorderGradientPack;B?Rl(o,B,h,!0,R.rect):R.shapeBorderRepeatImage?wd(o,R.shapeBorderRepeatImage,q,null,b._data,b.gv):(!P&&Z&&(q=Z),o.strokeStyle=q),o.lineWidth=d,o.stroke(),B&&o.restore(),R._94o&&ns(o,q,h(R._95o),d,b.gv._zoom,R._96o)}if(dn(o,f),O("shape.dash")){var M=O("shape.dash.width")||d;if(M>0){f=O("shape.dash.pattern");var z=Hm(o,f,b._2Q("shape.dash.offset"));z!==o&&_g(z,U,C,K),b._1Q(o,"shape",M,f)}}_&&o.restore(),o.lineJoin=L,o.lineCap=u,o.restore()},_48O:function(){},_47O:function(){}});var pk=function(i,_){jl(pk,this,[i,_])};Wi(pk,Xk,{getRotation:function(m,i,S){m=m||0;var P=this._data.getPoints(),G=P.size();return G>1?hk[S]?G&&0===G%2?Bc(P.get(G/2-1),P.get(G/2),i,m):m:vi[S]?Bc(P.get(0),P.get(1),i,m):Bc(P.get(G-2),P.get(G-1),i,m):m},getPosition:function(R,F,H,y,m){var Q=this._data.getPoints(),B=Q.size();if(B>1){if(hk[R]){var M=B%2;if(0===M)return wk(Q.get(B/2-1),Q.get(B/2),R,F,H,y,m);var k=Q.get((B-M)/2),t={x:k.x,y:k.y,width:0,height:0};return k=sc(R,t,y),k.x+=F,k.y+=H,k}return vi[R]?wk(Q.get(0),Q.get(1),R,F,H,y,m):wk(Q.get(B-2),Q.get(B-1),R,F,H,y,m)}return dm}});var Ip=function(d,m){jl(Ip,this,[d,m])};Wi(Ip,gr,{_3O:function(){var _=this;Ip.superClass._3O.call(_);var I=_.s,c=_._83o;_._82o=c.img||c.shape?X:{background:_.getBodyColor("grid.background"),depth:I("grid.depth"),rect:c.rect,_88o:I("grid.cell.depth"),cellBorderColor:I("grid.cell.border.color"),_89o:I("grid.row.count"),_90o:I("grid.column.count"),block:I("grid.block"),_91o:I("grid.block.color"),_92o:I("grid.block.padding"),_93o:I("grid.block.width")}},_80o:function($){var W=this,c=W._82o;if(!c)return Ip.superClass._80o.call(W,$),void 0;var w,H,X=W._data,t=c.background,B=c.rect,b=c.block,P=c._91o,q=c._92o,F=c._93o,z=c._88o,U=c.cellBorderColor,E=c._89o,C=c._90o;if(t)if(Ve($,B.x,B.y,B.width,B.height,t),Cj($,t,c.depth,B),z)for(w=0;E>w;w++)for(H=0;C>H;H++)B=X.getCellRect(w,H),B&&Cj($,t,z,B);else if(U){for($.beginPath(),w=0;E>w;w++)for(H=0;C>H;H++)B=X.getCellRect(w,H),B&&$.rect(B.x,B.y,B.width,B.height);$.strokeStyle=U,$.lineWidth=1,$.stroke()}if("h"===b)for(w=0;E>w;w++)B=Mb(X.getCellRect(w,0),X.getCellRect(w,C-1)),as(B,q),oo($,P,B.x,B.y,B.width,B.height,F);else if("v"===b)for(H=0;C>H;H++)B=Mb(X.getCellRect(0,H),X.getCellRect(E-1,H)),as(B,q),oo($,P,B.x,B.y,B.width,B.height,F);W._39O($,W._83o)}});var ro=function(u,X){jl(ro,this,[u,X])};Wi(ro,gr,{_checkEmptyRect:!1,_81o:function(){var l=this._data,K=ro.superClass._81o.call(this),_=l.s("text");if(_!=X){var g,n,G=l.s("text.font"),a=l.s("text.align"),d=l.s("text.vAlign"),y=Ll(G,_),B=y.width,h=y.height,u=l.getAnchor(),w=l.getWidth(),L=l.getHeight();"left"===a?g=-w*u.x:"center"===a?g=-w*u.x+(w-B)/2:"right"===a&&(g=w*(1-u.x)-y.width),"top"===d?n=-L*u.y:"middle"===d?n=-L*u.y+(L-h)/2:"bottom"===d&&(n=L*(1-u.y)-y.height);var J,T=l.getMatrix();if(J=$q([T.tf(g,n),T.tf(g+B,n),T.tf(g+B,n+h),T.tf(g,n+h)]),K=Mb(K,J),K&&l.s("text.shadow")){var e=Nq(K);e.x+=l.s("text.shadow.offset.x"),e.y+=l.s("text.shadow.offset.y"),as(e,l.s("text.shadow.blur")),K=Mb(K,e)}}return K}});var Lq=Um.Interactor=function(O){this.gv=this._graphView=O};Fp("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(I){this.gv.fi(I)},setCursor:function(v){Iq||this.gv.setCursor(v)},startDragging:function(I){var A=this;A._lastClientPoint=Wc(I),A._lastLogicalPoint=A.gv.lp(I),Aj(A,I)},clearDragging:function(){var f=this;f._lastClientPoint=f._lastLogicalPoint=f._logicalPoint=X},autoScroll:function(l){return this.gv.autoScroll(l,this._lastClientPoint)}});var Rr=X,wf=X,qo=function(C){wf.handleWindowTouchMove(C)},xe=function(G){wf.handleWindowTouchEnd(G),O(y,sj,qo),O(y,Gk,xe),wf=X},Qq=function(s){wf.handleWindowMouseMove(s)},Mk=function(T){wf.handleWindowMouseUp(T),O(y,ss,Qq),O(y,pi,Mk),wf=X},zi=function(p,j){if(p!==wf){var J=qc(j);wf?J?wf.handleWindowTouchEnd(j):wf.handleWindowMouseUp(j):J?(q(y,sj,qo),q(y,Gk,xe)):(q(y,ss,Qq),q(y,pi,Mk)),wf=p}},Xj=function(p){var G=this;G.gv=p,G._is2d=p instanceof Um.GraphView,G._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Fh,"wheel"].forEach(function(n){G.addListener(n)}),G.initImageResource()};Wi(Xj,Lq,{enableVR:function(J){var u=this;!!u._vrEnable!==J&&(u._vrEnable=J,J?u.gv.vr.mp(u.onVRControllerChange,u):u.gv.vr.ump(u.onVRControllerChange,u))},onVRControllerChange:function(U){var M=this,k=U.property,i=U.newValue,Q=i.id,F=M.gv.vr.getController(Q),C=F.getRay();if(C){C.controllerId=Q;var A=M.gv.vr.getRayEventType(C,k,i._62O);switch(A){case"down":M.handle_mousedown(C);break;case"up":wf&&Mk(C);break;case"move":M.handle_mousemove(C),wf&&M.handleWindowMouseMove(C)}}},setPreventEventDefault:function(G,J){var H=this,t=H._eventListeners[G];t?t._prevent=J:H._eventListeners[G]=t={_removal:p,_prevent:J}},removeListener:function(P){var o=this,c=o._eventListeners[P];c&&c._removal&&(c._removal(),c._removal=p)},addListener:function(N){var y=this,b=y._eventListeners[N];if(b||(y._eventListeners[N]=b={_removal:p,_prevent:!0}),!b||!b._removal){var c=function(Z){b._prevent&&E.preventDefault(Z),y.disabled||y.gv._48Q||("wheel"===N?$j(y,Z):y["handle_"+N](Z))};q(y.gv.getView(),N,c),b._removal=function(){O(y.gv.getView(),N,c)}}},handleWindowTouchMove:function(a){this.handleWindowMouseMove(a)},handleWindowMouseMove:function(n){return!this.downInfo||qc(n)&&1!==$r(n)?(this.isDragging&&(this.handleDownInfo("onEndDrag",n),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",n):(this.handleDownInfo("onBeginDrag",n),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(D){this.handleWindowMouseUp(D)},handleWindowMouseUp:function(m){if(this.isDragging&&(this.handleDownInfo("onEndDrag",m),this.isDragging=!1),this.downInfo){var O=this.handle("onUp",m);if(O&&O.data===this.downInfo.data){this.handleMissingUp(m);var j=this,h=2===m.button?"onContextMenu":"onClick";if(!j._dbclickTimer)return j._dbclickTimer=td(function(){delete j._dbclickTimer,j.handleClick(m,h,O),this.downInfo=X},E.clickDelay),void 0;zr(j._dbclickTimer),delete j._dbclickTimer,h="onDoubleClick",j.handleClick(m,h,O)}else this.handleDownInfo("onUp",m);this.downInfo=X,this.downComps=X}},handle_mouseleave:function(j){var S=this,l=S.gv;S._hoverTimer&&(zr(S._hoverTimer),delete S._hoverTimer);var I=S.currentInfo?S.currentInfo.data:X;if(I){I.s("onLeave")&&I.s("onLeave")(j,I,l),S.fire("data","onLeave",j,I),Rr!=X&&(l.setCursor(Rr),Rr=X);var b=S.currentInfo?S.currentInfo.hits:X;if(b)for(var W in b)S.handleLeave(j,W);S.currentInfo=X}},handle_mousewheel:function(I){I.scrollDelta=I.wheelDelta/40,this.handle("onScroll",I)},handle_DOMMouseScroll:function(D){D.scrollDelta=2===D.axis?-D.detail:0,this.handle("onScroll",D)},handle_touchstart:function(Y){this.handle_mousedown(Y)},handle_touchmove:function(v){this.handle("onMove",v)},handle_mousedown:function(O){this.isDragging&&(this.handleDownInfo("onEndDrag",O),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",O),this.downInfo&&zi(this,O)},handle_mousemove:function(p){var h=this,g=h.gv;if(h._hoverTimer&&(zr(h._hoverTimer),delete h._hoverTimer),!g._panning&&!g._moving){var t,N,F,J=h.handle("onMove",p),M=this.currentInfo?this.currentInfo.data:X,b=this.currentInfo?this.currentInfo.hits:X;if(J&&(N=J.data,F=J.hits,h._hoverTimer=td(function(){zr(h._hoverTimer),delete h._hoverTimer,h.handle("onHover",p,J)},g.getHoverDelay()||E.hoverDelay)),N!==M){if(M&&(M.s("onLeave")&&M.s("onLeave")(p,M,g),Rr!=X&&(g.setCursor(Rr),Rr=X),this.fire("data","onLeave",p,M)),N){var u=N.s("cursor");u&&(Rr=g.getView().style.cursor,g.setCursor(u)),N.s("onEnter")&&N.s("onEnter")(p,N,g),this.fire("data","onEnter",p,N)}if(b)for(t in b)this.handleLeave(p,t);if(F)for(t in F){var U=F[t],d=N._interactPrefix=U.prefix,m=d&&N.a(d+"onEnter")||U.target.onEnter;m&&m.call(U.target,p,N,g,U.point,U.width,U.height),this.fire(U.type,"onEnter",U.event,U.data,U.image,U.comp,U.point,U),N._interactPrefix=null}}else{if(b)for(t in b)F&&F[t]||this.handleLeave(p,t);if(F)for(t in F)if(!b||!b[t]){var U=F[t],d=N._interactPrefix=U.prefix,m=d&&N.a(d+"onEnter")||U.target.onEnter;m&&m.call(U.target,p,N,g,U.point,U.width,U.height),this.fire(U.type,"onEnter",U.event,U.data,U.image,U.comp,U.point,U),N._interactPrefix=null}}this.currentInfo=J}},handle:function(i,m,V){var H,e=this,X=e.gv;if(e._is2d){if(V=V||X.getDataInfoAt(m),!V||!X.isInteractive(V.data))return;if(H=V.ui.interactiveInfo){var N,s=V.data;if(s.s(i)&&s.s(i)(m,s,X),this.fire("data",i,m,s),"body"===V.part&&H.bodyInfo)N="body",V.hits=this.handleImage(N,X.getImage(s),i,m,s,V.point,H.bodyInfo);else if("icons"===V.part&&H._38o){var K=H._38o[V.name];K&&K[V.index]&&(N="icons|"+V.name+"|"+V.index,V.hits=this.handleImage(N,V.icon,i,m,s,V.point,K[V.index]))}}return V}var s,A;if(!V)if(m&&m instanceof S.Math.Ray&&X.isVREnabled()){var I=X.vr.intersectWorld(m);if(s=I.data,A=I.intersect,X.vr.renderRayDuringInteraction(m,s,A),!s)return;var t=X.getData3dUI(s);if(H=t.interactiveInfo,!H)return;V={data:s,part:A.part,ui:t}}else{if(V=X.getDataInfoAt(m),!V)return;V&&(V={data:V.data,part:V.part})}if(X.isInteractive(V.data)){if(!A){s=V.data;var t=X.getData3dUI(s);if(V.ui=t,H=t.interactiveInfo,!H)return V;if(A=X.intersectObject(m,s),!A)return}s.s(i)&&s.s(i)(m,s,X),this.fire("data",i,m,s);var E,M=A.part;return"body"!==M&&(E=s.s(M+".image")||s.s("shape3d."+M+".image")),E||(E=s.s("all.image")||s.s("shape3d.image")),E?(H="object"==typeof E?H[E.uuid]:H[E],H&&H.bodyInfo?(V.part="body",V.interactiveInfo=H,V.point=this._convertUVToPoint(A.uv,H),V.image=E,V.hits=this.handleImage("body",E,i,m,s,V.point,H.bodyInfo),V):V):V}},_handleLeaveOrMissing:function(I,U,F){var d="leave"===I?this.currentInfo:this.downInfo;if(d){var X=d.interactiveInfo||d.ui.interactiveInfo;if(X){var T,q,S=d.data;if(this._is2d){if(q=this.gv.lp(U),"body"===d.part&&X.bodyInfo)T="body","leave"===I?this.handleLeaveImage(F,T,this.gv.getImage(S),U,S,q,X.bodyInfo):this.handleMissingUpImage(T,this.gv.getImage(S),U,S,q,X.bodyInfo);else if("icons"===d.part&&X._38o){var _=X._38o[d.name];_&&_[d.index]&&(T="icons|"+d.name+"|"+d.index,"leave"===I?this.handleLeaveImage(F,T,d.icon,U,S,q,_[d.index]):this.handleMissingUpImage(T,d.icon,U,S,q,_[d.index]))}}else{if(!X.bodyInfo)return;var V=this.gv.intersectObject(U,S);q=V&&V.uv?this._convertUVToPoint(V.uv,X):{x:1/0,y:1/0},"leave"===I?this.handleLeaveImage(F,"body",d.image,U,S,q,X.bodyInfo):this.handleMissingUpImage("body",d.image,U,S,q,X.bodyInfo)}}}},handleClick:function(q,t,i){var p=this,x=this.downInfo;if(x&&i){var l,s=i.interactiveInfo||i.ui.interactiveInfo,y=i.data,k=this.gv;if(y.s(t)&&y.s(t)(q,y,k),p.fire("data",t,q,y),s)if(this._is2d){if(x.part===i.part){var X=k.lp(q);"body"===i.part&&s.bodyInfo&&(l="body",this.handleClickImage(l,k.getImage(y),t,q,y,X,s.bodyInfo,i))}}else{if(!s.bodyInfo)return;var T=k.intersectObject(q,y);if(!T)return;X=this._convertUVToPoint(T.uv,s),this.handleClickImage("body",x.image,t,q,y,X,s.bodyInfo,i)}}},handleDownInfo:function(l,G){if(this.downInfo){var K=this.downInfo,f=this.gv,_=K.interactiveInfo||K.ui.interactiveInfo;if(_){var N,j=K.data;if(j.s(l)&&j.s(l)(G,j,f),this.fire("data",l,G,j),this._is2d){var x=f.lp(G);if("body"===K.part&&_.bodyInfo)N="body",this.handleDownInfoImage(N,f.getImage(j),l,G,j,x,_.bodyInfo);else if("icons"===K.part&&_._38o){var Y=_._38o[K.name];Y&&Y[K.index]&&(N="icons|"+K.name+"|"+K.index,this.handleDownInfoImage(N,K.icon,l,G,j,x,Y[K.index]))}}else{if(!_.bodyInfo)return;var P=f.intersectObject(G,j);if(!P)return;x=this._convertUVToPoint(P.uv,_),this.handleDownInfoImage("body",K.image,l,G,j,x,_.bodyInfo)}}}},fire:function(P,I,v,b,Y,O,Q,q){this.gv.fi({kind:I,type:P,event:v,data:b,image:Y,comp:O,view:this.gv,point:Q,width:q?q.width:p,height:q?q.height:p})},handleImage:function(M,g,m,s,q,S,x){var E={};if(g&&(g=ir(g))){var e=this.gv,G=x.rect,k=this.convertPoint(S,x);k.inRect&&(g[m]&&g[m](s,q,e,k,G.width,G.height),this.fire("image",m,s,q,g,p,k,G),E[M+"|image"]={target:g,type:"image",image:g,data:q,event:s,point:k,width:G.width,height:G.height});for(var o,$=x.compInfos,d=g,B=$.length-1;B>=0;B--){var N=$[B],b=N.comp;if(k=this.convertPoint(S,N,d,b,e,q),k.inRect){G=N.rect;var U=q._interactPrefix=N.prefix,j=U&&q.a(U+m)||b[m];if(j&&(o=j.call(b,s,q,e,k,G.width,G.height)),this.fire("comp",m,s,q,g,b,k,G),o!==!0&&(g=G.image)&&(g[m]&&(o=g[m](s,q,e,k,G.width,G.height)),this.fire("image",m,s,q,g,p,k,G)),q._interactPrefix=null,E[M+"|"+B]={target:b,type:"comp",comp:b,image:g,data:q,event:s,point:k,width:G.width,height:G.height,prefix:U},this.downComps&&this.downComps.push(b),g&&(E[M+"|"+B+"|image"]={target:g,type:"image",image:g,data:q,event:s,point:k,width:G.width,height:G.height,prefix:U}),o===!0)break}}}return E},handleLeave:function(I,G){return this._handleLeaveOrMissing("leave",I,G)},handleMissingUp:function(r){return this._handleLeaveOrMissing("missing",r)},handleLeaveImage:function(E,w,P,B,b,f,u){if(P&&(P=ir(P))){var L=this.gv,I=u.rect,r=this.convertPoint(f,u);E===w+"|image"&&(P.onLeave&&P.onLeave(B,b,L,r,I.width,I.height),this.fire("image","onLeave",B,b,P,p,r,I));for(var d,t=u.compInfos,Q=P,O=t.length-1;O>=0;O--){var _=t[O],j=_.comp;r=this.convertPoint(f,_,Q,j,L,b),I=_.rect;var U=b._interactPrefix=_.prefix;if(E===w+"|"+O){var $=U&&b.a(U+"onLeave")||j.onLeave;$&&(d=$.call(j,B,b,L,r,I.width,I.height)),this.fire("comp","onLeave",B,b,P,j,r,I)}if(d!==!0&&(P=I.image)&&E===w+"|"+O+"|image"&&(P.onLeave&&(d=P.onLeave(B,b,L,r,I.width,I.height)),this.fire("image","onLeave",B,b,P,p,r,I)),b._interactPrefix=null,d===!0)break}}},handleMissingUpImage:function(M,A,c,o,S,y){var O="onUp",I=this.downInfo.hits;if(I&&A&&(A=ir(A))){var R=this.gv,Q=y.rect,K=this.convertPoint(S,y);!K.inRect&&I[M+"|image"]&&(A[O]&&A[O](c,o,R,K,Q.width,Q.height),this.fire("image",O,c,o,A,p,K,Q));for(var C,d=y.compInfos,N=A,w=d.length-1;w>=0;w--){var q=d[w],U=q.comp;if(K=this.convertPoint(S,q,N,U,R,o),!K.inRect){Q=q.rect;var i=o._interactPrefix=q.prefix;if(I[M+"|"+w]){var b=i&&o.a(i+O)||U[O];b&&(C=b.call(U,c,o,R,K,Q.width,Q.height)),this.fire("comp",O,c,o,A,U,K,Q)}if(C!==!0&&(A=Q.image)&&I[M+"|"+w+"|image"]&&(A[O]&&(C=A[O](c,o,R,K,Q.width,Q.height)),this.fire("image",O,c,o,A,p,K,Q)),o._interactPrefix=null,C===!0)break}}}},handleDownInfoImage:function(_,H,j,J,C,L,Y){var D=this.downInfo.hits;if(D&&H&&(H=ir(H))){var M=this.gv,F=Y.rect,X=this.convertPoint(L,Y);D[_+"|image"]&&(H[j]&&H[j](J,C,M,X,F.width,F.height),this.fire("image",j,J,C,H,p,X,F));for(var b,Q=Y.compInfos,k=H,A=Q.length-1;A>=0;A--){var f=Q[A],G=f.comp;X=this.convertPoint(L,f,k,G,M,C),F=f.rect;var B=C._interactPrefix=f.prefix,E=["onDrag","onEndDrag"].indexOf(j)>=0;if(!E&&D[_+"|"+A]||E&&this.downComps&&this.downComps.indexOf(G)>=0){var w=B&&C.a(B+j)||G[j];w&&(b=w.call(G,J,C,M,X,F.width,F.height)),this.fire("comp",j,J,C,H,G,X,F)}if(b!==!0&&(H=F.image)&&D[_+"|"+A+"|image"]&&(H[j]&&(b=H[j](J,C,M,X,F.width,F.height)),this.fire("image",j,J,C,H,p,X,F)),C._interactPrefix=null,b===!0)break}}},handleClickImage:function(A,y,o,U,C,w,F,K){var M=this.downInfo.hits,L=K.hits;if(M&&y&&(y=ir(y))){var z=this.gv,H=F.rect,B=this.convertPoint(w,F);M[A+"|image"]&&(y[o]&&y[o](U,C,z,B,H.width,H.height),this.fire("image",o,U,C,y,p,B,H));for(var I,Q=F.compInfos,E=y,f=Q.length-1;f>=0;f--){var _=Q[f],u=_.comp;B=this.convertPoint(w,_,E,u,z,C),H=_.rect;var $=C._interactPrefix=_.prefix;if(M[A+"|"+f]&&L[A+"|"+f]){var q=$&&C.a($+o)||u[o];q&&(I=q.call(u,U,C,z,B,H.width,H.height)),this.fire("comp",o,U,C,y,u,B,H)}if(I!==!0&&(y=H.image)&&M[A+"|"+f+"|image"]&&(y[o]&&(I=y[o](U,C,z,B,H.width,H.height)),this.fire("image",o,U,C,y,p,B,H)),C._interactPrefix=null,I===!0)break}}},initImageResource:function(){E.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(H,Y){if(!H)return{x:1/0,y:1/0};var A=Y.bodyInfo.rect,p=H.clone(),y=H.multiply({x:A.width,y:A.height});return y.local=p,y},convertPoint:function(H,h,B,v,S,N){var j=h.rect,o=h.matrix.applyInverse(H).sub(j),A=o.x>=0&&o.y>=0&&o.x<=j.width&&o.y<=j.height;if(!A)return o;if(v&&Qn(v.pixelPerfect,N,S)){var j,D=1;this._is2d?(D=S.getZoom(),j=Oh(H.x,H.y,p,D)):j=Oh(H.x,H.y);var I=!1,z=j.x,V=j.y,r=j.width,K=j.height,L=E.hitMaxArea,Q=r*K*D*D;if(Q>L){var c=Math.sqrt(L/Q);D*=c}r*=D,K*=D,2>r&&(r=2),2>K&&(K=2),z*=D,V*=D;var x=mf(r,K),C=new zh(0,-z,-V,D,D);C.append(h.matrix),S._drawForChecking=!0,v.transform=C;var s=B.fitSize;h.refRect&&h.refRect.fitSize?(v.refRect=h.refRect,B.fitSize=!0):B.fitSize=!1;var T=B.comps;B.comps=[v],tm(x,B,0,0,r,K,N,self),B.comps=T,B.fitSize=s,delete v.refRect,delete v.unionRect,delete v.transform,S._drawForChecking=!1;try{for(var R=0,J=x.getImageData(0,0,r,K).data;R<J.length;R+=4)if(0!==J[R+3]){I=!0;break}x.restore()}catch(O){ts=X,I=!1}o.inRect=I}else o.inRect=!0;return o}});var Wd=Um.DefaultInteractor=function(z){jl(Wd,this,[z])};Fp("DefaultInteractor",Lq,{handle_mousedown:function(D){Bi(D);var $=this,G=$.gv,J=G.getDataAt(D);if(G.setFocus(D)&&!G._editing&&!G._scrolling){re(D)?G.handleDoubleClick(D,J):G.handleClick(D,J);var f=Op(D);!tn()&&!f&&J&&(G.isMovable(J)||G._39Q(J))||!G.isPannable()||!Dj(D)&&!f||Yd(D)||($._tx=G.tx(),$._ty=G.ty(),$.startDragging(D))}},handleWindowMouseUp:function(h){var q=this,w=q.gv;w._panning&&(delete w._panning,w.onPanEnded(),q.fi({kind:"endPan",event:h})),delete q._tx,delete q._ty,q.clearDragging()},handle_mousemove:function(y){var J=this,T=J.gv;J._hoverTimer&&(zr(J._hoverTimer),delete J._hoverTimer),J._hoverTimer=td(function(){J.fi({kind:"hover",event:y}),zr(J._hoverTimer),delete J._hoverTimer},T.getHoverDelay()||E.hoverDelay)},handle_mouseleave:function(){var K=this;K._hoverTimer&&(zr(K._hoverTimer),delete K._hoverTimer)},handleWindowMouseMove:function(M){var L=this,I=L.gv;L.fi({kind:I._panning?"betweenPan":"beginPan",event:M}),I._panning=1;var U=Ln(I,M,L._lastClientPoint);I.setTranslate(L._tx+U.x,L._ty+U.y)},handle_mousewheel:function(m){this.gv.handleScroll(m,m.wheelDelta)},handle_DOMMouseScroll:function($){2===$.axis&&this.gv.handleScroll($,-$.detail)},handle_keydown:function(y){this.gv.handleKeyDown(y)}});var ik=Um.SelectInteractor=function(V){jl(ik,this,[V])};Fp("SelectInteractor",Lq,{_42:function(){var F=this,O=F.gv,M=O.getZoom(),a=F.mark,T=F.div;T||(T=F.div=_j(),vb(F.getView(),T));var B={};B.x=a.x*M+O.tx(),B.y=a.y*M+O.ty(),B.width=a.width*M,B.height=a.height*M,zd(T,B),this.intersects()?(T.style.border="",T.style.background=O.getRectSelectBackground()):(T.style.background="",T.style.border="1px solid "+O.getRectSelectBorderColor())},handle_mousedown:function(f){var q=this,r=q.gv;if(q._57I=X,q.pendingClickThrough=X,!(r._editing||r._scrolling||tn()||Op(f))){var _=r.getDataAt(f),w=r.sm();_?Yd(f)?w.co(_)?w.rs(_):w.as(_):w.co(_)?_ instanceof qk&&_.isClickThroughEnabled()&&Dj(f)&&(q.pendingClickThrough=Wc(f)):w.ss(_):Yd(f)||!r.isPannable()?Dj(f)&&(Yd(f)||w.cs(),r.isRectSelectable()&&(q.startDragging(f),r._77O=1)):Dj(f)&&(q._57I=Wc(f))}},handle_mouseup:function(K){var R=this,u=R.gv,v=R._57I;if(v&&(Fb(v,Wc(K))<=1&&u.sm().cs(),R._57I=X),R.pendingClickThrough){if(Fb(R.pendingClickThrough,Wc(K))<=1){var p=u.getDataAt(K);if(p instanceof qk&&p.isClickThroughEnabled()){var d=u.getDataAt(K,function(j){var K=j.getParent()===p&&u.isSelectable(j,!0);return K});d&&(K.clickThrough=!0,u.sm().ss(d))}}R.pendingClickThrough=X}},handleWindowMouseUp:function(f){this.clear(f)},handleWindowMouseMove:function(I){var Y=this,L=Y.gv;Y._logicalPoint=L.lp(I),Y.mark?(Y.fi({kind:"betweenRectSelect",event:I}),L.isPannable()&&Y.autoScroll(I),Y.redraw()):Y.fi({kind:"beginRectSelect",event:I}),Y.mark=$q(Y._lastLogicalPoint,Y._logicalPoint),Y.redraw()},intersects:function(){var P=this,U=P._lastLogicalPoint,R=P._logicalPoint;return U.x>R.x||U.y>R.y},clear:function(y){var d=this,x=d.gv,m=d.mark;if(d._57I=X,d.pendingClickThrough=X,d._lastLogicalPoint){if(m){if(0!==m.width&&0!==m.height){var q=x.getDatasInRect(m,d.intersects());if(!q.isEmpty()){var u=x.sm(),k=u.toSelection(),F=am(y),V=y.altKey;q.each(function($){u.co($)?(!F||F&&V)&&k.remove($):(!V||F&&V)&&k.add($)}),u.ss(k)}}cp(d.div),delete d.div,delete d.mark,d.redraw(),d.fi({kind:"endRectSelect",event:y}),x.onRectSelectEnded()}d.clearDragging(),delete x._77O}},redraw:function(){var m=this;m._draw||(m._draw=1,td(function(){m.mark&&m._42(),delete m._draw},16))}});var Vq=Um.MoveInteractor=function(F){jl(Vq,this,[F])};Fp("MoveInteractor",Lq,{handle_mousedown:function(r){var Z=this,o=Z.gv;if(Dj(r)&&!o._editing&&!o._scrolling&&!tn()){var H=o.getSelectedDataAt(r);!H||o._39Q(H)&&!o.isMovable(H)?o._focusData=X:(Z._data=H,o.handleMouseDown&&o.handleMouseDown(r,H),Z.startDragging(r),o.isMovable(H)&&(o._moving=1))}},handleWindowMouseUp:function(v){var V=this,J=V.gv;J.handleMouseUp&&J.handleMouseUp(v,V._data),V.clear(v)},handleWindowMouseMove:function(i){var k=this,$=k._data,M=k.gv;if((!M._93O||!M._93O(i,$))&&M._moving){k._logicalPoint||k.fi({kind:"prepareMove",event:i});var L=k._logicalPoint?"betweenMove":"beginMove",G={kind:L,event:i},g=k._logicalPoint=M.lp(i);"beginMove"!==L||k._alreadyBeginTransaction||(k._alreadyBeginTransaction=!0,M.getDataModel().beginTransaction());var c=k._calcShift(L,i),W=c.x,N=c.y,e=k.gv.getMoveMode(i,$);e&&("x"===e?N=0:"y"===e?W=0:"xy"!==e&&(W=N=0)),M.moveSelection(W,N),k._lastLogicalPoint=g,k.autoScroll(i),k.fi(G)}},_calcShift:function(){var V=this,o=V._logicalPoint,k=V._lastLogicalPoint,O=o.x-k.x,c=o.y-k.y;return{x:O,y:c}},clear:function(I){var K=this,V=K.gv;K._lastLogicalPoint&&(K._lastLogicalPoint=K._data=V._moving=X,K._logicalPoint&&(K.fi({kind:"endMove",event:I}),V.onMoveEnded()),K.clearDragging()),K._alreadyBeginTransaction&&(K._alreadyBeginTransaction=!1,V.getDataModel().endTransaction())}});var wj=Um.TextEditInteractor=function(t){jl(wj,this,[t]),this.init()};Fp("TextEditInteractor",Lq,{init:function(){var G=this,z=this.input=i.createElement("input"),D=z.style;z.text="text",D.border="1px solid #d8d8d8",D.position="absolute",D.padding="2px 3px",D.outline="none",D.marginLeft="-90px",D.marginTop="-16px",D.backgroundColor="rgba(255,255,255, 0.9)",D.fontSize="14px",D.width="180px",D.height="32px",D.boxShadow="0 0 13px rgba(16,142,233, 0.5)",D.textAlign="center",D.boxSizing="border-box",q(z,"keyup",function(M){ff(M)&&G.endTextEdit()}),q(z,"focus",function(){z.select()});var h=this.textarea=i.createElement("textarea"),x=this.wrap=i.createElement("div");x.appendChild(h),D=h.style,D.margin=0,D.padding="4px",D.overflow="hidden",D.boxSizing="border-box",D.position="absolute",D.outline="none",D.backgroundColor="transparent",D.resize="none",D.textAlign="center",D.fontSize="14px",D.border="none",D.borderWidth=0,D.width="100%",D.top="50%",D=x.style,D.boxSizing="border-box",D.margin=0,D.padding=0,D.position="absolute",D.boxShadow="0 0 13px rgba(16,142,233, 0.5)",D.border="1px solid #d8d8d8",D.backgroundColor="rgba(255,255,255, 0.9)",D.width="180px",D.marginLeft="-90px",q(h,"keydown",function($){return(am()||Yd())&&ff($)?(G.endTextEdit(),void 0):(G.calculateTextareaHeight(String.fromCharCode($.keyCode)),void 0)}),q(h,"focus",function(){h.select()});var n=function(b){b.stopPropagation()};q(z,"mousedown",n),q(z,"touchstart",n),q(h,"mousedown",n),q(h,"touchstart",n),G.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],G.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",G.handleWindowClick=function(e){var X=G._editingDOM;if(X){var f=X.getBoundingClientRect(),r=Wc(e);Ue(f,r)||G.endTextEdit()}}},handle_mousedown:function(f){var m=this,K=m.gv;if(re(f)&&!K._editing){var Z=K.getDataAt(f);if(Z){var e=K.getTextEditInfo(Z);e&&(this._editInfo=e,this._editTarget=Z,K._editing=!0,e.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var n=this,j=n.gv,V=n._editTarget,A=n.getTargetValue(),M=n.textarea,S=n.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===A||A===p)&&(A=""),M.value=A,n._editingDOM=M,j.getView().appendChild(S),this.layoutHTML(S,V),this.calculateTextareaHeight(),td(function(){M.focus(),q(y,"mousedown",n.handleWindowClick),q(y,"touchstart",n.handleWindowClick)},10)},handleTextEdit:function(){var Q=this,S=Q.gv,e=Q._editTarget,k=Q.getTargetValue(),j=Q.input;(null===k||k===p)&&(k=""),j.value=k,Q._editingDOM=j,S.getView().appendChild(j),this.layoutHTML(j,e),td(function(){j.focus(),q(y,"mousedown",Q.handleWindowClick),q(y,"touchstart",Q.handleWindowClick)},10)},layoutHTML:function(w,P){var l=this.gv,p=l.getZoom();if(P instanceof S.Node){var d=P.getRect(),e=Math.min(Math.max(100,d.width*p),800);w.style.left=(d.x+d.width/2)*p+l.tx()+"px",w.style.top=(d.y+d.height/2)*p+l.ty()+"px",w.style.width=e+"px",w.style.marginLeft=-e/2+"px"}else if(P instanceof S.Edge){var q=l.getDataUI(P),d=q._6I;w.style.left=(d.x+d.width/2)*p+l.tx()+"px",w.style.top=(d.y+d.height/2)*p+l.ty()+"px"}},endTextEdit:function(){var q=this,L=q._editInfo.isMultiline?q.wrap:q.input,v=q._editInfo.isMultiline?q.textarea:q.input;q.setTargetValue(v.value),q.gv.getView().removeChild(L),q.gv._editing=!1,delete q._editingDOM,O(y,"mousedown",q.handlelick),O(y,"touchstart",q.handleWindowClick)},setTargetValue:function(F){var o=this,e=o._editTarget,y=o._editInfo,Q=y.accessType,H=y.name;if(H&&Q||(Q="p",H="name"),"p"===Q){var c=S.Default.setter(H);e[c](F)}else"a"===Q?e.a(H,F):e.s(H,F)},getTargetValue:function(){var V=this,R=V._editTarget,I=V._editInfo,B=I.accessType,Z=I.name;if(Z&&B||(B="p",Z="name"),"p"===B){var Y=S.Default.getter(Z);return R[Y]()}return"a"===B?R.a(Z):R.s(Z)},createHiddenTextarea:function(){this.hiddenTextarea=i.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(B,l){if(l&&this.computedStyleCache)return this.computedStyleCache;var h=this,Z=y.getComputedStyle(B),X=Z.getPropertyValue("box-sizing")||Z.getPropertyValue("-moz-box-sizing")||Z.getPropertyValue("-webkit-box-sizing"),u=parseFloat(Z.getPropertyValue("padding-bottom"))+parseFloat(Z.getPropertyValue("padding-top")),c=parseFloat(Z.getPropertyValue("border-bottom-width"))+parseFloat(Z.getPropertyValue("border-top-width")),a=h.SIZING_STYLE.map(function(G){return G+":"+Z.getPropertyValue(G)
}).join(";"),o={sizingStyle:a,paddingSize:u,borderSize:c,boxSizing:X};return l&&(this.computedStyleCache=o),o},calculateTextareaHeight:function(l){l=l||"";var M=this,N=M.textarea,A=M.hiddenTextarea,U=M.wrap,O=32,x=M.calculateHTMLStyle(N,!1),b=x.paddingSize,d=x.borderSize,v=x.boxSizing,V=x.sizingStyle;A.setAttribute("style",V+";"+M.HIDDEN_TEXTAREA_STYLE),A.value=N.value+l;var m=A.scrollHeight;"border-box"===v?m+=d:"content-box"===v&&(m-=b),N.style.height=m+"px",N.style.marginTop=0-.5*m+"px",U.style.height=Math.max(m,O)+"px",U.style.marginTop=m*-.5+"px"}});var ij=Um.ScrollBarInteractor=function(G){jl(ij,this,[G])};Fp("ScrollBarInteractor",Lq,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(D){var x=this.gv.getViewRect();return this._41o()&&(x.x+x.width-this.gv.lp(D).x)*this.gv.getZoom()<Zp},isH:function(o){var v=this.gv.getViewRect();return this._40o()&&(v.y+v.height-this.gv.lp(o).y)*this.gv.getZoom()<Zp},handle_mousemove:function(x){this.handle_touchmove(x)},handle_touchmove:function(L){if(!Gr&&Dj(L)&&this.gv.isScrollBarVisible()){var i=this,c=i.isV(L),u=i.isH(L);(c||u)&&i.gv.showScrollBar(),i.gv._scrolling=c||u}},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},handleWindowTouchEnd:function(L){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=X,this.fi({kind:"endScroll",event:L})},handle_mousedown:function(m){this.handle_touchstart(m)},handle_touchstart:function(F){var t=this;if(t.gv.setFocus(F),Bi(F),t.handle_touchmove(F),!($r(F)>1)&&t.gv._scrolling&&t.gv.isScrollBarVisible()){t._cp=Wc(F),t._tx=t.gv.tx(),t._ty=t.gv.ty();var c=t.isV(F);t._state=c?"vScroll":"hScroll",Aj(t,F),t.fi({kind:"beginScroll",event:F})}},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowTouchMove:function(w){var b=Wc(w),d=this.gv.getViewRect(),Z=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-b.y)*Z.height/d.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-b.x)*Z.width/d.width),this.fi({kind:"betweenScroll",event:w})}});var Tq=Um.TouchInteractor=function(l,Q){Q=Q||{},Q.selectable===p&&(Q.selectable=!0),Q.movable===p&&(Q.movable=!0),Q.pannable===p&&(Q.pannable=!0),Q.pinchable===p&&(Q.pinchable=!0),Q.editable===p&&(Q.editable=!0),this.params=Q,jl(Tq,this,[l])};Fp("TouchInteractor",Lq,{ms_edit:1,setUp:function(){var S=this;Tq.superClass.setUp.call(S),Iq&&S.params.editable&&S.gv.setEditInteractor(S)},tearDown:function(){var C=this;Tq.superClass.tearDown.call(C),Iq&&C.params.editable&&C.gv.setEditInteractor(X)},clear:function(Z){var R=this,y=R.gv;y._moving&&(R.fi({kind:"endMove",event:Z}),delete y._moving,y.onMoveEnded(),y.dm().endTransaction()),y._panning&&(R.fi({kind:"endPan",event:Z}),delete y._panning,y.onPanEnded()),y._pinching&&(R.fi({kind:"endPinch",event:Z}),delete y._pinching,y.onPinchEnded()),y._editing&&(R._46O(Z),R._77I=R._node=R._edge=R._shape=R._rect=R._89I=R._index=y._editing=X),R.pendingClickThrough=R._moving=R._panning=R._pinching=R._editing=R._57I=R._data=R._beginHistory=X,R.clearDragging()},handle_touchstart:function(z){var n=this;if(!n.gv._editing){Bi(z),n._57I=X,n.pendingClickThrough=X;var d=n.params,j=n.gv,Y=j.sm(),P=j.getDataAt(z),C=$r(z);if(1===C){if(re(z))return j.handleDoubleClick(z,P),void 0;j.handleClick(z,P),P&&(j.handleMouseDown&&j.handleMouseDown(z,P),n._data=P),d.selectable||(P=X),P&&(Y.co(P)?P instanceof qk&&P.isClickThroughEnabled()&&(n.pendingClickThrough=Wc(z)):Y.ss(P),d.editable&&j.isEditable(P)&&n._79I(z,P,!0)?(n._editing=1,n.startDragging(z)):d.movable&&j.isMovable(P)&&(n._moving=1,n.startDragging(z))),P&&(j.isMovable(P)||j._39Q(P))||(n._57I=Wc(z),d.pannable&&j.isPannable()&&(n._panning=1,n.startDragging(z),n._translate={x:j.tx(),y:j.ty()}))}else if(d.pinchable&&2===C){if(!j.getEditInteractor()&&P){var Z=ir(j.getImage(P));if(Z&&Qn(Z.scrollable,P,this))return}n._pinching=1,n.startDragging(z);var J=j.getView(),B=j.getZoom(),$=J.getBoundingClientRect(),s=z.touches[0],p=z.touches[1],x={x:(s.clientX+p.clientX)/2-$.left,y:(s.clientY+p.clientY)/2-$.top};x.x-=j.tx(),x.y-=j.ty(),x.x/=B,x.y/=B,n._p=x,n._d=He(z)}}},handle_touchend:function(x){var f=this,L=f.gv,k=f._57I,W=f._data;if(k&&(Fb(k,Wc(x))<=1&&!L.getDataAt(x)&&L.sm().cs(),f._57I=X),W&&L.handleMouseUp&&L.handleMouseUp(x,W),f.pendingClickThrough){if(Fb(f.pendingClickThrough,Wc(x))<=1){var W=L.getDataAt(x);if(W instanceof qk&&W.isClickThroughEnabled()){var s=L.getDataAt(x,function(w){var o=w.getParent()===W&&L.isSelectable(w,!0);return o});s&&(x.clickThrough=!0,L.sm().ss(s))}}f.pendingClickThrough=X}},handleWindowTouchEnd:function(g){this.clear(g)},handleWindowTouchMove:function(Y){var d=this,o=d.gv,j=$r(Y);if(1===j){var $=Wc(Y),Z=Ln(o,$,d._lastClientPoint),y=Fb({x:0,y:0},Z);if(d._editing&&(d._beginHistory||(d._beginHistory=1,o.dm().beginTransaction()),o._editing=1,d._78I(Y)),d._moving){if(!o._moving&&y<E.touchMoveThreshold)return;d._beginHistory||(d._beginHistory=1,o.dm().beginTransaction()),d.handleMove(Y)}else if(d._panning){if(!o._panning&&y<E.touchMoveThreshold)return;o.setTranslate(d._translate.x+Z.x,d._translate.y+Z.y),d.fi({kind:o._panning?"betweenPan":"beginPan",event:Y}),o._panning=1}}else if(2===j&&d._pinching){var V=He(Y);o.handlePinch(d._p,V,d._d),d._d=V,d.fi({kind:o._pinching?"betweenPinch":"beginPinch",event:Y}),o._pinching=1}},handleMove:function(d){var S=this,M=S.gv,w=M.lp(d);M._93O&&M._93O(d,S._data)||(M.moveSelection(w.x-S._lastLogicalPoint.x,w.y-S._lastLogicalPoint.y),S._lastLogicalPoint=w,S.autoScroll(d),S.fi({kind:M._moving?"betweenMove":"beginMove",event:d}),M._moving=1)}});var S=y.ht,vc=S.graph._editor={Math:S.Math,Guide:{}};vc.getStyle=function(w){var v,E=vc.StyleMap;return E&&(v=E[w],v!==p)?v:vc.DefaultStyleMap[w]},vc.setStyle=function(E,I){var j=vc.StyleMap;j||(j=vc.StyleMap={}),j[E]=I},vc.inEdit=function(q){return q._inXEdit===!0},vc.startEdit=function(m){m._inXEdit=!0,vc.Inject.doInject(m)},vc._46O=function(r){r._inXEdit=!1,vc.Inject.undoInject(r)},vc.toScreenPosition=function(H,b){var d=H.tx(),q=H.ty(),U=H._zoom;return new vc.Math.Vector2(b.x*U+d,b.y*U+q)},vc.checkHit=function(K,u,x){return K.distanceTo(u)<x?!0:!1},vc.toWorldPosition=function(d,o){var k=d.tx(),G=d.ty(),i=d._zoom;return{x:(o.x-k)/i,y:(o.y-G)/i}},vc.setAntialias=function(W,V){for(var h,q=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],z=0,J=q.length;J>z&&(h=q[z],!(h in W));z++);W[h],W[h]=V},vc.getTargetCornersOnScreen=function(i,W){if(!W)return null;var n,h=[];if(bn(W,i)){var l=tg(i,W);n=[{x:l.x,y:l.y},{x:l.x+l.width,y:l.y},{x:l.x+l.width,y:l.y+l.height},{x:l.x,y:l.y+l.height}]}else{if(!W.getCorners)return null;n=W.getCorners()}return n.forEach(function(g){var I=vc.toScreenPosition(i,g);h.push(I.x,I.y)}),h},vc.log=function(){};var Ai=vc.Inject={_modules:[]};Ai.registAsModule=function(K,S){var A={},N={};for(var W in K){var i=S.prototype[W];A[W]=i}K.getBackup=function(Z){return A[Z]},K.getBackups=function(){return A},N.doInject=function(){for(var p in K)"getBackup"!==p&&(S.prototype[p]=K[p])},N.undoInject=function(){for(var z in K)"getBackup"!==z&&(S.prototype[z]=A[z])},Ai._modules.push(N)},Ai.doInject=function(R){for(var D,f=Ai._modules,F=0,M=f.length;M>F;F++)D=f[F],D.doInject(R)},Ai.undoInject=function(_){for(var s,x=Ai._modules,z=0,X=x.length;X>z;z++)s=x[z],s.undoInject(_)};var Lq=S.graph.EditInteractor=function(H){var g=this,l=i.createElement("canvas");l.className="editCanvas",l.style.position="absolute",g._uuid=S.Math.generateUUID(),g._styleMap={},g._canvas=l,g._context=l.getContext("2d"),Lq.superClass.constructor.call(g,H),this._editDetail=!1,vc.setAntialias(g._context,!1),g._subModules=[new vc.Anchor(g),new vc.RotateX(g),new vc.MoveDummy(g),new vc.Rect(g),new vc.Curve(g),new vc.MoveHelper(g)],g._gridGuide=new vc.Guide.Grid(g),g._rectGuide=new vc.Guide.Rect(g),g._hoverGuide=new vc.Guide.Hover(g)},yr=Lq;S.Default.def(Lq,S.graph.Interactor,{ms_edit:1,ms_fire:1}),b.defineProperties(Lq.prototype,{editDetail:{get:function(){var V=!!this._editDetail;return V},set:function(P){var V=this,D=V._editDetail;D!==P&&(V._editDetail=P,V.gv._editing=P,V.fp("editDetail",D,P),V.fp("pointsEditingMode",D,P),V.fi({kind:P?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(j){(!this._editDetail||j)&&(this.gv._editing=j,j||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(l){this._editing=l,this.gvEditing=l}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(A){var r=this;r.editDetail!==A&&(A?r._tryEnterEditDetailMode():r._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var x=this._gridEnabled;if(!x)return!1;var p=this.gv;return p?!0:!0},set:function(y){y!==this._gridEnabled&&(this._gridEnabled=y,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(l){l!==this._agEnabled&&(this._agEnabled=l,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Lq.prototype.getSubModule=function(q){var h,C,X,b=this._subModules;for(C=0,X=b.length;X>C;C++)if(h=b[C],h.catalog===q)return h},Lq.prototype.invokeSubModule=function(M,s){for(var u,a,Y,H=this,y=H._subModules,Z=Array.prototype.slice.call(arguments,2),j=0,C=y.length;C>j;j++)if(u=y[j],a=u[M],a&&(Y=a.apply(u,Z),Y!=p&&s))return u},Lq.prototype.invokeSubModuleInverse=function(M,b){var r=this,F=r._subModules;if(F)for(var Q,k,_,h=Array.prototype.slice.call(arguments,2),o=F.length-1;o>=0;o--)if(Q=F[o],k=Q[M],k&&(_=k.apply(Q,h),_!=p&&b))return Q},Lq.prototype.setUp=function(){vc.log("setUp");var Y=this,C=Y.gv,H=C.getView(),I=Y._canvas;Lq.superClass.setUp.call(Y),C.setEditInteractor(Y),C._79O?H.insertBefore(I,C._79O):H.appendChild(I),vc.startEdit(C),Y.invokeSubModule("setUp"),C.dm().mm(Y._onDataModelChanged,Y),C.dm().md(Y._onDataPropertyChanged,Y)},Lq.prototype.tearDown=function(){vc.log("tearDown");var D=this,$=D.gv,T=$.getView();D._resetCustomCursorStyle(),Lq.superClass.tearDown.call(D),$.dm().umm(D._onDataModelChanged,D),$.dm().umd(D._onDataPropertyChanged,D),$.setEditInteractor(null),T.removeChild(D._canvas),D._drawTimer&&(zr(D._drawTimer),D._drawTimer=null),vc._46O($),D.invokeSubModule("tearDown")},Lq.prototype._onDataModelChanged=function(o){var z=this;("clear"===o.kind||"remove"===o.kind&&z.editDetail&&o.data===z.getSubModule("Curve").target)&&(z.editDetail=!1,z._42())},Lq.prototype._onDataPropertyChanged=function(l){var k=this;if(k.editDetail){var F=k.getSubModule("Curve"),I=l.data;I===F.target&&(I._writing||F._handleDataChanged(l))}},Lq.prototype.clear=function(){vc.log("clear")},Lq.prototype.redraw=function(){this._42()},Lq.prototype._42=function(){var q=this;q._drawTimer||(q._drawTimer=td(function(){q._drawTimer=null,q.drawImpl()},0))},Lq.prototype.drawImpl=function(){var u;for(u in{_42:!0})break;return function(){var P=this,L=P._canvas,a=P.gv,o=a.getWidth(),s=a.getHeight(),p=P._context,e=S.Default.getInternal(),h=E.devicePixelRatio;(L.width!==o||L.height!==s)&&e.setCanvas(L,o,s,h),p.clearRect(0,0,L.width,L.height);var A=P._getValidSelection();p.save(),p.scale(h,h),P._gridGuide._42(),P.invokeSubModuleInverse(u,!1,p,a,A),P._rectGuide._42(),P._hoverGuide._42(),p.restore()}}(),Lq.prototype._getValidSelection=function(){var N=this,f=N.gv,t=f.sm().getSelection(),J=[];return t.each(function(R){f.isVisible(R)&&f.isEditable(R)&&J.push(R)}),J},Lq.prototype.handle_touchmove=function(D){return this.handle_mousemove(D)},Lq.prototype.handle_mousemove=function(w){if(!S.Default.isDragging()){var b=this;if((b.editDetail||!tn()&&!Op(w))&&!b.gv._externalEditing)if(b.gvEditing=!1,b._checkEdit(w))b.gvEditing=!0;else{if(!b.getStyle("hoverGuideVisible"))return;b.hoverData=b.gv.getDataAt(w),b._42()}}},Lq.prototype.handle_touchstart=function(q){return this.handle_mousedown(q)},Lq.prototype.handle_mousedown=function(f){Bi(f);var M=this;if((M.editDetail||!tn()&&!Op(f))&&!M.gv._externalEditing){if(re(f)&&!f.clickThrough){if(M.editDetail){if(M._tryQuitEditDetailMode(f))return}else if(M._tryEnterEditDetailMode())return;M.gv.dm().beginTransaction();var D=M.invokeSubModule("handleDoubleClick",!0,f);if(M.gv.dm().endTransaction(),D)return}var O=M._checkEdit(f);O&&(M._downPosition=M._getLogicalPoint(f),M.gv.dm().beginTransaction(),O.startEdit(M,f),M.editing=!0)}},Lq.prototype._checkEdit=function(y){var X=this,w=X.gv,S=X._getLogicalPoint(y),N=X.invokeSubModule("check",!0,w,y,S)||null;return X._editMod=N,N},Lq.prototype.handleWindowTouchMove=function(G){return this.handleWindowMouseMove(G)},Lq.prototype.handleWindowMouseMove=function(b){var o=this,l=o._downPosition;if(l){var Q=o._getLogicalPoint(b);if(Q.distanceTo(l)<o.getStyle("moveSensitivity"))return;delete o._downPosition}var B=o._editMod;B&&B.handleEdit(o.gv,b)},Lq.prototype._getLogicalPoint=function(y){var X=this,T=S.Default.getLogicalPoint(y,X._canvas);return new vc.Math.Vector2(T)},Lq.prototype.handleWindowTouchEnd=function(P){return this.handleWindowMouseUp(P)},Lq.prototype.handleWindowMouseUp=function(){var n;for(n in{_46O:!0})break;return function(F){var R=this;R.editing=!1,R.setCursor("default"),R.invokeSubModule(n,!1,F),R._42(),R.gv.dm().endTransaction()}}(),Lq.prototype.handle_mousewheel=function(n){var R=this;Bi(n),R.invokeSubModule("preHandleScroll",!0)||R.gv.handleScroll(n,n.wheelDelta)},Lq.prototype.handleDelete=function(){var M=this;if(!M.editDetail){M.gv.dm().beginTransaction();var $=M.invokeSubModule("handleNormalStateDelete",!0);return M.gv.dm().endTransaction(),$||M.gv.removeSelection(),void 0}M.gv.dm().beginTransaction(),M.invokeSubModule("handleDelete",!0),M.gv.dm().endTransaction(),M._42()},Lq.prototype.handle_keydown=function(k){var Y=this;if((k.metaKey||k.ctrlKey)&&Y._42(),tn(k)&&!Y.editing)return Y.gvEditing=!1,Y.setCursor("default"),Y._42(),void 0;var C=ff(k);return Y.editDetail?((C||ib(k))&&(Y.editDetail=!1,Y._42()),Y.gv.dm().beginTransaction(),Y.invokeSubModule("handle_keydown",!0,k),Y.gv.dm().endTransaction(),void 0):(Y.gv.dm().beginTransaction(),Y.invokeSubModule("handleNormalStateKeyDown",!0,k),Y.gv.dm().endTransaction(),C&&Y._tryEnterEditDetailMode(),void 0)},Lq.prototype.handle_keyup=function(X){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,X),this.gv.dm().endTransaction()},Lq.prototype._tryEnterEditDetailMode=function(){var E=this;return!E.editDetail&&E.invokeSubModule("canEnterEditDetailMode",!0)&&1===E._getValidSelection().length?(E.editDetail=!0,E._42(),!0):void 0},Lq.prototype._tryQuitEditDetailMode=function(f){var p=this;return p.editDetail?!f||p.invokeSubModule("canQuitEditDetailMode",!0,f)?(p.editDetail=!1,p._42(),!0):!1:!1},Lq.prototype.setStyle=function(U,P,A){var B=this;A?vc.setStyle(U,P):B._styleMap[U]=P,"baseColor"===U&&(zn=P),B.fp("styleChanged",null,{key:U,value:P,base:A}),B._42()},Lq.prototype.getStyle=function(X){var Q=this,d=Q._styleMap[X];return d!==p?d:vc.getStyle(X)},Lq.prototype.setCursor=function(t){this._resetCustomCursorStyle(),S.graph.EditInteractor.superClass.setCursor.call(this,t)},Lq.prototype._drawHostGuide=function(H){var U=this,q=U._context,t=U.gv;vc.Icons.DrawIcon(U,q,vc.Icons.NodeHoverGuide,H.corners);var g=H.host;if(g){var I=t.getAttachPoints(g);if(I&&I.length)for(var J=0,G=I.length;G>J;J++){var O=I[J],f=qd(t,g,0,O.offsetX||0,O.offsetY||0,O.x,O.y);f=vc.toScreenPosition(t,f),f.isAttach=H.attach===J,vc.Icons.DrawIcon(U,q,vc.Icons.AttachPoint,f)}}},Lq.prototype._resetCustomCursorStyle=function(){var B=this;if(B._customStyle){var E=this.gv.getView();E.classList&&E.classList.remove&&E.classList.remove(B._customStyle),B._customStyle=null}},Lq.prototype._setRotateCursor=function(B){var i=this,o=i._cursorFactory;o||(o=i._cursorFactory=new vc.CursorFactory(i));var Z=o.getRotateCursor(B),L=i.gv.getView();i._resetCustomCursorStyle(),i._customStyle=Z,L.classList&&L.classList.add&&L.classList.add(Z)};var rj=vc.Group=function(r){var N=this;N._entities=r,N._64O=0,N._position={x:0,y:0},N._scale={x:1,y:1},N._anchor={x:.5,y:.5},N._anchor2={x:.5,y:.5}};rj.prototype={},rj.prototype.constructor=rj;var Of=null,xl=null;rj.findOrCreateGroup=function(H,z){if(xl===z&&Of&&Of.checkIsMe(H))return Of;xl=z;var N=new vc.Group(H);return N.getKeyOb()?(Of=N,N):void 0},rj.prototype.checkIsMe=function(F){var E=this._entities;if(E.length!==F.length)return!1;var C,G={},Z=F.length;for(C=0;Z>C;C++)G[F[C]._id]=!0;for(C=0;Z>C;C++)if(!G[E[C]._id])return!1;return!0},rj.prototype.getRotation=function(){return this._64O},rj.prototype.getPosition=function(){return this._position},rj.prototype.getAnchor=function(){return this._anchor},rj.prototype.getWidth=function(){return this._width},rj.prototype.getScale=function(){return this._scale},rj.prototype.getSize=function(){return{width:this._width,height:this._height}},rj.prototype.getHeight=function(){return this._height},rj.prototype.getKeyOb=function(){for(var h=this._entities,T=h.length-1;T>=0;T--){var F=h[T];if(this.isNode(F))return F}},rj.prototype.getAnchor2=function(){var c=this,g=c.rotateCenter;if(g)return g;var b=c.getKeyOb();if(!b)return c._anchor;var N=c._anchor2,T=b.getMatrix();return T.tf({x:b.getWidth()*(N.x-b.getAnchor().x),y:b.getHeight()*(N.y-b.getAnchor().y)})},rj.prototype.setAnchor2=function(N,I){var H=this,Q=H.getKeyOb();if(Q){var b,m=Q.getMatrix();b="number"==typeof N?{x:N,y:I}:N;var f=m.tfi(b);H._anchor2={x:Q.getAnchor().x+f.x/Q.getWidth(),y:Q.getAnchor().y+f.y/Q.getHeight()}}},rj.prototype.setRotation=function(){},rj.prototype.beginRotate=function(w){this.rotateCenter=w.pos,this.rotateMode=w.groupRotateMode},rj.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},rj.prototype.addRotation=function(T,W,L){return"batch"===W?this._addRotationInBatchMode(T,L):"block"===W?this._addRotationInBlockMode(T,L):void 0},rj.prototype._addRotationInBlockMode=function(J,k){var R=this,w=R.rotateCenter||R.getPosition();R._entities.forEach(function(m){if(R.isNode(m)&&(!k||k(m))){var D=m.getMatrix();D.translate(-w.x,-w.y),D.rotate(J),D.translate(w.x,w.y);var P=Math.sign(m.getScale().x);m.setRotation($g(D.b*P,D.a*P)),m.setPosition(D.tx,D.ty)}})},rj.prototype._addRotationInBatchMode=function(y,n){var U=this,G=U._anchor2;U._entities.forEach(function(v){if(U.isNode(v)&&(!n||n(v))){var j=v.getAnchor(),V=v.getMatrix(),B=V.tf({x:v.getWidth()*(G.x-j.x),y:v.getHeight()*(G.y-j.y)}),i=new vc.Math.Matrix2d;i.set(V.a,V.b,V.c,V.d,V.tx,V.ty),i.translate(-B.x,-B.y),i.rotate(y),i.translate(B.x,B.y);var J=Math.sign(v.getScale().x);v.setRotation($g(i.b*J,i.a*J)),v.setPosition(i.tx,i.ty)}})},rj.prototype.setPosition=function(g){var Q,f,i,D,J=this,I=J._position,Y=g.x-I.x,U=g.y-I.y,u=J._entities;for(f=0,i=u.length;i>f;f++)Q=u[f],mo(Q)&&(D=Q.getPosition(),Q.setPosition(D.x+Y,D.y+U));J._position=g},rj.prototype.setScale=function(J,u){var _=this,U=J/_._scale.x,d=u/_._scale.y;_._adjustChildScaleOrSize(U,d,"size"),_._scale={x:J,y:u}},rj.prototype.getRect=function(){var K=this,O=K._position,m=K._width,N=K._height;return{x:O.x-m/2,y:O.y-N/2,width:m,height:N}},rj.prototype.setSize=function(A,v){var J=this,A=Math.max(1,A),v=Math.max(1,v),M=A/J._width,h=v/J._height;J._adjustChildScaleOrSize(M,h,"size"),J._width=A,J._height=v},rj.prototype._adjustChildScaleOrSize=function(G,I,v){var Z,r,P,n,E,w,N,l,q,J,t,V,d,i,$=this,X=$._position,e=$._entities,o=new vc.Math.Matrix2d;for(r=0,P=e.length;P>r;r++)if(Z=e[r],$.isNode(Z)){if(n=Z.getPosition(),E=Z.getRotation(),w=Z.getWidth(),N=Z.getHeight(),l=Z.getScale(),t=l.x*w,V=l.y*N,o.identity().scale(t,V).rotate(E).translate(n.x,n.y).translate(-X.x,-X.y).rotate(-$._64O),E=$g(o.b*Math.sign(t),o.a*Math.sign(t)),o.scale(G,I),q=Math.cos(E),J=Math.sin(E),Math.abs(q)<.001?(d=o.b/J,i=-o.c/J):(d=o.a/q,i=o.d/q),"scale"===v)Z.setScale(d/w,i/N);else if("size"===v){var U=d/l.x,_=i/l.y;Z.setScale(zb(d)*Math.abs(l.x),zb(i)*Math.abs(l.y)),Z.setSize(Math.max(.1,Math.abs(U)),Math.max(.1,Math.abs(_)))}o.rotate($._64O).translate(X.x,X.y),Z.setPosition(o.tx,o.ty)}},rj.prototype.getMatrix=function(){var A=this,m=A._position,l=S.Default.getInternal(),w=A._scale;return new l.Mat(A._64O,m.x,m.y,w.x,w.y)},rj.prototype.toGlobal=function(S){return this.getMatrix().tf(S)},rj.prototype.getCorners=function(){var s=this,z=s._width,J=s._height,l=s._anchor,h=-z*l.x,E=-J*l.y,C=s.getMatrix();return[C.tf(h,E),C.tf(h,E+J),C.tf(h+z,E+J),C.tf(h+z,E)]},rj.prototype.calcInfo=function(){var J,R,l,p,N,t,w=this,u=[],i=w._entities,M=w._64O;for(p=0,N=i.length;N>p;p++)t=i[p],w.isNode(t)&&t.getCorners&&u.push.apply(u,t.getCorners());if(u.length){var Q=Math.cos(-M),$=Math.sin(-M),r=1/0,S=-1/0,I=1/0,P=-1/0;for(p=0,N=u.length;N>p;p++)l=u[p],J=l.x,R=l.y,l.x=Q*J-$*R,l.y=$*J+Q*R,r=Math.min(r,l.x),S=Math.max(S,l.x),I=Math.min(I,l.y),P=Math.max(P,l.y);w._width=(S-r)/w._scale.x,w._height=(P-I)/w._scale.y,Q=Math.cos(M),$=Math.sin(M);var v=w._anchor;J=r+(S-r)*v.x,R=I+(P-I)*v.y,w._position={x:Q*J-$*R,y:$*J+Q*R}}},rj.prototype.isNode=function(K){return mo(K)?bn(K)?K.size()?!1:!0:!0:!1},rj.prototype._42=function(v,C,c){var q,A,Y,r,t,d,j,k,Q=this,h=Q._entities,T=Q.rotateMode;for("batch"===T&&(k=Q.getKeyOb()),q=0,A=h.length;A>q;q++)Y=h[q],Q.isNode(Y)&&(d=Y.getRect(),r=vc.toScreenPosition(c,{x:d.x,y:d.y}),t=vc.toScreenPosition(c,{x:d.x+d.width,y:d.y+d.height}),j={min:r,max:t},Y===k&&(j.isKeyOb=!0),vc.Icons.DrawIcon(v,C,vc.Icons.GroupSubEntityRect,j))};var mm=vc.CurveActiving=function(A,X){this._curve=A,this._interactor=A._interactor,this.silent=!0;for(var p in X)this[p]=X[p];delete this.silent};mm.prototype={},mm.prototype.constructor=mm,b.defineProperties(mm.prototype,{point:{get:function(){return this._point},set:function(l){var $=this;$._point=l,$.editingCtrl||$.silent||$._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(l){var E=this;E._pairs=l,E.editingCtrl&&!E.silent&&E._firePointChange()}}}),mm.prototype._firePointChange=function(){var e=this,t=e.getCurrentEditingPoint(),y=e._interactor;if(!t)return y.fi({kind:"selectPoint"}),void 0;var n=this._curve.target;if(n){var A=vc.getDataMatrix(n).invert(),J=t.e;t=A.apply(vc.toWorldPosition(y.gv,t)),t.e=J;var Y=e._lastFirePoint;Y&&Math.abs(t.x-Y.x)<1e-5&&Math.abs(t.y-Y.y)<1e-5&&(t.e==p&&Y.e==p||Math.abs(t.e-Y.e)<1e-5)||(e._lastFirePoint=t,y.fi({kind:"selectPoint",x:t.x,y:t.y,e:t.e}))}},mm.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},mm.prototype.getCurrentEditingPoint=function(){var T=this,F=T.editingCtrl;if(F){var o=T.pairs;if(o){var _=o[F.pairId];if(_){var E=_[F.type];if(E)return E}}}return T._point};var Lo=vc.CursorFactory=function(m){var D=this;D._interactor=m,D._rotateCursorStyles={}};Lo.prototype={},Lo.prototype.constructor=Lo,Lo.prototype.getRotateCursor=function(S){var t=this;0>S&&(S+=2*Math.PI);var z=t._interactor,H=z.getStyle("rotateCursorSize"),U=z.getStyle("rotateCursorRound"),E=Math.round(180*(S/Math.PI)/U);E*U>=360&&(E=0);var s=t._rotateCursorStyles,I="htCustomRotateStyle_"+H+"_"+U+"_"+E;return s[I]||(t._produceRotateCursor(I,H,U,E),s[I]=!0),I},Lo.prototype._produceRotateCursor=function(j,O,k,W){var A=this;A._interactor;var u=A._canvas;u||(u=A._canvas=i.createElement("canvas"));var M=E.devicePixelRatio;u.width=u.height=O*M,u.style.width=u.style.height=O+" px";var C=u.getContext("2d");vc.setAntialias(C,!1),C.scale(M,M);var r,t,S,J,F,y=Math.round(O/2),_=""+y+" "+y+",auto !important;",H=4;r=Math.PI/180*W*k,C.clearRect(0,0,O,O),C.save(),C.scale(O/32,O/32),C.translate(16,15),C.rotate(r+Math.PI/2),C.beginPath(),C.moveTo(-8,0),C.lineTo(-8,H),C.lineTo(-8+H,H),C.moveTo(8,0),C.lineTo(8,H),C.lineTo(8-H,H),C.moveTo(-8,H),C.quadraticCurveTo(0,-6,8,H),C.restore(),C.lineCap="round",C.lineJoin="miter",C.strokeStyle="white",C.lineWidth=4,C.stroke(),C.strokeStyle="black",C.lineWidth=2,C.stroke(),t=JSON.stringify(u.toDataURL()),J="cursor:url("+t+")"+_,1!==M&&(S='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+O+'px" height="'+O+'px"><image xlink:href='+t+' width="'+O+'" height="'+O+'"/></svg>',J+="cursor:url(data:image/svg+xml;base64,"+btoa(S)+")"+_,J+="cursor:-webkit-image-set(url("+t+")"+M+"x,url("+t+")1x)"+_),F=i.createElement("style"),F.textContent="body."+j+" *, ."+j+"{"+J+"}",i.head.appendChild(F)};var Hi=vc.Guide.Grid=function(L){var h=this;h._interactor=L,h._alignmentGuideId=0,h._xAlignmentGuide=[],h._yAlignmentGuide=[]};Hi.prototype={},Hi.prototype.constructor=Hi,b.defineProperties(Hi.prototype,{gridBlockSize:{get:function(){var b=this;return b._gridBlockSize||b._interactor.getStyle("gridBlockSize")},set:function(P){this._gridBlockSize=P,this._interactor._42()}},gridThickLinesEvery:{get:function(){var E=this;return E._gridThickLinesEvery||E._interactor.getStyle("gridThickLinesEvery")},set:function(l){this._gridThickLinesEvery=l,this._interactor._42()}},gridEnabled:{get:function(){var O=this,S=O._interactor;return S.gridEnabled&&O.isValidGrid()}}}),Hi.prototype._42=function(){var A=this,i=A._interactor;A.gridEnabled&&A.drawGrid(),i.alignmentGuideEnabled&&A.drawAlignmentGuide()},Hi.prototype.makeMatrix=function(){var Q=this,w=Q._interactor.getStyle("gridAngle"),C=Q._interactor.getStyle("gridRotation"),p=new vc.Math.Matrix2d,f=Math.sin(w),k=Math.cos(w);return p.set(1,0,k,f,0,0),p.rotate(C),p},Hi.prototype.isValidGrid=function(){var o=this,g=Math.PI,p=o._interactor,c=p.gv;if(c._zoom<p.getStyle("gridZoomThreshold"))return!1;var a=p.getStyle("gridAngle"),e=Math.abs(180*(a%g/g)),f=1-1e-8;return f>e||e>180-f?!1:!0},Hi.prototype.drawAlignmentGuide=function(){var C=this,x=C._interactor,G=x.gv,b=x._canvas,O=x._context,F=b.width,h=b.height,W=G.tx(),H=G.ty(),M=G._zoom;O.beginPath(),O.strokeStyle=x.getStyle("gridAlignmentGuideColor"),O.lineWidth=1,C._xAlignmentGuide.forEach(function(C){var Q=C.p*M+W;O.moveTo(Q,0),O.lineTo(Q,h)}),C._yAlignmentGuide.forEach(function(j){var V=j.p*M+H;O.moveTo(0,V),O.lineTo(F,V)}),O.stroke()},Hi.prototype.drawGrid=function(){function F(T,i,m,z){var Y=vc.toScreenPosition(c,I.apply({x:T,y:i})),t=vc.toScreenPosition(c,I.apply({x:m,y:z}));R.moveTo(Y.x,Y.y),R.lineTo(t.x,t.y)}var L=this,D=L._interactor,M=L.gridBlockSize,Z=L.gridThickLinesEvery,h=D.getStyle("gridThickColor"),H=D.getStyle("gridLightColor"),c=D.gv,z=D._canvas,R=D._context,e=z.width,d=z.height,I=L.makeMatrix(),n=I.applyInverse(vc.toWorldPosition(c,{x:0,y:0})),u=I.applyInverse(vc.toWorldPosition(c,{x:e,y:0})),g=I.applyInverse(vc.toWorldPosition(c,{x:0,y:d})),T=I.applyInverse(vc.toWorldPosition(c,{x:e,y:d})),Q=Math.min(n.x,u.x,g.x,T.x),y=Math.max(n.x,u.x,g.x,T.x),S=Math.min(n.y,u.y,g.y,T.y),G=Math.max(n.y,u.y,g.y,T.y);e=y-Q,d=G-S;var A=Math.ceil(Q/M),o=Math.floor(y/M),K=Math.ceil(S/M),E=Math.floor(G/M);c.tx(),c.ty(),c._zoom;var f,N,C;for(R.save(),R.lineWidth=1,R.beginPath(),R.strokeStyle=h,C=Math.ceil(A/Z)*Z;o>=C;C+=Z)f=C*M,F(f,S,f,G);for(C=Math.ceil(K/Z)*Z;E>=C;C+=Z)N=C*M,F(Q,N,y,N);for(R.stroke(),R.beginPath(),R.strokeStyle=H,C=A;o>=C;C++)0!==C%Z&&(f=C*M,F(f,S,f,G));for(C=K;E>=C;C++)0!==C%Z&&(N=C*M,F(Q,N,y,N));R.stroke(),R.restore()},Hi.prototype.getAlignmentGuides=function(){var s=this;return{x:s._xAlignmentGuide,y:s._yAlignmentGuide}},Hi.prototype.addAlignmentGuide=function(t,B,w){var u=this,s="x"===t?u._xAlignmentGuide:u._yAlignmentGuide,w=w?w:++u._alignmentGuideId,$={p:B,id:w};if(s.length){var r=u._findClosestAlignmentGuide($.p,s);r.dis<0?s.splice(r.index+1,0,$):s.splice(r.index,0,$)}else s.push($);return u._interactor._42(),w},Hi.prototype.findClosest=function(E,V,h){var g=this,l=g._interactor,G=l.gv;h&&(E=vc.toWorldPosition(G,E));var S,b,X,s=1/0,B=1/0,z=E.x,w=E.y;if(g.gridEnabled){var v=g.gridBlockSize,K=g.makeMatrix(),k=K.applyInverse(E);k=K.apply({x:Math.round(k.x/v)*v,y:Math.round(k.y/v)*v}),s=k.x-z,B=k.y-w,X=!0}if(l.alignmentGuideEnabled&&(S=g._findClosestAlignmentGuide(z,g._xAlignmentGuide).dis,b=g._findClosestAlignmentGuide(w,g._yAlignmentGuide).dis,Math.abs(S)<Math.abs(s)&&(s=S,X=!0),Math.abs(b)<Math.abs(B)&&(B=b,X=!0)),X){X=!1;var J=G._zoom,W=l.getStyle("smartGuideThreshold")/J,C={};if(Math.abs(s)<W&&"y"!==V&&(C.x=h?s*J:s,X=!0),Math.abs(B)<W&&"x"!==V&&(C.y=h?B*J:B,X=!0),X)return C}},Hi.prototype._findClosestAlignmentGuide=function(g,A){if(!A.length)return{dis:1/0};for(var O,$=0,l=A.length-1;l-$>1;)O=Math.floor(($+l)/2),A[O].p<g?$=O:l=O;var U=A[$].p-g,H=A[l].p-g;return Math.abs(U)<=Math.abs(H)?{line:A[$],dis:U,index:$}:{line:A[l],dis:H,index:l}},Hi.prototype.removeAllAlignmentGuide=function(r){var G=this;"y"!==r&&(G._xAlignmentGuide=[]),"x"!==r&&(G._yAlignmentGuide=[]),G._interactor._42()},Hi.prototype.removeAlignmentGuide=function(j){for(var J,k,r,v=this,t=v._xAlignmentGuide,e=0;2>e;e++)for(t=0===e?v._xAlignmentGuide:v._yAlignmentGuide,J=0,k=t.length;k>J;J++)if(r=t[J],r.id===j)return t.splice(J,1),v._interactor._42(),{axis:0===e?"x":"y",position:r.p};return!1},Hi.prototype.adjustAlignmentGuide=function(f,w){var Z=this,g=Z.removeAlignmentGuide(f);return g?(Z.addAlignmentGuide(g.axis,w,f),!0):!1};var Sp=vc.Guide.Rect=function(N){var j=this;j._interactor=N};Sp.prototype={},Sp.prototype.constructor=Sp,Sp.prototype.gatherRects=function(){var p,g,d,W,L=this,M=L._interactor.gv,$=[],a=[],u={x:$,y:a},n={},x=M.getDataModel(),G=x.a("width"),y=x.a("height");G&&y&&(p=0,g=0,d=G,W=y,$.push({node:x,type:0,p:p},{node:x,type:1,p:p+d/2},{node:x,type:2,p:p+d}),a.push({node:x,type:0,p:g},{node:x,type:1,p:g+W/2},{node:x,type:2,p:g+W}),n[x._id||0]={x:p,y:g,width:d,height:W}),x.each(function(E){if(mo(E)&&!M.isSelected(E)&&M.isVisible(E)&&M.isValidGuideLineSource(E)){var Y=!1;if(M.sm().getSelection().each(function(n){Y||(E.isHostOn(n)?Y=!0:E.isDescendantOf(n)&&(Y=!0))}),!Y){var z=E.getRect();p=z.x,g=z.y,d=z.width,W=z.height,$.push({node:E,type:0,p:p},{node:E,type:1,p:p+d/2},{node:E,type:2,p:p+d}),a.push({node:E,type:0,p:g},{node:E,type:1,p:g+W/2},{node:E,type:2,p:g+W}),n[E._id]=z}}}),$.sort(function(U,A){return U.p-A.p}),a.sort(function(Y,m){return Y.p-m.p}),L._grid=u,L._87I=n},Sp.prototype.gatherLines=function(T,d,v){var g,B,c,u,P,h,S,n,M,N,U,f,m=this,H=[m.findClosest({x:T.x,y:T.y},d),m.findClosest({x:T.x+T.w/2,y:T.y+T.h/2},d),m.findClosest({x:T.x+T.w,y:T.y+T.h},d)],K={},i=m._87I;v=v||255;var A,Y;for(m._guideLine=[],g=0;2>g;g++)for(K={},0===g?(u="y",n=T.x,M=n+T.w):(u="x",n=T.y,M=n+T.h),B=0;3>B;B++)P=H[B],P&&isFinite(P[u])&&(A=1<<3*g+B,v&A&&(h=P[u+"Line"],S=h.node,Y=S._id||0,K[Y]||(K[Y]=!0,f=i[Y],"y"===u?(N=f.x,U=f.x+f.width):(N=f.y,U=f.y+f.height),c=h.p,m._guideLine.push({type:u,a:n,b:M,c:N,d:U,p:c,center:1===h.type}))))},Sp.prototype._binarySearchClosest=function(q,D){if(!D.length)return{dis:1/0};for(var i,G=0,v=D.length-1;v-G>1;)i=Math.floor((G+v)/2),D[i].p<q?G=i:v=i;var p=D[G].p-q,H=D[v].p-q;return Math.abs(p)<=Math.abs(H)?{line:D[G],dis:p}:{line:D[v],dis:H}},Sp.prototype.findClosest=function(v,C,K){var d=this,h=d._interactor,P=h.gv,g=d._grid;K&&(v=vc.toWorldPosition(P,v));var k,y=d._binarySearchClosest(v.x,g.x),m=d._binarySearchClosest(v.y,g.y),p=y.dis,A=m.dis,J=P._zoom,r=h.getStyle("smartGuideThreshold")/J,Y={};return Math.abs(p)<r&&"y"!==C&&(Y.x=K?p*J:p,Y.xLine=y.line,k=!0),Math.abs(A)<r&&"x"!==C&&(Y.y=K?A*J:A,Y.yLine=m.line,k=!0),k?Y:void 0},Sp.prototype._42=function(){var W=this,D=W._guideLine;if(D&&!S.Default.isCtrlDown()){var E=W._interactor;if(E.getStyle("guideLineVisible")){var _,l,X,k,b,f,P,T,z,j,M,t,m,Y,w,O,i,K=E.gv,A=E._context,Z=K.tx(),G=K.ty(),y=K._zoom,u=E.getStyle("guideLineTextSpacing");for(_=0,l=D.length;l>_;_++)X=D[_],T=X.type,z=X.p,j=X.a,M=X.b,t=X.c,m=X.d,Y=Math.min(j,t),w=Math.max(M,m),"x"===T?(k=z*y+Z,b=Y*y+G,f=k,P=w*y+G):(k=Y*y+Z,b=z*y+G,f=w*y+Z,P=b),vc.Icons.DrawIcon(E,A,vc.Icons.MoveLineGuide,{rect:[k,b,f,P],center:X.center}),m>=j&&M>=t||(Y=j>m?m:M,w=j>m?j:t,i=w-Y,"x"===T?(X.center2center||(k-=u,f=k),b=Y*y+G,P=w*y+G,O=vc.Icons.MoveLineGuideDistanceV):"y"===T&&(X.center2center||(b-=u,P=b),k=Y*y+Z,f=w*y+Z,O=vc.Icons.MoveLineGuideDistanceH),vc.Icons.DrawIcon(E,A,O,{x0:k,y0:b,x1:f,y1:P,dis:i}))
}}},Sp.prototype.clear=function(){this._guideLine=null};var Pc=vc.Guide.Hover=function(x){var c=this;c._interactor=x};Pc.prototype={},Pc.prototype.constructor=Pc,b.defineProperties(Pc.prototype,{}),Pc.prototype._42=function(){var T=this._interactor;if(T.getStyle("hoverGuideVisible")&&!T.gvEditing){var h=T.hoverData,b=T.gv;if(!mo(h)||b.isSelected(h))return T.hoverData=null,void 0;var I=tg(b,h),Z=vc.toScreenPosition(b,{x:I.x,y:I.y}),O=vc.toScreenPosition(b,{x:I.x+I.width,y:I.y+I.height});vc.Icons.DrawIcon(T,T._context,vc.Icons.HoverDataRect,{min:Z,max:O,color:T.getStyle("hoverGuideColor")||T.getStyle("baseColor"),borderWidth:T.getStyle("hoverGuideBorderWidth")||1,borderPattern:T.getStyle("hoverGuideBorderPattern")||[1,4]})}},vc.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Yr=vc.Icons={},hn=1e4,Nr=null,zn=vc.DefaultStyleMap.baseColor,ve="rgb(183,232,135)",lo="rgb(255,204,153)",li=6;S.Default.setImage("Icons.RectPoint",{width:li,height:li,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return zn}},rect:[0,0,li,li]}]}),Yr.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var l=Yr.GroupSubEntityRect.data;if(!l)return[];var F=l.min,c=l.max;return[F.x,F.y,F.x,c.y,c.x,c.y,c.x,F.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Yr.GroupSubEntityRect.data.isKeyOb?zn:zn}}}]};var Uj=4;Yr.HoverDataRect={comps:[{type:"shape",points:{func:function(){var $=Yr.HoverDataRect.data;if(!$)return[];var O=$.min,m=$.max,B=Uj;return O.x-=B,O.y-=B,m.x+=B,m.y+=B,[O.x,O.y,O.x,m.y,m.x,m.y,m.x,O.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Yr.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Yr.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Yr.HoverDataRect.data.borderPattern}}}]},Yr.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Yr.Line.data.P1.x,Yr.Line.data.P1.y],li,li]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Yr.Line.data.P2.x,Yr.Line.data.P2.y],li,li]}}}]},Yr.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Yr.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Yr.Rect={comps:[{type:"shape",points:{func:function(){var E=Yr.Rect.data;if(!E)return[];var F=E.LT,K=E.LB,$=E.RB,B=E.RT;return[F.x,F.y,K.x,K.y,$.x,$.y,B.x,B.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return zn}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Yr.Rect.data.rotation}},rect:{func:function(){return[[Yr.Rect.data.LT.x,Yr.Rect.data.LT.y],li,li]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Yr.Rect.data.rotation}},rect:{func:function(){return[[Yr.Rect.data.LB.x,Yr.Rect.data.LB.y],li,li]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Yr.Rect.data.rotation}},rect:{func:function(){return[[Yr.Rect.data.RB.x,Yr.Rect.data.RB.y],li,li]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Yr.Rect.data.rotation}},rect:{func:function(){return[[Yr.Rect.data.RT.x,Yr.Rect.data.RT.y],li,li]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Yr.Rect.data.rotation}},visible:{func:function(){return Yr.Rect.data.L?!0:!1}},rect:{func:function(){return[[Yr.Rect.data.L.x,Yr.Rect.data.L.y],li,li]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Yr.Rect.data.rotation}},visible:{func:function(){return Yr.Rect.data.R?!0:!1}},rect:{func:function(){return[[Yr.Rect.data.R.x,Yr.Rect.data.R.y],li,li]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Yr.Rect.data.rotation}},visible:{func:function(){return Yr.Rect.data.T?!0:!1}},rect:{func:function(){return[[Yr.Rect.data.T.x,Yr.Rect.data.T.y],li,li]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Yr.Rect.data.rotation}},visible:{func:function(){return Yr.Rect.data.B?!0:!1}},rect:{func:function(){return[[Yr.Rect.data.B.x,Yr.Rect.data.B.y],li,li]}}}]};var $f=16;S.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return zn}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return zn}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Yr.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Yr.Anchor.data.POS.x,Yr.Anchor.data.POS.y],$f,$f]}}}]},Yr.TipShiftX=12,Yr.TipShiftY=12;var Fm=[8,28];Yr.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Yr.TipHelper.data.helperPos.x,Yr.TipHelper.data.helperPos.y,Fm[0]*Yr.TipHelper.data.size,Fm[1]]}},background:{func:function(){return Nr.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Yr.TipHelper.data.text}},rect:{func:function(){return[Yr.TipHelper.data.helperPos.x,Yr.TipHelper.data.helperPos.y,Fm[0]*Yr.TipHelper.data.size,Fm[1]]}},color:{func:function(){return Nr.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var rg=7;Yr.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Yr.ShapePoint.data.dynamicVisible}},rect:{func:function(){var c=Yr.ShapePoint.data.point,l=Yr.ShapePoint.data.size||rg;return[c,l+10,l+10]}},background:{func:function(){var s=Date.now(),y=Yr.ShapePoint.data.dynamicPeriod||1500,r=Math.sin(s%y/y*Math.PI);return"rgba(27,124,22,"+.5*r+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var e=Yr.ShapePoint.data.point,f=Yr.ShapePoint.data.size||rg;return[e,f,f]}},background:{func:function(){var u=Yr.ShapePoint.data.isEnd;return u?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Yr.ShapePoint.data.color||zn}}},{type:"rect",visible:{func:function(){return!!Yr.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return zn}},rect:{func:function(){var $=5;return[Yr.ShapePoint.data.point,$,$]}}}]},Yr.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Yr.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Yr.ShapeBgCurve.data.P}},segments:{func:function(){return Yr.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var x=Date.now(),Q=Yr.ShapeBgCurve.data.dynamicPeriod||1500,D=Math.sin(x%Q/Q*Math.PI);return"rgba(27,124,22,"+.3*D+")"}}},{type:"shape",points:{func:function(){return Yr.ShapeBgCurve.data.P}},segments:{func:function(){return Yr.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Yr.ShapeBgCurve.data.color||zn}}}]};var pc=8;Yr.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var Y=Yr.ShapeHighlighPoint.data;return[[Y.x,Y.y],pc,pc]}},background:{func:function(){return Nr.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Sf=10;Yr.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var q=Yr.ShapeHighlighRealPoint.data;return[[q.x,q.y],Sf,Sf]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return zn}}}]};var uj=8;Yr.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var a=Yr.ShapeHighlighCtrlPoint.data,j=a.x,w=a.y,u=uj/2;return[j-u,w-u,j-u,w+u,j+u,w+u,j+u,w-u]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Nr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Nr.getStyle("shapeCtrlPointBorderColor")||zn}}}]};var pe=3;Yr.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Yr.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:pe,borderColor:{func:function(){return Nr.getStyle("curveHighlightColor")}}}]},Yr.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Yr.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Yr.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Yr.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Yr.MoveLineGuide.data.center?ve:lo}}}]};var xq=5;Yr.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var b=Yr.MoveLineGuideDistanceH.data,z=b.x0,I=b.y0;return[z,I-xq,z,I+xq]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lo},{type:"shape",points:{func:function(){var L=Yr.MoveLineGuideDistanceH.data,P=L.x1,k=L.y1;return[P,k-xq,P,k+xq]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lo},{type:"text",text:{func:function(){return Math.round(Yr.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var $=Yr.MoveLineGuideDistanceH.data;return[[($.x0+$.x1)/2,$.y0-10],20,20]}},color:lo,font:"12px Arial",align:"center"}]},Yr.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var I=Yr.MoveLineGuideDistanceV.data,x=I.x0,P=I.y0;return[x-xq,P,x+xq,P]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lo},{type:"shape",points:{func:function(){var g=Yr.MoveLineGuideDistanceV.data,K=g.x1,A=g.y1;return[K-xq,A,K+xq,A]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lo},{type:"text",text:{func:function(){return Math.round(Yr.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var x=Yr.MoveLineGuideDistanceV.data;return[[x.x0-10,(x.y0+x.y1)/2],20,20]}},color:lo,font:"12px Arial",align:"center"}]},S.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Yr.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var Y=Yr.EdgeElevationGuide.data,G=Y.x,F=Y.y,i=Nr.getStyle("curveElevationIntersectSize"),s=Nr.getStyle("curveElevationGuideShift");return G+=s[0],F+=s[1],[G-i,F-i,2*i,2*i]}}}]},S.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),S.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Yr.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Yr.ConnectGuide.data.rotation}},rect:{func:function(){var T=Yr.ConnectGuide.data.connect;T.x,T.y;var W=Nr.getStyle("connectGuideIntersectSize");return[[T.x,T.y],2*W,2*W]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var p=Yr.ConnectGuide.data.cursorPos||Yr.ConnectGuide.data.connect,y=Nr.getStyle("connectGuideIntersectSize");return[[p.x,p.y],2*y-2,2*y-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var H=Yr.ConnectGuide.data.connect,v=Yr.ConnectGuide.data.cursorPos||H;return[H.x,H.y,H.x+.5*(v.x-H.x),H.y,v.x+.5*(H.x-v.x),v.y,v.x,v.y]}}}]},S.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),S.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Yr.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var D=Yr.ConnectGuideGarbage.data.hover;return D?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var d=Yr.ConnectGuideGarbage.data,T=Nr.getStyle("connectGuideGarbageIntersectsize");return d.hover&&(T+=5),[[d.x,d.y],2*T,2*T]}}}]};var Rp=6;Yr.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Yr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var m=Yr.ShapeActivingCtrl.data;return[m.point.x,m.point.y,m.c1.x,m.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return zn}}},{type:"shape",visible:{func:function(){return Yr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var O=Yr.ShapeActivingCtrl.data;return[O.point.x,O.point.y,O.c2.x,O.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return zn}}},{type:"shape",visible:{func:function(){return Yr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var J=Yr.ShapeActivingCtrl.data.c1,G=J.x,w=J.y,L=Rp/2;return"c1"===Yr.ShapeActivingCtrl.data.hl&&(L+=.5),[G-L,w-L,G-L,w+L,G+L,w+L,G+L,w-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Nr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Yr.ShapeActivingCtrl.data.hl?Nr.getStyle("shapeCtrlPointHighlightBorder")||zn:Nr.getStyle("shapeCtrlPointBorderColor")||zn}}},{type:"shape",visible:{func:function(){return Yr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var m=Yr.ShapeActivingCtrl.data.c2,y=m.x,r=m.y,b=Rp/2;return"c2"===Yr.ShapeActivingCtrl.data.hl&&(b+=.5),[y-b,r-b,y-b,r+b,y+b,r+b,y+b,r-b]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Nr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Yr.ShapeActivingCtrl.data.hl?Nr.getStyle("shapeCtrlPointHighlightBorder")||zn:Nr.getStyle("shapeCtrlPointBorderColor")||zn}}}]},Yr.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return zn}},rect:{func:function(){return[[Yr.RoundPoint.data.x,Yr.RoundPoint.data.y],li,li]}}}]},Yr.AttachPoint={comps:[{type:"rect",background:{func:function(){return Yr.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return zn}},rect:{func:function(){var v=Yr.AttachPoint.data.isAttach?li+4:li;return[[Yr.AttachPoint.data.x,Yr.AttachPoint.data.y],v,v]}}}]},Yr.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Yr.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Yr.SimpleRect.data.color||zn}},rect:{func:function(){var I=Yr.SimpleRect.data;return[I.x,I.y,I.width,I.height]}}}]},S.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Yr.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var c=Yr.MoveDummy.data;return[[c.pos.x,c.pos.y],2*c.size,2*c.size]}}}]},vc.Icons.DrawIcon=function(h,i,w,l){w.width=w.height=hn,w.data=l,Nr=h,S.Default.drawImage(i,w,0,0,hn,hn),Nr=p},vc.Icons.MapPoints=function(V,M){for(var E=0,w=V.length;w>E;E++)V[E]/=M},vc.roundTo=function(D,$,A){var K=Math.abs(D%$);return A>K||A>$-K?$*Math.round(D/$):D},vc.toFixed=function(s){return Math.round(100*s)/100},vc.getDataMatrix=function(N){if(N instanceof S.Shape){var Q=new S.Math.Matrix2d,p=N.getPosition();return Q.translate(-p.x,-p.y).scale(N.getScale().x,N.getScale().y).rotate(N.getRotation()).translate(p.x,p.y),Q}return N.getMatrix?N.getMatrix():new S.Math.Matrix2d};var yq=vc.Math.Curve=function(){this._curves=[]};yq.prototype={},yq.prototype.constructor=yq,yq.prototype.createFromHtShape=function(a,D,I){D instanceof S.List&&(D=D.toArray());var E,s,g,Y,z,y,$,r=this,w=null,_=null,e=0,M=vc.Math.Vector2,Q=vc.Math.CubicBezier,n=function(H){return new M(a[H],a[H+1],I?I[H/2]:p)};for(s=0,g=D.length;g>s;s++){switch(Y=D[s],z=null,Y){case 1:_=n(e),w=_,e+=2;break;case 2:E=n(e),e+=2,z=new Q(_,_.clone(),E.clone(),E),_=E;break;case 3:y=n(e),E=n(e+2),e+=4,z=new Q(_,y.clone().sub(_).multiplyScalar(2/3).add(_),y.clone().sub(E).multiplyScalar(2/3).add(E),E),_=E;break;case 4:y=n(e),$=n(e+2),E=n(e+4),e+=6,z=new Q(_,y,$,E),_=E;break;case 5:if(!w)break;z=new Q(_,_.clone(),w.clone(),w),_=null,w=null}z&&(z._index=r._curves.length,r._curves.push(z))}},yq.prototype.checkPoint=function(D,u){var v,d,e,s,o,b=this,A=b._curves;for(v=0,d=A.length;d>v;v++)if(s=A[v],o=s.intersectRect(D,u,u),o.length)return e=0,o.forEach(function($){e+=$.t}),e/=o.length,D=s.getPointAt(e),D.t=e,{bezier:s,intersection:D}},yq.prototype.insertKnot=function(t,E){var i=t.insertKnot(E),u=this,T=u._curves;T.splice(t._index,1,i[0],i[1])},yq.prototype._isCloseEnough=function(E,S){return Math.abs(E.x-S.x)<1e-6&&Math.abs(E.y-S.y)<1e-6},yq.prototype._isSamePoint=function(c,m){return c===m},yq.prototype.moveRealPoint=function(z,L){var Z=this,U=Z._curves,V=L.clone().sub(z);U.forEach(function(g){var K=g._p1;g._p2,g._p3;var C=g._p4;Z._isSamePoint(K,z)&&(g._p2.add(V),g._p1=L),Z._isSamePoint(C,z)&&(g._p3.add(V),g._p4=L)})},yq.prototype.moveCtrlDueToRealPointMovement=function(I,P){var X=this,o=X._curves,j=function($){$.add(P),$.e&&P.e&&($.e+=P.e)};o.forEach(function(m){var g=m._p1;m._p2,m._p3;var v=m._p4;X._isSamePoint(g,I)&&j(m._p2),X._isSamePoint(v,I)&&j(m._p3)})},yq.prototype.moveCtrlPoint=function(v,i,r){var s=v[r];if(s){s.e!==p&&(i.e=s.e);var L=this,t=L._curves;i.clone().sub(s),t.forEach(function(P){var U;"c2"===r?U="_p2":"c1"===r&&(U="_p3"),L._isSamePoint(P[U],s)&&(P[U]=i)}),v[r]=i}},yq.prototype.deleteRealPoint=function(d,i){var y,Z,t,$,C,G,Y,E=this,K=E._curves,g={},M=[],F=vc.Math.CubicBezier;for(Z=0,t=K.length;t>Z;Z++)y=K[Z],$=y._p1,C=y._p2,G=y._p3,Y=y._p4,(g[Z]||!E._isSamePoint($,d))&&(E._isSamePoint(Y,d)?t>Z+1&&E._isSamePoint(K[Z+1]._p1,d)&&(i||M.push(new F($,C,K[Z+1]._p3,K[Z+1]._p4))):M.push(y));E._curves=M},yq.prototype.findPairs=function(k,E){var N,J,K,o,C,Q,G,e,q=this,P=q._curves,s={},R=[];for(J=0,K=P.length;K>J;J++)N=P[J],o=N._p1,C=N._p2,Q=N._p3,G=N._p4,!s[J]&&q._isSamePoint(o,k)&&(E?R.push({point:o,r2:G}):R.push({point:o,c2:C})),q._isSamePoint(G,k)&&(e=E?{point:G,r1:o}:{point:G,c1:Q},K>J+1&&q._isSamePoint(P[J+1]._p1,k)&&(E?e.r2=P[J+1]._p4:e.c2=P[J+1]._p2,s[J+1]=!0),R.push(e));return R},yq.prototype.toHtShape=function(){var k=this,z=k._curves,e=[],s=[],p={x:1/0,y:1/0};return z.forEach(function(T){var g=T._p1,l=T._p2,U=T._p3,H=T._p4;return k._isCloseEnough(g,p)||(e.push(1),s.push(g.clone())),p=H,k._isCloseEnough(g,l)&&k._isCloseEnough(U,H)?(e.push(2),s.push(H.clone()),void 0):(e.push(4),s.push(l.clone(),U.clone(),H.clone()),void 0)}),{segments:e,points:s}};var mb=vc.Math.CubicBezier=function(O,S,s,G){var X=this;X._id=vc.Math.CubicBezier._globalId++,X._p1=O,X._p2=S,X._p3=s,X._p4=G};mb._globalId=1,mb.prototype={},mb.prototype.constructor=mb,mb.prototype.toString=function(){return this._id},mb.prototype.intersectRect=function(D,i,M){var Z=i/2,E=M/2,z=D.x,r=D.y,m=vc.Math.Vector2,w=new m(-Z+z,-E+r),S=new m(Z+z,E+r),R=new m(S.x,w.y),X=new m(w.x,S.y),V=this,x=V.intersectLine(w,R),d=V.intersectLine(R,S),Q=V.intersectLine(S,X),W=V.intersectLine(X,w),t=x.concat(d).concat(Q).concat(W);return t},mb.prototype.intersectLine=function(f,R){var i,k,P,s,w,Z,j,X,$,b,u,N,A,n=this,Y=f.clone().min(R),U=f.clone().max(R);s=n._p1,w=n._p2,Z=n._p3,j=n._p4,i=s.clone().multiplyScalar(-1),k=w.clone().multiplyScalar(3),P=Z.clone().multiplyScalar(-3),u=i.add(k).add(P).add(j),i=s.clone().multiplyScalar(3),k=w.clone().multiplyScalar(-6),P=Z.clone().multiplyScalar(3),b=i.add(k).add(P),i=s.clone().multiplyScalar(-3),k=w.clone().multiplyScalar(3),$=i.add(k),X=s.clone(),A=new vc.Math.Vector2(f.y-R.y,R.x-f.x),N=f.x*R.y-R.x*f.y;for(var Q=n.getRoots(A.dot(u),A.dot(b),A.dot($),A.dot(X)+N),F=new Array,T=0,B=Q.length;B>T;T++){var l=Q[T];if(!(0>l||l>1)){var g=n.getPointAt(l);g.t=l,f.x==R.x?Y.y<=g.y&&g.y<=U.y&&F.push(g):f.y==R.y?Y.x<=g.x&&g.x<=U.x&&F.push(g):g.x>=Y.x&&g.y>=Y.y&&g.x<=U.x&&g.y<=U.y&&F.push(g)}}return F},mb.prototype.solveTForPoint=function(i){var r,H,x,G,V=this;r=V._p1.x-i.x,H=V._p2.x-i.x,x=V._p3.x-i.x,G=V._p4.x-i.x;for(var f=V.getRoots(G-3*x+3*H-r,3*x-6*H+3*r,3*H-3*r,r),E=p,D=1/0,Q=0,R=f.length;R>Q;Q++){var z=f[Q];if(!(0>z||z>1)){var Z=V.getPointAt(z);Z.t=z;var U=Math.abs(Z.y-i.y);D>U&&(D=U,E=Z)}}return E},mb.prototype.getPointAt=function(G){var Z=this,x=Z._p1,g=Z._p2,n=Z._p3,y=Z._p4,M=x.clone().lerp(g,G),Q=g.clone().lerp(n,G),C=n.clone().lerp(y,G),L=M.lerp(Q,G),t=Q.lerp(C,G);return L.lerp(t,G)},mb.prototype.getPointByPercentage=function(f){var B=this.length*f,J=this._cacheLength,G=J.length;if(0===B)return J[0].point;if(f>=1)return J[G-1].point;for(var N=0;G>N;N++){var A=J[N];if(!(A.len<B)){var W=J[N-1];return A.point.clone().sub(W.point).setLength(B-W.len).add(W.point)}}},mb.prototype.getTByPercentage=function(e){var h=this.length*e,t=this._cacheLength,v=t.length;if(0===h||0>=e)return t[0].t;if(e>=1)return t[v-1].t;for(var M=0;v>M;M++){var k=t[M];if(!(k.len<h)){var y=t[M-1];return(h-y.len)/(k.len-y.len)*(k.t-y.t)+y.t}}},mb.prototype.getRoots=function(L,Z,F,I){var g,s,r,l,k,A=new Array;if(Math.abs(L)<1e-6){var g=Z,s=F/g,r=I/g,l=s*s-4*r;if(l>0){var k=Math.sqrt(l);A.push(.5*(-s+k)),A.push(.5*(-s-k))}else 0==l&&A.push(.5*-s)}Z/=L,F/=L,I/=L,g=(3*F-Z*Z)/3,s=(2*Z*Z*Z-9*F*Z+27*I)/27;var S=Z/3,M=s*s/4+g*g*g/27,x=s/2;if(Math.abs(M)<=1e-6&&(M=0),M>0){var e,a,k=Math.sqrt(M);e=-x+k,a=e>=0?Math.pow(e,1/3):-Math.pow(-e,1/3),e=-x-k,e>=0?a+=Math.pow(e,1/3):a-=Math.pow(-e,1/3),A.push(a-S)}else if(0>M){var m=Math.sqrt(-g/3),n=Math.atan2(Math.sqrt(-M),-x)/3,U=Math.cos(n),H=Math.sin(n),j=Math.sqrt(3);A.push(2*m*U-S),A.push(-m*(U+j*H)-S),A.push(-m*(U-j*H)-S)}else{var e;e=x>=0?-Math.pow(x,1/3):Math.pow(-x,1/3),A.push(2*e-S),A.push(-e-S)}return A},mb.prototype._70I=function(){var V=this;return V._p1.distanceToSquared(V._p2)<1e-10&&V._p3.distanceToSquared(V._p4)<1e-10},mb.prototype.insertKnot=function(U){var g=this,b=g._p1,F=g._p2,p=g._p3,s=g._p4,z=b.clone().lerp(F,U),B=F.clone().lerp(p,U),P=p.clone().lerp(s,U),Y=z.clone().lerp(B,U),K=B.clone().lerp(P,U),x=Y.clone().lerp(K,U);return g._70I()?(b.clone().lerp(s,U),[new vc.Math.CubicBezier(b,b.clone(),x.clone(),x),new vc.Math.CubicBezier(x,x.clone(),s.clone(),s)]):[new vc.Math.CubicBezier(b,z,Y,x),new vc.Math.CubicBezier(x,K,P,s)]},b.defineProperties(mb.prototype,{length:{get:function(){var b=this._cacheLength;if(!b){b=this._cacheLength=[];for(var K=this._p1,z=0,Q=0;1>=z;){var _=this.getPointAt(z+=.001);Q+=_.clone().sub(K).length(),K=_,b.push({len:Q,t:z,point:_.clone()})}}return b[b.length-1].len}},p1:{get:function(){return this._p1},set:function(Y){this._p1=Y,this._cacheLength=p}},p2:{get:function(){return this._p2},set:function(u){this._p2=u,this._cacheLength=p}},p3:{get:function(){return this._p3},set:function(w){this._p3=w,this._cacheLength=p}},p4:{get:function(){return this._p4},set:function(s){this._p4=s,this._cacheLength=p}}});var me=S.Default.getInternal().ui().EdgeUI,Np={_47O:function(I){var b=this,p=Np.getBackups()._47O;vc.inEdit(b.gv)||p.call(b,I)}};vc.Inject.registAsModule(Np,me);var gr=S.Default.getInternal().ui().NodeUI,Ac={_47O:function(o){var v=this,j=Ac.getBackups()._47O;vc.inEdit(v.gv)||j.call(v,o)},getSelectWidth:function(){var c=this,v=c.gv,L=c._data;if(v.isEditable(L)&&vc.inEdit(v))return 0;var C=Ac.getBackup("getSelectWidth");return C.call(c)}};vc.Inject.registAsModule(Ac,gr);var Gn=S.graph.GraphView,qf={_editPointSize:function(){var O=S.Default.isTouchable,z=vc.getStyle("pointSize");return z[O?0:1]}(),isPointEditable:function(v){var Y=this;if(vc.inEdit(Y))return Y._pointEditableFunc?Y._pointEditableFunc(v):!0;var R=qf.getBackup("isPointEditable");R.call(Y,v)},isEditable:function(l){var B,e=this,g=qf.getBackup("isEditable");if(B=l instanceof vc.Group?!0:g.call(e,l),!vc.inEdit(e))return B;if(!(l instanceof S.Edge))return B;if(!l.s("2d.editable"))return!1;var M=e.getEditableFunc();return M?M(l):!0},_42:function(w,m){var _=this,r=qf.getBackups()._42;if(r.call(_,w,m),vc.inEdit(_)){var H=_.getEditInteractor();H.drawImpl()}}};vc.Inject.registAsModule(qf,Gn);var Xk=S.Default.getInternal().ui().ShapeUI,mq={_47O:function(m){var q=this,G=mq.getBackups()._47O;vc.inEdit(q.gv)||G.call(q,m)}};vc.Inject.registAsModule(mq,Xk);var Wd=S.graph.DefaultInteractor,yn={handle_mousewheel:function(C){var Y=this,x=yn.getBackup("handle_mousewheel");vc.inEdit(Y.gv)||x.call(Y,C)}};vc.Inject.registAsModule(yn,Wd);var Vq=S.graph.MoveInteractor,Uk={_calcShift:function(k,V){var o=this,D=Uk.getBackup("_calcShift"),G=o.gv;if(!vc.inEdit(G))return D.call(o,k,V);var Q=G.getEditInteractor(),N=Q.getSubModule("Move").calcShift(k,V,o);return N||D.call(o,k,V)},clear:function(D){var l=this,O=Uk.getBackup("clear");O.call(l,D);var g=l.gv;if(vc.inEdit(g)){var q=g.getEditInteractor();q.getSubModule("Move").clear(D)}}};vc.Inject.registAsModule(Uk,Vq);var Sp=vc.Rect=function(y){this.catalog="Rect",this._interactor=y};Sp.prototype={},Sp.prototype.constructor=Sp,Sp.prototype.gatherInfo=function(w,e){var A=this;if(1===e.length){var i=e[0];return i instanceof S.Shape&&i._70I()?A.gatherLine(w,i):bn(i,w)?!1:A.gatherSingleTarget(w,i)}return e.length>1?A.gatherMultiTargets(w,e):!1},Sp.prototype.gatherSingleTarget=function(a,k){if(k.getCorners){var m,u=this,t=u.info;u.target=k,m=u.screenInfo={};var S=k.getCorners();t.LT=new vc.Math.Vector2(S[0]),t.LB=new vc.Math.Vector2(S[1]),t.RB=new vc.Math.Vector2(S[2]),t.RT=new vc.Math.Vector2(S[3]),t.T=t.LT.clone().add(t.RT).divideScalar(2),t.B=t.LB.clone().add(t.RB).divideScalar(2),t.L=t.LT.clone().add(t.LB).divideScalar(2),t.R=t.RT.clone().add(t.RB).divideScalar(2);for(var D in t)m[D]=vc.toScreenPosition(a,t[D]);var Z=u._interactor,o=Z.getStyle("checkSize"),i=function(X,h,r){var A=h.clone().sub(X).setLength(-o),p=r.clone().sub(X).setLength(-o),E=A.add(p).add(X);return E};return m.rotLT=i(m.LT,m.RT,m.LB),m.rotLB=i(m.LB,m.LT,m.RB),m.rotRB=i(m.RB,m.LB,m.RT),m.rotRT=i(m.RT,m.LT,m.RB),m.rotT=m.rotLT.clone().add(m.rotRT).divideScalar(2),m.rotB=m.rotLB.clone().add(m.rotRB).divideScalar(2),m.rotL=m.rotLT.clone().add(m.rotLB).divideScalar(2),m.rotR=m.rotRT.clone().add(m.rotRB).divideScalar(2),m.rotation=k.getRotation(),u.gatherConnectInfo(),!0
}},Sp.prototype.gatherConnectInfo=function(){var q=this,K=q.target,p=q._interactor,z=q.screenInfo,C=p.gv;if(C.isConnectActionVisible(K)&&p.getStyle("connectGuideVisible")){var D;K.s&&(D=K.s("connectGuideShift")),D||(D=p.getStyle("connectGuideShift"));var T=K.getAnchor(),i=K.getSize(),Q=K.toGlobal({x:i.width*(D[0]-T.x),y:i.height*(D[1]-T.y)});Q=vc.toScreenPosition(C,Q),z.P1?Q.add(z.P2.clone().sub(z.P1).setLength(D[2])):(Q.add(z.RT.clone().sub(z.LT).setLength(D[2])),Q.add(z.LB.clone().sub(z.LT).setLength(D[3]))),z.connect=Q}},Sp.prototype.gatherMultiTargets=function(M,q){var G=vc.Group.findOrCreateGroup(q,this._interactor._uuid);if(!G)return!1;var J=this;return J.editing&&"rotate"!==J.editing.mode||G.calcInfo(),J.gatherSingleTarget(M,G)},Sp.prototype.gatherLine=function(X,p){this.target=p;var c=this.screenInfo={},G=p.getPoints(),D=vc.getDataMatrix(p);return c.P1=vc.toScreenPosition(X,D.apply(G.get(0))),c.P2=vc.toScreenPosition(X,D.apply(G.get(1))),this.gatherConnectInfo(),!0},Sp.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Sp.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Sp.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Sp.prototype.check=function(r,C,B){if(S.Default.isLeftButton(C)){var p=this;if(p.editing=null,p.tipInfo=null,p.screenInfo){var U=p.target,X=r.isEditable(U),v=p.screenInfo;if(X&&v.connect){var y=p._checkConnect(B);if(y)return y}if(v.P1)return p._checkLine(B);var m,V,J,T=null,s=p._interactor,k=s.getStyle("checkSize");if(X&&r.isRectEditable(U))for(V=0;V<vc.Rect.ResizeKeys.length;V++)if(J=vc.Rect.ResizeKeys[V],vc.checkHit(B,v[J],k)){T=J,m="resize";break}if(!T&&X&&r.isRotationEditable(U)&&!s.getStyle("rotateAsClock")){var q=s.getStyle("rotateCheckSize");for(V=0;V<vc.Rect.RotateKeys.length;V++)if(J=vc.Rect.RotateKeys[V],vc.checkHit(B,v[J],q)){T=J,m="rotate";break}}if(!T)return s.setCursor("default"),void 0;if("rotate"===m){var e,A=r.lp(C);if(U instanceof vc.Group){var n=s.getStyle("groupRotateModeKey");"string"==typeof n&&(n=[n]);for(var P=!1,z=0,_=n.length;_>z;z++)if(C[n[z]]){P=!0;break}var W=s.getStyle("groupRotateModeDefault");e=P?"batch"===W?"block":"batch":W}var E="batch"===e?U.getAnchor2():U.getPosition(),x=Math.atan2(A.y-E.y,A.x-E.x);s._setRotateCursor(x),p.editing={mode:m,key:T,pos:E,flipY:U.getScale().y<0,rotation:U.getRotation(),hitRot:x},e&&(p.editing.groupRotateMode=e)}else{var j=vc.Rect.ResizeKeys.indexOf(T),D=vc.Rect.ResizeDirection[j],K=Math.cos(U.getRotation()),Z=Math.sin(U.getRotation()),t=D.x*Math.sign(U.getScale().x),u=D.y*Math.sign(U.getScale().y),N=Math.atan2(-Z*t-K*u,K*t-Z*u),i=(Math.round(N/(Math.PI/4))+8)%8,w=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][i];this._interactor.setCursor(w);var L=U.getWidth(),R=U.getHeight(),F=U.getAnchor();p.editing={mode:m,key:T,rect:{x:-L*F.x,y:-R*F.y,width:L,height:R},anchor:F,matrix:U.getMatrix()}}return T}}},Sp.prototype._checkLine=function(H){var E=this;E.screenInfo;var J,U=E._interactor.getStyle("checkSize");if(vc.checkHit(H,E.screenInfo.P1,U))J="P1";else{if(!vc.checkHit(H,E.screenInfo.P2,U))return this._interactor.setCursor("default"),void 0;J="P2"}return E.editing={mode:"line",key:J},J},Sp.prototype._checkConnect=function(O){var t=this,H=t.screenInfo,f=t._interactor,R=f.getStyle("connectGuideIntersectSize"),d=H.connect,$=O.x,w=d.x;if(w>$&&R>w-$&&Math.abs(d.y-O.y)<R||$>=w&&vc.checkHit(O,d,R)){var p="connect",B=E.getConnectAction(f.gv);if(t.editing={mode:p},B&&B.delete)if(t.target instanceof vc.Group){var m=!0;f.gv.sm().getSelection().each(function(k){B.delete.visible.call(null,f.gv,k)||(m=!1)}),t.editing.hasDeleteAction=m}else B.delete.visible.call(null,f.gv,t.target)&&(t.editing.hasDeleteAction=!0);return f.setCursor("default"),p}},Sp.prototype._fireEditEvent=function(Q,k){var P=this._interactor,f=this.editing;if(f){var j=f.mode;j="rotate"===j?"Rotation":"connect"===j?"Connection":"resize"===j?"Rect":j[0].toUpperCase()+j.slice(1),P.fi({kind:Q+"Edit"+j,event:k})}},Sp.prototype.startEdit=function(X,b){X.startDragging(b);var p=this;p._interactor.fi({kind:"prepareEdit",event:b});var P=p.editing,W=p.target;if(P){if(p._fireEditEvent("begin",b),P.started=!0,"rotate"===P.mode)return P.groupRotateMode&&W.beginRotate(P),X._42(),void 0;if("connect"!==P.mode)("line"===P.mode||W&&0===W.getRotation())&&(p._inSmartGuide=!0,p._interactor.rectGuide.gatherRects());else if(P.hasDeleteAction){var n=X.gv,e=p._interactor.getStyle("connectGuideGarbageShift");P.garbageInfo={x:n.getWidth()*e[0]+e[2],y:n.getHeight()*e[1]+e[3],size:p._interactor.getStyle("connectGuideGarbageIntersectsize")},X._42()}}},Sp.prototype._46O=function(i){var o,$,N=this,m=N.editing,G=N.target;if(m){if("connect"===m.mode&&!m.canceled&&!m.deleted)try{m.garbageInfo&&m.garbageInfo.hover?E.doDeleteConnectionAction(N._interactor.gv,G):E.doConnectAction(N._interactor.gv,G,m.target)}catch(Z){console.error(Z)}$=m.freezeFlag,o=N.editing.groupRotateMode,N._fireEditEvent("end",i),N.editing=null}N.tipInfo=null,N._inSmartGuide&&(N._interactor.rectGuide.clear(),N._inSmartGuide=!1),o&&G&&G.endRotate(),G instanceof S.Block&&($===p?delete G._freezeSyncFromChildren:G._freezeSyncFromChildren=$,G.updateFromChildren())},Sp.prototype.handleNormalStateDelete=function(){var A=this,G=A.editing;if(G&&"connect"===G.mode&&!G.canceled&&!G.deleted){if(G.garbageInfo){try{E.doDeleteConnectionAction(A._interactor.gv,A.target)}catch(x){console.error(x)}G.garbageInfo=null}return G.cursorPos=null,G.targetCorners=null,G.deleted=!0,A._interactor._42(),!0}},Sp.prototype.handleNormalStateKeyDown=function(z){var f=this,m=f.editing;return!m||"connect"!==m.mode||m.canceled||m.deleted?void 0:S.Default.isEsc(z)?(m.cursorPos=null,m.targetCorners=null,m.canceled=!0,f._interactor._42(),!0):void 0},Sp.prototype.handleEdit=function(e,X){var U=this,W=U.editing;if(W){var s,$,m,Z,c,i=U.target,o=W.key,P=W.mode,f=e.lp(X),n=U._interactor;if("connect"===P){if(W.canceled)return;if(W.deleted)return;W.cursorPos=n._getLogicalPoint(X);var V=W.garbageInfo;return V&&vc.checkHit(W.cursorPos,V,V.size)?(V.hover=!0,W.target=null,W.targetCorners=null):(V&&(V.hover=!1),W.target=e.getDataAt(f,function(m){return e.isSelectable(m)?mo(m)?!0:!1:!1})||null,W.targetCorners=vc.getTargetCornersOnScreen(e,W.target)),n._42(),void 0}if("rotate"===P){var A,b,d=W.pos,y=Math.atan2(f.y-d.y,f.x-d.x);if(W.groupRotateMode?b=y-W.hitRot:(A=y-W.hitRot,b=W.rotation+A),b%=2*Math.PI,0>b&&(b+=2*Math.PI),!S.Default.isCtrlDown(X)){var q,Y;am(X)?(q=n.getStyle("shiftRotateRound"),Y=q/2):(q=n.getStyle("rotateRound"),Y=n.getStyle("rotateSensitivity")),b=vc.roundTo(b,q,Y)}W.groupRotateMode?(A=b-(W.lastRotation||0),0!==A&&(i.addRotation(A,W.groupRotateMode,function(N){return e.isRotationEditable(N)}),W.lastRotation=b)):i.setRotation(b),n._setRotateCursor(y),b>Math.PI&&(b-=2*Math.PI);var v=180*(b/Math.PI);v=v.toFixed(2),s=""+v+"°"}else if("resize"===P){var I=W.rect;m=I.x,Z=I.y;var x,H=I.width,r=I.height,N=W.anchor,E=W.matrix,z=i.s&&i.s("keepAspectRatio")||n.getStyle("keepAspectRatio");am(X)&&(z=!z);var p=U._unionPointMode1,C=U._unionPointMode2;if(U._inSmartGuide&&!S.Default.isCtrlDown(X)&&!z){var D;"L"===o||"R"===o?D="x":("T"===o||"B"===o)&&(D="y"),U._adsorbedToClosest(f,D),c=!0}x=E.tfi(f);var K;"LT"===o?(I=p(x,{x:m+H,y:Z+r},H,r,z),K=9):"T"===o?(I=C({x:m,y:x.y},{x:m+H,y:Z+r},H,r,z,"v"),K=1):"RT"===o?(I=p(x,{x:m,y:Z+r},H,r,z),K=33):"L"===o?(I=C({x:x.x,y:Z},{x:m+H,y:Z+r},H,r,z,"h"),K=8):"R"===o?(I=C({x:m,y:Z},{x:x.x,y:Z+r},H,r,z,"h"),K=32):"LB"===o?(I=p(x,{x:m+H,y:Z},H,r,z),K=12):"B"===o?(I=C({x:m,y:Z},{x:m+H,y:x.y},H,r,z,"v"),K=4):"RB"===o&&(I=p(x,{x:m,y:Z},H,r,z),K=36);var g=E.tf(I.x+I.width*N.x,I.y+I.height*N.y);i instanceof S.Block&&(W.hasOwnProperty("freezeFlag")||(W.freezeFlag=i._freezeSyncFromChildren,i._freezeSyncFromChildren=!0)),i.setPosition(g),i.setSize(I.width,I.height),c&&($=i.getRect(),n.rectGuide.gatherLines({node:i,x:$.x,y:$.y,w:$.width,h:$.height},D,K)),s=""+Math.round(I.width)+" * "+Math.round(I.height)}else if("line"===P){if(am(X)){var Q=i.getPoints(),h="P1"===o?Q.get(1):Q.get(0),B={x:f.x-h.x,y:f.y-h.y},F=n.getStyle("shiftLineRotateRound"),J=U._shiftDirList;if(!J||U._shiftRotateRound!==F){U._shiftRotateRound=F,U._shiftDirList=J=[];for(var u=0;u<Math.PI;u+=F)J.push({x:T(u),y:t(u)})}for(var k,O=0,j=0,G=J.length;G>j;j++){var R=J[j],_=R.x*B.x+R.y*B.y;Math.abs(_)>Math.abs(O)&&(O=_,k=R)}f={x:h.x+k.x*O,y:h.y+k.y*O},n.rectGuide.clear()}else U._inSmartGuide&&!S.Default.isCtrlDown(X)&&(U._adsorbedToClosest(f),c=!0);var w=vc.getDataMatrix(i).applyInverse(f);i.setPoint("P1"===o?0:1,w,!0);var l=i.getPoints(),L=l.get(0),M=l.get(1);m=L.x-M.x,Z=L.y-M.y,s=" "+Math.round(Math.sqrt(m*m+Z*Z))+" ",c&&($=i.getRect(),n.rectGuide.gatherLines({node:i,x:$.x,y:$.y,w:$.width,h:$.height}))}if(s){var a=S.Default.getLogicalPoint(X,n._canvas);a.x+=vc.Icons.TipShiftX,a.y+=vc.Icons.TipShiftY,U.tipInfo={helperPos:a,text:s,size:s.length}}U._fireEditEvent("between",X)}},Sp.prototype._unionPointMode1=function(W,Y,s,$,m){if(m&&s&&$){var b=W.x-Y.x,A=W.y-Y.y;Math.abs(b*$)<Math.abs(A*s)?(A=Math.sign(A)*Math.abs(b*$/s),W.y=Y.y+A):(b=Math.sign(b)*Math.abs(A*s/$),W.x=Y.x+b)}return S.Default.unionPoint(W,Y)},Sp.prototype._unionPointMode2=function(l,z,y,Y,v,F){var j=S.Default.unionPoint(l,z);if(v&&y&&Y){var o;"v"===F?(o=j.x+j.width/2,j.width=y*j.height/Y,j.x=o-j.width/2):(o=j.y+j.height/2,j.height=Y*j.width/y,j.y=o-j.height/2)}return j},Sp.prototype._adsorbedToClosest=function(P,S){var l=this,G=l._interactor,s=G.rectGuide.findClosest(P,S),C=G.gridGuide.findClosest(P,S),i=1/0,K=1/0;s&&(isFinite(s.x)&&(i=s.x),isFinite(s.y)&&(K=s.y)),C&&(isFinite(C.x)&&Math.abs(C.x)<Math.abs(i)&&(i=C.x),isFinite(C.y)&&Math.abs(C.y)<Math.abs(K)&&(K=C.y)),isFinite(i)&&(P.x+=i),isFinite(K)&&(P.y+=K)},Sp.prototype._42=function(e,j,d){var s=this;s.info={},s.screenInfo=null;var G=s._interactor;if(!G.editDetail&&s.gatherInfo(j,d)){var $=s.editing,A=$?$.groupRotateMode:null,T=s.screenInfo;if("block"!==A||!$||!$.started){if(T.P1?vc.Icons.DrawIcon(G,e,vc.Icons.Line,T):vc.Icons.DrawIcon(G,e,vc.Icons.Rect,T),T.connect&&(vc.Icons.DrawIcon(G,e,vc.Icons.ConnectGuide,{rotation:T.rotation,connect:T.connect,cursorPos:$?$.cursorPos:null}),$)){if($.targetCorners){for(var m={x:1/0,y:1/0},F={x:-1/0,y:-1/0},H=0,C=$.targetCorners.length;C>H;H+=2)m.x=Math.min(m.x,$.targetCorners[H]),F.x=Math.max(F.x,$.targetCorners[H]),m.y=Math.min(m.y,$.targetCorners[H+1]),F.y=Math.max(F.y,$.targetCorners[H+1]);vc.Icons.DrawIcon(G,e,vc.Icons.HoverDataRect,{min:m,max:F,color:G.getStyle("hoverGuideColor")||G.getStyle("baseColor")})}$.garbageInfo&&vc.Icons.DrawIcon(G,e,vc.Icons.ConnectGuideGarbage,$.garbageInfo)}G.getStyle("rotateTipVisible")&&s.tipInfo&&vc.Icons.DrawIcon(G,e,vc.Icons.TipHelper,s.tipInfo)}s.target instanceof vc.Group&&s.target._42(G,e,j)}};var Eo=vc.Anchor=function(b){this.catalog="Anchor",this._interactor=b};Eo.prototype={},Eo.prototype.constructor=Eo,Eo.prototype.gatherInfo=function(v,x){var o=this;if(1===x.length){var L=x[0];if(!L.getAnchor)return;if(L instanceof S.Shape&&L._70I())return;if(bn(L,v))return;return o.gatherSingleTarget(v,x[0])}return x.length>1?o.gatherMultiTargets(v,x):!1},Eo.prototype.gatherSingleTarget=function(x,p){var t=this;return t.info.POS=p.getPosition(),t.screenInfo.POS=vc.toScreenPosition(x,t.info.POS),t.target=p,!0},Eo.prototype.gatherMultiTargets=function(d,o){var E=this,f=vc.Group.findOrCreateGroup(o,this._interactor._uuid);return f?(E.screenInfo.POS=vc.toScreenPosition(d,f.getAnchor2()),E.target=f,!0):!1},Eo.prototype.isVisible=function(){var G=this,v=G._interactor;if(v.getStyle("anchorVisible")===!1)return!1;var l=G.target;if(l){if(this.editing)return!0;var f=l.getAnchor(),M=v.getStyle("anchorOutsideVisibleThreshold");if(f.x<-M||f.x>1+M||f.y<-M||f.y>1+M)return!0;var A=l.getSize(),U=l.getScale(),c=Math.min(Math.abs(A.width*U.x),Math.abs(A.height*U.y));if(c*v.gv._zoom<v.getStyle("anchorHideThreshold"))return!1}return!0},Eo.prototype.check=function(N,Q,M){if(S.Default.isLeftButton(Q)){var y=this,G=y._interactor;if(y.isVisible()&&G.getStyle("anchorMovable")!==!1){y.editing=null,y.tipInfo=null;var p=y.target;if(p&&N.isAnchorEditable(p)&&N.isEditable(p)){var b;if(y.screenInfo&&(b=y.screenInfo.POS)&&vc.checkHit(M,new vc.Math.Vector2(b),G.getStyle("checkSize"))){if(p instanceof vc.Group)return y.editing={},!0;var B=p.getWidth(),r=p.getHeight(),h=p.getAnchor();return y.editing={rect:{x:-B*h.x,y:-r*h.y,width:B,height:r},anchor:h,matrix:p.getMatrix()},!0}}}}},Eo.prototype.startEdit=function(p,r){p.startDragging(r),p.fi({kind:"beginEditAnchor",event:r})},Eo.prototype._46O=function(_){var W=this;W.editing&&(W.editing=null,W._interactor.fi({kind:"endEditAnchor",event:_})),W.tipInfo=null},Eo.prototype.handleEdit=function(w,A){var M=this,Z=M.target;if(Z){var p=M.editing;if(p){var H=w.lp(A),R=M._interactor;if(Z instanceof vc.Group)return Z.setAnchor2(H),R._42(),void 0;var T=p.matrix,z=T.tfi(H),U=p.rect,q=(z.x-U.x)/U.width,x=(z.y-U.y)/U.height;if(!S.Default.isCtrlDown(A)){var a=R.getStyle("anchorRound"),o=R.getStyle("anchorSensitivity");q=vc.roundTo(q,a,o),x=vc.roundTo(x,a,o)}Z.setAnchor(q,x,!0);var W=S.Default.getLogicalPoint(A,R._canvas);W.x+=vc.Icons.TipShiftX,W.y+=vc.Icons.TipShiftY;var L=""+q.toFixed(2)+", "+x.toFixed(2);M.tipInfo={helperPos:W,text:L,size:L.length},R.fi({kind:"betweenEditAnchor",event:A})}}},Eo.prototype._42=function(s,O,x){var L=this;L.info={},L.screenInfo={};var W=L._interactor;W.editDetail||L.gatherInfo(O,x)&&L.isVisible()&&(vc.Icons.DrawIcon(W,s,vc.Icons.Anchor,L.screenInfo),L.tipInfo&&vc.Icons.DrawIcon(W,s,vc.Icons.TipHelper,L.tipInfo))};var Md=vc.MoveDummy=function(g){this.catalog="MoveDummy",this._interactor=g};Md.prototype={},Md.prototype.constructor=Md,Md.prototype.gatherInfo=function(){var v=this,_=this._interactor.getSubModule("Rect");if(_){var S=_.screenInfo;if(S){var H=v._interactor,N=v.getMovableTarget(_.target);if(N){var J=H.getStyle("moveDummyThreshold");if(J!==!1){var c=S.LT||S.P1,y=S.RT||S.P2,I=S.LB||c;if(c){var K=S.P1,b=Math.min(c.distanceTo(I),c.distanceTo(y));if(!(J!==!0&&b>J)){var s=H.getStyle("moveDummyPosition"),C=y.clone().sub(c),x=I.clone().sub(c),k=s[2],i=s[3];if(K){var Z=H.getStyle("moveDummyLineExtraShift");Z&&(k+=Z[0],i+=Z[1])}var R=c.clone().add(C.clone().multiplyScalar(s[0])).add(C.setLength(k)).add(x.clone().multiplyScalar(s[1])).add(x.setLength(i));return v.screenInfo.pos=R,v.screenInfo.size=H.getStyle("moveDummySensitivity"),!0}}}}}}},Md.prototype.getMovableTarget=function(x){var G=this._interactor.gv;if(mo(x)){if(G.isMovable(x))return x}else if(x instanceof vc.Group)for(var d=x._entities,_=d.length-1;_>=0;_--){var A=d[_];if(mo(A)&&G.isMovable(A))return A}return null},Md.prototype.getMoveInteractor=function(){for(var b,t,l,G=this._interactor.gv,A=G.getInteractors(),b=0,t=A.length;t>b;b++)if(l=A.get(b),l instanceof Vq)return l},Md.prototype.startEdit=function(o,M){o.startDragging(M);var Q=this.getMoveInteractor();if(Q){var Z=this.selectedTarget,A=o.gv;A._moving=1,Q._data=Z,A.handleMouseDown&&A.handleMouseDown(M,Z)}},Md.prototype._46O=function(V){var k=this,Q=k.getMoveInteractor();Q&&(Q.handleWindowMouseUp(V),k.selectedTarget=null)},Md.prototype.handleEdit=function(P,R){var W=this.getMoveInteractor();W&&W.handleWindowMouseMove(R)},Md.prototype.check=function(Y,h,c){if(this.selectedTarget=null,S.Default.isLeftButton(h)&&!Y._scrolling&&!tn()){var _=this;if(_.screenInfo){var T=_.screenInfo.pos;if(T&&!(c.distanceTo(T)>_.screenInfo.size)){var W=_._interactor;return _.selectedTarget=_.getMovableTarget(W.getSubModule("Rect").target),W.setCursor("default"),!0}}}},Md.prototype._42=function(p,M,V){var I=this;I.screenInfo={};var P=I._interactor;P.editDetail||I.gatherInfo(M,V)&&(!P.editing||I.selectedTarget)&&vc.Icons.DrawIcon(P,p,vc.Icons.MoveDummy,I.screenInfo)};var Cm=vc.RotateX=function(h){this.catalog="RotateX",this._interactor=h};Cm.prototype={},Cm.prototype.constructor=Cm,Cm.prototype.gatherInfo=function(o,r){var m=this;if(1===r.length){var b=r[0];return b instanceof S.Shape&&b._70I()||bn(b,o)?!1:m.gatherSingleTarget(o,b)}return r.length>1?m.gatherMultiTargets(o,r):!1},Cm.prototype.gatherSingleTarget=function(){var h=new S.Math.Vector2,r=new S.Math.Vector2,b=new S.Math.Vector2,o=new S.Math.Vector2,I=function(Q,_){var E=Q.x-_.x,b=Q.y-_.y;return E*E+b*b};return function(X,K){if(K.getCorners){var W=this,D=K.getCorners(),s=15,v=K.getPosition();h.copy(D[0]),b.copy(D[1]),o.copy(D[3]),r.copy(h).add(o).divideScalar(2).add(h.sub(b).setLength(s/X.getZoom()));var O=Math.max(I(v,D[0]),I(v,D[1]),I(v,D[2]),I(v,D[3]));return W.info.POS=r.clone(),W.screenInfo.POS=vc.toScreenPosition(X,W.info.POS),W.screenInfo.LEN=Math.sqrt(O)*X.getZoom()+s,W.screenInfo.CENTER=vc.toScreenPosition(X,v),W.target=K,!0}}}(),Cm.prototype.gatherMultiTargets=function(l,P){var i=this,o=vc.Group.findOrCreateGroup(P,this._interactor._uuid);if(!o)return!1;var i=this;return i.gatherSingleTarget(l,o)},Cm.prototype.isVisible=function(){var j=this._interactor;if(!j.getStyle("rotateAsClock"))return!1;var p=this.target;if(!p)return!0;var R=j.gv;return R.isEditable(p)&&R.isRotationEditable(p)?!0:!1},Cm.prototype.check=function(X,I,Y){var U=this,z=U._checkImpl(X,I,Y);return(z||U._clockPainted)&&U._interactor._42(),z},Cm.prototype._checkImpl=function(H,_,E){if(S.Default.isLeftButton(_)){var j=this;j.editing=null,j.tipInfo=null;var f;if(j.screenInfo&&(f=j.screenInfo.POS)&&j.isVisible()){var G=j._interactor;if(vc.checkHit(E,f,G.getStyle("checkSize"))){var U=j.target,t=H.lp(_),p=U.getPosition(),n=Math.atan2(t.y-p.y,t.x-p.x);return G._setRotateCursor(n),j.editing={pos:p,rotation:U.getRotation(),hitRot:n,groupRotateMode:"block",screenInfo:{CENTER:j.screenInfo.CENTER,LEN:j.screenInfo.LEN}},!0}}}},Cm.prototype.startEdit=function(B,P){B.startDragging(P),B.fi({kind:"beginEditRotation",event:P}),this.target instanceof vc.Group&&this.target.beginRotate(this.editing)},Cm.prototype._46O=function(H){var A=this;A.editing&&(A.editing=null,A._interactor.fi({kind:"endEditRotation",event:H})),A.target instanceof vc.Group&&A.target.endRotate(),A.tipInfo=null},Cm.prototype.handleEdit=function(c,i){var U=this,l=U.editing;if(l){var Q,_,Z=U.target,b=c.lp(i),p=U._interactor,Y=l.pos,P=Math.atan2(b.y-Y.y,b.x-Y.x),v=Z instanceof vc.Group;if(v?_=P-l.hitRot:(Q=P-l.hitRot,_=l.rotation+Q),_%=2*Math.PI,0>_&&(_+=2*Math.PI),!S.Default.isCtrlDown(i)){var B,N;am(i)?(B=p.getStyle("shiftRotateRound"),N=B/2):(B=p.getStyle("rotateRound"),N=p.getStyle("rotateSensitivity")),_=vc.roundTo(_,B,N)}v?(Q=_-(l.lastRotation||0),0!==Q&&(Z.addRotation(Q,l.groupRotateMode,function(V){return c.isRotationEditable(V)}),l.lastRotation=_)):Z.setRotation(_),p._setRotateCursor(P),_>Math.PI&&(_-=2*Math.PI);var J=180*(_/Math.PI),m=""+J.toFixed(2)+"°",q=S.Default.getLogicalPoint(i,p._canvas);q.x+=vc.Icons.TipShiftX,q.y+=vc.Icons.TipShiftY,U.tipInfo={helperPos:q,text:m,size:m.length},p.fi({kind:"betweenEditRotation",event:i})}},Cm.prototype._42=function(P,N,O){var Y=this;Y._clockPainted=!1,Y.info={},Y.screenInfo={};var W=Y._interactor;W.editDetail||Y.gatherInfo(N,O)&&Y.isVisible()&&(vc.Icons.DrawIcon(W,P,vc.Icons.RoundPoint,Y.screenInfo.POS),W.getStyle("rotateTipVisible")&&Y.tipInfo&&vc.Icons.DrawIcon(W,P,vc.Icons.TipHelper,Y.tipInfo),Y.editing&&Y.drawClock(P))},Cm.prototype.drawClock=function(z){z.save();var u=this;u._clockPainted=!0;var P=u.editing||{},j=P.screenInfo||u.screenInfo,D=j.LEN,Z=D+8,i=D+18;z.save(),z.translate(j.CENTER.x,j.CENTER.y),z.beginPath(),z.strokeStyle="rgb(150, 150, 150)";for(var B,M,V,p,I,W=0;360>W;W++)B=W*Math.PI/180,0===W%5&&(M=t(B)*D,V=T(B)*D,p=t(B)*Z,I=T(B)*Z,z.moveTo(M,V),z.lineTo(p,I)),0===W%45&&(M=t(B)*D,V=T(B)*D,p=t(B)*i,I=T(B)*i,z.moveTo(M,V),z.lineTo(p,I));z.stroke(),z.rotate(-fs);var E=P.lastRotation||u.target.getRotation();z.beginPath(),z.fillStyle="rgba(255, 0, 0, 0.1)",z.strokeStyle="rgb(157, 157, 157)",z.moveTo(0,0),z.arc(0,0,i,0,E,!1),z.fill(),z.beginPath(),z.moveTo(0+i,0),z.arc(0,0,i,0,E,!1),z.stroke(),z.restore()};var yq=vc.Curve=function(r){this.catalog="Curve",this._interactor=r};yq.prototype={},yq.prototype.constructor=yq,b.defineProperties(yq.prototype,{activing:{get:function(){return this._activing},set:function(K){var l=this;if(K)l._activing=new vc.CurveActiving(this,K),l._activing._firePointChange();else{var O=l._activing;O&&O.dispose(),l._activing=null}}}}),yq.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},yq.prototype.setUp=function(){var p=this,x=p._interactor;x&&x.gv.mp(p._onGraphviewPropertyChanged,p)},yq.prototype._onGraphviewPropertyChanged=function(F){("zoom"===F.property||"translateX"===F.property||"translateY"===F.property)&&this._handleDataChanged()},yq.prototype.tearDown=function(){var C=this,H=C._interactor;H&&H.gv.ump(C._onGraphviewPropertyChanged,C)},yq.prototype.canEnterEditDetailMode=function(){var x=mc(this._interactor);return x?this.target=x:void 0},yq.prototype.canQuitEditDetailMode=function(m){var T=this,P=T._interactor._getLogicalPoint(m);return T._checkEditRealPoint(P)?void 0:T._interactor.gv.getDataAt(m)!==T.target?!0:void 0},yq.prototype.preHandleScroll=function(){var M=this.editing;return M&&M.inEdit?!0:void 0},yq.prototype.getCurrentSelectintStatus=function(){var E=this;if(E.activing&&!E.activing.selections){if(E.activing.status!=p)return E.activing.status;var h=function(b){var p=E.activing.status;E.activing.status=b,E._interactor.fp("shapePointStatus",p,b)},n=vc.Curve.PointType,O=E.activing.point,_=E.activing.pairs;if(!_||1!==_.length)return h(n.Mirrored);var F=_[0],T=F.c1&&F.c1.isNearEnough(O),N=F.c2&&F.c2.isNearEnough(O);if(!F.c1||!F.c2)return T||N?h(n.Straight):h(n.Disconnected);if(T&&N)return h(n.Straight);if(T||N)return h(n.Asymmetric);var s=F.c1.clone().sub(O),c=F.c2.clone().sub(O);return Math.abs(s.x*c.y-s.y*c.x)>1e-5||s.x*c.x>0?h(n.Disconnected):Math.abs(s.length()-c.length())>1e-5?h(n.Asymmetric):h(n.Mirrored)}},yq.prototype.handle_keydown=function(Z){var q=this;if(q._interactor.editDetail){var F=vc.Curve.PointType;"1"===Z.key?q._setCurrentSelectionStatus(F.Straight):"2"===Z.key?q._setCurrentSelectionStatus(F.Mirrored):"3"===Z.key?q._setCurrentSelectionStatus(F.Disconnected):"4"===Z.key&&q._setCurrentSelectionStatus(F.Asymmetric)}},yq.prototype.setCurrentSelectionStatus=function(b){var T=this,j=T._interactor;if(j){var P=j.gv;P.dm().beginTransaction(),this._setCurrentSelectionStatus(b),P.dm().endTransaction()}},yq.prototype._setCurrentSelectionStatus=function(d){var r=this,h=r.activing;if(h){var B=r.getCurrentSelectintStatus();if(null!==B&&B!==d){h.status=d;var N=r.activing.point,F=r.activing.pairs;if(F&&1===F.length){var G=F[0],P=r.screenInfo.curve,e=vc.Curve.PointType,H=r._interactor,$=function(){r._writeToHt(),H.fp("shapePointStatus",B,d),r.check(H.gv,null,new vc.Math.Vector2(H._lastLogicalPoint))};if(d===e.Straight)return P.moveCtrlPoint(G,N,"c1"),P.moveCtrlPoint(G,N,"c2"),$(),void 0;if(B===e.Straight){var p=P.findPairs(N,!0),v=p[0],U=v.r1||N,w=v.r2||N,L=w.clone().sub(U).multiplyScalar(.25);return P.moveCtrlPoint(G,N.clone().sub(L),"c1"),P.moveCtrlPoint(G,N.clone().add(L),"c2"),$(),void 0}var z=G.c1,C=G.c2;if(z&&C){if(d===e.Mirrored)return P.moveCtrlPoint(G,N.clone().multiplyScalar(2).sub(C),"c1"),$(),void 0;if(d===e.Asymmetric&&B===e.Disconnected){var S=z.clone().sub(N).length(),L=N.clone().sub(C).setLength(S).add(N);return P.moveCtrlPoint(G,L,"c1"),$(),void 0}}h._firePointChange(),H.fp("shapePointStatus",B,d),r.check(H.gv,null,new vc.Math.Vector2(H._lastLogicalPoint))}}}},yq.prototype._handleDataChanged=function(){var o="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(V){var e=this;if(e.screenInfo&&e.target){if(V&&o.indexOf(V.property)<0)return;var D=e._interactor;e.gatherSingleTarget(D.gv,e.target,!0),e.check(D.gv,null,new vc.Math.Vector2(D._lastLogicalPoint)),D._42()}}}(),yq.prototype.gatherSingleTarget=function(E,V,J){var Y,l,W=this;W.screenInfo&&W.screenInfo.curve&&(l=W.screenInfo.curve._curves);var n=W.editing;Y=n?W.screenInfo:W.screenInfo={};var a,X,F=V instanceof S.Edge;F?(a=V.s("edge.segments"),X=V.s("edge.points")||new S.List):(a=V._58O,X=V._59O),Y.S=a;var h,m=Y.P=[],c=vc.getDataMatrix(V);if(V instanceof S.Polyline||V instanceof S.Edge&&W._interactor.getStyle("edgeElevationEditable"))h=V.getElevation&&V.getElevation()||0,Y.E=[];else{var M=!1;X.each(function(P){P.e!==p&&(M=!0)}),M&&(Y.E=[])}if(X.each(function(e){Y.E&&Y.E.push(e.e!=p?e.e:h),e=c.apply(e);var F=vc.toScreenPosition(E,e);m.push(F.x,F.y)}),F){var N=m.length,r=vc.toScreenPosition(E,V._lastSourcePoint||(N?{x:m[0],y:m[1]}:{x:0,y:0})),_=vc.toScreenPosition(E,V._lastTargetPoint||(N?{x:m[N-2],y:m[N-1]}:{x:0,y:0}));if(m.splice(0,0,r.x,r.y),m.push(_.x,_.y),Y.E){var O=V.getSource(),s=V.getTarget();Y.E.splice(0,0,((V.s("edge.source.anchor.elevation")||.5)-.5)*O.getTall()+O.getElevation()),Y.E.push(((V.s("edge.target.anchor.elevation")||.5)-.5)*s.getTall()+s.getElevation())}}if(!Y.S||!Y.S.size()){Y.S=new S.List,Y.S.add(1);for(var t=0;t<m.length/2-1;t++)Y.S.add(2)}if((!n||J)&&W.convertToCubicBezier(l),W.activing&&(J||!W.editing||"realPoint"===W.editing.type)){var y=Y.curve.findPairs(W.activing.point);W.activing.pairs=y}},yq.prototype._convertToNewPoint=function(X,D,t,o){var f,q,e;for(f=0,q=D.length;q>f;f++){if(e=D[f],e._p1.isNearEnough(X)&&(!o||o.indexOf(e._p1)<0))return e._p1;if(e._p4.isNearEnough(X)&&(!o||o.indexOf(e._p4)<0))return e._p4}if(t)for(f=0,q=Math.min(t.length,q);q>f;f++){if(e=t[f],e._p1===X&&(!o||o.indexOf(D[f]._p1)<0))return D[f]._p1;if(e._p4===X&&(!o||o.indexOf(D[f]._p4)<0))return D[f]._p4}},yq.prototype.convertToCubicBezier=function(h){var R,S,V=this,L=new vc.Math.Curve,O=V.screenInfo;if(L.createFromHtShape(O.P,O.S,O.E),O.curve=L,V.activing){var W=L._curves;R=V.activing.point,S=V._convertToNewPoint(R,W,h);var Q=[];if(S&&(V.activing.point=S,Q.push(S)),V.activing.selections){var M=-1,K=V.activing.selections;K.forEach(function(B){M++,S=V._convertToNewPoint(B,W,h,Q),S&&(K[M]=S,Q.push(S))})}}},yq.prototype.check=function(E,C,i){if(!C||Dj(C)||Op(C)){var R=this;if(R._interactor.setCursor("default"),R.editing=null,R.highlight=null,R.tipInfo=null,R.edgeEditResult=null,R.screenInfo){if(tn()||C&&Op(C))return R._interactor._42(),!0;if(R._checkEditCtrlPoint(i))return R._interactor._42(),!0;if(R._checkEditRealPoint(i))return R._interactor._42(),!0;if(R._checkEditElevation(i))return R._interactor._42(),!0;var a=R.screenInfo.curve,e=a.checkPoint(i,R._interactor.getStyle("curveIntersectSize"));if(e){var K=R.highlight={};K.type="insertKnot",K.bezier=e.bezier,K.point=e.intersection}return R._interactor._42(),!0}}},yq.prototype.getAdjacentBeziers=function(u){var B=this.screenInfo;if(B){var U,i,Z,j=B.curve._curves,x=[],A=p;for(U=0,i=j.length;i>U;U++)if(Z=j[U],A===p){if(Z._p4.isNearEnough(u)){x.push(Z),A=U;continue}}else{if(Z._p1.isNearEnough(u))return x.push(Z),x;if(Z._p4.isNearEnough(u)){x[0]=Z,A=U;continue}}}},yq.prototype.roundCorner=function(O){if(this.activing&&this.screenInfo){var q=this.screenInfo.curve,J=q._curves,N=this.getAdjacentBeziers(this.activing.point),i=N[1],V=i._index;i=i.insertKnot(i.getTByPercentage(O/i.length))[1],J[V]=i;var T=i.p1,u=N[0],z=u._index;u=u.insertKnot(u.getTByPercentage(1-O/u.length))[0],J[z]=u;var M=u.p4,s=this.activing.point,_=new vc.Math.CubicBezier(M,s.clone().sub(M).multiplyScalar(2/3).add(M),s.clone().sub(T).multiplyScalar(2/3).add(T),T);J.splice(V,0,_),this._writeToHt(),this.activing=null,this._interactor._42()}},yq.prototype._checkEditRealPoint=function(H){var m,W,n,O,D,b,a=this,f=a.screenInfo.curve._curves,N=a._interactor.getStyle("curvePointIntersectSize"),u=1/0;for(N*=N,n=0,O=f.length;O>n;n++)m=f[n],D=m._p1,b=H.distanceToSquared(D),u>b&&(u=b,W=D),D=m._p4,b=H.distanceToSquared(D),u>b&&(u=b,W=D);if(u>N)return!1;var V=a.highlight={};return V.type="changeRealPoint",V.point=W,a.editing={type:"realPoint",point:W,shiftGuide:{point:W.clone(),dir:"x",limit:0}},a._interactor.setCursor("crosshair"),!0},yq.prototype._checkEditElevation=function(Z){var R=this;if(!R._interactor.getStyle("curveElevationVisible"))return!1;var T=R.target;if(T instanceof S.Edge&&!R._interactor.getStyle("edgeElevationEditable"))return!1;var O=R.activing;if(!O)return!1;var u=O.getCurrentEditingPoint();if(!u)return!1;var W=R._interactor,A=W.getStyle("curveElevationGuideShift"),d=W.getStyle("curveElevationIntersectSize"),a=Z.distanceToSquared({x:u.x+A[0],y:u.y+A[1]});if(!(a>d*d)){var Q=R.highlight={};Q.type="elevation";var D=new vc.Math.Vector2(Z.x,Z.y,u.e);return R.editing={type:"elevation",startPoint:D},R._interactor.setCursor("crosshair"),!0}},yq.prototype._checkEditCtrlPoint=function(e){var f=this;if(f.activing&&!f.activing.selections){var V=f.getCurrentSelectintStatus();if(V!==vc.Curve.PointType.Straight){var n=f.activing.pairs;if(n){var d=f._interactor.getStyle("curvePointIntersectSize");d*=d;var k,U,B,L,x,Y,I,m,$,t=1/0;for(I=0,$=n.length;$>I;I++)for(L=n[I],m=0;2>m;m++)x=0===m?"c1":"c2",L[x]&&(Y=e.distanceToSquared(L[x]),t>Y&&(t=Y,k=L,U=I,B=x));if(t>d)return!1;f.activing.hlpair=k,f.activing.hltype=B;var q=f.highlight={};return q.type="changeCtrlPoint",q.point=k[B],f.editing={type:"ctrlPoint",pair:k,pairId:U,ctrlType:B,direction:k[B].clone().sub(f.activing.point).normalize()},f._interactor.setCursor("crosshair"),!0}}}},yq.prototype.startEdit=function(R,w){R.startDragging(w);var V=this;V.highlight&&"insertKnot"===V.highlight.type&&(V.insertKnot(),V.gatherSingleTarget(V._interactor.gv,V.target),V.activing=null,V._checkEditRealPoint(V._interactor._getLogicalPoint(w)));var b=V._activing;if(b){var B=V.editing?V.editing.type:null;"ctrlPoint"===B?b.editingCtrl={pairId:V.editing.pairId,type:b.hltype}:"realPoint"===B&&(b.editingCtrl=!1)}var F=V.highlight,N=S.Default.isCtrlDown(w);if(!F||tn()||Op(w)){var L=V._interactor.gv;if(!L.setFocus(w)||L._scrolling)return;return N?V._multiSelect={startPoint:L.lp(w)}:L.isPannable()&&(Dj(w)||Op(w))&&(V._pan={tx:L.tx(),ty:L.ty()},R.fi({kind:"beginPan",event:w})),void 0}if("changeRealPoint"===F.type){var s,I=V.activing?V.activing.point:null,v=V.activing?V.activing.selections:null;if(N&&V.activing)I===F.point?(v?(V.activing={point:v[0]},v.length>1&&(v.splice(0,1),V.activing.selections=v)):V.activing=null,V.editing=null):v&&(s=v.indexOf(F.point))>=0?(v.length>1?v.splice(s,1):delete V.activing.selections,V.editing=null):v?(v.push(I),V.activing={point:F.point,selections:v}):V.activing={point:F.point,selections:[I]};else if(v)I===F.point||((s=v.indexOf(F.point))>=0?(v.splice(s,1,I),V.activing={point:F.point,selections:v}):V.activing={point:F.point});else{var c;I===F.point&&(c=V.activing.status),V.activing={point:F.point},c&&(V.activing.status=c)}R.fi({kind:"beginEditPoint",event:w})}},yq.prototype.insertKnot=function(){var H=this,b=H.highlight,w=H.screenInfo.curve;w.insertKnot(b.bezier,b.point.t),H._writeToHt()},yq.prototype._writeToHt=function(){var V,W,i=this,Y=i.screenInfo.curve,e=Y.toHtShape(),_=e.points,R=[],u=e.segments,z=i._interactor.gv;z.dm().beginTransaction();var N,H,r=i.target,j=r instanceof S.Edge,Q=vc.getDataMatrix(r).invert();H=r instanceof S.Polyline||j&&i._interactor.getStyle("edgeElevationEditable"),H&&(N=r.getElevation&&r.getElevation()||0);for(var M=0,A=_.length;A>M;M++)V=_[M],W=vc.toWorldPosition(z,V),W=Q.apply(W),isFinite(V.e)&&V.e!==N&&(W.e=V.e),R.push(W);if(r._writing=!0,j){r.s("edge.type","points"),r.setStyle("edge.segments",u),r.setStyle("edge.points",R.slice(1,R.length-1)),r.setStyle("edge.source.offset.x",0),r.setStyle("edge.source.offset.y",0),r.setStyle("edge.target.offset.x",0),r.setStyle("edge.target.offset.y",0);var h=i._nextChangeEdgeHost;delete i._nextChangeEdgeHost,h&&("source"===h.type?r.setSource(h.host):r.setTarget(h.host)),i._writeEdgeHostAnchor("source",R[0]),i._writeEdgeHostAnchor("target",R[R.length-1])}else R.length?(r.setSegments(u),r.setPoints(R,!0)):r.removeFromDataModel();z.dm().endTransaction(),delete r._writing},yq.prototype._writeEdgeHostAnchor=function($,Z){var B=this,u=B.target,z=B._calcHostAnchor(u,$,Z);z.index!==p?(u.setStyle("edge."+$+".index",z.index),u.setStyle("edge."+$+".percent",p),u.setStyle("edge."+$+".anchor.x",p),u.setStyle("edge."+$+".anchor.y",p)):z.percent!==p?(u.setStyle("edge."+$+".percent",z.percent),u.setStyle("edge."+$+".index",p),u.setStyle("edge."+$+".anchor.x",p),u.setStyle("edge."+$+".anchor.y",p)):(u.s("edge."+$+".anchor.x",z.x),u.s("edge."+$+".anchor.y",z.y),u.s("edge."+$+".anchor.elevation",z.e),z.offsetX||z.offsetY?(u.s("edge."+$+".offset.x",z.offsetX),u.s("edge."+$+".offset.y",z.offsetY),u.s("edge."+$+".offset.elevation",z.offsetElevation)):(u.s("edge."+$+".offset.x",0),u.s("edge."+$+".offset.y",0),u.s("edge."+$+".offset.elevation",0)))
},yq.prototype._calcHostAnchor=function(I,A,Y,g){g||(g="source"===A?I.getSource():I.getTarget());var W=this._interactor.gv,k=W.calculateAttachPoint(g,Y);if(k)return k.info;if(br(g)){var e=W.calculateEdgePosition(g,Y);return e}var l=g.getRotation(),u=g.getAnchor();bn(g,W)&&(l=0);var y=g.getElevation(),$=g.getTall();y=((Y.e||0)-y)/$+.5;var H=g.getScale();if(l||H.x<0||H.y<0){var z=g.getMatrix(),K=z.tfi(Y),n=g.getSize();return{x:K.x/n.width+u.x,y:K.y/n.height+u.y,e:y}}var V=tg(W,g),Q={x:(Y.x-V.x)/V.width,y:(Y.y-V.y)/V.height,e:y};return Q},yq.prototype._handlePanning=function(N){var R=this,E=R._pan;if(E){E.started=!0;var i=R._interactor,Y=i.gv,I=i._lastClientPoint,C=Wc(N),Q=Ln(Y,C,I);Y.setTranslate(E.tx+Q.x,E.ty+Q.y),R.gatherSingleTarget(i.gv,R.target),i._42(),i.fi({kind:"betweenPan",event:N})}},yq.prototype.handleEdit=function(I,_){var X=this,h=X.editing;if(X._pan)return X._handlePanning(_),void 0;if(X._multiSelect)return X._multiSelect.endPoint=I.lp(_),X._interactor.redraw(),void 0;if(h){h.inEdit=!0;var a,U,A,V=X._interactor._getLogicalPoint(_),l=S.Default.isCtrlDown(_),d=S.Default.isShiftDown(_),K=h.type,q=X.activing;if(X._guideInfo=null,"ctrlPoint"===K&&d){var c=X.editing.direction.clone();a=q.point;var N=c.dot(V.clone().sub(a));V=c.setLength(N).add(a)}else if("ctrlPoint"===K||"realPoint"===K){var c;if("realPoint"===K&&d){var R=X.editing.shiftGuide;U=R.point;var Z=Math.abs(V.x-U.x),T=Math.abs(V.y-U.y);Z>T&&Z>R.limit&&"y"===R.dir&&(R.dir="x"),T>Z&&T>R.limit&&"x"===R.dir&&(R.dir="y"),c=R.dir,"x"===c?(V.y=U.y,R.limit=Math.max(R.limit,Z)):"y"===c&&(V.x=U.x,R.limit=Math.max(R.limit,T))}var C=X._isEditEdgeSourceTarget();if(C){var x=X._editEdgeSourceTarget(C,V,l);x&&(X.edgeEditResult=x,A=x.tipText)}else if(!l){var B=X._guidingToEdit(V,c),t="realPoint"===K?X._interactor.gridGuide.findClosest(V,c,!0):null,n=1/0,L=1/0;t&&(t.x&&(n=t.x),t.y&&(L=t.y));var k=!1;B&&(B.xList&&(Math.abs(B.x)<=Math.abs(n)?(k=!0,n=B.x):delete B.xList),B.yList&&(Math.abs(B.y)<=Math.abs(L)?(k=!0,L=B.y):delete B.yList),k&&(X._guideInfo=B)),isFinite(n)&&(V.x+=n),isFinite(L)&&(V.y+=L),k&&(B.v=V)}}var E=X.screenInfo.curve;if("realPoint"===h.type){a=h.point,a.e!==p&&(V.e=a.e),E.moveRealPoint(a,V),h.point=V,X.highlight.point=V;var F=q.status,g=q.selections;if(X.activing={point:V,status:F},g){var Q=V.clone().sub(a),m=0;g.forEach(function(I){var K=I.clone().add(Q);E.moveRealPoint(I,K),g[m++]=K}),X.activing.selections=g}}else if("ctrlPoint"===h.type){var f=q.pairs,D=f[h.pairId];E.moveCtrlPoint(D,V,h.ctrlType);var e=q.status,W=vc.Curve.PointType;if((e===W.Mirrored||e===W.Asymmetric)&&D.c1&&D.c2){var a=new vc.Math.Vector2(q.point),s="c1"===h.ctrlType?"c2":"c1";if(e===vc.Curve.PointType.Mirrored)E.moveCtrlPoint(D,a.clone().multiplyScalar(2).sub(V),s);else if(e===W.Asymmetric){var N=D[s].clone().sub(a).length(),z=a.clone().sub(D[h.ctrlType]).setLength(N).add(a);isNaN(z.x)||E.moveCtrlPoint(D,z,s)}}q._firePointChange()}else if("elevation"===h.type){U=h.startPoint;var M=U.e+(U.y-V.y)/I._zoom;X._setCurrentPointImpl("e",M),q._firePointChange(),A="E: "+vc.toFixed(M)}var G=S.Default.getLogicalPoint(_,X._interactor._canvas);if(G.x+=vc.Icons.TipShiftX,G.y+=vc.Icons.TipShiftY,!A){var y=vc.toWorldPosition(I,V);A=""+vc.toFixed(y.x)+", "+vc.toFixed(y.y)}X.tipInfo={helperPos:G,text:A,size:A.length},X._writeToHt(),X._interactor.fi({kind:"betweenEditPoint",event:_})}},yq.prototype._setCurrentPointImpl=function(a,F){var f=this,R=f._activing;if(!R)return!1;var G=f.target;if(!G)return!1;var I=R.getCurrentEditingPoint();if(!I)return!1;var Y=R.editingCtrl;if(!Y)var d=I.clone();if("e"===a)I.e=F;else{var M;if("x"===a||"y"===a){var h=R._lastFirePoint;M="x"===a?{x:F,y:h?h.y:0}:{x:h?h.x:0,y:F}}else"object"==typeof a?(M=a,a.e!==p&&(I.e=a.e)):(M={x:arguments[0],y:arguments[1]},arguments[2]!==p&&(I.e=arguments[2]));var n=vc.getDataMatrix(G);M=vc.toScreenPosition(f._interactor.gv,n.apply(M)),I.x=M.x,I.y=M.y}if(!Y){var $=d.multiplyScalar(-1).add(I);I.e&&d.e&&($.e=I.e-d.e);var D=f.screenInfo.curve;D.moveCtrlDueToRealPointMovement(I,$);var c=R.selections;if(c){var b=0;c.forEach(function(W){var p=W.clone().add($);isFinite($.e)&&(p.e=(isFinite(W.e)?W.e:G.getElevation()||0)+$.e),D.moveRealPoint(W,p),c[b++]=p}),R.selections=c}}return!0},yq.prototype.setCurrentPoint=function(H,Y){return this._setCurrentPointImpl(H,Y)?(this._writeToHt(),!0):!1},yq.prototype._isEditEdgeSourceTarget=function(){var D=this,W=D.target;if(!(W instanceof S.Edge))return!1;var n=D.editing.point,m=D.screenInfo.curve._curves;return n===m[0]._p1?"source":n===m[m.length-1]._p4?"target":!1},yq.prototype._editEdgeSourceTarget=function(e,L,A){var s,h=this,l=h.target;if(s="source"===e?l.getSource():l.getTarget()){var b,k=h._interactor.gv,S=vc.toWorldPosition(k,L),w=h._calcHostAnchor(l,e,S,s);if(b=w.index!==p||w.percent!==p?w.distance*k.getZoom()>h._interactor.getStyle("edgeHostEdgeMaxDistance"):h._interactor.getStyle("edgeHostDetectPerFrame")?!0:w.x<0||w.x>1||w.y<0||w.y>1?!0:!1){var u=k.getDataAt(S,function(L){return k.isSelectable(L)?k.isSourceTargetEditable(l,L,e)?l.canSetSourceTarget(L,e)?!0:!1:!1:!1});if(u){var i=h._calcHostAnchor(l,e,S,u);s=u,h._nextChangeEdgeHost={type:e,host:u},w=i}}var P,I,v;if(A||w.x===p)(w.percent!==p||w.index!==p)&&(I=w.point);else{var d=h._interactor.getStyle("anchorRound"),y=h._interactor.getStyle("anchorSensitivity");P=k.calculateAttachPoint(s,S),P?w=P.info:(w.x=vc.roundTo(w.x,d,y),w.y=vc.roundTo(w.y,d,y)),I=qd(k,s,0,w.offsetX||0,w.offsetY||0,w.x,w.y)}I&&(v=vc.toScreenPosition(k,I),L.x=v.x,L.y=v.y),h._edgeHostGuideInfo={corners:vc.getTargetCornersOnScreen(k,s),attach:P?P.index:-1,host:s};var Z;return w.percent!==p?Z="percent: "+w.percent.toFixed(2):w.index!==p?Z="index: "+w.index:(Z=""+w.x.toFixed(2)+", "+w.y.toFixed(2),(w.offsetX||w.offsetY)&&(Z+=" offset: "+w.offsetX.toFixed(2)+", "+w.offsetY.toFixed(2))),{host:s,anchor:w,tipText:Z}}},yq.prototype._guidingToEdit=function(r,c){var B,S,I=this;if(B=I.screenInfo.curve){S=B._curves;var G,j,$,p,g,T,F,N,Y=1/0,O=1/0,n=[];for(I.editing&&"realPoint"===I.editing.type&&(N=I.editing.point),g=0,T=2*S.length;T>g;g++)F=S[Math.floor(g/2)][g%2?"_p4":"_p1"],n.indexOf(F)>=0||(n.push(F),N&&N===F||($=F.x-r.x,p=F.y-r.y,Math.abs($)<Math.abs(Y)?(Y=$,G=[F]):$===Y&&G.push(F),Math.abs(p)<Math.abs(O)?(O=p,j=[F]):p===O&&j.push(F)));var V=I._interactor.getStyle("smartGuideThreshold");if((Math.abs(Y)>V||"y"===c)&&(G=null),(Math.abs(O)>V||"x"===c)&&(j=null),G||j){var W=!1,u={};if(G&&(W=!0,u.xList=G,u.x=Y),j&&(W=!0,u.yList=j,u.y=O),W)return u}}},yq.prototype._46O=function(c){var W=this;W.editing&&(W.editing=null,W._interactor.fi({kind:"endEditPoint",event:c})),W._guideInfo=null,W._edgeHostGuideInfo=null,W._pan&&(W._pan=null,W._interactor.fi({kind:"endPan",event:c})),W._multiSelect&&(W._handleMultiSelect(W._multiSelect,c),W._multiSelect=null),W.tipInfo=null,W.edgeEditResult=null},yq.prototype._handleMultiSelect=function(z,i){if(z.startPoint&&z.endPoint){var D,h,Y,j,G,b,O=this,I=O._interactor,N=I.gv,q=vc.toScreenPosition(N,z.startPoint),e=vc.toScreenPosition(N,z.endPoint),F=S.Default.unionPoint(q,e),X=O.screenInfo.curve._curves,H=[],K=function(G){G.x>=F.x&&G.y>=F.y&&G.x<=F.x+F.width&&G.y<=F.y+F.height&&H.indexOf(G)<0&&H.push(G)};for(D=0,h=X.length;h>D;D++)G=X[D],K(G._p1),K(G._p4);if(H.length){var t=O.activing||{},U=t.selections||[];t.point&&U.push(t.point);var L=S.Default.isShiftDown(i),x=i.altKey;if(x&&!L)for(b=H,H=[],D=0,h=b.length;h>D;D++)Y=b[D],j=U.indexOf(Y),j>=0&&H.push(Y);for(D=0,h=U.length;h>D;D++)Y=U[D],j=H.indexOf(Y),j>=0?(!L||L&&x)&&(H[j]=p):H.push(Y);for(b=H,H=[],D=0,h=b.length;h>D;D++)b[D]&&H.push(b[D]);h=H.length,0===h?O.activing=null:1===h?O.activing={point:H[0]}:(Y=H[h-1],O.activing={point:Y,selections:H.splice(0,h-1)}),I.redraw()}}},yq.prototype._canDeletePoint=function(U,K){var y=this.target;if(!(y instanceof S.Edge))return!0;var n=U._curves[0],h=U._curves[U._curves.length-1];return n._p1===K||h._p4===K?!1:!0},yq.prototype.handleDelete=function(){var N=this;if(N.activing&&N.screenInfo){var D=S.Default.isShiftDown(),Q=N.screenInfo.curve;N._canDeletePoint(Q,N.activing.point)&&Q.deleteRealPoint(N.activing.point,D),N.activing.selections&&N.activing.selections.forEach(function(Y){N._canDeletePoint(Q,Y)&&Q.deleteRealPoint(Y,D)}),N.activing=null,delete N.editing,delete N.tipInfo,delete N.edgeEditResult,delete N._pan,delete N._multiSelect,N._writeToHt(),N._interactor.fp("deleteShapePoint",!1,!0)}},yq.prototype.handleDoubleClick=function(d){var i=this,U=i._interactor._getLogicalPoint(d);if(i.screenInfo&&i._checkEditRealPoint(U)){var r=i.getCurrentSelectintStatus(),R=vc.Curve.PointType;return r=r===R.Mirrored?R.Straight:R.Mirrored,i._setCurrentSelectionStatus(r),i._interactor._42(),!0}},yq.prototype._drawHighlight=function(X){var L=this,w=L.highlight;if(w){var H=w.bezier,E=L._interactor;H&&vc.Icons.DrawIcon(E,X,vc.Icons.ShapeHighlightCurve,[H._p1.x,H._p1.y,H._p2.x,H._p2.y,H._p3.x,H._p3.y,H._p4.x,H._p4.y]);var I=w.point;I&&"insertKnot"===w.type&&vc.Icons.DrawIcon(E,X,vc.Icons.ShapeHighlighPoint,I)}},yq.prototype._drawGuide=function(H){var C=this,B=C._guideInfo;if(B){var E,h,i,g,w=B.v;for(E=0;2>E;E++)if(g=0===E?B.xList:B.yList)for(h=0,i=g.length;i>h;h++)vc.Icons.DrawIcon(C._interactor,H,vc.Icons.ShapeGuideLine,[w.x,w.y,g[h].x,g[h].y])}},yq.prototype._drawCurrentPoint=function(X){var y=this;if(y.activing){var T=y.activing,I=y.getCurrentSelectintStatus(),f=y._interactor;if(I!==vc.Curve.PointType.Straight){var i=T.pairs;T.hlpair,T.hltype;var D=T.selections,M=T.editingCtrl;if(i&&!D){var N,c,p;for(c=0,p=i.length;p>c;c++)N=i[c],M&&c===M.pairId&&N[M.type]?vc.Icons.DrawIcon(f,X,vc.Icons.ShapeActivingCtrl,{point:N.point,c1:N.c1,c2:N.c2,hl:M.type}):vc.Icons.DrawIcon(f,X,vc.Icons.ShapeActivingCtrl,N)}}vc.Icons.DrawIcon(f,X,vc.Icons.ShapeHighlighRealPoint,y.activing.point),D&&D.forEach(function(h){vc.Icons.DrawIcon(f,X,vc.Icons.ShapeHighlighRealPoint,h)})}},yq.prototype.clear=function(){var N=this;N.editing=null,N._guideInfo=null,N.activing=null,N.highlight=null},yq.prototype._42=function(H){var l=this;l.info={},l.editing||(l.screenInfo=null);var R=l._interactor;if(!R.editDetail)return l.clear(),void 0;var P=R.gv;if(!l.target||!P.isSelected(l.target)||!P.isVisible(l.target))return R.editDetail=!1,l.clear(),void 0;if(l.gatherSingleTarget(P,l.target),vc.Icons.DrawIcon(R,H,vc.Icons.ShapeBgCurve,l.screenInfo),l._interactor.getStyle("curveElevationVisible")&&(l.target instanceof S.Polyline||l.target instanceof S.Edge&&l._interactor.getStyle("edgeElevationEditable"))&&l.activing){var I=l.activing.getCurrentEditingPoint();I&&"string"!=typeof I.e&&vc.Icons.DrawIcon(R,H,vc.Icons.EdgeElevationGuide,I)}if(l._drawHighlight(H),l._drawCurrentPoint(H),l._getRealPoint().forEach(function(K){vc.Icons.DrawIcon(R,H,vc.Icons.ShapePoint,K)}),l._drawGuide(H),l.tipInfo&&l._interactor.getStyle("curveTipVisible")&&vc.Icons.DrawIcon(R,H,vc.Icons.TipHelper,l.tipInfo),l._edgeHostGuideInfo&&R._drawHostGuide(l._edgeHostGuideInfo),l.edgeEditResult&&l._drawEdgeHostHighlight(H,l.edgeEditResult.host,l.edgeEditResult.anchor),l._multiSelect&&l._multiSelect.endPoint){var z=S.Default.unionPoint(vc.toScreenPosition(P,l._multiSelect.startPoint),vc.toScreenPosition(P,l._multiSelect.endPoint));z.color=P.getRectSelectBorderColor(),H.save(),H.setTransform(1,0,0,1,0,0);var k=E.devicePixelRatio,O=z.borderWidth=Math.round(k);O/=2,z.x=Math.round(z.x*k)+O,z.y=Math.round(z.y*k)+O,z.width=Math.round(z.width*k),z.height=Math.round(z.height*k),vc.Icons.DrawIcon(R,H,vc.Icons.SimpleRect,z),H.restore()}},yq.prototype._drawEdgeHostHighlight=function(r,_,g){this.drawEdgeHostHighlight(r,_,g),this._interactor.redraw()},yq.prototype.drawEdgeHostHighlight=function(O,z,A){if(br(z)){var M,m,D,u,o=this,P=o._interactor,l=P.gv,e=l.getDataUI(z),t=Yq(e),d=[];for(D=0,u=t.points.length;u>D;D++)m=vc.toScreenPosition(l,t.points.get(D)),d.push(m.x,m.y);t.segments&&(M=t.segments.toArray());var U=P.getStyle("edgeHostHighlighPeriod"),Q=P.getStyle("edgeHostEdgeHighlighColor");vc.Icons.DrawIcon(P,O,vc.Icons.ShapeBgCurve,{P:d,S:M,color:Q,dynamicVisible:A.index===p,dynamicPeriod:U}),Q=P.getStyle("edgeHostPointHighlighColor");var Y=Qi(e);for(D=0,u=Y.length;u>D;D++){var W=Y[D],b=vc.toScreenPosition(l,W);vc.Icons.DrawIcon(P,O,vc.Icons.ShapePoint,{point:{x:b.x,y:b.y},color:Q,size:12,dynamicVisible:D===A.index,dynamicPeriod:U})}}},yq.prototype._getRealPoint=function(){var c,H=this.screenInfo,r=H.P,k=H.S,C=-1,o=[],u=-1,T=k.length;return k.each(function(e){u++;var K=1;if(3===e)K=2;else if(4===e)K=3;else if(5===e)return;C+=K,c=u+1>=T?!0:1===k.get(u+1)?!0:!1,o.push({point:{x:r[2*C],y:r[2*C+1]},segmentIndex:u,pointIndex:C,isEnd:c})}),o},yq.prototype.getEditingPointsInfo=function(i){var K=this,Q=K.activing;if(!Q)return!1;var L=Q.point;if(!L)return!1;var P=this._getRealPoint(),S=[{screen:L}];Q.selections&&Q.selections.forEach(function(v){S.push({screen:v})});var z,C,e=P.length;return S.forEach(function(r){for(z=0;e>z;z++)if(C=P[z],r.screen.isNearEnough(C.point)){r.segmentIndex=C.segmentIndex,r.pointIndex=C.pointIndex,r.point=K.target.getPoints().get(C.pointIndex);break}}),i&&S.sort(function(w,M){return w.segmentIndex-M.segmentIndex}),S};var Sr=vc.MoveHelper=function(v){var y=this;y.catalog="Move",y._interactor=v};Sr.prototype={},Sr.prototype.constructor=Sr,Sr.prototype.calcShift=function(h,z,U){var N,$,s=this,B=s._interactor.gv,O=B.lp(z);if("beginMove"===h&&s._gatherGridInfo(U._lastLogicalPoint||O),N=s._target){var t=N.downPosition;if(t){var V=s._interactor.getStyle("moveSensitivity")/B._zoom;if(t.distanceTo(O)<V)return{x:0,y:0};delete N.downPosition}var p;$=S.Default.isShiftDown(z),$&&(O=s._dealShiftDown(O),p=N.shiftGuide.dir);var l,c=N.rawPos={x:N.pos.x+O.x-N.lp.x,y:N.pos.y+O.y-N.lp.y};if(S.Default.isCtrlDown(z)){if(l=s._calcShiftByAddon(),s._target.node instanceof vc.Group){var X=s._target.node;X._position.x+=l.x,X._position.y+=l.y}return l}var q=s._interactor.rectGuide;if(N.node instanceof S.Data&&N.node.s("2d.attachable")){var Z=s._calcAttachNodeShift(N.node,c);if(q.clear(),Z)return Z}for(var A,Q=N.x+c.x,L=N.y+c.y,K={x:Q,y:L},I={x:Q+N.w/2,y:L+N.h/2},F={x:Q+N.w,y:L+N.h},W=s._interactor.gridGuide,n=[q.findClosest(K,p),q.findClosest(I,p),q.findClosest(F,p),W.findClosest(K,p),W.findClosest(I,p),W.findClosest(F,p)],u=1/0,y=1/0,d=0,Y=n.length;Y>d;d++)A=n[d],A&&(Q=A.x,L=A.y,isFinite(Q)&&Math.abs(Q)<Math.abs(u)&&(u=Q),isFinite(L)&&Math.abs(L)<Math.abs(y)&&(y=L));if(isFinite(u)||(u=0),isFinite(y)||(y=0),l=s._calcShiftByAddon(u,y),s._target.node instanceof vc.Group){var X=s._target.node;X._position.x+=l.x,X._position.y+=l.y}var o=N.node;if(!bn(o,B)){var D=c.x+u,r=c.y+y;s._interactor.rectGuide.gatherLines({node:o,x:N.x+D,y:N.y+r,w:N.w,h:N.h},p)}return l}},Sr.prototype._calcShiftByAddon=function(K,v){var o=this._target,p=o.rawPos,q=o.node.getPosition();return K=K||0,v=v||0,{x:p.x-q.x+K,y:p.y-q.y+v}},Sr.prototype._dealShiftDown=function(L){var n=this,g=n._target.shiftGuide,K=n._target.lp,B=Math.abs(L.x-K.x),E=Math.abs(L.y-K.y);B>E&&B>g.limit&&"y"===g.dir&&(g.dir="x"),E>B&&E>g.limit&&"x"===g.dir&&(g.dir="y");var a=g.dir;return"x"===a?(L.y=K.y,g.limit=Math.max(g.limit,B)):"y"===a&&(L.x=K.x,g.limit=Math.max(g.limit,E)),L},Sr.prototype._isAttachableLineShape=function(N){if(!N.getSegments)return!1;var F=N.getSegments();if(!F)return!0;F instanceof S.List&&(F=F.getArray());for(var T=1,M=F.length;M>T;T++)if(2!==F[T])return!1;return!0},Sr.prototype._calcAttachNodeShift=function(){var _=new Qf,e=new Qf,f=new Qf,J=new Qf;return function(n,D){var m=this._interactor.gv,g=n.getHost(),o=m.getDataAt(D,function(f){return f.s("2d.hostable")?!0:!1});if(o&&g!==o&&n.setHost(o),!o)return this._edgeHostGuideInfo=null,n.setHost(null);var Y=this._edgeHostGuideInfo={corners:vc.getTargetCornersOnScreen(m,o),host:o,attach:-1};if(this._isAttachableLineShape(o)){for(var k,X,$,Z,P,K,E=o.getPoints(),R=E.size(),i=o.getPointsMatrix2d(),s=1/0,U=0;R>U&&(U!==R-1||o.isClosePath());U++)0!==U?e.copy(f):i.apply(E.get(U),e),i.apply(U===R-1?E.get(0):E.get(U+1),f),_.copy(D).sub(e),J.copy(f).sub(e),k=J.length(),J.divideScalar(k),X=_.dot(J),0>X?X=0:X>k&&(X=k),J.multiplyScalar(X).add(e),$=_.copy(D).sub(J).lengthSq(),s>$&&(s=$,K=U,Z=X,P=k);return Math.sqrt(s)*m.getZoom()>this._interactor.getStyle("attachThreshold")?(n.s({"attach.index":-1}),n.setHost(null),void 0):(n.s("attach.offset.opposite")&&(Z=P-Z),n.s({"attach.index":K,"attach.offset":n.s("attach.offset.relative")?Z/P:Z}),{x:0,y:0})}var N=m.calculateAttachPoint(o,D);if(N){var u=N.point;return Y.attach=N.index,this._calcShiftByAddon(u.x-D.x,u.y-D.y)}}}(),Sr.prototype._gatherGridInfo=function(R){var P,U=this,Y=U._interactor,q=Y._getValidSelection();if(q.length){if(1===q.length){if(P=q[0],!P.getRect)return U._target=null,void 0}else if(P=vc.Group.findOrCreateGroup(q,Y._uuid),!P)return U._target=null,void 0}else{var q=Y.gv.sm().getSelection();if(q.length&&(P=q.get(0),!P.getRect))return U._target=null,void 0}if(P){var w=P.getPosition(),z=P.getRect();U._target={node:P,x:z.x-w.x,y:z.y-w.y,w:z.width,h:z.height,lp:{x:R.x,y:R.y},pos:{x:w.x,y:w.y},shiftGuide:{dir:"x",limit:0},downPosition:new vc.Math.Vector2(R)},Y.rectGuide.gatherRects()}},Sr.prototype.clear=function(){var v=this;v._edgeHostGuideInfo=null,v._interactor.rectGuide.clear(),v._interactor._42()},Sr.prototype._42=function(){var h=this._edgeHostGuideInfo;h&&this._interactor._drawHostGuide(h)};var Hh=b.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Hr=function(){function F(N,$){var x=p;return function(){return x||(x=N.getExtension($)),x}}function s(u,Y){Y==p&&(Y={}),Y.version=n&&(u instanceof WebGL2RenderingContext||b.prototype.toString.call(u)===E)?2:1,Y.extensions=function(){for(var A={},X=u.getSupportedExtensions(),h=X.length;h--;)A[name]=F(u,X[h]);return A}();for(var w=b.keys(Q),M=0,s=w.length;s>M;++M){var i=w[M];Y[i]=u.getParameter(Q[i])}if(Y.version>1){w=b.keys(g);for(var M=0,s=w.length;s>M;++M){var i=w[M];Y[i]=u.getParameter(g[i])}}return Y}var n="undefined"!=typeof WebGL2RenderingContext,E="[object WebGL2RenderingContext]",Q={aliasedLineWidthRange:Hh.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Hh.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Hh.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Hh.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Hh.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Hh.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Hh.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Hh.MAX_TEXTURE_SIZE,maxVaryingVectors:Hh.MAX_VARYING_VECTORS,maxVertexAttribs:Hh.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Hh.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Hh.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Hh.MAX_VIEWPORT_DIMS},g={max3DTextureSize:Hh.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Hh.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Hh.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Hh.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Hh.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Hh.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Hh.MAX_DRAW_BUFFERS,maxElementIndex:Hh.MAX_ELEMENT_INDEX,maxElementsIndices:Hh.MAX_ELEMENTS_INDICES,maxElementsVertices:Hh.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Hh.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Hh.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Hh.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Hh.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Hh.MAX_SAMPLES,maxTextureLODBias:Hh.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Hh.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Hh.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Hh.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Hh.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Hh.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Hh.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Hh.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Hh.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Hh.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Hh.MIN_PROGRAM_TEXEL_OFFSET};
return{"for":function(C){var t=C._info;return t||(C._info=t=s(C,t)),t}}}(),Hb=function(){function k(S,J,b){return{def:S,getter:b?function(g){var c=Hr.for(g);return c.version>1?g.getParameter(J):S}:function(T){return T.getParameter(J)},setter:b?function(Y,G){var Z=Hr.for(Y);Z.version>1&&Y.pixelStorei(J,G)}:function(n,b){n.pixelStorei(J,b)}}}function c(D){return"string"==typeof D?aq(D):D.r!==p?(e[0]=D.r,e[1]=D.g,e[2]=D.b,e[3]=D.a,e):D.red!==p?(e[0]=D.red,e[1]=D.green,e[2]=D.blue,e[3]=D.alpha,e):D}function f(J){return v(J)?Array.prototype.slice.call(J,0):J}function r(H,Z,z){this.gl=Z,this._record=z||{},this._branches={},this._leafSync={},this._struct=H;for(var M=H.children,d=M.length;d--;){var A=M[d],i=A.name;A.isLeaf?(this._leafSync[i]=!1,this._record[i]=f(A.desc.def)):this._record[i]={}}}function I(O){function w(L,F){r.call(this,O,L,F);for(var i=Q.length;i--;){var n=Q[i];this._branches[n._name]=new n._type(L,this._record[n._name])}}function g(g,t){function X(i,u){for(var Y=e,U=!1;Y--;)i[Y]!==u[Y]&&(i[Y]=u[Y],U=!0);return U}var w=g.name,T=v(g.desc.def),e=T&&g.desc.def.length;if(g.isLeaf){var y=g.desc.setter,K=g.desc.parse;b.defineProperty(t,w,{configurable:!1,enumerable:!0,get:function(){return this._record[w]},set:T?function(q){K&&(q=K(q)),(X(this._record[w],q)||!this._leafSync[w])&&(y(this.gl,this._record[w]),this._leafSync[w]=!0)}:function(B){this._record[w]===B&&this._leafSync[w]||(y(this.gl,B),this._record[w]=B,this._leafSync[w]=!0)}})}else Q.push({_name:w,_type:I(g)}),b.defineProperty(t,w,{configurable:!1,enumerable:!0,get:function(){return this._branches[w]},set:function(H){this._branches[w].apply(H)}})}var Q=[];return j(w,r),O.forEach(g,w.prototype),w}var e="undefined"!=typeof Float32Array&&new Float32Array(4),M={viewport:{def:[0,0,0/0,0/0],getter:function(h){return h.getParameter(h.VIEWPORT)},setter:function(B,$){var h=$[2]!==$[2]?B.drawingBufferWidth-$[0]:$[2],i=$[3]!==$[3]?B.drawingBufferHeight-$[1]:$[3];B.viewport($[0],$[1],h,i)}},dither:{def:!1,getter:function(q){return q.isEnabled(q.DITHER)},setter:function(x,o){o?x.enable(x.DITHER):x.disable(x.DITHER)}},rasterizerDiscard:{def:!1,getter:function(Q){var A=Hr.for(Q);return A.version>1&&Q.isEnabled(Q.RASTERIZER_DISCARD)},setter:function(S,Z){var v=Hr.for(S);1!==v.version&&(Z?S.enable(S.RASTERIZER_DISCARD):S.disable(S.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(N){return N.lineWidth?N.getParameter(N.LINE_WIDTH):1},setter:function(I,g){I.lineWidth&&I.lineWidth(g)}},color:{clear:{def:[0,0,0,0],getter:function(N){return N.getParameter(N.COLOR_CLEAR_VALUE)},setter:function(R,N){R.clearColor(N[0],N[1],N[2],N[3])},parse:c},mask:{def:[!0,!0,!0,!0],getter:function(M){return M.getParameter(M.COLOR_WRITEMASK)},setter:function(L,R){L.colorMask(R[0],R[1],R[2],R[3])}}},blend:{enabled:{def:!1,getter:function(A){return A.isEnabled(A.BLEND)},setter:function(K,s){s?K.enable(K.BLEND):K.disable(K.BLEND)}},color:{def:[0,0,0,0],getter:function(o){return o.getParameter(o.BLEND_COLOR)},setter:function(l,D){l.blendColor(D[0],D[1],D[2],D[3])},parse:c},equation:{def:[Hh.FUNC_ADD,Hh.FUNC_ADD],getter:function(p){return[p.getParameter(p.BLEND_EQUATION_RGB),p.getParameter(p.BLEND_EQUATION_ALPHA)]},setter:function(Z,I){Z.blendEquationSeparate(I[0],I[1])},parse:function(N){var B=N.length;return B>1?N:1===B?(e[1]=e[0]=N[0],e):(e[1]=e[0]=N,e)}},func:{def:[Hh.ONE,Hh.ZERO,Hh.ONE,Hh.ZERO],getter:function(i){return[i.getParameter(i.BLEND_SRC_RGB),i.getParameter(i.BLEND_DST_RGB),i.getParameter(i.BLEND_SRC_ALPHA),i.getParameter(i.BLEND_DST_ALPHA)]},setter:function(_,f){_.blendFuncSeparate(f[0],f[1],f[2],f[3])},parse:function(m){var U=m.length;return U>3?m:(e[2]=e[0]=m[0],e[3]=e[1]=m[1],e)}}},cullFace:{enabled:{def:!1,getter:function(y){return y.isEnabled(y.CULL_FACE)},setter:function(F,b){b?F.enable(F.CULL_FACE):F.disable(F.CULL_FACE)}},mode:{def:Hh.BACK,getter:function(G){return G.getParameter(G.CULL_FACE_MODE)},setter:function(p,F){p.cullFace(F)}},frontFace:{def:Hh.CCW,getter:function(t){return t.getParameter(t.FRONT_FACE)},setter:function(C,o){C.frontFace(o)}}},scissor:{enabled:{def:!1,getter:function(i){return i.isEnabled(i.SCISSOR_TEST)},setter:function(h,H){H?h.enable(h.SCISSOR_TEST):h.disable(h.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(B){return B.getParameter(B.SCISSOR_BOX)},setter:function(B,Z){var H=Z[2]!==Z[2]?B.drawingBufferWidth-Z[0]:Z[2],R=Z[3]!==Z[3]?B.drawingBufferHeight-Z[1]:Z[3];B.scissor(Z[0],Z[1],H,R)}}},depth:{enabled:{def:!1,getter:function(A){return A.isEnabled(A.DEPTH_TEST)},setter:function(E,t){t?E.enable(E.DEPTH_TEST):E.disable(E.DEPTH_TEST)}},clear:{def:1,getter:function(u){return u.getParameter(u.DEPTH_CLEAR_VALUE)},setter:function(U,i){U.clearDepth(i)}},mask:{def:!0,getter:function(K){return K.getParameter(K.DEPTH_WRITEMASK)},setter:function(I,b){I.depthMask(b)}},range:{def:[-1,1],getter:function(z){return z.getParameter(z.DEPTH_RANGE)},setter:function(E,K){E.depthRange(K[0],K[1])}},func:{def:Hh.LESS,getter:function(N){return N.getParameter(N.DEPTH_FUNC)},setter:function(s,w){s.depthFunc(w)}}},stencil:{enabled:{def:!1,getter:function(H){return H.isEnabled(H.STENCIL_TEST)},setter:function(R,d){d?R.enable(R.STENCIL_TEST):R.disable(R.STENCIL_TEST)}},clear:{def:0,getter:function(y){return y.getParameter(y.STENCIL_CLEAR_VALUE)},setter:function(C,F){C.clearStencil(F)}},frontMask:{def:255,getter:function(F){return F.getParameter(F.STENCIL_WRITEMASK)},setter:function($,t){$.stencilMaskSeparate($.FRONT,t)}},frontOp:{def:[Hh.KEEP,Hh.KEEP,Hh.KEEP],getter:function(R){return[R.getParameter(R.STENCIL_FAIL),R.getParameter(R.STENCIL_PASS_DEPTH_FAIL),R.getParameter(R.STENCIL_PASS_DEPTH_PASS)]},setter:function(X,g){X.stencilOpSeparate(X.FRONT,g[0],g[1],g[2])}},frontFunc:{def:[Hh.ALWAYS,0,255],getter:function($){return[$.getParameter($.STENCIL_FUNC),$.getParameter($.STENCIL_REF),$.getParameter($.STENCIL_VALUE_MASK)]},setter:function(p,Y){p.stencilFuncSeparate(p.FRONT,Y[0],Y[1],Y[2])}},backMask:{def:255,getter:function(K){return K.getParameter(K.STENCIL_BACK_WRITEMASK)},setter:function(i,O){i.stencilMaskSeparate(i.BACK,O)}},backOp:{def:[Hh.KEEP,Hh.KEEP,Hh.KEEP],getter:function(I){return[I.getParameter(I.STENCIL_BACK_FAIL),I.getParameter(I.STENCIL_BACK_PASS_DEPTH_FAIL),I.getParameter(I.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(R,h){R.stencilOpSeparate(R.BACK,h[0],h[1],h[2])}},backFunc:{def:[Hh.ALWAYS,0,255],getter:function(d){return[d.getParameter(d.STENCIL_BACK_FUNC),d.getParameter(d.STENCIL_BACK_REF),d.getParameter(d.STENCIL_BACK_VALUE_MASK)]},setter:function(R,D){R.stencilFuncSeparate(R.BACK,D[0],D[1],D[2])}}},hint:{generateMipmap:{def:Hh.DONT_CARE,getter:function(S){return S.getParameter(S.GENERATE_MIPMAP_HINT)},setter:function(x,B){x.hint(x.GENERATE_MIPMAP_HINT,B)}},fragmentShaderDerivative:{def:Hh.DONT_CARE,getter:function(o){var G=Hr.for(o);return 1!==G.version||G.extensions.OES_standard_derivatives?o.getParameter(Hh.FRAGMENT_SHADER_DERIVATIVE_HINT):Hh.DONT_CARE},setter:function(x,q){var Z=Hr.for(x);return Z.version>1||Z.extensions.OES_standard_derivatives?(x.hint(Hh.FRAGMENT_SHADER_DERIVATIVE_HINT,q),void 0):void 0}}},pixelStore:{packAlignment:k(4,Hh.PACK_ALIGNMENT,!1),unpackAlignment:k(4,Hh.UNPACK_ALIGNMENT,!1),unpackFlipY:k(!1,Hh.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:k(!1,Hh.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:k(Hh.BROWSER_DEFAULT_WEBGL,Hh.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:k(0,Hh.PACK_ROW_LENGTH,!0),packSkipPixels:k(0,Hh.PACK_SKIP_PIXELS,!0),packSkipRows:k(0,Hh.PACK_SKIP_ROWS,!0),unpackRowLength:k(0,Hh.UNPACK_ROW_LENGTH,!0),unpackImageHeight:k(0,Hh.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:k(0,Hh.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:k(0,Hh.UNPACK_SKIP_ROWS,!0),unpackSkipImages:k(0,Hh.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(F){return F.isEnabled(F.POLYGON_OFFSET_FILL)},setter:function(T,x){x?T.enable(T.POLYGON_OFFSET_FILL):T.disable(T.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(c){return[c.getParameter(c.POLYGON_OFFSET_FACTOR),c.getParameter(c.POLYGON_OFFSET_UNITS)]},setter:function(c,H){c.polygonOffset(H[0],H[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(c){return c.isEnabled(c.SAMPLE_COVERAGE)},setter:function(U,x){x?U.enable(U.SAMPLE_COVERAGE):U.disable(U.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(T){return T.isEnabled(T.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(x,i){i?x.enable(x.SAMPLE_ALPHA_TO_COVERAGE):x.disable(x.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(F){return[F.getParameter(F.SAMPLE_COVERAGE_VALUE),F.getParameter(F.SAMPLE_COVERAGE_INVERT)]},setter:function(k,m){k.sampleCoverage(m[0],m[1])}}}},w=Vd.create(M,function(h){return"def"in h});r.prototype.reset=function(){for(var R=this._struct.children,H=R.length;H--;){var o=R[H],e=o.name;o.isLeaf?this[e]=o.desc.def:this._branches[e].reset()}},r.prototype.save=function(d){d==p&&(d={});for(var I=this._struct.children,C=I.length;C--;){var S=I[C],z=S.name;if(S.isLeaf)d[z]=f(this._record[z]);else{var t=d[z];t==p&&(d[z]=t={}),this._branches[z].save(t)}}return d},r.prototype.sync=function(G,i){for(var w=this._struct.children,T=w.length;T--;){var c=w[T],n=c.name;c.isLeaf?(i||!this._leafSync[n])&&(G?(this._record[n]=c.desc.getter(this.gl),this._leafSync[n]=!0):(c.desc.setter(this.gl,this._record[n]),this._leafSync[n]=!0)):this._branches[n].sync(G,i)}},r.prototype.syncLoss=function(){for(var v=this._struct.children,y=v.length;y--;){var l=v[y];l.isLeaf?this._leafSync[l.name]=!1:this._branches[l.name].syncLoss()}},r.prototype.apply=function(w){for(var x=this._struct.children,t=x.length;t--;){var o=x[t],q=o.name;q in w&&(o.isLeaf?this[q]=w[q]:this._branches[q].apply(w[q]))}},r.prototype.append=function(q){var V=this._struct.childMap;for(var f in q){var n=V[f];n&&(n.isLeaf?this[f]=q[f]:this._branches[f].append(q[f]))}};var V=I(w);return function(f){var A=f._state;return A||(f._state=A=new V(f)),A}}(),Ke=function(){function L(N,j,W,o){if(N){var F=N.length;if(F!=p)for(var E=0;o>E;++E)j[W+E]=N[E];else N.toArray&&N.toArray(j,W)}else for(var E=0;o>E;++E)j[W+E]=0}function g(w,A,B){var U=w[0];if(0>=U||U>0)return w;var a=A*B,m=K[a];if(m==p&&(K[a]=m=new Float32Array(a)),0!==A){L(U,m,0,B);for(var W=1,I=0;W!==A;++W)I+=B,L(w[W],m,I,B)}return m}function c(q,U){q.uniform1f(this.addr,U)}function G(e,A){e.uniform1fv(this.addr,A)}function l(r,y){if(y.x!=p)r.uniform2f(this.addr,y.x,y.y);else{var h=K[2];h.set(y,0),r.uniform2fv(this.addr,h)}}function d(y,d){y.uniform2fv(this.addr,g(d,this.size,2))}function h(U,W){if(W.x!=p)U.uniform3f(this.addr,W.x,W.y,W.z);else if(W.r!=p)U.uniform3f(this.addr,W.r,W.g,W.b);else if(W.red!=p)U.uniform3f(this.addr,W.red,W.green,W.blue);else{var v=K[3];v.set(W,0),U.uniform3fv(this.addr,v)}}function J(C,o){C.uniform3fv(this.addr,g(o,this.size,3))}function M(X,Z){if("string"==typeof Z&&(Z=aq(Z)),Z.x!=p)X.uniform4f(this.addr,Z.x,Z.y,Z.z,Z.w);else if(Z.r!=p)X.uniform4f(this.addr,Z.r,Z.g,Z.b,Z.a);else if(Z.red!=p)X.uniform4f(this.addr,Z.red,Z.green,Z.blue,Z.alpha);else{var s=K[4];s.set(Z,0),X.uniform4fv(this.addr,s)}}function C(Q,i){Q.uniform4fv(this.addr,g(i,this.size,4))}function f(k,T){k.uniform1i(this.addr,T)}function x(s,t){s.uniform1iv(this.addr,t)}function B(N,s){N.uniform2iv(this.addr,s)}function X(d,S){d.uniform3iv(this.addr,S)}function T(m,d){m.uniform4iv(this.addr,d)}function H(m,J){m.uniform1i(this.addr,N[J?1:0])}function i(F,m){var s=K[4];s.set(m,0),F.uniformMatrix2fv(this.addr,!1,s)}function U(X,V){X.uniformMatrix2fv(this.addr,!1,g(V,this.size,4))}function z(B,q){var e=K[9];e.set(q,0),B.uniformMatrix3fv(this.addr,!1,e)}function e(h,G){h.uniformMatrix3fv(this.addr,!1,g(G,this.size,9))}function v(O,W){var $=K[16];$.set(W,0),O.uniformMatrix4fv(this.addr,!1,$)}function W(f,z){f.uniformMatrix4fv(this.addr,!1,g(z,this.size,16))}function s(_,j){_.uniform1i(this.addr,this.slots[0]),_.activeTexture(_.TEXTURE0+this.slots[0]),_.bindTexture(_.TEXTURE_2D,j||_._emptyTexture)}function n(s,n){s.uniform1iv(this.addr,this.slots);for(var A=this.slots.length;A--;)s.activeTexture(s.TEXTURE0+this.slots[A]),s.bindTexture(s.TEXTURE_2D,n[A]||s._emptyTexture)}function A(b,z){b.uniform1i(this.addr,this.slots[0]),b.activeTexture(b.TEXTURE0+this.slots[0]),b.bindTexture(b.TEXTURE_CUBE_MAP,z||b._emptyCubeTexture)}function w(y,c){y.uniform1iv(this.addr,this.slots);for(var X=this.slots.length;X--;)y.activeTexture(y.TEXTURE0+this.slots[X]),y.bindTexture(y.TEXTURE_CUBE_MAP,c[X]||y._emptyCubeTexture)}function a(T,V,w){o[T]=[V,w]}function $(L,b,B){switch(L.type){case 35678:case 35680:if("uSampler"===B)return[0];if("uBlendSampler"===B)return[1];for(var j=L.size,o=new Int32Array(j),N=0;j>N;++N)o[N]=b.usedTextureSlot++;return o}return p}function E(d,u,V,G,W){this.name=d,this.addr=u,this.size=G?V.size:0,this.activeInfo=V,this.setter=o[V.type][G?1:0],this.slots=$(V,W,d),tl(this)}function S(j,o,T,D){var x=j.name,I=x.length;for(u.lastIndex=0;;){var $=u.exec(x),m=u.lastIndex,C=$[1],R="]"===$[2],N=$[3];if(R&&(C=0|C),N===p||"["===N&&m+2===I){T[C]=new E(C,o,j,N!==p,D);break}var Q=T[C];Q==p&&(T[C]=Q={}),T=Q}}function F(X,V,c){this.gl=V,this._program=c,this._leaves={},this._branches={},this._struct=X}function q(n){function r(V,i){F.call(this,n,V,i);for(var I=T.length;I--;){var E=T[I];this._branches[E._name]=new E._type(V,i)}this.uuid=or.generateUUID()}function y(X,Z){var Q=X.name;if(X.isLeaf){var B=V("d.setter(this.gl, v);",["v"],["d"],[X.desc]);b.defineProperty(Z,Q,{configurable:!1,enumerable:!0,get:function(){return B},set:B})}else T.push({_name:Q,_type:q(X)}),b.defineProperty(Z,Q,{configurable:!1,enumerable:!0,get:function(){return this._branches[Q]},set:function($){this._branches[Q].apply($)}})}var T=[];return j(r,F),n.forEach(y,r.prototype),r}function k(x,W){for(var E=x.getProgramParameter(W,x.ACTIVE_UNIFORMS),v={},Y={usedTextureSlot:2};E--;){var m=x.getActiveUniform(W,E),M=m.name,R=x.getUniformLocation(W,M);S(m,R,v,Y)}var I=Vd.create(v,function(S){return"addr"in S}),B=q(I);return b.defineProperty(B.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:Y.usedTextureSlot}),new B(x,W)}var K=[];if("function"==typeof Float32Array)for(var Z=1;17>Z;++Z)K[Z]=new Float32Array(Z);var N=[0,1],o=[];a(Hh.FLOAT,c,G),a(Hh.FLOAT_VEC2,l,d),a(Hh.FLOAT_VEC3,h,J),a(Hh.FLOAT_VEC4,M,C),a(Hh.INT,f,x),a(Hh.INT_VEC2,B,B),a(Hh.INT_VEC3,X,X),a(Hh.INT_VEC4,T,T),a(Hh.BOOL,H,x),a(Hh.BOOL_VEC2,B,B),a(Hh.BOOL_VEC3,X,X),a(Hh.BOOL_VEC4,T,T),a(Hh.FLOAT_MAT2,i,U),a(Hh.FLOAT_MAT3,z,e),a(Hh.FLOAT_MAT4,v,W),a(Hh.SAMPLER_2D,s,n),a(Hh.SAMPLER_CUBE,A,w);var u=/([\w\d_]+)(\])?(\[|\.)?/g;return F.prototype.apply=function(V){for(var T=this._struct.children,Q=T.length;Q--;){var y=T[Q],P=y.name;P in V&&(y.isLeaf?this[P]=V[P]:this._branches[P].apply(V[P]))}},F.prototype.append=function(W){var A=this._struct.childMap;for(var j in W){var G=A[j];G&&(G.isLeaf?this[j]=W[j]:this._branches[j].append(W[j]))}},function(Y,n){var d=n._uniforms;return d||(n._uniforms=d=k(Y,n)),d}}(),Xn=function(){function w(s,T,l){T.vertexAttrib1f(s.addr,l)}function m(u,K,b){if(b.x!=p)K.vertexAttrib2f(u.addr,b.x,b.y);else{var $=D[2];$.set(b,0),K.vertexAttrib2fv(u.addr,$)}}function W(v,R,k){if(k.x!=p)R.vertexAttrib3f(v.addr,k.x,k.y,k.z);else if(k.r!=p)R.vertexAttrib3f(v.addr,k.r,k.g,k.b);else if(k.red!=p)R.vertexAttrib3f(v.addr,k.red,k.green,k.blue);else{var N=D[3];N.set(k,0),R.vertexAttrib3fv(v.addr,N)}}function N(T,X,i){if("string"==typeof i&&(i=aq(i)),i.x!=p)X.vertexAttrib4f(T.addr,i.x,i.y,i.z,i.w);else if(i.r!=p)X.vertexAttrib4f(T.addr,i.r,i.g,i.b,i.a);else if(i.red!=p)X.vertexAttrib4f(T.addr,i.red,i.green,i.blue,i.alpha);else{var d=D[4];d.set(i,0),X.vertexAttrib4fv(T.addr,d)}}function M(k,L,B){B=B.el||B;for(var q=0,T=0;2>q;++q)L.vertexAttrib2f(k.addr,B[T++],B[T++])}function x(S,x,B){B=B.el||B;for(var u=0,j=0;3>u;++u)x.vertexAttrib3f(S.addr,B[j++],B[j++],B[j++])}function g(u,A,j){j=j.el||j;for(var I=0,R=0;4>I;++I)A.vertexAttrib4f(u.addr,j[R++],j[R++],j[R++],j[R++])}function T(Q,D,L,X,q,Y,V){D.bindBuffer(D.ARRAY_BUFFER,L),D.vertexAttribPointer(Q.addr,1,X||D.FLOAT,!!q,Y||0,V||0),D.bindBuffer(D.ARRAY_BUFFER,null)}function E(U,j,N,P,h,u,n){j.bindBuffer(j.ARRAY_BUFFER,N),j.vertexAttribPointer(U.addr,2,P||j.FLOAT,!!h,u||0,n||0),j.bindBuffer(j.ARRAY_BUFFER,null)}function h(A,m,f,P,t,U,H){m.bindBuffer(m.ARRAY_BUFFER,f),m.vertexAttribPointer(A.addr,3,P||m.FLOAT,!!t,U||0,H||0),m.bindBuffer(m.ARRAY_BUFFER,null)}function H(A,p,m,y,U,r,B){p.bindBuffer(p.ARRAY_BUFFER,m),p.vertexAttribPointer(A.addr,4,y||p.FLOAT,!!U,r||0,B||0),p.bindBuffer(p.ARRAY_BUFFER,null)}function Z(K,E,S,W,I,h,i){var h=h||4,i=i||0;E.bindBuffer(E.ARRAY_BUFFER,S),E.vertexAttribPointer(K.addr,2,W||E.FLOAT,!!I,h,i),E.vertexAttribPointer(K.addr+1,2,W||E.FLOAT,!!I,h,i+2),E.bindBuffer(E.ARRAY_BUFFER,null)}function Y(f,w,x,M,X,u,N){var u=u||9,N=N||0;w.bindBuffer(w.ARRAY_BUFFER,x),w.vertexAttribPointer(f.addr,3,M||w.FLOAT,!!X,u,N),w.vertexAttribPointer(f.addr+1,3,M||w.FLOAT,!!X,u,N+3),w.vertexAttribPointer(f.addr+2,3,M||w.FLOAT,!!X,u,N+6),w.bindBuffer(w.ARRAY_BUFFER,null)}function F(J,D,Q,A,C,l,K){var l=l||16,K=K||0;D.bindBuffer(D.ARRAY_BUFFER,Q),D.vertexAttribPointer(J.addr,4,A||D.FLOAT,!!C,l,K),D.vertexAttribPointer(J.addr+1,4,A||D.FLOAT,!!C,l,K+4),D.vertexAttribPointer(J.addr+2,4,A||D.FLOAT,!!C,l,K+8),D.vertexAttribPointer(J.addr+3,4,A||D.FLOAT,!!C,l,K+12),D.bindBuffer(D.ARRAY_BUFFER,null)}function G(I,q,Y){S[I]=function(M,X,i,A,k,f){this.addr==p||this.addr<0||(X==p||X===!1?M.disableVertexAttribArray(this.addr):Dq(X)===C?(M.enableVertexAttribArray(this.addr),Y(this,M,X,i,A,k,f)):(M.disableVertexAttribArray(this.addr),q(this,M,X)))}}function k(u,q,a){this.name=u,this.addr=q,this.activeInfo=a,this.setter=S[a.type],tl(this)}function A(O,$,D){this.gl=$,this.program=D,this._branches={},this._struct=O}function t(v){function c(J,Q){A.call(this,v,J,Q);for(var m=u.length;m--;){var E=u[m];this._branches[E._name]=new E._type(J,Q)}}function M(s,_){var d=s.name;if(s.isLeaf){var z=V("d.setter(this.gl, v);",["v"],["d"],[s.desc]);b.defineProperty(_,d,{configurable:!1,enumerable:!0,get:function(){return z},set:z})}else u.push({_name:d,_type:t(s)}),b.defineProperty(_,d,{configurable:!1,enumerable:!0,get:function(){return this._branches[d]},set:function(U){this._branches[d].apply(U)}})}var u=[];return j(c,A),v.forEach(M,c.prototype),c}function y(I,h){for(var q=I.getProgramParameter(h,I.ACTIVE_ATTRIBUTES),D={};q--;){var P=I.getActiveAttrib(h,q),g=P.name,l=I.getAttribLocation(h,g);D[g]=new k(g,l,P)}var K=Vd.create(D,function(K){return"addr"in K}),s=t(K);return new s(I,h)}for(var D=[],r=1;17>r;++r)D[r]=new en(r);var S=[],C="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return G(Hh.FLOAT,w,T),G(Hh.FLOAT_VEC2,m,E),G(Hh.FLOAT_VEC3,W,h),G(Hh.FLOAT_VEC4,N,H),G(Hh.FLOAT_MAT2,M,Z),G(Hh.FLOAT_MAT3,x,Y),G(Hh.FLOAT_MAT4,g,F),A.prototype.disable=function(){for(var p=this._struct.children,m=p.length;m--;){var c=p[m],y=c.name;c.isLeaf?this.gl.disableVertexAttribArray(c.desc.addr):this._branches[y].disable()}},A.prototype.apply=function(l){for(var w=this._struct.children,U=w.length;U--;){var F=w[U],T=F.name;T in l&&(F.isLeaf?this[T]=l[T]:this._branches[T].apply(l[T]))}},A.prototype.append=function(l){var A=this._struct.childMap;for(var H in l){var a=A[H];a&&(a.isLeaf?this[H]=l[H]:this._branches[H].append(l[H]))}},function(U,l){var k=l._attribs;return k||(l._attribs=k=y(U,l)),k}}(),is=function(w){var s=this;b.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:w,writable:!1},glState:{configurable:!1,enumerable:!1,value:Hb(w),writable:!1}}),s._currProgram=p,s._currUniforms=p,s._currAttribs=p,s._sync=!0};b.defineProperties(is.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(Y){var N=this;N._sync&&Y===N._currProgram||(N.gl.useProgram(Y),N._currProgram=Y,N._currUniforms=Ke(N.gl,Y),N._currAttribs=Xn(N.gl,Y),N._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var b=this;return b._currProgram&&!b._sync&&(b.gl.useProgram(b._currProgram),b._sync=!0),b._currUniforms},set:function(g){var $=this;$._currUniforms&&($._currProgram&&!$._sync&&($.gl.useProgram($._currProgram),this._sync=!0),$._currUniforms.apply(g))}},attribs:{configurable:!1,enumerable:!1,get:function(){var e=this;return e._currProgram&&!e._sync&&(e.gl.useProgram(e._currProgram),e._sync=!0),e._currAttribs},set:function(b){var i=this;i._currUniforms&&(i._currProgram&&!i._sync&&(i.gl.useProgram(i._currProgram),this._sync=!0),i._currAttribs.apply(b))}}}),is.prototype.useProgram=function(I){var l=this;l._sync&&I===l._currProgram||(l.gl.useProgram(I),l._currProgram=I,l._currUniforms=Ke(l.gl,I),l._currAttribs=Xn(l.gl,I),l._sync=!0)},is.prototype.directState=function(){return this.glState},is.prototype.directUniforms=function(){return this._currUniforms},is.prototype.directAttribs=function(){return this._currAttribs},is.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},is.for=function(g){var V=g._renderState;return V||(g._renderState=V=new is(g)),V};var Ee="directional",vn="point",io="spot",Tg="light.color",gp=4294967295,rp={},$h=[],ci=0,tq=function($,m){tc(m)&&Jb.test(m)?yf($,m):Mj(m)&&m.modelType?Ze($,m):m===p?delete jr[$]:jr[$]=m},Ah=function(g){return g},De=function(s){s=E.convertShape3dModelName(s);var o;if(Mj(s)){if(s.modelType){if(s.uuid){if(o=jr[s.uuid])return o}else s.uuid=S.Math.generateUUID();return o===p&&(ni&&ni[s.uuid]||Ze(s.uuid,s)),p}return s}return o=jr[s],s&&o===p&&Jb.test(s)&&(ni&&ni[s]||yf(s,s)),o},hp=function(Q,w){Q.frameStack?Q.frameStack.push(w):Q.frameStack=[w],Q.bindFramebuffer(Q.FRAMEBUFFER,w)},eb=function(q){var Z=q.frameStack;if(Z){if(Z.pop(),Z.length)return q.bindFramebuffer(q.FRAMEBUFFER,Z[Z.length-1]),void 0;q.frameStack=null}q.bindFramebuffer(q.FRAMEBUFFER,null)};Vm(E,{graph3dViewAttributes:X,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:f/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Cl,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:f,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:f/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:tq,getShape3dModel:De,convertShape3dModelName:Ah,getShape3dModelMap:function(){return jr},getCachedShape3dModelMap:function(){return nq},createMatrix:function(s,d){Kc(s)||(s=[s]);for(var H=s.length-1;H>=0;H--){var V=s[H];d=Wo(V.mat,V.s3,V.r3,V.rotationMode,V.t3,d)}return d},transformVec:function(q,s){return $c(q,s)},glBindFrame:hp,glUnbindFrame:eb,createBoxModel:function(){return{vs:vo,ns:nm,uv:Db,is:Te}},createRoundRectModel:function(K,u){return Pj.roundRect(K,u)},createStarModel:function(k,a){return Pj.star(k,a)},createRectModel:function($,L){return Pj.rect($,L)},createTriangleModel:function(h,f){return Pj.triangle(h,f)},createRightTriangleModel:function(O,g){return Pj.rightTriangle(O,g)},createParallelogramModel:function(G,A){return Pj.parallelogram(G,A)},createTrapezoidModel:function(I,H){return Pj.trapezoid(I,H)},createSmoothSphereModel:function(n,H,W,V,t,r,I){return Jc(new cf(n,H,W,V,t,r,I))},createSphereModel:function(J,Z,P,X,D,W,F){return J?xm(J,Z,P,X,D,W,F):E.createSmoothSphereModel()},createSmoothConeModel:function(i,u,e,b,C){return hj(i,u,e,b,C)},createConeModel:function(D,W,T,d,Y,H,Z,r){return D?Kk(D,W,T,d,Y,H,Z,r):hj(H)},createSmoothCylinderModel:function(g,c,Z,r,e,N,k,R){return Jc(new Yc(g,c,Z,r,e,N,k,R))},createCylinderModel:function(O,C,J,c,o,w,F,g){return O?Zl(O,C,J,c,o,w,F,g):bb(w,F)},createSmoothTorusModel:function(x,Z,X,J,u,F){return Jc(new rs(x,Z,X,J,u,F))},createTorusModel:function(h,v,n,y,x,P,Y,$){return h?Cn(h,v,n,y,x,P,Y,$):Xo(P,Y)},createExtrusionModel:function(n,j,d,P,B,R,Q,a){return Dk(n,j,d,P,B,R,Q,a)},createSmoothRingModel:function(r,f,M,N,Z,B){for(var k=[],s=0;s<r.length-1;s+=2)k.push({x:r[s],y:r[s+1]});for(r=fl(k,f,M)[0],k=[],s=0;s<r.length;s++){var X=r[s];k.push(new Ph(X.x,0,X.y))}return Jc(new jp(k,B,N,Z))},createTextGeometry:function(C,x){return Jc(new Wn(C,x))},loadFontFace:function(M,I){E.xhrLoad(M,function(M){if(!M)return I();var y;try{y=JSON.parse(M)}catch(b){y=JSON.parse(M.substring(65,M.length-2))}dq.loadFace(y),I&&I(y.familyName.toLowerCase())},I?null:{sync:!0})},getShaderErrorLog:function(){return $h.join("\n")},createRingModel:function(R,r,A,s,F,k,$,H,N,L){for(var j=[],b=0;b<R.length-1;b+=2)j.push({x:R[b],y:R[b+1]});k=k||E.shapeSide,$=$||0,H=H||k;var Y,p,y,D,h,f,B,O,P,u,b,v,V,m,G,q,M,w,Z=[],W=[],z=N?[]:X,C=N?[]:X,U=L?[]:X,K=L?[]:X,I=s?[]:X,_=s?[]:X,g=F?[]:X,e=F?[]:X,R=fl(j,r,A),c=Kp(R),n=0,S=2*Math.PI/k;return R.forEach(function(R){if(y=R.length,y>1){if(D=R[0],s)for(f=D.x,O=D.y,b=$;H>b;b++)v=b+1,V=b*S,m=v*S,G=t(V),q=T(V),M=t(m),w=T(m),I.push(G*f,O,-q*f,M*f,O,-w*f,0,O,0),_.push(.5-.5*G,.5-.5*q,.5-.5*M,.5-.5*w,.5,.5);for(u=0;y>u;u++){for(h=R[u],f=D.x,B=h.x,O=D.y,P=h.y,Y=n/c,n+=Fb(D,h),p=n/c,b=$;H>b;b++)v=b+1,V=b*S,m=v*S,G=t(V),q=T(V),M=t(m),w=T(m),Z.push(G*B,P,-q*B,M*B,P,-w*B,G*f,O,-q*f,M*B,P,-w*B,M*f,O,-w*f,G*f,O,-q*f),W.push(b/k,p,v/k,p,b/k,Y,v/k,p,v/k,Y,b/k,Y),N&&b===$&&(z.push(0,O,0,0,P,0,G*B,P,-q*B,G*B,P,-q*B,G*f,O,-q*f,0,O,0),C.push(0,.5-O,0,.5-P,2*B,.5-P,2*B,.5-P,2*f,.5-O,0,.5-O)),L&&v===H&&(U.push(0,O,0,M*B,P,-w*B,0,P,0,M*B,P,-w*B,0,O,0,M*f,O,-w*f),K.push(1,.5-O,1-2*B,.5-P,1,.5-P,1-2*B,.5-P,1,.5-O,1-2*f,.5-O));D=h}if(F)for(f=D.x,O=D.y,b=$;H>b;b++)v=b+1,V=b*S,m=v*S,G=t(V),q=T(V),M=t(m),w=T(m),g.push(M*f,O,-w*f,G*f,O,-q*f,0,O,0),e.push(.5-.5*M,.5+.5*w,.5-.5*G,.5+.5*q,.5,.5)}}),{vs:Z,uv:W,bottom_vs:g,bottom_uv:e,top_vs:I,top_uv:_,from_vs:z,from_uv:C,to_vs:U,to_uv:K}}},!0),Vm(G,{"3d.move.mode":p,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":p,"edge.gradient.color":p,"edge.source.t3":p,"edge.target.t3":p,"light.type":vn,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":f/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":gp,"wf.visible":!1,"wf.width":1,"wf.color":$k,"wf.short":!1,"wf.mat":p,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:p,"transparent.mask":!1,brightness:p,"select.brightness":.7,"repeat.uv.length":p,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":p,"3d.clipbox.enabled":!0,"effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.mask":gp,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":p,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Vo,"label.t3":p,"label.r3":p,"label.texture.scale":2,"label.rotationMode":Ci,"label.light":!1,"label.blend":p,"label.reverse.flip":!1,"label.reverse.color":Go,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Vo,"label2.t3":p,"label2.r3":p,"label2.texture.scale":2,"label2.rotationMode":Ci,"label2.light":!1,"label2.blend":p,"label2.reverse.flip":!1,"label2.reverse.color":Go,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Vo,"note.t3":p,"note.r3":p,"note.texture.scale":2,"note.rotationMode":Ci,"note.light":!1,"note.blend":p,"note.reverse.flip":!1,"note.reverse.color":Go,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Vo,"note2.t3":p,"note2.r3":p,"note2.texture.scale":2,"note2.rotationMode":Ci,"note2.light":!1,"note2.blend":p,"note2.reverse.flip":!1,"note2.reverse.color":Go,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:p,"shape3d.color":Qd,"shape3d.top.color":p,"shape3d.bottom.color":p,"shape3d.from.color":p,"shape3d.to.color":p,"shape3d.image":p,"shape3d.image.projection":p,"shape3d.top.image":p,"shape3d.bottom.image":p,"shape3d.from.image":p,"shape3d.to.image":p,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":p,"shape3d.side.to":p,"shape3d.smooth":p,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":p,"shape3d.opacity":p,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Go,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":p,"shape3d.uv.scale":p,"shape3d.uv.rotation":p,"shape3d.top.uv.offset":p,"shape3d.top.uv.scale":p,"shape3d.top.uv.rotation":p,"shape3d.bottom.uv.offset":p,"shape3d.bottom.uv.scale":p,"shape3d.bottom.uv.rotation":p,"shape3d.from.uv.offset":p,"shape3d.from.uv.scale":p,"shape3d.from.uv.rotation":p,"shape3d.to.uv.offset":p,"shape3d.to.uv.scale":p,"shape3d.to.uv.rotation":p,"shape3d.top.cap":p,"shape3d.bottom.cap":p,"shape3d.start.angle":0,"shape3d.sweep.angle":$,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":p,"camera.ortho.width":p,"camera.near":p,"camera.far":p,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":p,"texture.filter":p,"texture.filter.min":p,"texture.filter.mag":p,"texture.wrap":p,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":Qd,"all.image":p,"all.blend":p,"all.opacity":p,"all.reverse.flip":!1,"all.reverse.color":Go,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":p,"all.uv.offset":p,"all.uv.scale":p,"all.uv.rotation":p,"all.discard.selectable":!0,mat:p,"left.mat":p,"right.mat":p,"top.mat":p,"bottom.mat":p,"front.mat":p,"back.mat":p,"edge.source.anchor.elevation":p,"edge.target.anchor.elevation":p},!0);var rb,Ok=!1,$b=[0,0,0,0],rh=function(F){return F instanceof uk},kk=function(v){return[v.x,v.e||0,v.y]},Jf=function(K,p,H){for(var p=aq(p||0),r=p[0],N=p[1],Z=p[2];H--;)K.push(r,N,Z)
},Fr=function(A,E,V){for(var E=aq(E||0),f=E[0],a=E[1],i=E[2],M=E[3];V--;)A.push(f,a,i,M)},cc=function(o,v,y){if(v)for(var f,O,k,g=v[0],N=v[1],e=v[2],J=v[4],T=v[5],E=v[6],G=v[8],x=v[9],$=v[10],c=v[12],D=v[13],A=v[14],S=y.length,B=0,B=0;S>B;B+=3)f=y[B],O=y[B+1],k=y[B+2],o.push(g*f+J*O+G*k+c,N*f+T*O+x*k+D,e*f+E*O+$*k+A);else nh(o,y)},sq=function(B,D,N){var a=D.s("light.intensity"),Y=aq(D.s(Tg)),y=Y[0],M=Y[1],b=Y[2];1!==a&&(y*=a,M*=a,b*=a);var H=D.s("light.disabled");B.push(y,M,b,H?1:0),N.c.push(y,M,b),N.g.push(H?-1:D.s("light.group")),N.e.push(H?1:0)},Pr=function(X,W){var A=is.for(W),Q=A.directUniforms(),E=X._lastLightUploadInfo={c:[],g:[],e:[]};Q.uHeadlightRange=X._headlightRange,Q.uHeadlightAmbientIntensity=X._headlightAmbientIntensity;var G=X._headlightIntensity,P=aq(X._headlightColor);1!==G&&(P=[P[0]*G,P[1]*G,P[2]*G]);var s;Q.uHeadlightColor=[P[0],P[1],P[2],(s=X._headlightDisabled)?1:0],E.c.push(P[0],P[1],P[2]),E.g.push(s?-1:X._headlightGroup),E.e.push(s?1:0);var a=X._59O,F=X._spots,n=X._dirs;if(a.length){var l=[],L=[],d=[];a.forEach(function(I){sq(l,I,E),nh(L,X._transformPointToViewSpace(I.p3())),d.push(I.s("light.range"))}),Q.uPointColor=l,Q.uPointRange=d,Q.uPointPosition=L}if(F.length){var m=[],Z=[],y=[],M=[],p=[],k=[];F.forEach(function(n){sq(m,n,E),nh(Z,X._transformPointToViewSpace(n.p3())),nh(p,X._transformDirectionToViewSpace(n.p3(),n.s("light.center"))),y.push(n.s("light.range")),M.push(t(n.s("light.angle")/2)),k.push(n.s("light.exponent"))}),Q.uSpotColor=m,Q.uSpotRange=y,Q.uSpotAngle=M,Q.uSpotExponent=k,Q.uSpotPosition=Z,Q.uSpotDirection=p}if(n.length){var V=[],I=[];n.forEach(function(m){sq(V,m,E),nh(I,X._transformDirectionToViewSpace(m.p3()))}),Q.uDirColor=V,Q.uDirDirection=I}X._lastLightMask=gp},dh=function(a,t,V){if(V!==a._lastLightMask){a._lastLightMask=V;var p=a._lastLightUploadInfo;if(p){var x,H,v,G=p.g,R=p.e,q=G.length,T=new Array(q),c=!1;for(H=0;q>H;H++)x=G[H],v=0>x||x>=32?1:V&1<<x?0:1,T[H]=v,v!==R[H]&&(c=!0);if(c){p.e=R=T;var S=p.c;t.uHeadlightColor=[S[0],S[1],S[2],R[0]];var z,u=a._59O,E=a._spots,A=a._dirs,W=3,P=1;if(q=u.length){for(H=0,z=[];q>H;H++)z.push(S[W++],S[W++],S[W++],R[P++]);t.uPointColor=z}if(q=E.length){for(H=0,z=[];q>H;H++)z.push(S[W++],S[W++],S[W++],R[P++]);t.uSpotColor=z}if(q=A.length){for(H=0,z=[];q>H;H++)z.push(S[W++],S[W++],S[W++],R[P++]);t.uDirColor=z}}}}},ag=function(M,A){return Math.max(M.getRotateMinPhi()+zk,Math.min(M.getRotateMaxPhi()-zk,A))},Si=function(){return.05+Zm()/2},pg=function(b,f,h,D){var W,j=b.getEye();return b.isOrtho()?(W=Fi(b.getCenter(),j),W[0]+=D[0],W[1]+=D[1],W[2]+=D[2]):W=j,no(f,h,D,W)},no=function(s,o,v,r){var J=gq(s,o),D=Fi(r,v,!0),R=gq(D,o);if(a(R)<zk)return X;var b=(J-gq(v,o))/R;return[v[0]+D[0]*b,v[1]+D[1]*b,v[2]+D[2]*b]},jd=function(k,L){return{x:2*k.x-L.x,y:2*k.y-L.y}},kb=function(u,c,e,D){var w,o;if(!u)return w=$g(c.y-e.y,e.x-c.x),{x:c.x+D*T(w),y:c.y+D*t(w)};if(!e)return w=$g(u.y-c.y,c.x-u.x),{x:c.x+D*T(w),y:c.y+D*t(w)};var a=Fi([u.x,u.y,0],[c.x,c.y,0],!0),O=Fi([e.x,e.y,0],[c.x,c.y,0],!0),H=-(a[0]+O[0])/2,x=-(a[1]+O[1])/2,s=B(H*H+x*x);if(zk>s)return w=$g(u.y-c.y,c.x-u.x),{x:c.x+D*T(w),y:c.y+D*t(w)};var M=u.x-c.x,Q=u.y-c.y,L=e.x-c.x,r=e.y-c.y,Y=B(M*M+Q*Q),i=B(L*L+r*r);w=z(gq(a,O))/2,o=a[1]*O[0]-a[0]*O[1]>0?-1:1,H/=s,x/=s;var S=D/T(w),U=P(Y,i)/t(w);s=Math.min(S,U);var m={x:c.x+o*s*H,y:c.y+o*s*x};return e.b&&S>i/t(w)&&(m.adjust=!0),m},ap=function(l){var e=l[1],c=l[2],I=l[3],m=l[6],g=l[7],M=l[11];l[1]=l[4],l[2]=l[8],l[3]=l[12],l[4]=e,l[6]=l[9],l[7]=l[13],l[8]=c,l[9]=m,l[11]=l[14],l[12]=I,l[13]=g,l[14]=M},tf=function(e){var b=e[0],Q=e[1],r=e[2],w=e[3],L=e[4],t=e[5],c=e[6],o=e[7],k=e[8],u=e[9],G=e[10],a=e[11],O=e[12],j=e[13],h=e[14],V=e[15],n=b*t-Q*L,C=b*c-r*L,g=b*o-w*L,v=Q*c-r*t,U=Q*o-w*t,i=r*o-w*c,P=k*j-u*O,m=k*h-G*O,I=k*V-a*O,A=u*h-G*j,E=u*V-a*j,d=G*V-a*h,_=n*d-C*E+g*A+v*I-U*m+i*P;return _?(_=1/_,e[0]=(t*d-c*E+o*A)*_,e[1]=(r*E-Q*d-w*A)*_,e[2]=(j*i-h*U+V*v)*_,e[3]=(G*U-u*i-a*v)*_,e[4]=(c*I-L*d-o*m)*_,e[5]=(b*d-r*I+w*m)*_,e[6]=(h*g-O*i-V*C)*_,e[7]=(k*i-G*g+a*C)*_,e[8]=(L*E-t*I+o*P)*_,e[9]=(Q*I-b*E-w*P)*_,e[10]=(O*U-j*g+V*n)*_,e[11]=(u*g-k*U-a*n)*_,e[12]=(t*m-L*A-c*P)*_,e[13]=(b*A-Q*m+r*P)*_,e[14]=(j*C-O*v-h*n)*_,e[15]=(k*v-u*C+G*n)*_,void 0):X},qq=function(B,g){if(g){var $=g[0],z=g[1],x=g[2];B[12]=B[0]*$+B[4]*z+B[8]*x+B[12],B[13]=B[1]*$+B[5]*z+B[9]*x+B[13],B[14]=B[2]*$+B[6]*z+B[10]*x+B[14],B[15]=B[3]*$+B[7]*z+B[11]*x+B[15]}},Em=function(m,s){if(s){var v=s[0],u=s[1],Q=s[2];m[0]=m[0]*v,m[1]=m[1]*v,m[2]=m[2]*v,m[3]=m[3]*v,m[4]=m[4]*u,m[5]=m[5]*u,m[6]=m[6]*u,m[7]=m[7]*u,m[8]=m[8]*Q,m[9]=m[9]*Q,m[10]=m[10]*Q,m[11]=m[11]*Q}},sm=function(Z,I,w){var f=I[0],i=I[1],R=I[2],p=I[3],H=I[4],Y=I[5],u=I[6],j=I[7],k=I[8],O=I[9],d=I[10],L=I[11],e=I[12],T=I[13],x=I[14],h=I[15],q=w[0],E=w[1],z=w[2],t=w[3];return Z[0]=q*f+E*H+z*k+t*e,Z[1]=q*i+E*Y+z*O+t*T,Z[2]=q*R+E*u+z*d+t*x,Z[3]=q*p+E*j+z*L+t*h,q=w[4],E=w[5],z=w[6],t=w[7],Z[4]=q*f+E*H+z*k+t*e,Z[5]=q*i+E*Y+z*O+t*T,Z[6]=q*R+E*u+z*d+t*x,Z[7]=q*p+E*j+z*L+t*h,q=w[8],E=w[9],z=w[10],t=w[11],Z[8]=q*f+E*H+z*k+t*e,Z[9]=q*i+E*Y+z*O+t*T,Z[10]=q*R+E*u+z*d+t*x,Z[11]=q*p+E*j+z*L+t*h,q=w[12],E=w[13],z=w[14],t=w[15],Z[12]=q*f+E*H+z*k+t*e,Z[13]=q*i+E*Y+z*O+t*T,Z[14]=q*R+E*u+z*d+t*x,Z[15]=q*p+E*j+z*L+t*h,Z},kh=function(z,q,O,J){var G,Q,_,u,U,p,X,t,m,x,K=q[0],j=q[1],e=q[2],s=J[0],l=J[1],R=J[2],P=O[0],T=O[1],o=O[2];return a(K-P)<zk&&a(j-T)<zk&&a(e-o)<zk?bf(z):(X=K-P,t=j-T,m=e-o,x=1/B(X*X+t*t+m*m),X*=x,t*=x,m*=x,G=l*m-R*t,Q=R*X-s*m,_=s*t-l*X,x=B(G*G+Q*Q+_*_),x?(x=1/x,G*=x,Q*=x,_*=x):(G=0,Q=0,_=0),u=t*_-m*Q,U=m*G-X*_,p=X*Q-t*G,x=B(u*u+U*U+p*p),x?(x=1/x,u*=x,U*=x,p*=x):(u=0,U=0,p=0),z[0]=G,z[1]=u,z[2]=X,z[3]=0,z[4]=Q,z[5]=U,z[6]=t,z[7]=0,z[8]=_,z[9]=p,z[10]=m,z[11]=0,z[12]=-(G*K+Q*j+_*e),z[13]=-(u*K+U*j+p*e),z[14]=-(X*K+t*j+m*e),z[15]=1,z)},Nb=function(X,H,u,y,E){var l=1/Bl(H/2),_=1/(y-E);return X[0]=l/u,X[1]=0,X[2]=0,X[3]=0,X[4]=0,X[5]=l,X[6]=0,X[7]=0,X[8]=0,X[9]=0,X[10]=(E+y)*_,X[11]=-1,X[12]=0,X[13]=0,X[14]=2*E*y*_,X[15]=0,X},rl=function(m,J,z,F,e,S,N){var h=1/(J-z),u=1/(F-e),o=1/(S-N);return m[0]=-2*h,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=-2*u,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2*o,m[11]=0,m[12]=(J+z)*h,m[13]=(e+F)*u,m[14]=(N+S)*o,m[15]=1,m},Bo=function(g,K){var L=K[0],O=K[1],A=K[2],C=K[3],z=L*L+O*O+A*A+C*C,b=z?1/z:0;return g[0]=-L*b,g[1]=-O*b,g[2]=-A*b,g[3]=C*b,g},Pp=function(q,w){var O=w[0]+w[5]+w[10],u=0;return O>0?(u=2*Math.sqrt(O+1),q[3]=.25*u,q[0]=(w[6]-w[9])/u,q[1]=(w[8]-w[2])/u,q[2]=(w[1]-w[4])/u):w[0]>w[5]&w[0]>w[10]?(u=2*Math.sqrt(1+w[0]-w[5]-w[10]),q[3]=(w[6]-w[9])/u,q[0]=.25*u,q[1]=(w[1]+w[4])/u,q[2]=(w[8]+w[2])/u):w[5]>w[10]?(u=2*Math.sqrt(1+w[5]-w[0]-w[10]),q[3]=(w[8]-w[2])/u,q[0]=(w[1]+w[4])/u,q[1]=.25*u,q[2]=(w[6]+w[9])/u):(u=2*Math.sqrt(1+w[10]-w[0]-w[5]),q[3]=(w[1]-w[4])/u,q[0]=(w[8]+w[2])/u,q[1]=(w[6]+w[9])/u,q[2]=.25*u),q},Ed=function(N,v,K){var S=v[0],q=v[1],R=v[2],A=v[3],c=S+S,r=q+q,Y=R+R,W=S*c,B=S*r,b=S*Y,Q=q*r,D=q*Y,_=R*Y,J=A*c,V=A*r,y=A*Y;return N[0]=1-(Q+_),N[1]=B+y,N[2]=b-V,N[3]=0,N[4]=B-y,N[5]=1-(W+_),N[6]=D+J,N[7]=0,N[8]=b+V,N[9]=D-J,N[10]=1-(W+Q),N[11]=0,N[12]=K[0],N[13]=K[1],N[14]=K[2],N[15]=1,N},Me=function(X,s){if(X.isVREnabled()){var c=X.vr.getViewMatrix(s);if(c)return c}return X._camera?X._camera.getViewMatrix(s):kh(s?s:df(),X._eye,X._center,X._up)},ip=function(X,x){if(X.isVREnabled()){var G=X.vr.getProjectMatrix();if(G)return G}if(X._camera)return X._camera.getProjectMatrix();if(!x&&X._computedProjectMatrix)return le(X._computedProjectMatrix);var A=X.getAspect(),R=X._near,S=X._far,P=df();if(X._ortho){var U=X._orthoWidth/2,o=U/A;rl(P,-U,U,-o,o,R,S)}else Nb(P,X._fovy,A,R,S);return P},ls=function(V,Y){if(!V)return X;var H=0,v=1,l=2,$=[],a=0,G=V.length,D=G/3;if(Y){for(;G>a;a++)$[a]=0;for(a=0;a<Y.length;a+=3){var M=[],L=[],R=[];M[H]=V[3*Y[a+1]+H]-V[3*Y[a]+H],M[v]=V[3*Y[a+1]+v]-V[3*Y[a]+v],M[l]=V[3*Y[a+1]+l]-V[3*Y[a]+l],L[H]=V[3*Y[a+2]+H]-V[3*Y[a+1]+H],L[v]=V[3*Y[a+2]+v]-V[3*Y[a+1]+v],L[l]=V[3*Y[a+2]+l]-V[3*Y[a+1]+l],R[H]=M[v]*L[l]-M[l]*L[v],R[v]=M[l]*L[H]-M[H]*L[l],R[l]=M[H]*L[v]-M[v]*L[H];for(var g=0;3>g;g++)$[3*Y[a+g]+H]+=R[H],$[3*Y[a+g]+v]+=R[v],$[3*Y[a+g]+l]+=R[l]}}else for(a=0;D>a;a+=3){var M=[],L=[],R=[];M[H]=V[3*(a+1)+H]-V[3*a+H],M[v]=V[3*(a+1)+v]-V[3*a+v],M[l]=V[3*(a+1)+l]-V[3*a+l],L[H]=V[3*(a+2)+H]-V[3*(a+1)+H],L[v]=V[3*(a+2)+v]-V[3*(a+1)+v],L[l]=V[3*(a+2)+l]-V[3*(a+1)+l],R[H]=M[v]*L[l]-M[l]*L[v],R[v]=M[l]*L[H]-M[H]*L[l],R[l]=M[H]*L[v]-M[v]*L[H];for(var g=0;3>g;g++)$[3*(a+g)+H]=R[H],$[3*(a+g)+v]=R[v],$[3*(a+g)+l]=R[l]}for(a=0;G>a;a+=3){var K=[];K[H]=$[a+H],K[v]=$[a+v],K[l]=$[a+l];var P=B(K[H]*K[H]+K[v]*K[v]+K[l]*K[l]);0===P&&(P=zk),K[H]=K[H]/P,K[v]=K[v]/P,K[l]=K[l]/P,$[a+H]=K[H],$[a+v]=K[v],$[a+l]=K[l]}return new en($)},gm=function(b,i,f,c){if(f||(f=b.createTexture()),i){var z=b.TEXTURE_2D,m=b.REPEAT,I=b.CLAMP_TO_EDGE,A=b.TEXTURE_MIN_FILTER;c=c||Xr;var w=c.minFilter||c.filter||b.LINEAR,_=c.magFilter||c.filter||b.LINEAR;b.activeTexture(b.TEXTURE0),Sb(b,f),b.texImage2D(z,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,i),Lg(b,b.TEXTURE_MAG_FILTER,_);var t=i.naturalWidth||i.width,x=i.naturalHeight||i.height;or.isPOT(t)&&or.isPOT(x)&&!c.clampToEdge&&!i.clampToEdge?(Lg(b,b.TEXTURE_WRAP_S,m),Lg(b,b.TEXTURE_WRAP_T,m),Lg(b,A,w===b.NEAREST?b.NEAREST_MIPMAP_NEAREST:b.LINEAR_MIPMAP_LINEAR),c.mipmapMaxLevel!==p&&Lg(b,b.TEXTURE_MAX_LEVEL,c.mipmapMaxLevel),b.generateMipmap(z)):(Lg(b,b.TEXTURE_WRAP_S,I),Lg(b,b.TEXTURE_WRAP_T,I),Lg(b,A,w)),Sb(b,X)}return f},Bb=function(_,G){var j=new Uint8Array(4);return G=G||_.createTexture(),_.activeTexture(_.TEXTURE0),Sb(_,G),Lg(_,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,j),G},tp=function(k,z){var w=new Uint8Array(4);return z=z||k.createTexture(),k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,z),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MAG_FILTER,k.LINEAR),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MIN_FILTER,k.LINEAR),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,w),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,w),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,w),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,w),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,w),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,w),z},Vf=function(W){W._26I&&W._prg&&(W._26I.deleteProgram(W._prg),W._prg=X)},oi=function(D,a,M,h){var y=D.createShader(M);return D.shaderSource(y,h),D.compileShader(y),D.attachShader(a,y),y},Wp=function(W){return W.createBuffer()},Sb=function(m,H){m.bindTexture(m.TEXTURE_2D,H||m._emptyTexture)},Lg=function(s,P,N){s.texParameteri(s.TEXTURE_2D,P,N)},Dn=function(c,f){var d=is.for(c).directState();d.polygonOffset.enabled=!0,d.polygonOffset.value=f},Dm=function(E){var L=is.for(E).directState();L.polygonOffset.enabled=!1},ih=function(x,C){if(C){var M=is.for(x).directState();M.color.clear=aq(C)}},wn=function(j){var M=is.for(j),G=M.directUniforms(),$=M.directAttribs();G.uFix=!0,$.aNormal=!1},$l=function(y){var K=is.for(y),H=K.directUniforms();K.directAttribs(),H.uFix=!1},vm=function(i,j,d,p,$,R,H,y){var z=is.for(i),l=z.directState(),U=z.directUniforms();i._picking||(d?(U.uBlend=!0,U.uBlendColor=d):U.uBlend=!1,U.uLight=p==X?!0:p,po($)&&1!==$&&(U.uPartOpacity=$),U.uReverseFlip=R==X?!1:R,U.uFixPickReverseColor=H||Go),l.cullFace.enabled=y?!0:!1},Ii=function(Z){if(!Z._picking){var K=is.for(Z),r=K.directUniforms();r.uPartOpacity=1}},Wm=function(){var x=new S.Math.Matrix2d,j=[1,0,0,0,1,0,0,0,0];return function(K,S,c,I,g,B,_,F,E,Q){var D=is.for(K),U=D.directUniforms(),h=D.directAttribs();return c?(U.uTexture=!0,U.uDiscardSelectable=Pk(I)?I:!0,h.aUv=jj(K,g,B,X,2),Q?(U.uBlendTexture=!0,U.uBlendSampler=Q):(U.uBlendTexture=!1,U.uBlendSampler=K._emptyBlendTexture),U.uSampler=c,U.uUvMatrix=_||F||E?Nn(E,_,F,x).toArray9():j,void 0):(U.uSampler=K._emptyTexture,U.uBlendSampler=K._emptyBlendTexture,void 0)}}(),Ck=function(J,H,M){var s=is.for(J),D=s.directUniforms(),R=s.directAttribs();J.activeTexture(J.TEXTURE0),Sb(J,X),J.activeTexture(J.TEXTURE1),Sb(J,X),M&&(R.aUv=!1,D.uTexture=!1,D.uSampler=J._emptyTexture,D.uBlendTexture=!1,D.uBlendSampler=J._emptyBlendTexture)},Ic=function(e,R,D,S,$,l){var g=is.for(e),n=g.directUniforms(),J=g.directAttribs();!D||Ao||qm||e.lineWidth(D),S&&!e._picking&&(n.uFixPickReverseColor=S),$&&(J.aPosition=jj(e,$,l,X))},Kl=function(U,b,r,Q){rb&&(Q=U[rb]),U.drawArrays(Q==X?U.TRIANGLES:Q,b,r);var g=U._renderInfo;g&&(g.calls++,g.vertices+=r,(Q==X||Q===U.TRIANGLES)&&(g.faces+=r/3),Q===U.LINES&&(g.lines+=r/2),Q===U.POINTS&&(g.points+=r))},Ri=function(A,C,j,O,K){rb&&(O=A[rb]),A.drawElements(O==X?A.TRIANGLES:O,j,K==X?A.UNSIGNED_SHORT:K,C==X?0:2*C);var D=A._renderInfo;D&&(D.calls++,D.vertices+=j,(O==X||O===A.TRIANGLES)&&(D.faces+=j/3),O===A.LINES&&(D.lines+=j/2),O===A.POINTS&&(D.points+=j))},Xm=function(a,p,u){var O=a.ARRAY_BUFFER;return a.bindBuffer(O,p),u&&a.bufferData(O,u,a.STATIC_DRAW),p},jj=function(N,t,Z,M,s){return Z?Nc(N,N.ARRAY_BUFFER,t,Z):Xm(N,t,Z,M,s)},pb=function(K,T,j){var i=K.ELEMENT_ARRAY_BUFFER;K.bindBuffer(i,T),j&&K.bufferData(i,j,K.STATIC_DRAW)},nb=function(v,K,C){Nc(v,v.ELEMENT_ARRAY_BUFFER,K,C)},Nc=function(z,a,g,d){var Q=d._bufId;Q||(Q=d._bufId=S.Math.generateIncreasingID());var g,f=z._bufPool;return(g=f[Q])&&g._buf?z.bindBuffer(a,g._buf):(g=f[Q]={_buf:Wp(z)},z.bindBuffer(a,g._buf),z.bufferData(a,d,z.STATIC_DRAW)),g._fid=z._renderInfo.frame,g._buf},Rf=function(x,d){d!=X&&d>=0&&x.enableVertexAttribArray(d)},Fj=function(I,P){P!=X&&P>=0&&I.disableVertexAttribArray(P)},hd=function(A,i){var j=A.getGL(),r=is.for(j),c=r.directUniforms();A._7O=A._8O.pop(),i&&(c.uMVMatrix=A._7O,A._6O=i,c.uNMatrix=i)},Ak=function(J,b){return b||(b=df()),eo(b,J),tf(b),ap(b),b},nn=function(h,C){var p=h.getGL(),b=h._7O,t=is.for(p),x=t.directUniforms();C?(h._8O.push(le(b)),x.uMMatrix=C,sm(b,b,C),h._7O=b):x.uMMatrix=Jq,x.uMVMatrix=b,x.uNMatrix=Ak(b,h._6O)},yo={body:0,label:1,label2:2,note:3,note2:4,symbol:5},_l=10,dl=function(f,q,z,P,w,v){var Y;if(z){var G=P._pickId;G||(G=P._pickId=q._pickIdUsed,q._pickIdUsed+=_l);var X,V=yo[w];if(null!=V)X=G+V;else{var a=P._pickExtraPartMap;a||(a=P._pickExtraPartMap={}),(X=a[w])||(X=a[w]=q._pickIdUsed++)}q[X]||(q[X]={data:P,part:w}),Y=sd(X)}else Y=$b;if(!v){var A=is.for(f),g=A.directUniforms();g.uFixPickReverseColor=Y}return Y},up=dl,ep=function(D,j,S){"target"!==S&&(S="source");var G="target"===S?j.getTargetAgent():j.getSourceAgent(),o="edge."+S+".";if(mo(G)){var c=j.s(o+"anchor.x"),L=j.s(o+"anchor.elevation"),d=j.s(o+"anchor.y"),h=ec(G,D.getMat(G)),Y=G.getAnchor3d();return $c([(c===p?.5:c)-Y.x,(L===p?.5:L)-Y.y,(d===p?.5:d)-Y.z],h)}var i=j.s(o+"index"),R=D.getData3dUI(G);if(!R.info||!R.info.list)return!1;if(i>=0){var g,X,k,$,C,s=R.info._lastPointsSegments,A=s.points,l=s.segments,x=-1,v=-1;for(k=0,$=l?l.length:A.length;$>k;k++){if(X=l?l.get(k):1,3===X)C=2;else if(4===X)C=3;else{if(5===X)continue;C=1}if(x+=C,v++,v===i){g=A.get(x);break}}return g||(g=A.get(A.length-1)),[g.x,g.e||0,g.y]}var e=j.s(o+"percent")||.5;if(e=Math.max(0,Math.min(e,1)),!R||!R.getCache)return!1;var T=R.getCache(),$=T[T.length-1].length,s=D.getLineOffset(G,e*$),w=s.point;return[w.x,w.y,w.z]},Ap=function(){var q={center:function(T,Q,B,M,J){var y=-Q[1]/2,I={x:-Q[0]/2,y:y,width:Q[0],height:Q[1]},D=sc(T,I,B);return[D.x+M,-D.y-J,Si()]},front:function(q,M,B,e,g){var p=-M[1]/2,V={x:-M[0]/2,y:p,width:M[0],height:M[1]},Q=sc(q,V,B);return[Q.x+e,-Q.y-g,M[2]/2+Si()]},back:function(T,M,i,Y,C){var v=-M[0]/2,W=-M[1]/2,K={x:v,y:W,width:M[0],height:M[1]},g=sc(T,K,i);return[-g.x-Y,-g.y-C,-M[2]/2-Si()]},left:function(C,L,V,N,W){var J=-L[1]/2,Q={x:-L[2]/2,y:J,width:L[2],height:L[1]},s=sc(C,Q,V);return[-L[0]/2-Si(),-s.y-W,s.x+N]},right:function(z,P,o,F,W){var i=-P[2]/2,t=-P[1]/2,y={x:i,y:t,width:P[2],height:P[1]},C=sc(z,y,o);return[P[0]/2+Si(),-C.y-W,-C.x-F]},top:function(c,n,k,Q,i){var V={x:-n[0]/2,y:-n[2]/2,width:n[0],height:n[2]},p=sc(c,V,k);return[p.x+Q,n[1]/2+Si(),p.y+i]},bottom:function(k,D,M,b,h){var c=-D[2]/2,x={x:-D[0]/2,y:c,width:D[0],height:D[2]},w=sc(k,x,M);return[w.x+b,-D[1]/2-Si(),-w.y-h]}};return function(R,I,$,E,Y,x){return q[E](R,I,$,Y||0,x||0)}}(),Wl=function(_,I,e,b,l,O,z,i,v,d){if(l&&(I[0]+=l[0],I[1]+=l[1],I[2]+=l[2]),qq(_,e),i){var K=df();if(Br(K,v,d),$c(I,K),qq(_,I),_.auto=i,_.pos=$c([0,0,0],_),O){var q=_.mat2=df();Br(q,O,z)}}else Br(_,v,d),qq(_,I),b===cq?fg(_,-fs):b===Jo?fg(_,fs):b===yb?ce(_,-fs):b===jc?ce(_,fs):b===ii&&fg(_,f),Br(_,O,z);return _},bo=function(N,C){var d=C.auto,g=C.mat2,U=N.gv;if(d){var Z,w=df(),o=[0,0,0,0];Z="string"==typeof d?[d.indexOf("x")<0?U._eye[0]:U._center[0],d.indexOf("y")<0?U._eye[1]:U._center[1],d.indexOf("z")<0?U._eye[2]:U._center[2]]:U._eye,Pp(o,kh(df(),Z,U._center,U._up)),Ed(w,Bo(o,o),C.pos),g&&sm(w,w,g),nn(U,w)}else nn(U,C)},op=function(k,R,s,P,U){var q=k.s,t=k.gv,O=t.getGL(),F=t._prg,L=t._buffer,z=t._1O,T=is.for(O),u=T.directAttribs();gm(O,ts,z),bo(k,s),vm(O,F,q(R+".blend"),q(R+".light"),q(R+".opacity"),q(R+".reverse.flip"),q(R+".reverse.color"),q(R+".reverse.cull")),Wm(O,F,z,U,L.uv,nc),u.aPosition=jj(O,L.vs,P,X),u.aNormal=jj(O,L.ns,uc,X),nb(O,L.is,xi),Ri(O,0,xi.length),Ck(O,F,z),Ii(O,F),hd(t)},Bp=function(u,Y,H){var o=u.gv,D=u.data,k=u[Y]={blend:o.getBodyColor(D)||o.getFaceBlend(D,Y),light:o.getFaceLight(D,Y),color:o.getFaceColor(D,Y),opacity:o.getFaceOpacity(D,Y),transparent:o.getFaceTransparent(D,Y),reverseFlip:o.getFaceReverseFlip(D,Y),reverseColor:o.getFaceReverseColor(D,Y),reverseCull:o.getFaceReverseCull(D,Y),texture:o.getFaceImage(D,Y),blendTexture:o.getFaceBlendImage(D,Y),discardSelectable:o.getFaceDiscardSelectable(D,Y)};if("csg"!==Y){k.uv=o.getFaceUv(D,Y)||H&&H[Y+"Uv"],k.uvScale=o.getFaceUvScale(D,Y)||H&&H[Y+"UvScale"],k.uvOffset=o.getFaceUvOffset(D,Y)||H&&H[Y+"UvOffset"],k.uvRotation=o.getFaceUvRotation(D,Y)||H&&H[Y+"uvRotation"];var L=o.getFaceMat(D,Y);if(L){var h=ec(D,L);D.appendAnchorMatrix3d(h),k.mat=h}}return k},fo=function(i,E,p,Q,x){var o=i[Q];if(o){if(!x(o.transparent))return;var N=i.data,m=i.gv,j=m._buffer,C=m.getTexture(o.texture,N,Q),H=m.getTexture(o.blendTexture,N),M=is.for(E),Z=M.directUniforms(),$=M.directAttribs();Wm(E,p,C,o.discardSelectable,j.uv,o.tuv,o.uvOffset,o.uvScale,o.uvRotation,H),vm(E,p,o.blend,o.light,o.opacity,o.reverseFlip,o.reverseColor,o.reverseCull),o.cs&&!m._batchColorDisabled?(Z.uBatchColor=!0,$.aBatchColor=jj(E,j.batchColor,o.cs,p.aBatchColor,4)):Z.uDiffuse=o.color||G["color.empty"],$.aPosition=jj(E,j.vs,o.vs,X),$.aNormal=jj(E,j.ns,o.ns,X),Kl(E,0,o.vs.length/3),o.cs&&!m._batchColorDisabled&&(Z.uBatchColor=!1,Fj(E,p.aBatchColor)),Ii(E,p),Ck(E,p,C)}},gn=function(X,N,T){Kc(X)?X.forEach(function(H){gn(H,N,T)}):tc(X)?gn(Lh(N,X),N,T):Mj(X)?X.shape3d?gn(X.shape3d,N,T):T.push(X):T.push(X)},mg=function(){for(var B=50,R=arguments.length,c=[],u=0;R>u;u++)c[u]=arguments[u];$h[ci]="Time : "+(new Date).toLocaleString()+", Info :"+c.join(", "),ci=(ci+1)%B,console.error("Failed to create shader.")},Nn=function(){var e=new or.Matrix2d;return function(l,X,b,$){$||($=e);var J,s,M,K;return X?(J=X[0],s=X[1]):J=s=0,b?(M=b[0],K=b[1]):M=K=1,$.setFromTransform(l||0,J,s,M,K)}}(),Yb=function(l,B,t,z,Q,X){var r,Z,d,p,R,k,b,s,J,v,f,G=[z-B,Q-t],I=l?l.length:0;for(d=0;I>d;d++){for(p=2,r=l[d],R=r[0],k=r[1];p+1<r.length;){if(b=r[p],s=r[p+1],Z=Tb(B,t,z,Q,R,k,b,s,!0)){J=[b-R,s-k],v=Fb(J),J[0]/=v,J[1]/=v,v=gq(G,J),v=v>0?X:-X,f=[J[0]*v,J[1]*v];break}R=b,k=s,p+=2}if(f)break}if(f)for(z=B+f[0],Q=t+f[1],d=0;I>d;d++)for(p=2,r=l[d],R=r[0],k=r[1];p+1<r.length;){if(b=r[p],s=r[p+1],Z=Tb(B,t,z,Q,R,k,b,s,!0))return[0,0];R=b,k=s,p+=2}return f?f:[z-B,Q-t]},yd=function(f){return"nearest"===f?Hh.NEAREST:"linear"===f?Hh.LINEAR:f},Gq=S.graph3d={WebGLConstants:Hh},de=function(F,$,Y){Wi(K+".graph3d."+F,$,Y)},gf="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg<{zy/**1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg<mbdpMwVxpmg!4dfw1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!gjeof$!|*ldjQva!%%!yjGva)gj!1!>>!SFQQJMD`YPC`YBN!gj$!<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Ng="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~<chs/*^j]wVxpmg!-^j]fsvuyfUxpmg)E3fsvuyfu!!>,!chs/eJ!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj!gjeof$!~~~!<osvufs!<esbdtje!|!****ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv)!gj<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1>j!uoj)spg<mbdpMw!4dfw|!*qjmDypCfmcboFv)!gj!1!?!SFQQJMD`YPC`YBN!gj$!~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!!gjeof$!!~~<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw|!ftmf!~<*1/2!-1spmpd)5dfw!osvufs|!*1/1!>>!Gqjn)!gj<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw<*qjn)sppmg!>!uoJqjn!ubpmg<*qjn)udbsg!>!Gqjn!ubpmg<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~<qjn!osvufs~<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn|!ftmf!~<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn|!*7s!>?!ttfoihvps)!gj!ftmf!~<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn|!*6s!>?!ttfoihvps)!gj!ftmf!~<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn|!*5s!>?!ttfoihvps)!gj!ftmf!~<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn|!*2s!>?!ttfoihvps)!gj<1/1!>!qjn!ubpmg|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~<*z/g!-nc!-nu)yjn!osvufs<*y/g!-sc!-mc)yjn!>!nc!4dfw<*y/g!-su!-mu)yjn!>!nu!4dfw<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw<f{jTmfyfu!>.!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw<f{jTmfyfu!>,!z/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw<f{jTmfyfu!>,!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw<f{jTmfyfu!>+!wv<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv~<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj<f{jTfdbg!+!fdbg!>,!y/wv~<1/4!>.!fdbg<f{jTfdbg!>,!z/wv|!*1/3!?!fdbg)!gj<g!.!6/1!>,!wv<*wv)udbsg!>!g!3dfw<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg<*opjudfsje)fdbGufh!>!fdbg!ubpmg|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~<*1/2!,!wv)!+!6/1!osvufs~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv|!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/5!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv|!*1/4!>>!fdbg)!gj!ftmf!~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/3!>>!fdbg)!gj!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv|!*1/2!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv|!*1/1!>>!fdbg)!gj<wv!3dfw|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~<fdbg!osvufs~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj|!ftmf!~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj<1/2!.!>!fdbg!ubpmg<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*z/w)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*y/w)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*1/1!?!{/w)!gj!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!{/Wtcb)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*w)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!|!*utfUnvutvsg)!gj!!!!!!!!!!!!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*y/g!-c!-b)yjn!>!d!ubpmg!!!!!!!!!!!!<*z/g!-us!-cs)yjn!>!c!ubpmg!!!!!!!!!!!!<*z/g!-um!-cm)yjn!>!b!ubpmg!!!!!!!!!!!!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!!!!!!!!!!!!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*tspudbGldbqoV!-w)upe!osvufs|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*/763!!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov<qjmDypCfmcboFv!mppc!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
Vm(E,{setBatchInfo:function(_,E){ys[_]=E},getBatchInfo:function(C){return ys[C]},getBatchInfoMap:function(){return ys},setBatchInfoMap:function(W){ys=W}},!0);var er=[1,1,1],If=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_o=[1,0,0,0,0,1,0,1,1,1,1,0],Fo=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Il=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],sb=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Aq=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],og=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],ig=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Mm=function(v,q){var I=v._40Q;I.each(function(E){E.ivBatch(q)})},ng=function(T,g,N){var p=N._id,i=g[p];if(i){var J=i.batch,t=T[J],s=t.ds,V=i.index;if(t.invalidate=!0,delete g[p],s.splice(V,1),aj(s))return delete T[J],void 0;for(var f=i.begin,W=i.size,c=3*f,v=3*W,y=4*f,w=4*W,u=t.vs,D=t.ps,A=t.uv,E=t.cs,z=t.bs,_=t.rs,Z=t.ns,C=t.ls;V<s.length;V++)i=g[s[V]._id],i.index--,i.begin-=W;u.splice(c,v),D.splice(y,w),A&&A.splice(2*f,2*W),E&&E.splice(y,w),z&&z.splice(c,v),_&&_.splice(f,W),Z&&Z.splice(c,v),C&&C.splice(f,W)}},gc=function(T,b,p,S,G){if(!S)return X;var l=b[S];if(!l){var F=G.getBatchInfo(S)||Xr,H=F.image?[]:X;l=b[S]={vs:[],ns:[],uv:H,cs:H?X:F.color?X:[],bs:F.blend?[]:X,ps:[],rs:F.brightness?[]:X,ds:[]}}return l.invalidate=!0,T[p._id]={index:l.ds.length,begin:l.vs.length/3,batch:S},l.ds.push(p),l},Bd=function(d,j){return j!=X&&1!==j?[d[0]*j,d[1]*j,d[2]*j,d[3]]:d},qp=function(U){var s=U.shapeModel;s||(s=Lh(U)),s&&(s._ctlineModel=[],s._lineModel=p)},Mo=function(){var x;return function(X,c,k){var Y=X.getData3dUI(c),q=Y.shapeModel;if(q||(q=Lh(Y)),q||!Y.shapeName){var B,C=c.s("wf.combineTriangle");if(k.geometry){if(!q&&(c instanceof S.Node&&!(c instanceof S.Shape)?(x||(x={vs:vo,is:Te,uv:Db}),q=x):q=[Y.left,Y.front,Y.right,Y.back,Y.top,Y.bottom],!q))return p;if(C){var Z=c.s("wf.normEpsilon");isNaN(Z)&&(Z=2),C=0|Math.min(3,Math.max(1,isNaN(C)?1:C)),B=eq[C-1](q,Y,180/(Math.PI*Z))}else B=Yo(q,Y);if(!B||0===B.length)return}else B=k.short?Kj:Yf;var J=X.getBrightness(c),U=c.s("bloom"),G=c.s("3d.reflectable"),L=aq(k.color||"white"),W=L[3]<1,Q=Math.ceil(k.width)||1,M=c.s("3d.clipbox.enabled")&&!c.s("3d.clipbox"),u=(W?"T":"O")+(U?"_1":"_0")+(G?"1_":"0_")+(M?"1_":"0_")+Q,v=c.getRenderLayer(),y=X._40Q.get(v),j=y.wireframeIndexMap,e=y.wireframeModelMap,f=e[u];f||(f=e[u]={vs:[],cs:[],ps:[],ds:[],T:W,B:U,clipboxEnabled:M,reflectable:!!G,W:Q}),f.invalidate=!0;var H=f.vs,n=f.cs,O=f.ds,R=j[c._id]={index:O.length,begin:H.length/3,batch:u};O.push(c);var _=Y.mat;c instanceof S.Edge||!(!_||!k.geometry&&c instanceof S.Shape)||(_=ec(c,k.mat),c.appendAnchorMatrix3d(_)),cc(H,_,B);var h=R.size=H.length/3-R.begin;Fr(n,Bd(L,J),h)}}}(),uq=function(E,W,I,G,w,P,y,N,_){var j=E.getBrightness(W);j==X&&(j=1);var u=Bd(aq(G),j),H=u[3]<1;P=Math.ceil(P)||1;var F=(H?"T":"O")+P;if(y){var U=y[0],c=(y[1]||U)+U;F+="-"+U+"-"+c,_&&(F+="-"+wb(_)+"-"+j,_=Bd(aq(_),j))}var Y=W.getRenderLayer(),K=E._40Q.get(Y),v=K.polylineIndexMap,V=K.polylineModelMap,r=V[F];r||(r=V[F]={vs:[],cs:[],ps:[],ds:[],ls:y?[]:X,T:H,W:P},y&&(r.D=U,r.G=c,r.A=_)),r.invalidate=!0;var p,Q=r.vs,i=r.cs,g=r.ds,S=r.ls,t=v[W._id]={index:g.length,begin:Q.length/3,batch:F};g.push(W),nh(Q,I);var D,z=t.size=Q.length/3-t.begin,k=I.length,$=0,J=[];if(y||w)for(p=0;k>p;p+=6)D=Fb([I[p],I[p+1],I[p+2]],[I[p+3],I[p+4],I[p+5]]),J.push(D),$+=D;if($&&w){var L,h=Bd(aq(w),j),s=[h[0]-u[0],h[1]-u[1],h[2]-u[2],h[3]-u[3]],T=0;for(p=0;k>p;p+=6)L=T/$,Fr(i,[u[0]+s[0]*L,u[1]+s[1]*L,u[2]+s[2]*L,u[3]+s[3]*L],1),T+=J[p/6],L=T/$,Fr(i,[u[0]+s[0]*L,u[1]+s[1]*L,u[2]+s[2]*L,u[3]+s[3]*L],1)}else Fr(i,u,z);if(y)for(T=N||0,p=0;k>p;p+=6)S.push(T),T+=J[p/6],S.push(T)},hi=function(I,K,J){if(K){var a=4*K.begin,n=J[K.batch].ps;if(n[a]!==I[0]||n[a+1]!==I[1]||n[a+2]!==I[2]||n[a+3]!==I[3]){for(var y=0;y<K.size;y++)n[a++]=I[0],n[a++]=I[1],n[a++]=I[2],n[a++]=I[3];n._invalidateThisFrame=!0}}},Cg=function(){var m=new S.Math.Vector3,I=new S.Math.Vector3;return function(X,J){var n=J+["32"],F=X[J],o=X[n];if(F){if(E.extractBatchTranslation&&"vs"===J){I.set(0,0,0);for(var Y=F.length,M=0;Y>M;M+=3)I.add(m.fromArray(F,M));I.divideScalar(Y/3);for(var $=I.x,N=I.y,H=I.z,Z=new Array(Y),M=0;Y>M;M+=3)Z[M]=F[M]-$,Z[M+1]=F[M+1]-N,Z[M+2]=F[M+2]-H;F=Z,X.translate=[$,N,H]}o&&o.length===F.length?(o.set(F),o._bufId=null):X[n]=new en(F)}else delete X[n]}}(),ud=function(a,D,N,V,e,d,h,R){if(Kc(N))N.forEach(function(O){ud(a,D,O,V,e,d,h,R)});else if(tc(N))ud(a,D,Lh(V,N),V,e,d,h,R);else if(Mj(N)){var g,O=Qn(N.mat,D,a),r=Qn(N.s3,D,a),F=Qn(N.t3,D,a),Y=Qn(N.r3,D,a);if((r||Y||F||O)&&(g=Wo(O,r,Y,Qn(N.rotationMode,D,a),F),d.push(g)),N.shape3d)ud(a,D,N.shape3d,V,e,d,h,N);else{var E=V.s;R=R||Xr;var o=d[0],y=d.length,M=E("shape3d.color",N.color,R.color);if(e||(e=E("shape3d.blend",N.blend,R.blend)),y>1){o=le(o);for(var Z=1;y>Z;Z++)sm(o,o,d[Z])}var n=o?Ak(o):X;N.vs&&E(Zj,N.visible,R.visible)&&Oc(o,h,N.vs,N.uv,N.is,N.ns,n,e,M),N.top_vs&&E(wc,N.topVisible,R.topVisible)&&Oc(o,h,N.top_vs,N.top_uv,N.top_is,N.top_ns,n,e,E("shape3d.top.color",N.topColor,R.topColor)||M),N.bottom_vs&&E(zg,N.bottomVisible,R.bottomVisible)&&Oc(o,h,N.bottom_vs,N.bottom_uv,N.bottom_is,N.bottom_ns,n,e,E("shape3d.bottom.color",N.bottomColor,R.bottomColor)||M),N.from_vs&&E(bj,N.fromVisible,R.fromVisible)&&Oc(o,h,N.from_vs,N.from_uv,N.from_is,N.from_ns,n,e,E("shape3d.from.color",N.fromColor,R.fromColor)||M),N.to_vs&&E(qg,N.toVisible,R.toVisible)&&Oc(o,h,N.to_vs,N.to_uv,N.to_is,N.to_ns,n,e,E("shape3d.to.color",N.toColor,R.toColor)||M)}g&&d.pop()}},Oc=function(S,P,e,p,C,K,b,V,O){var U,m=P.cs,q=P.uv,J=P.bs,H=P.ns,s=P.vs;if(K&&0!==K.length||(K=ls(e,C)),C){U=C.length;for(var D=0;U>D;D++){var o=C[D],c=3*o;cc(s,S,[e[c],e[c+1],e[c+2]]),cc(H,b,[K[c],K[c+1],K[c+2]]),q&&nh(q,[p[2*o],p[2*o+1]])}}else U=e.length/3,cc(s,S,e),cc(H,b,K),q&&nh(q,p);m&&Fr(m,O,U),J&&(V?Jf(J,V,U):nh(J,er,U))},mj=function(W,u,q,H){H?ud(W.gv,W.data,H,W,W.getBodyColor(),[u],q):(bg(W,cq,u,q),bg(W,Jo,u,q),bg(W,Vo,u,q),bg(W,ii,u,q),bg(W,yb,u,q),bg(W,jc,u,q),bg(W,"csg",u,q))},bg=function(q,k,s,A){var R=q[k];if(R){var J=R.tuv;if(J){var t=R.uvScale,T=R.uvOffset,H=R.uvRotation;if(t||T||H){var N,$,b,g=Nn(H,T,t),L=g.a,u=g.b,w=g.c,v=g.d,M=g.tx,G=g.ty,B=J.length;for(b=0;B>b;b+=2)N=J[b],$=J[b+1],J[b]=L*N+w*$+M,J[b+1]=u*N+v*$+G}}Oc(s,A,R.vs,J,X,X,s?Ak(s):X,R.blend,R.color)}},_p=function(A,T,R,e,w,m,p,k){var V,P=R.cs,H=R.uv,N=R.bs,s=R.vs,X=R.ns,F=ls(k);if(A.getFaceVisible(T,p)){var j=A.getFaceMat(T,p);if(j&&(w=ec(T,j),m=Ak(w)),cc(s,w,k),cc(X,m,F),P&&Fr(P,A.getFaceColor(T,p),6),H){var C=A.getFaceUv(T,p)||e[p+"Uv"],v=A.getFaceUvScale(T,p)||e[p+"UvScale"],y=A.getFaceUvOffset(T,p)||e[p+"UvOffset"],n=A.getFaceUvRotation(T,p)||e[p+"UvRotation"];C=C?[C[6],C[7],C[0],C[1],C[2],C[3],C[2],C[3],C[4],C[5],C[6],C[7]]:_o;var z=C[0],Q=C[1],c=C[2],E=C[3],l=C[4],q=C[5],d=C[6],M=C[7],U=C[8],B=C[9],o=C[10],Z=C[11];if(v||y||n){var h=Nn(n,y,v),g=h.a,u=h.b,J=h.c,G=h.d,r=h.tx,_=h.ty;z=g*z+J*Q+r,Q=u*z+G*Q+_,c=g*c+J*E+r,E=u*c+G*E+_,l=g*l+J*q+r,q=u*l+G*q+_,d=g*d+J*M+r,M=u*d+G*M+_,U=g*U+J*B+r,B=u*U+G*B+_,o=g*o+J*Z+r,Z=u*o+G*Z+_}H.push(z,Q,c,E,l,q,d,M,U,B,o,Z)}N&&(V=A.getBodyColor(T)||A.getFaceBlend(T,p),V?Jf(N,V,6):nh(N,er,6))}},fq=function(h,u,o,R){var o=h._picking?h.pickColorMap:null,w=h.getGL(),N=h._prg,B=h._buffer;if(!Ub(u)){nn(h,If),wn(w,N);for(var A in u){var z=u[A];if(!(R&&!z.T||!R&&z.T||h.isReflecting(w)&&z.reflectable===!1)){z.invalidate?(z.invalidate=!1,Cg(z,"vs"),Cg(z,"cs"),Cg(z,"ls"),Cg(z,"ps")):o&&z.ps&&z.ps._invalidateThisFrame&&(z.ps._invalidateThisFrame=!1,Cg(z,"ps"));var P=z.translate;P&&nn(h,[1,0,0,0,0,1,0,0,0,0,1,0,P[0],P[1],P[2],1]);var K=z.vs32,q=o?z.ps32:z.cs32;Ic(w,N,z.W,X,B.vs,K);var n=is.for(w),f=n.directUniforms(),Q=n.directAttribs(),j=z.D,_=!h._dashDisabled&&j;f.uAlphaTest=G.alphaTest,w._blooming&&!z.B&&(f.blackout=!0),f.uEnableBoxClip=z.clipboxEnabled!==!1,_&&(f.uDash=!0,f.uDashDistance=j,f.uDashGapDistance=z.G,f.uDiffuse=z.A||G["color.empty"],Q.aLineDistance=jj(w,B.lineDistance,z.ls32,X,1));var x=!h._batchColorDisabled;x&&q.length?(f.uBatchColor=!0,Q.aBatchColor=jj(w,B.batchColor,q,X,4)):(f.uBatchColor=!1,Q.aBatchColor=!1),Wm(w),Kl(w,0,K.length/3,w.LINES),Ck(w),x&&(f.uBatchColor=!1,Q.aBatchColor=!1),_&&(f.uDash=!1,Q.aLineDistance=!1),w._blooming&&!z.B&&(f.blackout=!1),P&&hd(h)}}$l(w,N),hd(h)}},ds=function(O){O.invalidate=!1,Cg(O,"vs"),Cg(O,"ns"),Cg(O,"cs"),Cg(O,"rs"),Cg(O,"ps"),Cg(O,"bs"),Cg(O,"uv")},he=function(n,D,W,v,$){var C,i,F,w,l,O,M,A,k,Q,E,N,W=n._picking?n.pickColorMap:null,u=n.getGL(),H=n._prg,e=is.for(u),x=e.directUniforms(),b=e.directAttribs(),Y=n._buffer;if(!Ub(D)&&!n.drawFilter){nn(n,If);for(C in D)if(i=n.getBatchInfo(C)||Xr,i.visible!==!1&&!(v&&!i.transparent||!v&&i.transparent||n.isReflecting(u)&&i.reflectable===!1)){var a=i.renderLayerMask;if(a==X&&(a=hg),$==X&&($=hg),bs($,a)&&(F=D[C],W||!i.transparentMask)){var q=v&&i.autoSort===!0&&(n._33Q||F.invalidate);if(F.invalidate?ds(F):W&&F.ps&&F.ps._invalidateThisFrame&&(F.ps._invalidateThisFrame=!1,Cg(F,"ps")),l=F.vs32,O=W?F.ps32:F.cs32,k=F.uv32,M=F.bs32,A=F.rs32,E=l.length/3,q){var c=ql(l,n.getEye(),n);c?(F.is=c.is,F.elementTypeUint=c.useUint32):(F.is=null,F.elementTypeUint=null)}if(E){N=F.translate,N&&nn(n,[1,0,0,0,0,1,0,0,0,0,1,0,N[0],N[1],N[2],1]),w=i.light,Q=n.getTexture(i.image),vm(u,H,X,i.light,i.opacity,i.reverseFlip,i.reverseColor,i.reverseCull),O?n._batchColorDisabled?(x.uBatchColor=!1,b.aBatchColor=!1):(x.uBatchColor=!0,b.aBatchColor=jj(u,Y.batchColor,O,X,4)):(x.uBatchColor=!1,x.uDiffuse=i.color||G["color.empty"]);var L=i.alphaTest;x.uAlphaTest=L===p?G.alphaTest:L,x.shadowReceive=!W&&i.shadowReceive!==!1,x.uEnableBoxClip=i.clipboxEnabled!==!1,dh(n,x,i.lightMask===p?gp:i.lightMask),u._blooming&&!i.bloom&&(x.blackout=!0),i.envmap!==p?(x.uUseEnvMap=!0,x.uReflectivity=i.envmap,x.roughness=i.roughness||0,n._setEnvmapByProbeId(x,i.envmapProbe||0)):(x.uUseEnvMap=!1,x.uReflectivity=0);var J=M&&!n._batchBlendDisabled;J&&(x.uBatchBlend=!0,b.aBatchBlend=jj(u,Y.batchBlend,M,X));var t=A&&!n._batchBrightnessDisabled;t&&(x.uBatchBrightness=!0,b.aBatchBrightness=jj(u,Y.batchBrightness,A,X,1)),k?Wm(u,H,Q,i.discardSelectable,Y.uv,k,i.uvOffset,i.uvScale,i.uvRotation):Wm(u),b.aPosition=jj(u,Y.vs,l,X),b.aNormal=jj(u,Y.ns,F.ns32,X),F.is?(pb(u,Y.is,F.is),Ri(u,0,E,null,F.elementTypeUint?u.UNSIGNED_INT:null)):Kl(u,0,E),k?Ck(u,H,Q):Ck(u),O&&!n._batchColorDisabled&&(x.uBatchColor=!1,b.aBatchColor=!1),J&&(x.uBatchBlend=!1,b.aBatchBlend=!1),t&&(x.uBatchBrightness=!1,b.aBatchBrightness=!1),u._blooming&&!i.bloom&&(x.blackout=!1),Ii(u,H),N&&hd(n)}}}hd(n)}},ql=function(t,E,W){var D=t.length/3,A=D>65535,c=W._glCapabilities.elementTypeUint&&A;if(!c&&A)return null;for(var l=new Array(D),d=D/3,r=new Array(d),Q=0;d>Q;Q++)r[Q]=Q;r.sort(function(V,R){var I=9*V,Z=[(t[I]+t[I+3]+2*t[I+6])/4,(t[I+1]+t[I+4]+2*t[I+7])/4,(t[I+2]+t[I+5]+2*t[I+8])/4];I=9*R;var L=[(t[I]+t[I+3]+2*t[I+6])/4,(t[I+1]+t[I+4]+2*t[I+7])/4,(t[I+2]+t[I+5]+2*t[I+8])/4],f=Fb(E,Z)-Fb(E,L);return f>0?-1:0>f?1:0});for(var Q=0;d>Q;Q++){var P=3*Q,k=3*r[Q];l[P]=k,l[P+1]=k+1,l[P+2]=k+2}return{useUint32:c,is:c?new Uint32Array(l):new Ql(l)}},km={obj:function(N,P){var j={mat:N.mat,s3:N.s3,r3:N.r3,rotationMode:N.rotationMode,t3:N.t3,cube:N.cube==X?!0:N.cube,center:N.center==X?!0:N.center,ignoreMtls:N.ignoreMtls,ignoreTransparent:N.ignoreTransparent,ignoreColor:N.ignoreColor,ignoreImage:N.ignoreImage,ignoreNormal:N.ignoreNormal,prefix:N.prefix,flipY:N.flipY,flipFace:N.flipFace,reverseFlipMtls:N.reverseFlipMtls,finishFunc:function(j,I){if(j){var I=[];for(var $ in j){var p=j[$];I.rawS3=p.rawS3,p.center&&(I.center=p.center),I.push(p),N.eachModel&&N.eachModel($,p)}I.json=N,P(I)}else P()}};E.loadObj(N.obj,N.mtl,j)},bin:function(K,O){var h={finishFunc:function(k){k?O(k):O()}};E.loadBin(K.url,h)}};E.getModelTypeHandlers=function(){return km},E.setModelTypeHandler=function(N,y){km[N]=y},E.getModelTypeHandler=function(W){return km[W]},E.handleModelLoaded=function(){},E.handleUnfoundModel=function(){};var ni=X,xp=X,xf=function(d){ni&&!d._loadingModelView_&&(xp||(xp={}),xp[d._loadingModelView_=Ne()]=d)},yf=function(P,h){ni||(ni={});var r=ni[P];if(r){if(r.url===h)return;r.request.onload=wh,r.request.onerror=wh}if(h.indexOf(".bin")===h.length-4)return Ze(P,{modelType:"bin",url:h},h);if(h=E.beforeLoadURL(h),h.data){var Y=E.parse(h.data);Ze(P,Y,h)}else{var o=new _r;ni[P]={request:o,url:h},o.onload=function(){if(200===this.status||0===this.status){delete ni[P];var V=E.parse(o.getResponseText());Ze(P,V,h)}else Rd(P,E.handleUnfoundModel(P,h)||X)},o.onerror=function(){Rd(P,E.handleUnfoundModel(P,h)||X)};var l={};l.url=encodeURI(h),l.sync=!1,o.send(l)}},Ze=function(U,I,r){var V=I.modelType;if(!V)return Rd(U,I),E.handleModelLoaded(U,I),void 0;var p=E.getModelTypeHandler(V);if(p){if(ni||(ni={}),ni[U])return;ni[U]=!0;var A=function(m){m?(Rd(U,m),E.handleModelLoaded(U,m)):Rd(U,E.handleUnfoundModel(U,r,I)||X)};p(I,A)}else Rd(U,E.handleUnfoundModel(U,r,I)||X)},Rd=function(Y,U){if(delete ni[Y],tc(U)&&Jb.test(U))return yf(Y,U),void 0;if(jr[Y]=U,Ub(ni)&&(ni=X,xp)){for(var u in xp){var B=xp[u];B.invalidateAll&&B.invalidateAll(p,"modelLoaded",Y),B.redraw&&B.redraw(),B.iv(),delete B._loadingModelView_}xp=X}if(U&&xp)for(var u in xp){var B=xp[u];B.invalidateAll&&B.invalidateAll(p,"modelLoading",Y),B.redraw&&B.redraw(),B.iv()}},nc=new en([0,0,0,1,1,1,1,0]),uc=new en([0,0,1,0,0,1,0,0,1,0,0,1]),xi=new Ql([0,1,2,2,3,0]),vo=new en([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Te=new Ql([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Db=new en([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),nm=ls(vo,Te),Jd=(new en([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Ql([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[cq,Vo,Jo,ii,yb,jc]),Yf=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Kj=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],xm=function(w,F,W,c,Q,O,J){O=O||16,w=w||16,F=F||0,W=W||w;var j,q,D,m,Y,v,K,o,x,V=.5,z=[],k=[],X=$/w,u=f/O;for(j=0;O>j;j++)for(v=j+1,m=j*u,x=v*u,q=F;W>q;q++)K=q+1,D=q*X,o=K*X,z.push(V*T(m)*t(D),V*t(m),-V*T(m)*T(D),V*T(x)*t(o),V*t(x),-V*T(x)*T(o),V*T(m)*t(o),V*t(m),-V*T(m)*T(o),V*T(m)*t(D),V*t(m),-V*T(m)*T(D),V*T(x)*t(D),V*t(x),-V*T(x)*T(D),V*T(x)*t(o),V*t(x),-V*T(x)*T(o)),k.push(q/w,j/O,K/w,v/O,K/w,j/O,q/w,j/O,q/w,v/O,K/w,v/O);if(J){var A=[];for(j=0,Y=z.length;Y>j;j+=3)A.push(2*z[j],2*z[j+1],2*z[j+2])}if(c){var Z=[],l=[];for(D=F*X,j=0;O>j;j++)v=j+1,m=j*u,x=v*u,Z.push(0,0,0,V*T(x)*t(D),V*t(x),-V*T(x)*T(D),V*T(m)*t(D),V*t(m),-V*T(m)*T(D)),l.push(0,.5,F/w,v/O,F/w,j/O)}if(Q){var I=[],y=[];for(D=W*X,j=0;O>j;j++)v=j+1,m=j*u,x=v*u,I.push(0,0,0,V*T(m)*t(D),V*t(m),-V*T(m)*T(D),V*T(x)*t(D),V*t(x),-V*T(x)*T(D)),y.push(1,.5,W/w,j/O,W/w,v/O)}var H={vs:z,uv:k,from_vs:Z,from_uv:l,to_vs:I,to_uv:y};return J&&(H.ns=A),H},Xo=function(z,M,Y){z=z||.17,M=M||12,Y=Y||18,0>z?z=0:z>.25&&(z=.25);var x,g,A,u,m,_,W,o=.5,V=[],Q=[],R=[],E=$/Y,I=$/M,d=o-z;for(g=0;M>=g;g++)for(u=-f+g*I,_=t(u),m=T(u),x=0;Y>=x;x++)A=x*E,W=d+z*_,V.push(t(A)*W,m*z,-T(A)*W),Q.push(x/Y,1-g/M);for(g=0;M>g;g++){var G=g*(Y+1),B=(g+1)*(Y+1);for(x=0;Y>x;x++)R.push(G+x,B+x+1,B+x,G+x,G+x+1,B+x+1)}return{vs:V,uv:Q,is:R}},Cn=function(b,e,N,L,P,I,o,Z){o=o||12,b=b||18,e=e||0,N=N||b,I=I||.17,0>I?I=0:I>.25&&(I=.25);var R,w,m,u,k,r,d,j,a,W,n=.5,_=[],E=[],s=$/b,X=$/o,U=n-I,D=Z?[]:p;for(m=0;o>m;m++)for(u=m+1,d=-f+m*X,j=-f+u*X,R=e;N>R;R++)w=R+1,k=R*s,r=w*s,a=U+I*t(d),W=U+I*t(j),_.push(t(k)*a,T(d)*I,-T(k)*a,t(r)*a,T(d)*I,-T(r)*a,t(r)*W,T(j)*I,-T(r)*W,t(k)*a,T(d)*I,-T(k)*a,t(r)*W,T(j)*I,-T(r)*W,t(k)*W,T(j)*I,-T(k)*W),E.push(R/b,1-m/o,w/b,1-m/o,w/b,1-u/o,R/b,1-m/o,w/b,1-u/o,R/b,1-u/o),Z&&D.push(t(k)*t(d),T(d),-T(k)*t(d),t(r)*t(d),T(d),-T(r)*t(d),t(r)*t(j),T(j),-T(r)*t(j),t(k)*t(d),T(d),-T(k)*t(d),t(r)*t(j),T(j),-T(r)*t(j),t(k)*t(j),T(j),-T(k)*t(j));if(L){var A=[],F=[];for(m=0;o>m;m++)u=m+1,d=-f+m*X,j=-f+u*X,k=e*s,a=U+I*t(d),W=U+I*t(j),A.push(t(k)*a,T(d)*I,-T(k)*a,t(k)*W,T(j)*I,-T(k)*W,t(k)*U,0,-T(k)*U),F.push(.5+.5*t(d),.5-.5*T(d),.5+.5*t(j),.5-.5*T(j),.5,.5)}if(P){var S=[],y=[];for(m=0;o>m;m++)u=m+1,d=-f+m*X,j=-f+u*X,k=N*s,a=U+I*t(d),W=U+I*t(j),S.push(t(k)*a,T(d)*I,-T(k)*a,t(k)*U,0,-T(k)*U,t(k)*W,T(j)*I,-T(k)*W),y.push(.5-.5*t(d),.5-.5*T(d),.5,.5,.5-.5*t(j),.5-.5*T(j))}var G={vs:_,uv:E,from_vs:A,from_uv:F,to_vs:S,to_uv:y};return Z&&(G.ns=D),G},bb=function(o,Z){for(var D,u,O,Y,Q,W=.5,h=16,i=[],N=[],I=[],g=[],p=$/h,r=0;h>=r;r++)D=r*p,u=t(D),Y=u*W,O=T(D),Q=O*W,i.push(Y,-W,Q,Y,W,Q),I.push(u,0,O,u,0,O),N.push(1-r/h,1,1-r/h,0);for(r=0;h>r;r++)g.push(2*r,2*r+1,2*r+3,2*r,2*r+3,2*r+2);if(Z){var e=[],d=[],c=[];for(e.push(0,-W,0),d.push(.5,.5),r=0;h>=r;r++)D=r*p,u=t(D),O=T(D),e.push(u*W,-W,-O*W),d.push(.5+.5*u,.5+.5*O);for(r=0;h>r;r++)c.push(0,r+2,r+1)}if(o){var j=[],s=[],F=[];for(j.push(0,W,0),s.push(.5,.5),r=0;h>=r;r++)D=r*p,u=t(D),O=T(D),j.push(u*W,W,-O*W),s.push(.5+.5*u,.5-.5*O);for(r=0;h>r;r++)F.push(0,r+1,r+2)}return{vs:i,uv:N,is:g,ns:I,bottom_vs:e,bottom_uv:d,bottom_is:c,top_vs:j,top_uv:s,top_is:F}},Zl=function(i,Z,P,N,k,z,J,F){i=i||12,Z=Z||0,P=P||i;for(var D,c,m,s,O,j,e,E,o,v=.5,U=[],Q=[],x=$/i,b=Z;P>b;b++)D=b+1,c=b*x,m=D*x,s=t(c)*v,O=T(c)*v,j=t(m)*v,e=T(m)*v,U.push(s,-v,-O,j,-v,-e,s,v,-O,j,-v,-e,j,v,-e,s,v,-O),Q.push(b/i,1,D/i,1,b/i,0,D/i,1,D/i,0,b/i,0);if(F){var f=[];for(b=0,o=U.length;o>b;b+=3)f.push(2*U[b],0,2*U[b+2])}if(J){var q=[],h=[];for(b=Z;P>b;b++)c=x*b,m=x*(b+1),s=t(c),O=T(c),j=t(m),e=T(m),q.push(s*v,-v,-O*v,0,-v,0,j*v,-v,-e*v),h.push(.5+.5*s,.5+.5*O,.5,.5,.5+.5*j,.5+.5*e)}if(z){var r=[],n=[];for(b=Z;P>b;b++)c=x*b,m=x*(b+1),s=t(c),O=T(c),j=t(m),e=T(m),r.push(s*v,v,-O*v,j*v,v,-e*v,0,v,0),n.push(.5+.5*s,.5-.5*O,.5+.5*j,.5-.5*e,.5,.5)}if(N){var A=[],K=[];c=x*Z,s=t(c)*v,O=T(c)*v,E=Z/i,A.push(0,v,0,0,-v,0,s,-v,-O,s,-v,-O,s,v,-O,0,v,0),K.push(0,0,0,1,E,1,E,1,E,0,0,0)}if(k){var _=[],R=[];c=x*P,s=t(c)*v,O=T(c)*v,E=P/i,_.push(0,-v,0,0,v,0,s,v,-O,s,v,-O,s,-v,-O,0,-v,0),R.push(1,1,1,0,E,0,E,0,E,1,1,1)}var C={vs:U,uv:Q,bottom_vs:q,bottom_uv:h,top_vs:r,top_uv:n,from_vs:A,from_uv:K,to_vs:_,to_uv:R};return F&&(C.ns=f),C},hj=function(v,p,Q,l,H){p=p||18,Q=Q||0,l=l==X?$:l,H=H==X?.5:H;for(var Y,P,u,K,g,e,d=[0,.5,.75,.875,.9375],L=[],b=[],O=[],n=l/p,_=0;_<d.length;_++){var s=0===_%2?0:.5;for(Y=0;p>=Y;Y++)P=(Y+s)*n+Q,u=1-d[_],L.push(t(P)*H*u,-H+2*d[_]*H,-T(P)*H*u),b.push((Y+s)/p,u)}for(_=0;_<d.length-1;_++){var w=_*(p+1),f=(_+1)*(p+1);for(Y=0;p>Y;Y++)O.push(w+Y,f+Y+1,f+Y,w+Y,w+Y+1,f+Y+1)}for(e=L.length/3-(p+1),Y=0;p>Y;Y++)L.push(0,H,0),b.push((Y+.5)/p,0);for(Y=0;p>Y;Y++)O.push(e+Y,e+Y+1,e+(p+1)+Y);if(v){var h=[],D=[],y=[];for(h.push(0,-H,0),D.push(.5,.5),Y=0;p>=Y;Y++)P=Y*n+Q,K=t(P),g=T(P),h.push(K*H,-H,-g*H),D.push(.5+.5*K,.5+.5*g);for(Y=0;p>Y;Y++)y.push(0,Y+2,Y+1)}return{vs:L,uv:b,is:O,bottom_vs:h,bottom_uv:D,bottom_is:y}},Kk=function(U,w,W,l,r,q,z,p){U=U||16,w=w||0,W=W||U,z=z||1;var X,g,L,Z,R,D,i,G=.5,s=[],v=[],H=$/U,d=w,P=1/z,g=new Zh,L=new Zh,a=new Zh,F=new Zh,B=new Zh,y=new Zh,S=new Zh;for(p&&(X=[],R=new Zh,D=new Zh,i=new Zh);W>d;d++){var o=d+1,E=H*d,O=H*o;for(g.set(t(E)*G,-G,-T(E)*G),L.set(t(O)*G,-G,-T(O)*G),a.set(0,G,0),p&&(R.set(t(E),.5,-T(E)).normalize(),D.set(t(O),.5,-T(O)).normalize(),i.copy(R).add(D).normalize()),F.lerpVectors(a,g,P),B.lerpVectors(a,L,P),s.push(F.x,F.y,F.z,B.x,B.y,B.z,a.x,a.y,a.z),v.push(d/U,P,o/U,P,(d+o)/2/U,0),p&&X.push(R.x,R.y,R.z,D.x,D.y,D.z,i.x,i.y,i.z),Z=1;z>Z;Z++)F.lerpVectors(a,g,P*(Z+1)),B.lerpVectors(a,L,P*(Z+1)),y.lerpVectors(a,g,P*Z),S.lerpVectors(a,L,P*Z),s.push(F.x,F.y,F.z,B.x,B.y,B.z,y.x,y.y,y.z,y.x,y.y,y.z,B.x,B.y,B.z,S.x,S.y,S.z),v.push(d/U,P*(Z+1),o/U,P*(Z+1),d/U,P*Z,d/U,P*Z,o/U,P*(Z+1),o/U,P*Z),p&&X.push(R.x,R.y,R.z,D.x,D.y,D.z,R.x,R.y,R.z,R.x,R.y,R.z,D.x,D.y,D.z,D.x,D.y,D.z)}if(q){var M=[],Y=[];for(d=w;W>d;d++){E=H*d,O=H*(d+1);var J=t(E),C=T(E),f=t(O),I=T(O);M.push(J*G,-G,-C*G,0,-G,0,f*G,-G,-I*G),Y.push(.5+.5*J,.5+.5*C,.5,.5,.5+.5*f,.5+.5*I)}}if(l){var K=[],x=[];E=H*w,K.push(0,G,0,0,-G,0,t(E)*G,-G,-T(E)*G),x.push(0,0,0,1,w/U,1)}if(r){var A=[],_=[];E=H*W,A.push(0,-G,0,0,G,0,t(E)*G,-G,-T(E)*G),_.push(1,1,1,0,W/U,1)}var N={vs:s,uv:v,bottom_vs:M,bottom_uv:Y,from_vs:K,from_uv:x,to_vs:A,to_uv:_};return p&&(N.ns=X),N},Dk=function(Y,F,N,q,D,b,H,I){for(var j=[],O=0;O<Y.length-1;O+=2)j.push({x:Y[O],y:Y[O+1]});return Pe(j,F,N,q,D,b,H,I,!1)},Pj={roundRect:function(T,Q){return Dk([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],T,Q,3)},star:function(B,c){return Dk([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],B,c)},rect:function(E,d){return Dk([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],E,d)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(l,o){return Dk([0,-.5,.5,.5,-.5,.5],[1,2,2,5],l,o)},rightTriangle:function(W,Q){return Dk([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],W,Q)},parallelogram:function(U,v){return Dk([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],U,v)},trapezoid:function(L,i){return Dk([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],L,i)}},Qj={sphere:1,cylinder:1,cone:1,torus:1},lf={torus:1,sphere:1,cone:1},Jk=Vm(Nq(Pj),{cylinder:1}),Sh=Vm(Nq(Pj),{cylinder:1,cone:1}),np=function(m,l,d){var Q,w=Qn(m.anchor3d,d,l),L=Qn(m.mat,d,l),q=Qn(m.s3,d,l),R=Qn(m.t3,d,l),F=Qn(m.r3,d,l),H=q||F||R||L;if(w||H){Q=le(l._6O);var j=H?Wo(L,q,F,Qn(m.rotationMode,d,l),R):df();w&&qq(j,[.5-w[0],.5-w[1],.5-w[2]]),nn(l,j)}return Q},bl=function(y,v,g,U,d,z,o){if(Kc(g))g.forEach(function(X){bl(y,v,X,U,d,z,o)});else if(tc(g))bl(y,v,Lh(U,g),U,d,z,o);else if(Mj(g))if(g.shape3d){var T=np(g,y,v);bl(y,v,g.shape3d,U,d,z,g),T&&hd(y,T)}else Mi(y,v,g,U.s,d,z,o)},Mi=function(F,S,J,r,c,W,p){if(p=p||Xr,!W||W(r("shape3d.transparent",J.transparent,p.transparent))){var M=np(J,F,S);if(qn(J)){var $=F.getData3dUI(S);$.dispatchBoundingBoxChanged()}var n=F._26I,V=F._prg,A=F._buffer,w=r("shape3d.color",J.color,p.color);c||(c=r("shape3d.blend",J.blend,p.blend));var m,d=J.opacity==X?p.opacity:J.opacity,Z=r("shape3d.opacity");m=Z!=X&&d!=X?d*Z:d!=X?d:Z,vm(n,V,c,r("shape3d.light",J.light,p.light),m,r("shape3d.reverse.flip",J.reverseFlip,p.reverseFlip),r("shape3d.reverse.color",J.reverseColor,p.reverseColor),r("shape3d.reverse.cull",J.reverseCull,p.reverseCull));var Q=r("polygonOffset",J.polygonOffset,p.polygonOffset);J.vs&&r(Zj,J.visible,p.visible)&&ab(n,V,A,w,F.getTexture(r("shape3d.image",J.image,p.image),S),r("shape3d.discard.selectable",J.discardSelectable,p.discardSelectable),J.vs,J.uv,J.ns,J.is,r("shape3d.uv.offset",J.uvOffset,p.uvOffset),r("shape3d.uv.scale",J.uvScale,p.uvScale),r("shape3d.uv.rotation",J.uvRotation,p.uvRotation),Q),J.top_vs&&r(wc,J.topVisible,p.topVisible)&&ab(n,V,A,r("shape3d.top.color",J.topColor,p.topColor)||w,F.getTexture(r("shape3d.top.image",J.topImage,p.topImage),S,"top"),r("shape3d.top.discard.selectable",J.topDiscardSelectable,p.topDiscardSelectable),J.top_vs,J.top_uv,J.top_ns,J.top_is,r("shape3d.top.uv.offset",J.topUvOffset,p.topUvOffset),r("shape3d.top.uv.scale",J.topUvScale,p.topUvScale),r("shape3d.top.uv.rotation",J.topUvRotation,p.topUvRotation),Q),J.bottom_vs&&r(zg,J.bottomVisible,p.bottomVisible)&&ab(n,V,A,r("shape3d.bottom.color",J.bottomColor,p.bottomColor)||w,F.getTexture(r("shape3d.bottom.image",J.bottomImage,p.bottomImage),S,"bottom"),r("shape3d.bottom.discard.selectable",J.bottomDiscardSelectable,p.bottomDiscardSelectable),J.bottom_vs,J.bottom_uv,J.bottom_ns,J.bottom_is,r("shape3d.bottom.uv.offset",J.bottomUvOffset,p.bottomUvOffset),r("shape3d.bottom.uv.scale",J.bottomUvScale,p.bottomUvScale),r("shape3d.bottom.uv.rotation",J.bottomUvRotation,p.bottomUvRotation),Q),J.from_vs&&r(bj,J.fromVisible,p.fromVisible)&&ab(n,V,A,r("shape3d.from.color",J.fromColor,p.fromColor)||w,F.getTexture(r("shape3d.from.image",J.fromImage,p.fromImage),S,"from"),r("shape3d.from.discard.selectable",J.fromDiscardSelectable,p.fromDiscardSelectable),J.from_vs,J.from_uv,J.from_ns,J.from_is,r("shape3d.from.uv.offset",J.fromUvOffset,p.fromUvOffset),r("shape3d.from.uv.scale",J.fromUvScale,p.fromUvScale),r("shape3d.from.uv.rotation",J.fromUvRotation,p.fromUvRotation),Q),J.to_vs&&r(qg,J.toVisible,p.toVisible)&&ab(n,V,A,r("shape3d.to.color",J.toColor,p.toColor)||w,F.getTexture(r("shape3d.to.image",J.toImage,p.toImage),S,"to"),r("shape3d.to.discard.selectable",J.toDiscardSelectable,p.toDiscardSelectable),J.to_vs,J.to_uv,J.to_ns,J.to_is,r("shape3d.to.uv.offset",J.toUvOffset,p.toUvOffset),r("shape3d.to.uv.scale",J.toUvScale,p.toUvScale),r("shape3d.to.uv.rotation",J.toUvRotation,p.toUvRotation),Q),Ii(n,V),M&&hd(F,M)}},ab=function(B,O,H,S,C,p,o,$,q,T,e,K,Z,g){if(o){g&&Dn(B,g);var E=is.for(B),w=E.directUniforms(),W=E.directAttribs();w.uDiffuse=S||G["color.empty"],$?Wm(B,O,C,p,H.uv,$,e,K,Z):Wm(B),W.aPosition=jj(B,H.vs,o,X),W.aNormal=jj(B,H.ns,q,X),T?(nb(B,H.is,T),Ri(B,0,T.length,null,T instanceof Uint32Array?B.UNSIGNED_INT:null)):Kl(B,0,o.length/3),$?Ck(B,O,C):Ck(B),g&&Dm(B)}},Lh=function(F,D){var g=F.s;if(D||(D=g(Yp)),!D)return X;var P=De(D);if(P)return P;if("text"===D){var r={amount:g("shape3d.text.amount"),size:g("shape3d.text.size"),font:g("shape3d.text.font"),style:g("shape3d.text.style"),weight:g("shape3d.text.weight"),fill:g("shape3d.text.fill"),curveSegments:g("shape3d.text.curveSegments"),spacing:g("shape3d.text.spacing")},A=F.gv.getShape3dText(F.data),z=A;for(var d in r)z+="_"+(r[d]===p?"U":r[d]);return F._cachedTextKey===z?F._cachedTextGeometry:(F._cachedTextKey=z,F._cachedTextGeometry=E.createTextGeometry(A,r))}var d=D;if(Qj[D]){var i=g("shape3d.side"),n=g("shape3d.side.from"),S=g("shape3d.side.to"),o=g(bj),k=g(qg);3>i?(i=0,n=0,S=0,o=!1,k=!1):((n==X||0>n)&&(n=0),(S==X||S>i)&&(S=i),0===n&&S===i&&(o=!1,k=!1));var O=g("shape3d.smooth");d+="-"+i+"-"+n+"-"+S+"-"+o+"-"+k+(O?1:0)}if(Jk[D]){var L=g(wc);d+="-"+L}if(Sh[D]){var V=g(zg);d+="-"+V}if("torus"===D){var f=g("shape3d.torus.radius");0>f?f=0:f>.25&&(f=.25),d+="-"+f}if(lf[D]){var N=g(nl);d+="-"+N}return P=nq[d],P||("box"===D?P=E.createBoxModel():Pj[D]?P=Pj[D](L,V):"sphere"===D?P=E.createSphereModel(i,n,S,o,k,N,O):D===kc?P=E.createCylinderModel(i,n,S,o,k,L,V,O):"cone"===D?P=E.createConeModel(i,n,S,o,k,V,N,O):"torus"===D&&(P=E.createTorusModel(i,n,S,o,k,f,N,O)),nq[d]=P),P},qn=function(){var O=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],q=["is","top_is","bottom_is","from_is","to_is"];return e=yj(gf.substr(gf.indexOf("^#")+2)),Ho(E[Bh(Di+O[15]+"n"+O[16])]())&&$d()?function(t){return t&&!t._complete_?(t._complete_=!0,t.vs&&aj(t.ns)&&(t.ns=ls(t.vs,t.is),t.boundingBox=p),t.top_vs&&aj(t.top_ns)&&(t.top_ns=ls(t.top_vs,t.top_is),t.top_boundingBox=p),t.bottom_vs&&aj(t.bottom_ns)&&(t.bottom_ns=ls(t.bottom_vs,t.bottom_is),t.bottom_boundingBox=p),t.from_vs&&aj(t.from_ns)&&(t.from_ns=ls(t.from_vs,t.from_is),t.from_boundingBox=p),t.to_vs&&aj(t.to_ns)&&(t.to_ns=ls(t.to_vs,t.to_is),t.to_boundingBox=p),O.forEach(function(i){var C=t[i];Kc(C)&&(t[i]=new en(C))}),q.forEach(function(q){var m=t[q];Kc(m)&&(t[q]=new Ql(m))}),!0):!1}:void 0}(),dg=function(o,h){var k=o[h];Kc(k)&&(o[h]=new en(k))};Vm(cm,{_25Q:function(a){a._16O=function(o,O,$,R,C,W,Q,Z,B){var S=this.info;if(S){var a,y,U,d,M,E,X=df();if(hk[O]?(a=S.p3,y=S.c1,U=S.c2):vi[O]?(y=S.s1||S.c1,U=S.s2||S.c2):(y=S.t1||S.c1,U=S.t2||S.c2),a)E=Ap(O,An,$,R,Z,B);else{var H=Fi(U,y),N=Fb(y,U);d=[0,-$g(H[2],H[0]),r(H[1]/N)],M="zyx",a=[(y[0]+U[0])/2,(y[1]+U[1])/2,(y[2]+U[2])/2],E=Ap(O,[N,0,0],$,R,Z,B)}return Wl(X,E,a,R,C,W,Q,o,d,M)}return Jq},a._80o=function(O,k,E){var l=this,t=l.shapeModel;if(t){var q=l.gv;nn(q),bl(q,l.data,t,l,l.getBodyColor(),E)}},a.createLineModel=function(V,y,m,T,H){var i=this,l=i.s,J=il(V,y,l(nl)),W=l(T+".color");if(W){for(var B=[],c=0;c<J.length;c++){var q=J[c],K=q.length;if(K>1){var Z=q[0];B.push(Z.x,Z.y,Z.z);for(var N=1;K-1>N;N++)Z=q[N],B.push(Z.x,Z.y,Z.z),B.push(Z.x,Z.y,Z.z);Z=q[K-1],B.push(Z.x,Z.y,Z.z)}}var U,j,g,A=l(H),u=0;A&&(j=l(H+".color"),U=l(H+".pattern"),u=l(H+".offset"),g=W),uq(i.gv,i.data,B,j||W,g?X:l(T+".gradient.color"),m,U||l(T+".pattern"),u,g)}return J},a.createTubeModel=function(N,O,t,_){for(var E=this,A=E.s,P=A("shape3d.side")||Xh,q=A("shape3d.start.angle"),L=A("shape3d.sweep.angle"),m=A(wc)?A("shape3d.top.cap"):X,u=A(zg)?A("shape3d.bottom.cap"):X,R="flat"===m,V="flat"===u,F=R&&(_?_.uv:A("shape3d.top.image")),w=V&&(_?_.uv:A("shape3d.bottom.image")),e=_?_.uv:A("shape3d.image"),n=A("shape3d.smooth"),k={vs:[],uv:e?[]:X,ns:n?[]:X,top_vs:R?[]:X,top_uv:F?[]:X,bottom_vs:V?[]:X,bottom_uv:w?[]:X},Q=il(N,O,A(nl),t),z=0,D=Q.length;D>z;z++)Qo(k,Q[z],A(Ep),t,P,q,L,m,u);return _?ud(E.gv,E.data,k,E,E.getBodyColor(),E.mat?[E.mat]:[],_):E.shapeModel=k,E.lineShapeModel=k,Q},a.getCache=function(){var I=this.info;if(I){var O=I.list;if(O){var a=I.cache;return a||(a=I.cache=rf(O)),a}}return X}}});var _q=function(Z,C){for(var Y,D=0,S=Z.length,P=0,a=S-1;a>=P;)if(D=x(P+(a-P)/2),Y=Z[D].length-C,0>Y)P=D+1;else{if(!(Y>0)){a=D;break}a=D-1}D=a;var v=Z[D],M=v.point;return D===S-1||v.length===C||(M=(new Ph).subVectors(Z[D+1].point,M).normalize().multiplyScalar(C-v.length).add(M)),{point:M,tangent:v.tangent}},rf=function(k){for(var I,v,D=[],d=0,M=0;M<k.length;M++){for(var u=k[M],L=0;L<u.length;L++){I=u[L],v&&(d+=v.distanceTo(I));var $=new Ph,m=u[L+1];m?$.subVectors(m,I):v?$.subVectors(I,v):$.x=1,$.normalize(),D.push({point:I,length:d,tangent:$}),v=I}v=null}return D},il=function(R,Z,c,M){c=c||ke;for(var w=[],K=0,Q=R.size();Q>K;K++){var r=R.get(K);w.push(new Ph(r.x,r.e||0,r.y))}Z&&(Sd(Z)&&(Z=Z._as),Z.length||(Z=null));for(var P,g,H,t,B,f=[],D=[],W=0,p=0,I=Z?Z.length:Q;I>p;p++){if(B=Z?Z[p]:0===p?1:2,1===B)f.push(H=[]),H.push(w[W++]);else if(2===B||5===B)if(t=2===B?w[W++]:H[0],M){var Y=Z?Z[p+1]:I>p+1?2:X;if(2===Y||5===Y){var b=H[H.length-1],m=2===Y?w[W]:H[0],E=(new Ph).subVectors(b,t),L=(new Ph).subVectors(m,t),N=E.length(),u=L.length();if(N&&u)if(M>N/2&&M>u/2)H.push(t);else for(E.multiplyScalar(d(M,N/2)/N).add(t),L.multiplyScalar(d(M,u/2)/u).add(t),P=new fh(E,t,L).getPoints(c),g=0;c>=g;g++)H.push(P[g])}else H.push(t)}else H.push(t);else if(3===B)for(P=new fh(H[H.length-1],w[W++],w[W++]).getPoints(c),g=1;c>=g;g++)H.push(P[g]);else if(4===B)for(P=new ck(H[H.length-1],w[W++],w[W++],w[W++]).getPoints(c),g=1;c>=g;g++)H.push(P[g]);D.push(f.length,H.length)}return f.indexMark=D,f},Ld=function(w){for(var V,M,p=new Ph,o=[],Q=[],r=[],P=0,X=w.length;X>P;P++)V=w[P],M=w[P+1],M?p.subVectors(M,V):p.subVectors(V,w[P-1]),o.push(p.normalize().clone());var E,h=new Ph,y=new Ph,O=new Qk,W=1e-4,c=o[0],H=Q[0]=new Ph,N=r[0]=new Ph;for(Math.abs(Math.abs(c.y)-1)<W?h.set(1,0,0):h.set(0,1,0),y.crossVectors(c,h).normalize(),H.crossVectors(c,y),N.crossVectors(c,H),P=1;X>P;P++)Q[P]=Q[P-1].clone(),r[P]=r[P-1].clone(),y.crossVectors(o[P-1],o[P]),y.length()>W&&(y.normalize(),E=z(nr(o[P-1].dot(o[P]),-1,1)),Q[P].applyMatrix4(O.makeRotationAxis(y,E))),r[P].crossVectors(o[P],Q[P]);
return{B:r,T:o,N:Q}},Qo=function(){var k=function(k){for(var C=1;C<arguments.length;C++){var z=arguments[C];k.push(z.x,z.y,z.z)}},L=function(J){for(var f=1;f<arguments.length;f++){var z=arguments[f].uv;J.push(z[0],z[1])}},q=function(Y){for(var b=1;b<arguments.length;b++){var H=arguments[b].ns;Y.push(H[0],H[1],H[2])}},U=function(A,v,n,b,V){var k=-b*t(V),N=b*T(V);return new Ph(A.x+k*n.x+N*v.x,A.y+k*n.y+N*v.y,A.z+k*n.z+N*v.z)},Z=function(u,s,C,y,D,p,z,t,v){z=z||$;for(var q,K=[],N=z/D,q=v?new Zh:X,G=0;D>=G;G++){var J=U(u,s,C,y,G*N+p);K.push(J),t!=X&&(J.uv=[t,1-G/D]),v&&(J.ns=q.subVectors(J,u).normalize().toArray())}return K},s=function(C,O,E,P,Y,H,m,d,M){M=M||$;var w=O?C.top_vs:C.bottom_vs;if(w)for(var A=O?C.top_uv:C.bottom_uv,x=M/m,i=0;m>i;i++){var _,F;O?(_=i*x+d,F=(i+1)*x+d):(F=i*x+d,_=(i+1)*x+d),k(w,U(E,P,Y,H,_),U(E,P,Y,H,F),E),A&&A.push(.5-.5*t(_),.5-.5*T(_),.5-.5*t(F),.5-.5*T(F),.5,.5)}};return function(R,Y,v,G,d,U,e,F,Q){var T=Y.length;if(T>1){var o,z,r,E,S,J,w,c=Ld(Y),C=c.T,l=c.N,g=c.B;"flat"===F&&s(R,!0,Y[0],g[0],l[0],G,d,U,e),"flat"===Q&&s(R,!1,Y[T-1],g[T-1],l[T-1],G,d,U,e);var O,P,h=[],A=I(d/2),f="round"===F,n="round"===Q,b=Y[0],V=C[0],y=g[0],N=l[0],m=Y[T-1],H=C[T-1],i=g[T-1],$=l[T-1];if(f){for(r=1;A>=r;r++)l.splice(0,0,N),g.splice(0,0,y),C.splice(0,0,V),P=-r/A*G,Y.splice(0,0,V.clone().multiplyScalar(P).add(b)),h[A-r]=B(G*G-P*P);T+=A}if(n){for(r=1;A>=r;r++)l.push($),g.push(i),C.push(H),P=r/A*G,Y.push(H.clone().multiplyScalar(P).add(m)),h[Y.length-1]=B(G*G-P*P);T+=A}if(R.uv){var _=0,M=0,W=[];for(v&&(_=v),S=Y[0],W[0]=0,r=1;T>r;r++)E=Y[r],W[r]=S.distanceTo(E),S=E,v||(_+=W[r]);for(O=[],r=0;T>r;r++)M+=W[r],O[r]=_?M/_:0}var t=R.ns?!0:!1;for(r=0;T>r;r++){if(E=Y[r],J=g[r],w=l[r],o=Z(E,J,w,h[r]===p?G:h[r],d,U,e,O?O[r]:X,t),z)for(var u=0;d>u;u++){var D=z[u],j=z[u+1]||z[0],K=o[u],a=o[u+1]||o[0];k(R.vs,j,D,K,K,a,j),R.uv&&L(R.uv,j,D,K,K,a,j),t&&q(R.ns,j,D,K,K,a,j)}z=o}}}}();Vm(E,{getLineLength:function(z){return z[z.length-1].length},getLineOffset:function(e,h){return _q(e,h)},getLineCacheInfo:function(I,S,d,l){return rf(il(I,S,d,l))}});var pn=S.graph3d.RenderLite={},we=new Array(0),Pg=pn.Buffer=function(b,v,k,r){this.gl=b,this.buffer=b.createBuffer(),this.type=v||b.ARRAY_BUFFER,this.drawType=r||b.STATIC_DRAW,this.data=we,k&&this.upload(k)};Pg.prototype.upload=function($,q,J){J||this.bind();var b=this.gl;$=$||this.data,q=q||0,this.data.byteLength>=$.byteLength?b.bufferSubData(this.type,q,$):b.bufferData(this.type,$,this.drawType),this.data=$},Pg.prototype.bind=function(){var e=this.gl;e.bindBuffer(this.type,this.buffer)},Pg.createVertexBuffer=function(e,l,n){return new Pg(e,e.ARRAY_BUFFER,l,n)},Pg.createIndexBuffer=function(U,q,Z){return new Pg(U,U.ELEMENT_ARRAY_BUFFER,q,Z)},Pg.create=function(k,c,C,r){return new Pg(k,c,r)},Pg.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Lb=pn.Shader=function(q,B,T){this.gl=q,this.program=_e(q,B,T),this.attributes=Qb(q,this.program);var v=Ih(q,this.program);this.uniforms=Jr(q,v)};Lb.prototype.bind=function(){this.gl.useProgram(this.program)},Lb.prototype.destroy=function(){this.gl};var _e=function(x,C,J){var L=el(x,x.VERTEX_SHADER,C),p=el(x,x.FRAGMENT_SHADER,J),P=x.createProgram();return x.attachShader(P,L),x.attachShader(P,p),x.linkProgram(P),x.getProgramParameter(P,x.LINK_STATUS)||(mg("LINK","LITE",x.getProgramParameter(P,x.VALIDATE_STATUS),x.getError(),x.getProgramInfoLog(P)),x.deleteProgram(P),P=null),x.deleteShader(L),x.deleteShader(p),P},el=function(S,T,H){var q=S.createShader(T);return S.shaderSource(q,H),S.compileShader(q),S.getShaderParameter(q,S.COMPILE_STATUS)?q:(mg("COMPILE","LITE",T,S.getError(),S.getShaderInfoLog(q)),null)},Ih=function(L,x){for(var B={},p=L.getProgramParameter(x,L.ACTIVE_UNIFORMS),v=0;p>v;v++){var g=L.getActiveUniform(x,v),N=g.name.replace(/\[.*?\]/,""),K=os(L,g.type);B[N]={type:K,size:g.size,location:L.getUniformLocation(x,N),value:El(K,g.size)}}return B},Qb=function(L,B){for(var i={},$=L.getProgramParameter(B,L.ACTIVE_ATTRIBUTES),x=0;$>x;x++){var k=L.getActiveAttrib(B,x),d=os(L,k.type);i[k.name]={type:d,size:yg(d),gl:L,location:L.getAttribLocation(B,k.name),pointer:Gf}}return i},Gf=function(W,q,i,P,u){var S=this.gl;S.enableVertexAttribArray(this.location),W instanceof pn.Buffer||(W=pn.Buffer.createVertexBuffer(S,W)),S.bindBuffer(W.type,W.buffer),S.vertexAttribPointer(this.location,this.size,q||S.FLOAT,i||!1,P||0,u||0)},yg=function(Y){return so[Y]},so={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},os=function(D,i){if(!Dl){var Y=b.keys(Ej);Dl={};for(var f=0;f<Y.length;++f){var n=Y[f];Dl[D[n]]=Ej[n]}}return Dl[i]},Dl=null,Ej={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},El=function(m,c){switch(m){case"float":return 0;case"vec2":return new Float32Array(2*c);case"vec3":return new Float32Array(3*c);case"vec4":return new Float32Array(4*c);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*c);case"ivec3":return new Int32Array(3*c);case"ivec4":return new Int32Array(4*c);case"bool":return!1;case"bvec2":return je(2*c);case"bvec3":return je(3*c);case"bvec4":return je(4*c);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},je=function(j){for(var X=new Array(j),l=0;l<X.length;l++)X[l]=!1;return X},Jr=function(R,q){var m={data:{}};m.gl=R;for(var H=b.keys(q),I=0;I<H.length;I++){var u=H[I],C=u.split("."),v=C[C.length-1],z=Tc(C,m),K=q[u];z.data[v]=K,z.gl=R,b.defineProperty(z,v,{get:qr(v),set:wm(v,K)})}return m},qr=function(I){var Z=Jg.replace("%%",I);return new Function(Z)},wm=function(G,l){var K,g=qe.replace(/%%/g,G);return K=1===l.size?gk[l.type]:cn[l.type],K&&(g+="\nthis.gl."+K+";"),new Function("value",g)},Tc=function(D,L){for(var J=L,c=0;c<D.length-1;c++){var M=J[D[c]]||{data:{}};J[D[c]]=M,J=M}return J},Jg=["return this.data.%%.value;"].join("\n"),qe=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),gk={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},cn={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Xl=function(J){function R(Y){if("string"!=typeof Y)return 0|Y;switch(Y){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var a=this;a.enable=!1;var Q,j,D,Z,N=E.graph3dViewShadowType,F=E.graph3dViewShadowIntensity,L=E.graph3dViewShadowBias,z=E.graph3dViewShadowQuality,O=E.graph3dViewShadowRadius,P=E.graph3dViewShadowDegreeX,w=E.graph3dViewShadowDegreeZ,l=1,q=R(z),$=!1,G=new S.Math.Matrix4,n=new S.Math.Matrix4,m=a.pvMatrix=new S.Math.Matrix4,_=0;a.render=function(){if(!J._picking&&a.enable){var R=J.getGL();if(R){if($&&a.setupShadowCamera(),J._glCapabilities&&(q=Math.min(q,J._glCapabilities.maxTextureSize)),Z=J.isReflecting(R)){if(_===R._renderInfo.frame)return;_=R._renderInfo.frame}var o=Z?"mapForReflector":"map";if((Q=a[o])?Q.setSize(q,q):Q=a[o]=new Rj(J,J.getGL(),0,0,{samples:1,minFilter:Hh.NEAREST,magFilter:Hh.NEAREST,width:q,height:q}),!R._shadowShader){var A="#define MAX_BOX_CLIPPER "+J._boxClippers.length;R._shadowShader=new pn.Shader(R,Xl.shaderSrc.vs.replace("$DEFINE",A),Xl.shaderSrc.fs.replace("$DEFINE",A))}var l=J._frameState,c=l.renderState.glState;c.blend.enabled=!1,c.depth.enabled=!0,c.depth.mask=!0;var T=c.color.clear.slice(0);ih(R,[1,1,1,1]),l.renderState.useProgram(R._shadowShader.program),U(),ih(R,T)}}},a.deleteShadowProgram=function(){var d=J.getGL();d&&d._shadowShader&&(d.deleteProgram(d._shadowShader.program),d._shadowShader=null)},a.getShadow=function(){var J={degreeX:P,degreeZ:w,intensity:F,quality:z,type:N,radius:O,bias:L};return 1!==l&&(J.boundExtend=l),J},a.setShadow=function(h,H){h=!!h;var $=a.enable!==h;a.enable=h,"object"==typeof H&&(H.intensity!==p&&(F=H.intensity),H.bias!==p&&(L=H.bias),H.radius!==p&&(O=H.radius),H.degreeX!==p&&(P=H.degreeX),H.degreeZ!==p&&(w=H.degreeZ),H.quality!==p&&(z=H.quality),H.type!==p&&N!==H.type&&(N=H.type,$=!0),q=R(z),H.boundExtend!==p&&(l=H.boundExtend)),h&&a.setupShadowCamera(),$&&Vf(J),J.iv()},a.refresh=function(){this.enable&&(this.setupShadowCamera(),J.iv())},a.tryUpdateBounding=function(T){var A=this.boundingSphere;if(A){var Z=(new Qk).fromArray(ec(T,J.getMat(T))),y=T.getAnchor3d(),f=new Zh;A.containsPoint(f.set(0-y.x,0-y.y,0-y.z).applyMatrix4(Z))&&A.containsPoint(f.set(0-y.x,0-y.y,1-y.z).applyMatrix4(Z))&&A.containsPoint(f.set(0-y.x,1-y.y,0-y.z).applyMatrix4(Z))&&A.containsPoint(f.set(0-y.x,1-y.y,1-y.z).applyMatrix4(Z))&&A.containsPoint(f.set(1-y.x,0-y.y,0-y.z).applyMatrix4(Z))&&A.containsPoint(f.set(1-y.x,0-y.y,1-y.z).applyMatrix4(Z))&&A.containsPoint(f.set(1-y.x,1-y.y,0-y.z).applyMatrix4(Z))&&A.containsPoint(f.set(1-y.x,1-y.y,1-y.z).applyMatrix4(Z))||a.setupShadowCamera()}},a.createShadow=function(p){if(p||(p=J._frameState.renderState.directUniforms()),p.shadowMatrix=m.toArray(),J._getFrameRenderOptions("renderShadow")===!1)p.shadowMap=J.getGL()._emptyTexture;else{var H=J._getFrameRenderOptions("useReflectorSelfShadowMap")&&a.mapForReflector;p.shadowMap=H?a.mapForReflector.texture:a.map.texture}p.shadowSize=[Q.width,Q.height],p.shadowIntensity=F,p.shadowBias=L,p.shadowRadius=O},a.genShaderDefine=function(){var O="#define USE_SHADOWMAP\n";return"hard"===N?O+="#define SHADOWMAP_TYPE_PCF\n":"soft"===N&&(O+=J.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),O};var H;a.setupShadowCamera=function(){j||(j=a.boundingSphere=new S.Math.Sphere),$=!1;var T,p,N=J.getBoundingBox(J.dm().toDatas(function(x){return x.s("shadow.cast")&&J.isVisible(x)}));N?(T=new Zh(N.min),p=new Zh(N.max)):(T=new Zh(-256,-256,-256),p=new Zh(256,256,256),$=!0),j.set(T.clone().add(p).multiplyScalar(.5),.5*T.distanceTo(p)*l);var b,y=j.radius,F=J.getBoundingBox(J.dm().toDatas(function(W){return(W.s("shadow.cast")||W.s("shadow.receive"))&&J.isVisible(W)}));if(F){T.copy(F.min),p.copy(F.max);var V=.5*T.distanceTo(p);b=V+Math.min(V,y+j.center.distanceTo(T.add(p).multiplyScalar(.5)))}else b=2*y;H=rl(df(),-y,y,-y,y,b/1e3,b),m.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),m.multiply(G.fromArray(H));var u=Math.tan(-P*Math.PI/180),e=Math.tan(-w*Math.PI/180),D=y/Math.sqrt(u*u+e*e+1),h=new Zh(D*u,D,D*e);G.lookAt(h,new Zh(0,0,0),new Zh(0,1,0)).setPosition(h.add(j.center)),G.getInverse(G),m.multiply(G)};var U=function(){var S=J.getGL(),V=q,x=q;Q.setSize(S,V,x),Q.bind(S),S.clear(Hh.COLOR_BUFFER_BIT|Hh.DEPTH_BUFFER_BIT);var P=J._frameState,p=P.renderState,e=p.directUniforms(),h=p.directAttribs(),v=p.directState();e.projectionMatrix=H,(D=J._boxClippers.length>0)&&(e.uEnableBoxClip=!1,e.uClipperMatrix=J._boxClipperMatrixes,e.uClipperClipInner=J._boxClipperClipInner);var u=J._viewport;J.setViewport(S,0,0,V,x);var f,z,O,T;for(f=0,z=Vk.length;z>f;f++)if(O=Vk[f],!Ki[O].ignore&&(T=J._40Q.get(O))){var m=T.batchIndexMap;a.renderItems(S,e,h,v,T.opaque,m),a.renderItems(S,e,h,v,T.transparent,m),a.renderBatch(S,e,h,v,T.batchModelMap,m)}Q.unbind(S),J.setViewport(S,u[0],u[1],u[2],u[3])};a._renderDirect=function(w,$,Q,Z){Q&&Q.length&&($.position=jj(w,J._buffer.vs,Q,X),Z?(nb(w,J._buffer.is,Z),Ri(w,0,Z.length,null,Z instanceof Uint32Array?w.UNSIGNED_INT:null)):Kl(w,0,Q.length/3))},a.renderShapeModel=function(f,n,k,J){var M,c,s;if(Kc(k))for(c=0,s=k.length;s>c;c++)M=k[c],M&&a.renderShapeModel(f,n,M,J);else tc(k)?a.renderShapeModel(f,n,Lh(J,k),J):Mj(k)&&(k.shape3d?a.renderShapeModel(f,n,k.shape3d,J):a.renderShapeModelImpl(f,n,k))},a.renderShapeModelImpl=function(f,c,U){qn(U),a._renderDirect(f,c,U.vs,U.is),a._renderDirect(f,c,U.top_vs,U.top_is),a._renderDirect(f,c,U.bottom_vs,U.bottom_is),a._renderDirect(f,c,U.from_vs,U.from_is),a._renderDirect(f,c,U.to_vs,U.to_is)},a.renderBatch=function(B,d,I,P,g){if(!Ub(g)&&!J.drawFilter){d.modelViewMatrix=n.identity().premultiply(G).toArray();var N,A,o;for(N in g)o=J.getBatchInfo(N)||Xr,o.visible!==!1&&o.shadowCast!==!1&&(Z&&o.reflectable===!1||(A=g[N],A.invalidate&&ds(A),D&&(d.uEnableBoxClip=o.clipboxEnabled!==!1),a._renderDirect(B,I,A.vs32,A.is)))}},a.renderItems=function(q,h,B,L,C,g){var A,V,m,d,k,$,r=C.length;for(A=0;r>A;A++)if(V=C[A],d=V.ui,m=V.data,!(rh(m)||!m.s("shadow.cast")||m instanceof Sq||!J.isVisible(m)||g[m._id]||Z&&m.s("3d.reflectable")===!1)){var W=d.s("3d.clip.direction");if(W){var M=d.s("3d.clip.percentage");if(0===M)continue;var R=d._formatClipUniforms(W,M,m);h.uClipPercent=R[1],h.uClipDirection=R[0]}else h.uClipDirection=0;k=d.shapeModel||Lh(d),k||(k=m instanceof S.Node&&!(m instanceof S.Shape)?{vs:vo,is:Te}:[d.left,d.front,d.right,d.back,d.top,d.bottom]),$=d.mat?n.fromArray(d.mat):n.identity(),D&&(h.modelMatrix=$.toArray(),h.uEnableBoxClip=m.s("3d.clipbox.enabled")&&!m.s("3d.clipbox")),h.modelViewMatrix=$.premultiply(G).toArray(),L.cullFace.enabled=!!m.s("shape3d.reverse.cull"),a.renderShapeModel(q,B,k,d)}}};Xl.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform bool uEnableBoxClip;","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","if (uEnableBoxClip) {","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin)))) { discard; return; }","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Xl.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var cg=function(H){function K(_,U,D,x,M){var y=H.getData3dUI(D),A=y.s("shape3d");if("billboard"===A||"plane"===A){var q;(q=P[U])||(q=P[U]=new Rj(H));var Z=D.s("effect.flow.size"),e=D.s("effect.flow.uvshape");q.setSize(_,Z,Z),q.bind(_);var Q=H.getViewport(_);H.setViewport(_,0,0,Z,Z),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT);var W,y=H.getData3dUI(D),T=Lh(y,A);if(!T)return!1;!T.ns&&T.length&&(T=T[0]),W=T.vs;var n,B=D.s("effect.flow.gradient");if(B){if(n="Flow3d.Cached."+B,!S.Default.getImage(n)){var d=100;S.Default.setImage(n,S.Default.toCanvas({width:d,height:d,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:B,rect:[0,0,d,d]}]},d,d))}}else n=D.s("shape3d.image");x.useXZ="plane"===A,x.image=H.getTexture(n,D),x.uvMatrix=Nn(y.s("shape3d.uv.rotation"),y.s("shape3d.uv.offset"),y.s("shape3d.uv.scale"),u).toArray9();var a=G.indexOf(e);-1===a&&0===e.indexOf("polygon")&&(a=yc(1*e.substring(7),3,1024)-1),x.shape=a,M.position=jj(_,null,W,X,3),Kl(_,0,W.length/3),q.unbind(_),H.setViewport(_,Q[0],Q[1],Q[2],Q[3]);var R=D.getMatrix4();R.getInverse(R);var N=R.getElements();"plane"===A?N[1]=N[5]=N[9]=N[13]=0:N[2]=N[6]=N[10]=N[14]=0,g[U]={matrix:R,group:D.s("effect.flow.group")}}}var u,l=this,P=this.renderTargetPool=[],g=[],G=["rect","circle","polygon"];l.render=function(){if(!H._picking){var w=H._flowObjects;if(w.length){var M=H.getGL();if(M){var t;(t=M._flowShader)||(t=M._flowShader=new pn.Shader(M,cg.shaderSrc.vs,cg.shaderSrc.fs));var N=H._frameState.renderState,j=N.glState;j.blend.enabled=!1,j.depth.enabled=!1;var G=j.color.clear.slice(0);ih(M,[0,0,0,1]),N.useProgram(t.program);var X,z,A=N.directUniforms(),I=N.directAttribs();for(X=0,z=w.length;z>X;X++)K(M,X,w[X],A,I);ih(M,G),P.length!==z&&P.splice(z,P.length-z)}}}},l.createFlow=function(z){var J;if(J=P.length){z||(z=H._frameState.renderState.directUniforms());for(var T=[],O=[],c=[],D=0;J>D;D++)T[D]=g[D].matrix.toArray(),O[D]=P[D].texture,c[D]=!1;z.flowMatrix=T,z.flowTexture=O,z.flowEnabled=c}},l.disableFlow=function(d){var D;if(D=P.length){d||(d=H._frameState.renderState.directUniforms());for(var G=[],C=0;D>C;C++)G[C]=!1;d.flowEnabled=G}},l.resetDataFlowEnabld=function(J,V){var L=J.s("effect.flow.mask"),d=P.length,x=new Array(d);if(L)for(var q=0;d>q;q++)L&1<<g[q].group&&(x[q]=!0);V.flowEnabled=x}};cg.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","gl_FragColor = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy));","}"].join("\n")};var kg=function($){this.gv=$,this.onMouseOver=this.onMouseOver.bind(this),this.mode=kg.Mode.Style,this.type=G["highlight.type"],this.color=G["highlight.color"],this.width=G["highlight.width"],this.glow=G["highlight.glow"],this.strength=G["highlight.strength"]};kg.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},cm.ms_highlight=function(u){u.setHighlightMode=function(F){var N;N="selection"===F||"selected"===F?kg.Mode.Selection:"mouseover"===F||"hover"===F?kg.Mode.MouseOver:"style"===F?kg.Mode.Style:kg.Mode.Disable;var E=this.getHighlightMode();this._highlightHelper.mode=N,this.firePropertyChange("highlightMode",E,F)},u.getHighlightMode=function(){var Q=this._highlightHelper.mode;return Q===kg.Mode.Selection?"selected":Q===kg.Mode.MouseOver?"hover":Q===kg.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(M){var r=M.replace(/(^|\.)[a-z]/g,function(f){return f[f.length-1].toUpperCase()});u["getHighlight"+r]=function(){return this._highlightHelper[M]},u["setHighlight"+r]=function(j){var Y=this._highlightHelper,u=Y[M];j!==u&&(Y[M]=j,this.firePropertyChange("highlight"+r,u,j))}})},Wi(kg,b,{onMouseOver:function(q){E.preventDefault(q);var p=this.gv;if(!p._48Q){var c=p.getDataAt(q);c!==this.mouseOverData&&(this.mouseOverData=c,p.iv())}},setFetchTargetFunc:function(d){this.fetchTargetFunc=d},_42:function(l,P){var L,f,Y=this,A=Y._mode,k=Y.gv;if(!l._renderInfo.reflectDepth&&A!==kg.Mode.Disable){if(A===kg.Mode.Selection?L=k.sm().getSelection().toArray(function(j){return j.s("highlight.visible")}):A===kg.Mode.MouseOver&&Y.mouseOverData&&Y.mouseOverData.s("highlight.visible")&&(L=[Y.mouseOverData]),Y.fetchTargetFunc&&(L=Y.fetchTargetFunc(L)),A===kg.Mode.Style)L=L||[],f=function(S){if(L.indexOf(S)>=0)return!1;var l=k.getDataHighlightMode(S);return l===!1?!0:l===!0?!1:"selected"===l?k.isSelected(S)?!1:!0:"hover"===l?S===Y.mouseOverData?!1:!0:!0};else{if(!L||!L.length)return;f=function(Y){return L.indexOf(Y)<0?!0:void 0}}var C=k.isVRPresenting(),x=k.getWidth();if(C){var F=k.getWidth;x/=2,k.getWidth=function(){return x};var N=k.getViewport()}var i,u=k.getDevicePixelRatio(),W=Math.floor(x*u),U=Math.floor(k.getHeight()*u);(i=Y._renderTarget)?i.setSize(l,W,U):Y._renderTarget=i=new Gq.RenderTarget(k,l,W,U);var $="soft"===Y.type;if(i.bind(l),$){var b=l.getParameter(l.COLOR_CLEAR_VALUE);ih(l,[1,1,1,1]),l.clear(l.COLOR_BUFFER_BIT),ih(l,b)}else l.clear(l.COLOR_BUFFER_BIT);k.setViewport(l,0,0,W,U),k.drawFilter=f,dl=function(V,Q,A,v,X,J){var f=[A?0:1,1,1,1];return J||(is.for(V).directUniforms().uFixPickReverseColor=f),f},k.renderPickScene(),dl=up,k.drawFilter=null,i.unbind(l),Ao&&Fj(l,P.aPosition),Fj(l,P.aNormal),C&&(k.getWidth=F,k.setViewport(l,N[0],N[1],N[2],N[3]));var M=k.getHighlightColor();if(Y._lastHighlightColor!==M){var o=wb(Y._lastHighlightColor=M);Y._highlightColorData=[o[0]/255,o[1]/255,o[2]/255,o[3]/255]}return $?Y.renderSoftOutline(l,W,U):Y.renderHardOutline(l,W,U),l.useProgram(P=k._prg),Ao&&Rf(l,P.aPosition),!0}},_assureShader:function(Z,N){var x=Z._compiledShader[N];return x||(x=Z._compiledShader[N]=new pn.Shader(Z,kg.CommonShaderVs,kg[N].fs)),x},renderHardOutline:function(Y,L,A){var o=this,g=o.gv,N=g._postProcessing,e=is.for(Y),d=e.directState();d.blend.enabled=!0,d.depth.enabled=!1,N.blitScreen(null,o._renderTarget.texture,o._assureShader(Y,"HighlightHard"),{textureSize:[L,A],edgeWidth:g.getHighlightWidth(),edgeColor:o._highlightColorData},{clear:!1}),d.blend.enabled=!1,d.depth.enabled=!0},renderSoftOutline:function(z,e,o){var C,v,m,k,n,G=this,W=G.gv,d=W._postProcessing,J=Math.floor(e/2),X=Math.floor(o/2),I=Math.floor(e/4),u=Math.floor(o/4),D=G._downSampleRenderTarget;D?(C=G._edgeDetectionRenderTarget,v=G._blurV2,m=G._blurH2,k=G._blurV4,n=G._blurH4,(D.width!==J||D.height!==X)&&(D.setSize(J,X),C.setSize(J,X),v.setSize(J,X),m.setSize(J,X),k.setSize(I,u),n.setSize(I,u))):(D=G._downSampleRenderTarget=new Gq.RenderTarget(W,z,J,X),C=G._edgeDetectionRenderTarget=new Gq.RenderTarget(W,z,J,X),v=G._blurV2=new Gq.RenderTarget(W,z,J,X),m=G._blurH2=new Gq.RenderTarget(W,z,J,X),k=G._blurV4=new Gq.RenderTarget(W,z,I,u),n=G._blurH4=new Gq.RenderTarget(W,z,I,u));var $=z.getParameter(z.COLOR_CLEAR_VALUE),r=W.getViewport(),Z=G.width,L=G.strength,Q=G.glow,x=is.for(z).glState,w=x.depth,s=x.blend,U=w.enabled;ih(z,[1,1,1,1]),w.enabled=!1,s.apply({func:[z.SRC_ALPHA,z.ONE]}),d.blitScreen(D,G._renderTarget.texture),d.blitScreen(C,D.texture,G._assureShader(z,"EdgeDetection"),{texSize:[J,X],color:G._highlightColorData}),d.blitScreen(m,C.texture,G._assureShader(z,"Blur"),{direction:[1,0],texSize:[J,X],radius:Z}),d.blitScreen(v,m.texture,G._assureShader(z,"Blur"),{direction:[0,1],texSize:[J,X],radius:Z}),d.blitScreen(n,v.texture,G._assureShader(z,"Blur"),{direction:[1,0],texSize:[I,u],radius:Z}),d.blitScreen(k,n.texture,G._assureShader(z,"Blur"),{direction:[0,1],texSize:[I,u],radius:Z}),s.apply({enabled:!0}),W.setViewport(z,r[0],r[1],r[2],r[3]),d.blitScreen(null,G._renderTarget.texture,G._assureShader(z,"BlendTogether"),{edgeTexture1:v.texture,edgeTexture2:k.texture,edgeStrength:L*Z,edgeGlow:Q},{clear:!1}),s.apply({func:[z.SRC_ALPHA,z.ONE_MINUS_SRC_ALPHA,z.ONE,z.ONE_MINUS_SRC_ALPHA]}),w.enabled=U,ih(z,$)}}),b.defineProperties(kg.prototype,{mode:{get:function(){return this._mode},set:function(U){var Q=this._mode;if(U!==Q){this._mode=U;var f=Q===kg.Mode.MouseOver||Q===kg.Mode.Style,n=U===kg.Mode.MouseOver||U===kg.Mode.Style;n&&f||(f&&O(this.gv.getView(),"mousemove",this.onMouseOver),n&&q(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),kg.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),kg.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},kg.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},kg.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},kg.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var uk=S.Light=function(){jl(uk,this),this.s(Tg,G[Tg]),this.s(Yp,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Ef("Light",vd,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(G,I,T){uk.superClass.onStyleChanged.apply(this,arguments),G===Tg&&this.s("shape3d.color",T)}});var bm=Gq.FrameState=function(J,x){this.renderState=is.for(x),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=p,this.projectMatrix=p,this.viewMatrix=p,this.view=J,this.defaultProgram=p,this.pickColorMap=p,this._pvStack=[],this._renderStateStack=[]};bm.prototype.savePV=function(){var j=this.view;this._pvStack.push([le(this.projectMatrix),le(this.viewMatrix),j._18Q,le(j._7O)])},bm.prototype.restorePV=function(){var p=this._pvStack.pop();if(p){var R=this.view;this.projectMatrix=R._projectMatrix=p[0],this.viewMatrix=R._viewMatrix=p[1],R._18Q=p[2],R._7O=p[3]}},bm.prototype.setPV=function(b,$){var K=this.view,o=!1;if(b&&(this.projectMatrix=K._projectMatrix=b,o=!0),$&&(this.viewMatrix=K._viewMatrix=$,K._7O=le($),o=!0),o){var a=K.getWidth(),g=K.getHeight(),X=le(this.projectMatrix);K._18Q=sm(X,X,$),K._18Q._wh=a/g}},bm.prototype.syncEnv=function(e){var O=this,g=O.view;O.envmapReflectivity=g._envmapReflectivity||.5,O.cameraPosition=g.getEye(),O.projectMatrix=g._projectMatrix,O.viewMatrix=g._viewMatrix,O.pickColorMap=e,O.picking=g.getGL()._picking},bm.prototype.setGLState=function(){var G=[0,0,0,0],e=[!0,!0,!0,!0],K=[-1,1],Z=[Hh.FUNC_ADD,Hh.FUNC_ADD],n=[Hh.SRC_ALPHA,Hh.ONE_MINUS_SRC_ALPHA,Hh.ONE,Hh.ONE_MINUS_SRC_ALPHA];return function(i,B){var T=this,U=T.renderState.gl,Q=T.renderState.glState;Q.dither=!1,B?Q.color.mask=e:Q.color.reset(),Q.pixelStore.reset(),Q.blend.color=G,Q.blend.equation=Z,Q.blend.func=n,Q.cullFace.enabled=!1,Q.scissor.enabled=!1,Q.depth.enabled=!0,Q.depth.clear=1,Q.depth.func=U.LEQUAL,Q.depth.range=K,Q.stencil.enabled=!1,Q.polygonOffset.enabled=!1,i?(Q.depth.mask=!1,Q.blend.enabled=!0):(Q.depth.mask=!0,Q.blend.enabled=!1)}}(),bm.prototype.setUniforms=function(J){var W=this,C=W.view,x=W.renderState,$=x.gl,X=x.uniforms;X.uBrightness=1,X.uOpacity=1,X.uPartOpacity=1,X.uPick=W.picking,X.uTexture=!1,X.uBlendTexture=!1,X.uAlphaTest=G.alphaTest,X.uTransparent=!!J,X.uFix=!1,X.uBatchColor=!1,X.uBatchBlend=!1,X.uBatchBrightness=!1,X.uReflectivity=W.envmapReflectivity||.5,X.uCameraPosition=W.cameraPosition,X.uPMatrix=W.projectMatrix,X.uViewMatrix=W.viewMatrix,X.uEnvMap=null,X.uEnableBoxClip=!1,X.uClipperMatrix=C._boxClipperMatrixes,X.uClipperClipInner=C._boxClipperClipInner,C._envmapRenderer.resetUniformCache(),W.picking||(Pr(C,$,p),C._fogDisabled||(X.uFogColor=C._fogColor,X.uFogDensity=C._fogDensity,X.uFogNear=C._fogNear,X.uFogFar=C._fogFar))},bm.prototype.drawLayer=function(O){return this.view.renderLayers(O,!0)},bm.prototype.drawData=function(M,h,Q){var j=this.view;if(j.isVisible(M)){var V=this.renderState,u=V.uniforms,I=j.getData3dUI(M);if(I){var d=V.gl,z=d._picking,T=j._picking,N=M._pickId;Q&&(M._pickId=Q),u.uPick=d._picking=j._picking=!!Q,u.uTransparent=!!h,I._42(V.gl,V.program,h?l:A),u.uPick=d._picking=z,j._picking=T,M._pickId=N}}};var zp=Gq.Graph3dView=function(Y,W){var w=this;w._webGLVersion=1,w._attributes=W||E.graph3dViewAttributes,w._25I={},w._view=Mn(1,w);var Q=w._canvas=_i(w._view);q(Q,"webglcontextlost",function(P){P.preventDefault(),Vf(w),w._26I&&w._doBufferGC(w._26I,!0),w._26I=X,w._1o.onContextLost(),w._35O=!0}),q(Q,"webglcontextrestored",function(){w._35O=!1,w.iv()}),w._40Q=new tr,w._43Q={},w._44Q=-1,w._batchIndexMap={},w._batchModelMap={},w._wireframeIndexMap={},w._wireframeModelMap={},w._wireframeIndexMapSwap={},w._wireframeModelMapSwap={},w._polylineIndexMap={},w._polylineIndexMap={},w._polylineIndexMapSwap={},w._polylineIndexMapSwap={},w._8O=[],w._7O=df(),w._6O=df(),w._1o=new Ds(w),w._30O=new Gs(w),w._31O=new Es(w),w._32O=new Fs(w),w._raycaster=new Rs(w),w._highlightHelper=new kg(w),w._postProcessing=new _s(w),w._41Q=[],w._42Q=0,w._frameRenderOptionStack=[],Gq.VR?(w.vr=new Gq.VR(w),w.isVREnabled=function(){return this.vr.enable
},w.isVRPresenting=function(){return this.vr.isPresenting()}):(w.vr={enable:!1,isPresenting:U},w.isVREnabled=U,w.isVRPresenting=U),w.shadowMap=new Xl(w),w.flowMap=new cg(w),w._33Q=!0,w._eye=Nq(E.graph3dViewEye),w._center=Nq(E.graph3dViewCenter),w._up=Nq(E.graph3dViewUp),w._lightChanged=!1,w._59O=[],w._spots=[],w._dirs=[],w._boxClippers=[],w._flowObjects=[],w._frameId=0,w._picking=!1,w._batchInfoMap={},w.overlappingBox=new hc(w),w.dm(Y?Y:new pf),w._coreInteractor=new Xj(this),w._envmapRenderer=new Gq.EnvmapRenderer(this),w.setInteractors([new Dd(w)]),w._initView()},Vr={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Tp=0;de("Graph3dView",b,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",rq,cb,"firstPersonMode",Bj,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",kj,Yn,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:E.graph3dViewSortable,_editHelperDisabled:E.graph3dViewEditHelperDisabled,_blockSelectable:E.graph3dViewBlockSelectable,_devicePixelRatio:p,_boundaries:p,_moveStep:E.graph3dViewMoveStep,_rotateStep:E.graph3dViewRotateStep,_rotateMinPhi:E.graph3dViewMinPhi===p?E.graph3dViewRotateMinPhi:E.graph3dViewMinPhi,_rotateMaxPhi:E.graph3dViewMaxPhi===p?E.graph3dViewRotateMaxPhi:E.graph3dViewMaxPhi,_pannable:E.graph3dViewPannable,_rotatable:E.graph3dViewRotatable,_walkable:E.graph3dViewWalkable,_resettable:E.graph3dViewResettable,_zoomable:E.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:E.graph3dViewFirstPersonMode,_mouseRoamable:E.graph3dViewMouseRoamable,_gridVisible:E.graph3dViewGridVisible,_gridSize:E.graph3dViewGridSize,_gridGap:E.graph3dViewGridGap,_gridColor:E.graph3dViewGridColor,_originAxisVisible:E.graph3dViewOriginAxisVisible,_centerAxisVisible:E.graph3dViewCenterAxisVisible,_axisXColor:E.graph3dViewAxisXColor,_axisYColor:E.graph3dViewAxisYColor,_axisZColor:E.graph3dViewAxisZColor,_ortho:E.graph3dViewOrtho,_orthoWidth:E.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:E.graph3dViewSyncEyeWithOrthoWidth,_fovy:E.graph3dViewFovy,_near:E.graph3dViewNear,_far:E.graph3dViewFar,_headlightColor:E.graph3dViewHeadlightColor,_headlightIntensity:E.graph3dViewHeadlightIntensity,_headlightRange:E.graph3dViewHeadlightRange,_headlightGroup:E.graph3dViewHeadlightGroup,_headlightAmbientIntensity:E.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:E.graph3dViewHeadlightDisabled,_rectSelectable:E.graph3dViewRectSelectable,_rectSelectBackground:E.graph3dViewRectSelectBackground,_editSizeColor:E.graph3dViewEditSizeColor,_autoMakeVisible:Hc,_fogDisabled:E.graph3dViewFogDisabled,_fogMode:E.graph3dViewFogMode,_fogDensity:E.graph3dViewFogDensity,_fogColor:E.graph3dViewFogColor,_fogNear:E.graph3dViewFogNear,_fogFar:E.graph3dViewFogFar,_pickerResolution:E.graph3dViewPickerResolution,_dashDisabled:E.graph3dViewDashDisabled,_batchColorDisabled:E.graph3dViewBatchColorDisabled,_batchBlendDisabled:E.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:E.graph3dViewBatchBrightnessDisabled,addCamera:function(G){var y=this,h=b.freeze({id:y._42Q++,priority:G.priority||0,ignoreInPick:!!G.ignoreInPick,render:G.render});G.switch3DStatus&&(y._43Q[h.id]=!0),y._41Q.push(h),y._41Q.sort(function(o,H){return o.priority!==H.priority?o.priority-H.priority:o.id-H.id})},setEye:function(R,v,a){1===arguments.length&&(v=R[1],a=R[2],R=R[0]);var I=this._eye;I[0]=R,I[1]=v,I[2]=a,this.fp(kj,X,I)},setCenter:function(b,Y,n){1===arguments.length&&(Y=b[1],n=b[2],b=b[0]);var A=this._center;A[0]=b,A[1]=Y,A[2]=n,this.fp(Yn,X,A)},setUp:function(q,W,b){1===arguments.length&&(W=q[1],b=q[2],q=q[0]);var d=this._up;d[0]=q,d[1]=W,d[2]=b,this.fp("up",X,d)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||yh},isTransparentMask:function(e){return e.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var j=this,V=j._aspect;return V?V:(V=j.getWidth()/j.getHeight(),V||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(n){var o=this,O=o._dataModel,K=o._selectionModel;O!==n&&(O&&(O.ump(o.handleDataModelPropertyChange,o),O.umm(o.handleDataModelChange,o),O.umd(o.handleDataPropertyChange,o),K||O.sm().ums(o.handleSelectionChange,o)),o._dataModel=n,n.mp(o.handleDataModelPropertyChange,o),n.mm(o.handleDataModelChange,o),n.md(o.handleDataPropertyChange,o),K?K._21I(n):n.sm().ms(o.handleSelectionChange,o),o._postProcessing.handleDataModleChange(O,n),o._tryInvalidateEnvmap(),o.invalidateAll(!0),o.invalidateLight(),o.invalidateboxClipper(),o.invalidateFlowObjects(),o._49Q(),o.fp(Zd,O,n),o._canvas.style.background=n.getBackground()||"")},handleDataModelPropertyChange:function(m){var h=m.property;if("background"===h){var r=this._canvas.style.background,F=m.newValue||"";this._canvas.style.background=F,this.fp("canvasBackground",r,F)}else"envmapType"===h?this._tryInvalidateEnvmap():"envmap"===h&&this.iv()},handleDataPropertyChange:function(v){var r=v.data;this.invalidateData(r);var q=v.property;rh(r)&&"s:light.type"===q?this.invalidateLight():"s:3d.clipbox"===q?this.invalidateboxClipper(r):"s:effect.flow"===q?this.invalidateFlowObjects(r):"s:shadow.cast"===q?this.shadowMap.tryUpdateBounding(r):"s:3d.visible"===q&&this.invalidateQuickVisible(r)},invalidateboxClipper:function(p){var j=this._boxClippers,T=j.length;if(p)if(p.s("3d.clipbox"))j.indexOf(p)<0&&j.push(p);else{var F=j.indexOf(p);F>=0&&j.splice(F,1)}else j=this._boxClippers=[],this.dm().each(function(x){x.s("3d.clipbox")&&j.push(x)});T!==j.length&&(Vf(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix()),this.iv()},_updateBoxClipperMatrix:function(){for(var S,B,J=this._boxClippers,j=this._boxClipperMatrixes=[],T=this._boxClipperClipInner=[],N=new Qk,v=0,p=J.length;p>v;v++)S=J[v],S.appendAnchorMatrix3d(B=ec(S,this.getMat(S))),j.push(N.getInverse(N.fromArray(B)).toArray()),T.push("inner"===S.s("3d.clipbox"))},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<E.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(q){var z=this._flowObjects,W=z.length;if(q)if(q.s("effect.flow"))z.indexOf(q)<0&&z.push(q);else{var E=z.indexOf(q);E>=0&&z.splice(E,1)}else z=this._flowObjects=[],this.dm().each(function(g){g.s("effect.flow")&&z.push(g)});W!==z.length&&Vf(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(W){var S=this,B=W.property;S.iv(),S._18Q=X,"eye"===B?S._33Q=!0:"devicePixelRatio"===B?S._42(S.getDevicePixelRatio()):Vr[B]&&Vf(S)},_5O:function(J){var D=J._22Q();return D?new D(this,J):X},getData3dUI:function(q){var b=this._25I[q._id];return b===p&&(b=this._5O(q),this._25I[q._id]=b),b},invalidateAll:function(N){var h=this;if(N){for(var Y in h._25I){var c=h._25I[Y];c&&c.dispose()}h._25I={},h.iv(),Mm(h)}else Mm(h),h.dm().each(function(z){h.invalidateData(z)})},invalidateSelection:function(){var y=this;y.sm().each(function(r){y.invalidateData(r)})},invalidateData:function($){var F=this,T=F.getData3dUI($);T&&(T.iv(),F.iv()),Mm(F,$)},getShape3dText:function(q){return q.getStyle("shape3d.text")||this.getLabel(q)},invalidateBatch:function(q){var B=this,m=B._40Q;m.each(function(W){B._invalidateBatch(W.batchModelMap,W.batchIndexMap,W.polylineModelMap,W.polylineIndexMap,W.wireframeModelMap,W.wireframeIndexMap,q),W.markBatchInvalid()})},_invalidateBatch:function(B,O,J,i,s,N,V){var h=this,Z=B[V],l=[],W={};if(Z){Z.ds.forEach(function(p){var g=h.getData3dUI(p);g&&g.iv(),delete O[p._id],l.push(p._id)}),delete B[V];for(var d,X,H,F,v,P,T,G,m,o=[s,J],y=[N,i],j=0;j<o.length;j++){var f=o[j],n=y[j];for(W={},G=0;G<l.length;G++){var $=n[l[G]];if($){delete n[l[G]],m=$.batch,d=f[m];var e=$.begin,a=$.size,I=3*e,g=3*a,C=4*e,K=4*a;for(X=d.ds,H=d.vs,F=d.cs,v=d.ps,P=d.ls,T=$.index,d.invalidate=!0,X[T]=p,T=I;I+g>T;T++)H[T]=p;for(T=C;C+K>T;T++)F[T]=p;for(T=C;C+K>T;T++)v[T]=p;if(P)for(T=I;I+g>T;T++)P[T]=p;W[m]=!0}}for(m in W){d=f[m],X=d.ds,H=d.vs,F=d.cs,v=d.ps,P=d.ls;var t=[];for(T=0;T<X.length;T++)X[T]!==p&&t.push(X[T]);if(0===t.length)delete f[m];else{for(d.ds=t,t=[],T=0;T<H.length;T++)H[T]!==p&&t.push(H[T]);for(d.vs=t,t=[],T=0;T<F.length;T++)F[T]!==p&&t.push(F[T]);for(d.cs=t,t=[],T=0;T<v.length;T++)v[T]!==p&&t.push(v[T]);if(d.ps=t,P){for(t=[],T=0;T<P.length;T++)P[T]!==p&&t.push(P[T]);d.ls=t}}}}h.iv()}},handleDataModelChange:function(e){var D=this,G=e.kind,v=e.data;if("add"===G)D.invalidateData(v),br(v)&&v.getEdgeGroup()&&v.getEdgeGroup().eachSiblingEdge(D.invalidateData,D),rh(v)&&D.invalidateLight(),v.s("3d.clipbox")&&D.invalidateboxClipper(v),v.s("effect.flow")&&D.invalidateFlowObjects(v),D._49Q();else if(G===Uc){var z=v._id,U=D._25I[z];U&&(U.dispose(),delete D._25I[z],D.iv()),v===D._currentSubGraph&&D.setCurrentSubGraph(X),Mm(D,v),rh(v)&&D.invalidateLight(),v.s("3d.clipbox")&&D.invalidateboxClipper(v),v.s("effect.flow")&&D.invalidateFlowObjects(v)}else G===ef&&(D.invalidateAll(!0),D.setCurrentSubGraph(X),Mm(D),D.invalidateLight(),D.invalidateboxClipper(),D.invalidateFlowObjects())},toCanvas:function(A,Z,r){var n=this,q=n.getGL();if(n.validate(),A){var Q=q.getParameter(q.COLOR_CLEAR_VALUE);ih(q,A)}n._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var N=n.getWidth()||1,D=n.getHeight()||1,v=new Uint8Array(4*N*D),o=_i(),W=o.getContext("2d");q.readPixels(0,0,N,D,q.RGBA,q.UNSIGNED_BYTE,v),zl(o,N,D,1);for(var t=W.getImageData(0,0,N,D),w=t.data,$=0;$<w.length;$+=4){var j=$/4,O=x(j/N),m=j-O*N;j=4*((D-1-O)*N+m),w[j]=v[$],w[j+1]=v[$+1],w[j+2]=v[$+2],w[j+3]=v[$+3]}if(W.putImageData(t,0,0),A&&ih(q,Q),n._42(n.getDevicePixelRatio()),Z&&r){var I=_i(),i=I.getContext("2d");return zl(I,Z,r,1),E.drawImage(i,o,0,0,Z,r),I}return o},toDataURL:function(f,H){var Y=this,w=Y.getGL();if(Y.validate(),f){var z=w.getParameter(w.COLOR_CLEAR_VALUE);ih(w,f)}Y._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var s=Y._canvas.toDataURL(H||"image/png",1);return f&&ih(w,z),Y._42(Y.getDevicePixelRatio()),s},getGL:function(){var P=this._26I;if(P)return this.acquireProgram(),P;if(!this._35O){var W=this,z=W._canvas,u=W._attributes;if(!u||u.requestWebGL2!==!1)try{P=z.getContext("webgl2",u)||z.getContext("experimental-webgl2",u),P&&(W._webGLVersion=2,W._26I=P)}catch(G){}if(!P)try{P=z.getContext("webgl",u)||z.getContext("experimental-webgl",u)}catch(G){throw new Error("WebGL not supported")}if(!P)throw new Error("WebGL not supported");W._26I=P;var Y=W._frameState=new bm(this,P);W._glExtensions=new L(P),W._glCapabilities=new C(P,W._glExtensions),W._2O={},P._emptyCubeTexture=tp(P),P._compiledShader={},P._emptyTexture=Bb(P),P._emptyBlendTexture=Bb(P),P._bufPool={},P._id=++Tp,Y.setGLState(),W._buffer={vs:Wp(P),ns:Wp(P),is:Wp(P),uv:Wp(P),batchColor:Wp(P),batchBlend:Wp(P),batchBrightness:Wp(P),lineDistance:Wp(P)},W._1O=gm(P);var n=W._cube={vs:Wp(P),ns:Wp(P),is:Wp(P),uv:Wp(P)};return Xm(P,n.vs,vo),Xm(P,n.ns,nm),Xm(P,n.uv,Db),pb(P,n.is,Te),W.acquireProgram(),P._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},P}},getGLCapabilities:function(){var t=this.getGL();return t?this._glCapabilities:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<E.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var a,j=this.dm();return j&&(a=j.getEnvmapType()),a||"legacy"},invalidateEnvmap:function(h){return this._envmapRenderer.invalidateEnvmap(h)},_setEnvmapByProbeId:function(D,B){return this._envmapRenderer.setEnvmapByProbeId(D,B)},_tryInvalidateEnvmap:function(){var $=this.getEnvmapType();$!==this._lastProgramEnvmapType&&(Vf(this),this.iv())},acquireProgram:function(){var w=this,c=w._26I;if(c&&!w._prg){var G=w._prg=c.createProgram();if(!G)return X;var Z=w._dirs.length,P=w._spots.length,J=w._59O.length,n=w._boxClippers.length,i=w._flowObjects.length,f=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];Z&&f.push("uDirColor","uDirDirection"),P&&f.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),J&&f.push("uPointColor","uPointRange","uPointPosition"),Ok||(gf=yj(gf.substring(0,gf.indexOf("^#"))),Ng=yj(Ng),Ok=!0);var I=w.getEnvmapType(),V=["#define MAX_DIR "+Z,"#define MAX_SPOT "+P,"#define MAX_POINT "+J,"#define MAX_BOX_CLIPPER "+n,"#define MAX_FLOW_OBJECT "+i,w._fogDisabled?"":"#define FOG","exp2"===w.getFogMode()?"#define FOG_EXP2":"",w._dashDisabled?"":"#define DASH","#define USE_ENVMAP","legacy"!==I?"#define ENVMAP_TYPE_CUBE_UV":"",w.isOrtho()?"#define ORTHOGRAPHIC":"",w._batchColorDisabled?"":"#define BATCHCOLOR",w._batchBlendDisabled?"":"#define BATCHBLEND",w._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",w.shadowMap.enable?w.shadowMap.genShaderDefine():"",""].join("\n"),S=oi(c,G,c.VERTEX_SHADER,gf.replace("PREFIX",V));c.getShaderParameter(S,c.COMPILE_STATUS)||mg("COMPILE",c.VERTEX_SHADER,c.getError(),c.getShaderInfoLog(S));var R=oi(c,G,c.FRAGMENT_SHADER,Ng.replace("PREFIX",V));if(c.getShaderParameter(R,c.COMPILE_STATUS)||mg("COMPILE",c.FRAGMENT_SHADER,c.getError(),c.getShaderInfoLog(R)),Ao?f.push("aPosition"):(G.aPosition=0,c.bindAttribLocation(G,0,"aPosition")),c.linkProgram(G),!c.getProgramParameter(G,c.LINK_STATUS)){var N=c.getProgramInfoLog(G);return w._prg=X,N.indexOf("maximum temp register")>=0&&!w._glTempRegisterLimited?(w._glTempRegisterLimited=!0,c.deleteProgram(G),w.acquireProgram()):(mg("LINK",c.getProgramParameter(G,c.VALIDATE_STATUS),c.getError(),N),c.deleteProgram(G),X)}f.forEach(function(S){G[S]=/^u/.test(S)?c.getUniformLocation(G,S):c.getAttribLocation(G,S)});var C=w._frameState;C.renderState.program=C.defaultProgram=G,w._envmapRenderer.changeEnvmapType(w._lastProgramEnvmapType=I),c.deleteShader(S),c.deleteShader(R)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(t){var I=t.s("brightness"),Q=this.isSelected(t)?t.s("select.brightness"):X;return I==X?Q:Q==X?I:I*Q},getDataHighlightMode:function(S){return S.s("highlight.mode")},getWireframe:function(g){var c=g.s("wf.visible"),m=g.s("wf.width");return c===!0||m>0&&"selected"===c&&this.isSelected(g)?{color:g.s("wf.color"),width:m,"short":g.s("wf.short"),mat:g.s("wf.mat")}:void 0},_transformPointToViewSpace:function(c){var I=[c[0],c[1],c[2]];return $c(I,this._viewMatrix),I},_transformDirectionToViewSpace:function(f,s){var z=[f[0],f[1],f[2]];$c(z,this._viewMatrix);var S=s?[s[0],s[1],s[2]]:[0,0,0];$c(S,this._viewMatrix);var p=S[0]-z[0],P=S[1]-z[1],G=S[2]-z[2],x=Math.sqrt(p*p+P*P+G*G);return x?[p/x,P/x,G/x]:[p,P,G]},getWireframeGeometry:function(I){return I.s("wf.geometry")?{color:I.s("wf.color"),width:I.s("wf.width"),mat:I.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(j){return j.s("body.color")},getMat:function(V){return V.getMat?V.getMat():V.s("mat")},getFaceMat:function(L,Z){return L.getFaceMat?L.getFaceMat(Z):L.s(Z+".mat")},getFaceBlend:function(G,$){return G.s($+".blend")||G.s("all.blend")},getFaceColor:function(P,B){return P.s(B+".color")||P.s("all.color")},getFaceImage:function(u,C){return u.s(C+".image")||u.s("all.image")},getFaceBlendImage:function(q,A){return q.s(A+".blend.image")||q.s("all.blend.image")},getFaceDiscardSelectable:function(d,f){var v=d.s(f+".discard.selectable");return v==X?d.s("all.discard.selectable"):v},getFaceUv:function(K,r){return K.s(r+".uv")||K.s("all.uv")},getFaceUvOffset:function(d,r){return d.s(r+".uv.offset")||d.s("all.uv.offset")},getFaceUvScale:function(q,S){return q.s(S+".uv.scale")||q.s("all.uv.scale")},getFaceUvRotation:function(D,m){return D.s(m+".uv.rotation")||D.s("all.uv.rotation")},getFaceLight:function(R,F){var M=R.s(F+".light");return M==X?R.s("all.light"):M},getFaceVisible:function(C,J){var T=C.s(J+".visible");return T==X?C.s("all.visible"):T},getFaceOpacity:function(G,W){var o=G.s(W+".opacity");return o==X?G.s("all.opacity"):o},getFaceTransparent:function(n,h){var I=n.s(h+".transparent");return I==X?n.s("all.transparent"):I},getFaceReverseColor:function(C,O){return C.s(O+".reverse.color")||C.s("all.reverse.color")},getFaceReverseFlip:function(M,z){var s=M.s(z+".reverse.flip");return s==X?M.s("all.reverse.flip"):s},getFaceReverseCull:function(T,S){var $=T.s(S+".reverse.cull");return $==X?T.s("all.reverse.cull"):$},getTextureMap:function(){return this._2O},_2Oi:function(e,l,C){C=C||"";var L;(L=this._2O[e])||(L=this._2O[e]={}),L[C]=l},deleteTexture:function(m){var v=this,J=v._2O[m];if(J){delete v._2O[m];var I=v.getGL();for(var s in J)I.deleteTexture(J[s])}},renderPickScene:function(){var Z=this.getGL();this.syncRenderState(),this._picking=Z._picking=!0,this.renderScene(),this._picking=Z._picking=!1},invalidateCachedTexture:function(q){var b=this.getData3dUI(q);b.invalidateCachedTexture(this.getGL()),this.invalidateData(q)},invalidateShape3dCachedImage:function(t){this.invalidateCachedTexture(t)},invalidateCachedGeometry:function(e){var d=this.getData3dUI(e);d.invalidateCachedGeometry(),this.invalidateData(e)},isInteractive:function(B){return B.s("interactive")},getTexture:function(h,_,G,w){if(!h)return X;var H,e,v=this,T=v.getGL(),Z=v._2O[h];if(Z&&(_&&(e=_.s("texture.mipmap.max")),H=Z[e||""]||Z.default),!H){var B=ir(h);if(w||(w={}),!B)return T._emptyTexture;if(_){w.mipmapMaxLevel=e=_.s("texture.mipmap.max");var W=_.s("texture.wrap");w.clampToEdge="clampToEdge"===W?!0:"repeat"===W?!1:p}if(B.uuid||(B.uuid=S.Math.generateUUID()),B.tagName){if(B.dynamic)return gm(T,B,v._1O,w);H=gm(T,B,p,w),v._2Oi(h,H,e)}else{var U,y=_&&(_.s("texture.cache")||_.s("shape3d.image.cache")||B.textureCache),F=v.isVRPresenting();if(F&&(_._textureUpdateFrame===T._renderInfo.frame?y=!0:_._textureUpdateFrame=T._renderInfo.frame),y&&(U=v.getData3dUI(_),H=U.getCachedTexture(G),H&&U.interactiveInfo&&H.interactiveInfo&&(U.interactiveInfo[H.interactiveInfo.key]=H.interactiveInfo.info)),!H){var i=T._renderInfo.textureCache;if(y){if(i.time>E.graph3dMaxVectorCacheTime)return v.redraw(),T._emptyTexture;if(!pq(B,_))return T._emptyTexture}var f;_&&(1!==_.s("texture.scale")?f=_.s("texture.scale"):1!==_.s("shape3d.texture.scale")&&(f=_.s("shape3d.texture.scale"))),f||(f=1);var r=_&&(_.s("fixSizeOnScreen")||_.s("shape3d.fixSizeOnScreen")),P=r?T.NEAREST:T.LINEAR;r?"number"==typeof r&&(f*=0>r?1:r):_&&(_.s("vector.dynamic")||_.s("shape3d.vector.dynamic"))&&(U||(U=v.getData3dUI(_)),r=U.getVectorDynamicSize());var J,Q,o,n=_&&_.s("shape3d");"billboard"===n?o=_.getTall()/_.getWidth():"plane"===n&&(o=_.getHeight()/_.getWidth());var $=rc(B,_);if(r){var q;q=y?v._devicePixelRatio||yh:v.getDevicePixelRatio(),J=r[0]>0?r[0]*q:f*$*q,Q=r[1]>0?r[1]*q:f*(o?Sn(B,_,v,Math.min(4096,$*o)):Sn(B,_))*q}else J=f*$,Q=f*(o?Sn(B,_,v,Math.min(4096,$*o)):Sn(B,_));if(J>=1&&Q>=1){var D=0;(y||F)&&(D=Date.now());var j=v._glCapabilities.maxTextureSize;J=Math.min(J,j),Q=Math.min(Q,j);var C=mf(J,Q);if(!U&&_&&(U=v.getData3dUI(_)),U&&U.interactiveInfo){var O=h;"object"==typeof O&&(O=O.uuid||(O.uuid=S.Math.generateUUID()));var t=U.interactiveInfo[O]={};C.interactiveInfo=t.bodyInfo={compInfos:[],matrix:new zh,rect:{x:0,y:0,width:J,height:Q}}}tm(C,B,0,0,J,Q,_,v),C.interactiveInfo&&(C.interactiveInfo=null),C.restore(),i.count++,i.pixels+=J*Q,_?(w.minFilter=yd(_.s("texture.filter.min")||_.s("texture.filter"))||P,w.magFilter=yd(_.s("texture.filter.mag")||_.s("texture.filter"))||P):w.minFilter=w.magFilter=P,y||F?(H=gm(T,ts,null,w),U.setCachedTexture(H,G),i.time+=Date.now()-D,t&&(H.interactiveInfo={key:O,info:t}),ts=null):H=gm(T,ts,v._1O,w)}}}}return H},redraw:function(){this.iv()},validateImpl:function(){var U=this;if(U._lightChanged){U._lightChanged=!1;var h=[],c=[],x=[];U.dm().each(function(S){if(rh(S)){var b=S.s("light.type");b===vn?h.push(S):b===io?c.push(S):b===Ee&&x.push(S)}}),(h.length!==U._59O.length||c.length!==U._spots.length||x.length!==U._dirs.length)&&Vf(U),U._59O=h,U._spots=c,U._dirs=x}var b=U.getAspect();b!==U.__cachedAspect__&&(U._updateSkybox({property:"asceptChanged"}),U.__cachedAspect__=b),U._42(),U._1o.iv()},getRenderInfo:function(){var o=this.getGL();return o?o._renderInfo:void 0},getDebugTip:function(){var o=this,E=o.getRenderInfo();if(E){var p=o.getGL()._validBufCount||0,C="Draw Calls: "+E.calls+"<br/>"+"Vertices: "+E.vertices+"<br/>"+"Faces: "+E.faces+"<br/>"+"Lines: "+E.lines+"<br/>"+(E.points?"Points: "+E.points+"<br/>":"")+"Buffers: "+p+"<br/>"+"Cache Models: "+b.keys(nq).length+"<br/>"+"Shape3d Models: "+b.keys(jr).length;if(o.isVRPresenting()&&(C+="<br/>VR fps: "+o.vr.getFps()),E.textureCache){var g=E.textureCache.count;if(C+="<br/>2D Dynamic Textures: "+E.textureCache.count,g>0){var n,l=E.textureCache.pixels;n=l>1e6?Math.round(l/1e6)+"M":l>1e3?Math.round(l/1e3)+"K":Math.round(l),C+="<br/>2D Dynamic pixels: "+n}}return C}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var i=new S.Math.Box3,L=new S.Math.Matrix4;return function(I){var f=I;if(f instanceof S.Data&&(f=this.getData3dUI(f)),!f.mat)return!0;var y=f.getBoundingBox();i.copy(y).applyMatrix4(L.fromArray(f.mat));var b=this.getFrustum();return b.intersectsBox(i)}}(),updateScene:function(){var d=this;d._81O=X,d.overlappingBox.clear();var j=d._40Q;j.init();var R=d.getGL(),O=d.dm();if(O.isHierarchicalRendering())O.eachByHierarchical(function(s){var z=d.getData3dUI(s);z&&z.update(d,R,j)});else{var U,i,H,I=O.getDatas().getArray(),w=I.length;for(U=0;w>U;U++)i=I[U],H=d.getData3dUI(i),H&&H.update(d,R,j)}this._updateBoxClipperMatrix(),j.onUpdated()},_pushFrameRenderOptions:function(K){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=K},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(J){var w=this._currentFrameRenderOptions;return w&&w[J]},getRenderLists:function(){return this._40Q},renderScene:function(G){function j($,K){d.setGLState($,K),d.setUniforms($),d.renderState.attribs.disable(),o=N.directUniforms(),B=N.directAttribs(),B.disable()}function A(k){for(;F>Z;Z++){var I=q[Z];if(!n||!I.ignoreInPick){if(I.priority>=k)break;(!C._43Q[C._44Q=I.id]||pj[ll.length])&&(I.render(r,C,d),j())}}}var C=this;C._pushFrameRenderOptions(G),C._getFrameRenderOptions("createShadowMap")!==!1&&C.shadowMap.render(),C.flowMap.render();var r=C.getGL();C._envmapRenderer.onBeforeRender(r),C._44Q=-1;var o,B,d=C._frameState,N=d.renderState,l=N.glState,Q=C._prg;C._projectMatrix=ip(C),Me(C,C._7O),C._viewMatrix=le(C._7O),C.isReflecting(r)||sm(C._projScreenMatrix=df(),C._projectMatrix,C._viewMatrix),d.syncEnv(this._picking?this.pickColorMap:p),N.useProgram(Q),j(!1,!0),r.clear(r.DEPTH_BUFFER_BIT);var n=C._picking,q=this._41Q,Z=0,F=q.length;if(A(E.cameraPriority.skybox),n){var t=l.color.clear.slice(0);ih(r,[0,0,0,0])}else ih(r,[0,0,0,0]),l.blend.enabled=!1,l.depth.enabled=!1,l.depth.mask=!1,C._camera&&C._camera.s("camera.renderSky")===!1||C.drawSky(r,Q),C._getFrameRenderOptions("renderReflector")!==!1&&C.drawReflectors(r)&&(C._projectMatrix=ip(C),Me(C,C._7O),C._viewMatrix=le(C._7O),d.syncEnv(),j()),l.blend.enabled=!1,l.depth.enabled=!0,l.depth.mask=!0,o.uTransparent=!1,C._getFrameRenderOptions("renderGrid")!==!1&&C._31O._42(r,Q);if(!r.textureBatch||pj[(ONE_FRAME_TIME-6)/2]){n||(C.shadowMap.enable&&C.shadowMap.createShadow(o),C.flowMap.createFlow(o));for(var P=0,s=Vk.length;s>P;P++){var u=Vk[P],b=Ki[u];if(!(!C._camera&&b.ignore||C._camera&&!C._camera.isLayerVisible(u))){var J=b.priority;A(J),this.renderLayer(u)}}A(E.cameraPriority.infinity),C.flowMap.disableFlow(o),dh(C,o,0),o.uHeadlightColor=[1,1,1,0],o.uUseEnvMap=!1,l.depth.enabled=!1,o.uTransparent=!1,o.shadowReceive=!1,o.uEnableBoxClip=!1,n?C.drawFilter||C._30O._42(r,Q):(C._highlightHelper._42(r,Q),this._renderAxisAndEditHelper(C._getFrameRenderOptions("renderAxis")!==!1,C._getFrameRenderOptions("renderEdit")!==!1),l.blend.enabled=!1,l.depth.mask=!0),l.depth.enabled=!0,n&&ih(r,t),Xm(r,X),pb(r,X),C._44Q=-1,C._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(v,I){if(v||I){var L=this,A=L.getGL(),E=L._prg,C=L._frameState,k=C.renderState,O=k.glState,Z=k.directUniforms();C.renderState.attribs.disable(),O.depth.enabled=!1,Z.uTransparent=!1,Z.shadowReceive=!1,O.blend.enabled=!1,O.depth.mask=!0,Z.uPick=L._picking,v&&L._32O._42(A,E),I&&L._30O._42(A,E),Xm(A,X),pb(A,X)}},renderLayers:function(R,D){D&&(R=Rm(R));for(var y=0,C=R.length;C>y;y++)this.renderLayer(R[y])},renderSky:function(){var M=this,c=M._frameState,q=c.renderState,H=q.glState,f=M.getGL(),v=M._prg;M._projectMatrix=ip(M),Me(M,M._7O),M._viewMatrix=le(M._7O),sm(M._projScreenMatrix=df(),M._projectMatrix,M._viewMatrix),c.syncEnv(),q.useProgram(v),c.setGLState(!1,!0),c.setUniforms(!1),c.renderState.attribs.disable(),f.clear(f.DEPTH_BUFFER_BIT),ih(f,[0,0,0,0]),H.blend.enabled=!1,H.depth.enabled=!1,H.depth.mask=!1,M.drawSky(f,v),H.depth.mask=!0,H.depth.enabled=!0,Xm(f,X),pb(f,X)},addRenderLayerListener:function(b,y,O){var F=this;F._renderLayerNotifier||(F._renderLayerNotifier=new Hd),F._renderLayerNotifier.add(b,y,O)},removeRenderLayerListener:function(e,E){this._renderLayerNotifier&&this._renderLayerNotifier.remove(e,E)},fireRenderLayerEvent:function(v,I){var A=this._renderLayerNotifier;A&&A.fire({layer:v,phase:I})},renderLayer:function(F){var W=this,o=W._picking,t=W._40Q.get(F);if(t){W.fireRenderLayerEvent(F,"prepare");var M=W.getGL(),i=Ki[F],O=W._frameState,Q=O.renderState,L=Q.glState,B=Q.directUniforms();!o&&W.isSortable()&&t.sort(W._sortFunc,W._projScreenMatrix);var p,K,_,b=t.opaque,U=t.transparent,c=t.batchModelMap,T=t.polylineModelMap,S=t.wireframeModelMap,M=W.getGL(),E=W._prg;o||(L.blend.enabled=!1,L.depth.enabled=!0,L.depth.mask=!0),B.uTransparent=!1,i.clearDepth!==!1&&M.clear(M.DEPTH_BUFFER_BIT);var h=this.drawFilter;if(h)for(_=b,p=0,K=_.length;K>p;p++)h(_[p].data)!==!0&&_[p].ui._42(M,E,A);else{for(_=b,p=0,K=_.length;K>p;p++)_[p].ui._42(M,E,A);if(o)for(_=U,p=0,K=_.length;K>p;p++)_[p].ui._46Q(M);he(W,c),fq(W,T),fq(W,S)}if(o||(L.blend.enabled=!0,L.depth.mask=!1),W._45Q=B.uTransparent=!0,h)for(_=U,p=0,K=_.length;K>p;p++)h(_[p].data)!==!0&&_[p].ui._42(M,E,l);else{for(_=U,p=0,K=_.length;K>p;p++)_[p].ui._42(M,E,l);he(W,c,null,!0),fq(W,T,null,!0),fq(W,S,null,!0)}W._45Q=null,W.fireRenderLayerEvent(F,"post")}},_42:function(F,O){var p=this;if(!p._35O&&(!bh||pj(bh))){var B=p.getWidth(),y=p.getHeight();if(B&&y){var a=p.getGL();if(a){var A,J=p._canvas;if(F?A=!0:F=p.getDevicePixelRatio(),!p._picking&&(A||B!==J.clientWidth||y!==J.clientHeight)){zl(J,B,y,F);var I=F;B&&Math.abs(a.drawingBufferWidth-B*F)>1&&(I=Math.min(I,a.drawingBufferWidth/B)),y&&Math.abs(a.drawingBufferHeight-y*F)>1&&(I=Math.min(I,a.drawingBufferHeight/y)),I!==F&&(p.setDevicePixelRatio(F=I),zl(J,B,y,F)),p._18Q=null}a.clear(a.COLOR_BUFFER_BIT);var n=a._renderInfo;n.calls=0,n.vertices=0,n.faces=0,n.lines=0,n.points=0,n.textureCache={time:0,count:0,pixels:0},n.frame=++p._frameId,n.cacheTimeCost=0,n.reflectDepth=0,B*=F,y*=F,this.syncRenderState();do{if(p.isVREnabled()&&p.vr.render(a,B,y,O))break;if(p.updateScene(),p._postProcessing.render(a,B,y,O))break;p.setViewport(a,0,0,B,y),p.renderScene(O)}while(!1);p._33Q=!1,p.countFrame(),p._doBufferGC(a)}}}},syncRenderState:function(){var s,o;(s=this._frameState)&&(o=s.renderState)&&o.syncLoss()},drawReflectors:function(c){c._renderInfo.reflectDepth++;var D,t,G,C=this,y=C._dataModel.getReflectors(),V=!1;for(D in y)t=y[D],C.isVisible(t)&&(G=C.getData3dUI(t),G&&G.drawReflector(c)&&(V=!0));return c._renderInfo.reflectDepth--,V},isReflecting:function(H){return H._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(O,W){return this._postProcessing.enableModule(O,W)},getPostProcessingModule:function(L){return this._postProcessing.getModule(L)},getPostProcessingValue:function(a,i){var I=this._postProcessing.getModule(a);return I?I[i]:p},setPostProcessingValue:function(W,t,T){var f=this.getPostProcessingValue(W,t),l=this._postProcessing.getModule(W);l&&f!==T&&("enable"===t?this.enablePostProcessing(W,T):l[t]=T,this.firePropertyChange("postProcessing."+W+"."+t,f,T))},setViewport:function(m,X,u,x,M){this._viewport=[X,u,x,M],is.for(m).directState().viewport=this._viewport},getRenderState:function(){return is.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(X){this._bufferGCInterval=X},_doBufferGC:function(F,S){var M,s,U=F._bufPool,P=0,p=0,r=F._renderInfo.frame,$=this._bufferGCInterval||10;for(M in U)P++,s=U[M],s&&(S||r-s._fid>$?(F.deleteBuffer(s._buf),s._buf=null,U[M]=null):p++);if(P/2>p&&P>128){var t={};for(M in U)U[M]&&(t[M]=U[M]);F._bufPool=t}F._validBufCount=p},_swapLineMap:function(){var d=this;Bq=d._polylineModelMap,d._polylineModelMap=d._polylineModelMapSwap,d._polylineModelMapSwap=Bq,Bq=d._wireframeModelMap,d._wireframeModelMap=d._wireframeModelMapSwap,d._wireframeModelMapSwap=Bq,Bq=d._polylineIndexMap,d._polylineIndexMap=d._polylineIndexMapSwap,d._polylineIndexMapSwap=Bq,Bq=d._wireframeIndexMap,d._wireframeIndexMap=d._wireframeIndexMapSwap,d._wireframeIndexMapSwap=Bq},_updateSkybox:function(S){if(this._skybox&&S){var h=S.property,f=!1,J=this._skybox;if("eye"===h||"forceUpdate"===h){var r=this._eye;J.p3(r[0],r[1],r[2]),f=!0}if("near"===h||"far"===h||"forceUpdate"===h||"asceptChanged"===h){var M=J.__cachedS3__;M||(M=J.__cachedS3__=J.getFinalScale3d());var D=Math.sqrt(3),t=1/0,$=-1/0;M.forEach(function(w){w/=2,t=d(w,t),$=P(w,$)}),$*=D;var j=this._near,H=this._far,W=Math.tan(this.getFovy()/2)*j,k=this.getAspect()*W,g=1.1*Math.sqrt(k*k+W*W+j*j),O=1;if(g>t)O=g/t;else if($>=H){var A=H*H/(j+H);O=A/$}if(1!==O){J.__updatingSkybox__=!0;var o=M.map(function(h){return O*h});J.s3(o),J.setScale3d(1,1,1),f=!0,delete J.__updatingSkybox__}}f&&this.invalidateData(J)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(h){return this.setSkybox(h)},getSkybox:function(){return this._skybox},setSkybox:function($){var E=this._skybox;if(E===$)return $&&this._updateSkybox({property:"forceUpdate"}),void 0;if(E&&(this._skyboxStyleMap&&E.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&E.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&E.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Uc,data:E})),this._skybox=$,this.ump(this._updateSkybox,this),$){$.dm()&&$.dm().remove($),this._skyboxStyleMap=S.Default.clone($.getStyleMap()),this._skyboxAnchor3d=$.getAnchor3d(),$.setAnchor3d(.5,.5,.5),this._skyboxP3=$.p3().slice(0),$.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});
var D=$.onPropertyChanged;$.onPropertyChanged=function(g){D.call($,g),!$.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(g.property)>=0&&($.__cachedS3__=p)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",E,$)},drawSky:function(J,v){var D=this,a=D._skybox;if(a){var O=is.for(J).directUniforms(),r=D._headlightIntensity,e=aq(D._headlightColor),v=D._prg;1!==r&&(e=[e[0]*r,e[1]*r,e[2]*r]),O.uHeadlightColor=[e[0],e[1],e[2],1];var j=D.getData3dUI(a);if(j){var N=D.isOrtho(),Y=N||this._computedProjectMatrix;if(Y){var k=D._projectMatrix;N&&(D._ortho=!1),O.uPMatrix=D._projectMatrix=ip(D,!0)}var o=a.p3(),F=this.getEye();(o[0]!==F[0]||o[1]!==F[1]||o[2]!==F[2])&&(a._position.x=F[0],a._54O=F[1],a._position.y=F[2]),j.validate(),j._42(J,v,g),Y&&(N&&(D._ortho=!0),O.uPMatrix=D._projectMatrix=k)}J.clear(J.DEPTH_BUFFER_BIT),O.uHeadlightColor=[e[0],e[1],e[2],D._headlightDisabled?1:0]}},getLogicalPoint:function(Q){return Bm(Q,this._canvas)},isRectOverlapping:function(T){var R=this.getData3dUI(T);return R._rectOverlapping},getHitFaceInfo:function(J){J.target&&(J=this.lp(J));var n=this.getDataInfoAt(J);if(n){var f=this.intersectObject(J,n.data);if(f)return{data:n.data,face:f.part}}return X},unproject:function(E,F){var j=this,K=j.getWidth(),f=j.getHeight(),$=E.target?j.lp(E):E,N=$.x-K/2,D=$.y-f/2,L=2*(N/K),C=2*(-1*D/f);F=F||0;var R=df(),g=ip(j),p=Me(j);sm(R,g,p),tf(R);var e=fm([L,C,F,1],R);return[e[0]/e[3],e[1]/e[3],e[2]/e[3]]},getDataAt:function(L){var $=this.getDataInfoAt(L);return $?$.data:X},getDataInfoAt:function(Q,M,L){return Q.target&&(Q=this.lp(Q)),this._1o.get(Oh(Q.x,Q.y,M),!0,L)},getDatasInRect:function(U,T){return this._1o.get(U,!1,T)},setEditable:function(O){var T=this,Q=T._editable;T._editable=O,this.fp(cs,Q,O)},isEditable:function(A){var M=this;return A?M._editable?mo(A)?A.s("3d.editable")?M._editableFunc?M._editableFunc(A):!0:!1:!1:!1:M._editable},isSelectable:function(p){return p.s("3d.selectable")&&this.sm().isSelectable(p)},isMovable:function(i){var l=this;return br(i)&&i.getStyle(Ug)!==tk?!1:i.s("3d.movable")?l._movableFunc?l._movableFunc(i):!0:!1},isSizeEditable:function(h){return mo(h)?this._sizeEditableFunc?this._sizeEditableFunc(h):!0:!1},isRotationEditable:function(y){return mo(y)&&y.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(y):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(E){this.setZoom(Nl,E)},zoomOut:function(M){this.setZoom(1/Nl,M)},setZoom:function(){var Z=new Zh,h=new Zh,H=new Zh,Q=new Zh;return function(g,Y){if(1!==g){var r=this;r._14o&&r._14o.stop(!0);var v,i=1/g;Z.copy(r.getCenter()),h.copy(r.getEye());var T=r._ortho;if(T){if(v=r._orthoWidth,v<r._moveStep&&g>1)return}else if(Z.distanceTo(h)<r._moveStep&&1>i)return;var k=!1;return r._zoomToCenter===!1&&r._lastZoomLP&&(H.copy(h).sub(Z).normalize(),r._81O=null,Q.copy(r.getHitPosition(r._lastZoomLP,Z.toArray(),H.toArray())),k=!0,r._lastZoomHit=Q),(Y=zq(Y))?(Y.action=function(a){r.fi({kind:r._zooming?"betweenZoom":"beginZoom"}),r._zooming=1;var z=(i-1)*a+1;T&&r.setOrthoWidth(v*z),k?(r.setEye(H.lerpVectors(Q,h,z).toArray()),r.setCenter(H.lerpVectors(Q,Z,z).toArray())):T||r.setEye(H.lerpVectors(Z,h,z).toArray())},Y._37o=function(){delete r._14o,delete r._zooming,r.fi({kind:"endZoom"}),r.onZoomEnded()},r._14o=Ti(Y)):(T&&r.setOrthoWidth(v*i),k?(r.setEye(H.lerpVectors(Q,h,i).toArray()),r.setCenter(H.lerpVectors(Q,Z,i).toArray())):T||r.setEye(H.lerpVectors(Z,h,i).toArray()),void 0)}}}(),setOrthoZoom:function(X,c){return this.setZoom(X,c)},getPositionInfo:function(T){var k=this,B=k._eye,y=k._center,H=k.getAspect(),J=T?gq(Fi(y,B,!0),Fi(T,B)):Fb(B,y);if(k._ortho){var s=k._orthoWidth;return{length:J,height:s/H,width:s}}var K=2*Bl(k._fovy/2)*J;return{length:J,height:K,width:K*H}},getCenterInfo:function(){var h=this;return h._81O||(h._81O=h.getPositionInfo()),Nq(h._81O)},rotate:function(S,I,v,D){var k=this;if(S||I){D==X&&(D=k._firstPersonMode),k._88O&&k._88O.stop(!0);var j=k._center,x=k._eye,n=k.getCenterInfo().length,E=D?j:x,H=D?x:j,q=Fi(E,H),R=$g(q[0],q[2]),U=$g(B(q[0]*q[0]+q[2]*q[2]),q[1]),V=D?Yn:kj;return D&&(I=-I),(v=zq(v))?(v.action=function(W){k.fi({kind:k._rotating?"betweenRotate":"beginRotate"}),k._rotating=1;var B=R+S*W,u=U+I*W;u=D?f-ag(k,f-u):ag(k,u),q[0]=n*T(u)*T(B),q[1]=n*t(u),q[2]=n*T(u)*t(B),E[0]=H[0]+q[0],E[1]=H[1]+q[1],E[2]=H[2]+q[2],k.fp(V,X,E)},v._37o=function(){delete k._88O,delete k._rotating,k.fi({kind:"endRotate"}),k.onRotateEnded()},k._88O=Ti(v)):(R+=S,U+=I,U=D?f-ag(k,f-U):ag(k,U),q[0]=n*T(U)*T(R),q[1]=n*t(U),q[2]=n*T(U)*t(R),E[0]=H[0]+q[0],E[1]=H[1]+q[1],E[2]=H[2]+q[2],k.fp(V,X,E),void 0)}},pan:function(D,u,f,J){if(D||u){var e=this;J==X&&(J=e._firstPersonMode),e._89O&&e._89O.stop(!0);var d=Me(e),O=[d[0]*D,d[4]*D,d[8]*D],c=[d[1]*u,d[5]*u,d[9]*u],y=O[0]+c[0],E=O[1]+c[1],V=O[2]+c[2],A=e._center,g=e._eye;if(J){var Y=Yb(e.getBoundaries(),g[0],g[2],g[0]+y,g[2]+V,B(y*y+V*V));y=Y[0],V=Y[1]}if(f=zq(f)){var p=Nq(g),I=Nq(A);return f.action=function(a){e.fi({kind:e._panning?"betweenPan":"beginPan"}),e._panning=1,A[0]=I[0]+y*a,A[1]=I[1]+E*a,A[2]=I[2]+V*a,g[0]=p[0]+y*a,g[1]=p[1]+E*a,g[2]=p[2]+V*a,e.fp(kj,X,g),e.fp(Yn,X,A)},f._37o=function(){delete e._89O,delete e._panning,e.fi({kind:"endPan"}),e.onPanEnded()},e._89O=Ti(f)}A[0]+=y,A[1]+=E,A[2]+=V,g[0]+=y,g[1]+=E,g[2]+=V,e.fp(kj,X,g),e.fp(Yn,X,A)}},walk:function(i,x,I){if(i){var q=this;I==X&&(I=q._firstPersonMode),q._90O&&q._90O.stop(!0);var v=q._center,l=q._eye,Z=Fi(v,l,!0);if(I){var p=Yb(q.getBoundaries(),l[0],l[2],l[0]+Z[0]*i,l[2]+Z[2]*i,a(i));if(i=Fb(p),!i)return;Z=[p[0]/i,0,p[1]/i]}if(x=zq(x)){var G=Nq(l),$=Nq(v);return x.action=function(c){q.fi({kind:q._walking?"betweenWalk":"beginWalk"}),q._walking=1;var H=i*c;l[0]=G[0]+Z[0]*H,l[1]=G[1]+Z[1]*H,l[2]=G[2]+Z[2]*H,v[0]=$[0]+Z[0]*H,v[1]=$[1]+Z[1]*H,v[2]=$[2]+Z[2]*H,q.fp(kj,X,l),q.fp(Yn,X,v)},x._37o=function(){delete q._90O,delete q._walking,q.fi({kind:"endWalk"}),q.onWalkEnded()},q._90O=Ti(x)}l[0]+=Z[0]*i,l[1]+=Z[1]*i,l[2]+=Z[2]*i,v[0]+=Z[0]*i,v[1]+=Z[1]*i,v[2]+=Z[2]*i,q.fp(kj,X,l),q.fp(Yn,X,v)}},handleScroll:function(H,p){Bi(H);var v=this,g=v._moveStep,Q=v.getDataInfoAt(H);if(Q){var r=Q.data;if(r&&v.isInteractive(r)){var K=v.intersectObject(H,r);if(K){var Z=K.part,I=ir(r.s(Z+".image")||r.s("shape3d."+Z+".image")||r.s("all.image")||r.s("shape3d.image"));if(I&&Qn(I.scrollable,r,v))return}}}return v.isFirstPersonMode()?(v.isPannable()&&v.pan(0,p>0?g:-g),void 0):(v.isZoomable()&&(v._lastZoomLP=v.lp(H),v.setZoom(0>p?1/lj:lj),v._lastZoomLP=v._lastZoomHit=null),void 0)},handlePinch:function(f,A){if(this.isZoomable()){if(Math.abs(f-A)<E.pinchZoomThreshold)return;this.setZoom(A>f?1/Td:Td)}},reset:function(h){this.setUp(E.graph3dViewUp),this.moveCamera(E.graph3dViewEye,E.graph3dViewCenter,h)},moveSelection:function(F,G,e){var Y=this;Y.dm().beginTransaction(),id(this.sm().toSelection(this.isMovable,this),F,G,e),Y.dm().endTransaction()},getMoveMode:function(Q,V){var K=V.s("3d.move.mode");if(K)return K;var c="88",T="89",J="90";return am(Q)||tb[c]&&tb[T]&&tb[J]?"xyz":tb[c]&&tb[T]?"xy":tb[c]&&tb[J]?"xz":tb[T]&&tb[J]?"yz":tb[c]?"x":tb[T]?"y":tb[J]?"z":"xz"},handleTick:function(){var h=this,V=!1,O=h._moveStep,C=O,G=!1,g=!0,I=h._rotateStep*(g?-1:1);if(h.isWalkable()||(C=0),h.isPannable()||(O=0),h.isRotatable()||(I=0),h._32Q){var f=(vk()-h._32Q)/50;C*=f,O*=f,I*=f}h._31Q&&(yl(h._31Q),delete h._31Q,delete h._32Q),Ar()&&(V=!0,h.pan(-O,0,G,g)),Qh()&&(V=!0,h.pan(O,0,G,g)),Wr()&&(V=!0,am()?h.pan(0,O,G,g):h.walk(C,G,g)),sn()&&(V=!0,am()?h.pan(0,-O,G,g):h.walk(-C,G,g)),Rg()&&(V=!0,h.rotate(-I,0,G,g)),Ye()&&(V=!0,h.rotate(I,0,G,g)),Nk()&&(V=!0,h.rotate(0,-I/2,G,g)),Ae()&&(V=!0,h.rotate(0,I/2,G,g)),V&&(h._32Q=vk(),h._31Q=hm(h.handleTick,h))},handleKeyDown:function(I){var o=this;!Yd(I)&&Af[I.keyCode]?o.handleTick():qb(I)?o.selectAll():Am(I)?o.handleDelete(I):tn(I)&&this.isResettable()&&o.reset()},checkDoubleClickOnNote:function(v,N,b){var l=this;if(b===Pl){if(N.s("note.toggleable"))return N.s(ym,!N.s(ym)),l.fi({kind:"toggleNote",event:v,data:N,part:b}),!0}else if(b===Io&&N.s("note2.toggleable"))return N.s(We,!N.s(We)),l.fi({kind:"toggleNote2",event:v,data:N,part:b}),!0;return!1},checkDoubleClickOnRotation:function(j,i,J){return J===Ks?(i.setRotationX(0),!0):J===Ls?(i.setRotationY(0),!0):J===Ms?(i.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(M){var I=this;if(I.isOrtho())return I.getWidth()/I.getOrthoWidth();var r=I.getCenter(),z=I.getHeight(),T=I.getEye(),v=[r[0]-T[0],r[1]-T[1],r[2]-T[2]],a=[M[0]-T[0],M[1]-T[1],M[2]-T[2]],w=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]),k=1/Math.tan(I.getFovy()/2);return z*w*k/(a[0]*v[0]+a[1]*v[1]+a[2]*v[2])},inViewSpace:function(Q){var J,O=this,r=O._transformPointToViewSpace(Q),t=O.getAspect(),j=O.getNear(),x=O.getFar();return-r[2]<j||-r[2]>x?!1:O.isOrtho()?(J=O.getOrthoWidth()/2,Math.abs(r[0])<=J&&Math.abs(r[1]*t)<=J):(J=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2])*Math.tan(O.getFovy()/2),Math.abs(r[1]<=J)&&Math.abs(r[0])<=J*t)},getPVMatrix:function(){var L,F=this;return(L=F._18Q)||(L=ip(F),F._18Q=sm(L,L,Me(F)),F._18Q._wh=F.getWidth()/2/F.getHeight()),L},getFrustum:function(){var z=new Qk,k=new lk,I=new Array(16);return function(){for(var Z=this.getPVMatrix(),Y=!1,w=0;16>w;w++)Z[w]!==I[w]&&(Y=!0,I[w]=Z[w]);return Y&&k.setFromMatrix(z.fromArray(Z)),k}}(),toViewPosition:function(e){var K=this,f=K.getWidth()/2,T=K.getHeight()/2,U=K.getPVMatrix();return e=fm([e[0],e[1],e[2],1],U),{x:f+f*e[0]/e[3],y:T-T*e[1]/e[3],z:e[2]/e[3]}},getHitPosition:function(N,J,H){var m=this,E=m.getWidth(),z=m.getHeight(),i=N.target?m.lp(N):N,f=i.x-E/2,g=i.y-z/2,o=m.getCenterInfo(),c=Me(m);J=J?J:[0,0,0],H=H?H:[0,1,0],f=f/E*o.width,g=-1*g/z*o.height;var P=[c[0]*f,c[4]*f,c[8]*f],K=[c[1]*g,c[5]*g,c[9]*g],T=[P[0]+K[0],P[1]+K[1],P[2]+K[2]],L=m.getCenter(),M=pg(m,J,H,[T[0]+L[0],T[1]+L[1],T[2]+L[2]]);return M?M:[0,0,0]},intersectObject:function(X,h){return this._raycaster.intersectObject(X,h)},intersectObjects:function(F,G,$){return this._raycaster.intersectObjects(F,G,$)},getLineLength:function(M){this.validate();var C=this.getData3dUI(M);if(C&&C.getCache){var R=C.getCache();if(R)return R[R.length-1].length}return 0},getLineOffset:function(K,Q){var x=this.getData3dUI(K);if(x&&x.getCache){var N=x.getCache();if(N){var S=_q(N,Q);if(!K.r3)return S;var D=K.r3();if(0===D[0]&&0===D[1]&&0===D[2])return S;var F=new Zh(K.p3()),j=new Zh(S.point).sub(F),b=new Zh(S.tangent).add(j),h=(new nd).setFromEuler(new Zg(D,K.getRotationMode(),!0));return j.applyQuaternion(h),b.applyQuaternion(h),{point:j.add(F),tangent:b.sub(j).normalize()}}}return X},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(O,D,w){var r=this,b=r.getEye();b=[b[0],b[1],b[2]];var j=r.getCenter();if(j=[j[0],j[1],j[2]],O||(O=b),D||(D=j),r._flyAnim&&r._flyAnim.stop(!0),w=zq(w),!w)return r.setEye(O[0],O[1],O[2]),r.setCenter(D[0],D[1],D[2]),delete r._flyAnim,!0;var o=[O[0]-b[0],O[1]-b[1],O[2]-b[2]],S=[D[0]-j[0],D[1]-j[1],D[2]-j[2]];return w.action=function(Y){r.setCenter(j[0]+S[0]*Y,j[1]+S[1]*Y,j[2]+S[2]*Y),r.setEye(b[0]+o[0]*Y,b[1]+o[1]*Y,b[2]+o[2]*Y)},w._37o=function(){delete r._flyAnim},r._flyAnim=Ti(w)},flyTo:function(){function g(A,K,J){if(J instanceof S.Node){o.fromArray(ec(J,K.getMat(J)));var b=J.getAnchor3d();A.push((new Zh).set(0-b.x,0-b.y,0-b.z).applyMatrix4(o)),A.push((new Zh).set(0-b.x,0-b.y,1-b.z).applyMatrix4(o)),A.push((new Zh).set(0-b.x,1-b.y,0-b.z).applyMatrix4(o)),A.push((new Zh).set(0-b.x,1-b.y,1-b.z).applyMatrix4(o)),A.push((new Zh).set(1-b.x,0-b.y,0-b.z).applyMatrix4(o)),A.push((new Zh).set(1-b.x,0-b.y,1-b.z).applyMatrix4(o)),A.push((new Zh).set(1-b.x,1-b.y,0-b.z).applyMatrix4(o)),A.push((new Zh).set(1-b.x,1-b.y,1-b.z).applyMatrix4(o))}}var Q=new Zh,f=new Zh,e=new Zh,Z=new Zh,m=new Zh,o=new Qk,z=new S.Math.Quaternion,j=new Zg,X=new ml;return function(C,J,V){var i=this;if(V!==p)J={animation:J,ratio:V};else{var O=typeof J;("boolean"===O||"object"===O&&J.duration)&&(J={animation:J})}J=J||{},Q.fromArray(i.getEye()),f.fromArray(i.getCenter());var P,H,c=[],l=J.center,M=J.distance===p;if(l&&e.fromArray(l),C||(C=i.dm().getDatas()),1===C.length&&(C=Sd(C)?C.get(0):C[0]),C instanceof S.Node)l||e.fromArray(C.p3()),M&&(g(c,i,C),P=c.length);else{if(!C.length)return;if((M||!l)&&(c=[],C.forEach(function(R){g(c,i,R)}),P=c.length,!P))return;l||(X.setFromPoints(c),e.copy(X.min).add(X.max).multiplyScalar(.5))}if(i.setCenter(e.x,e.y,e.z),Z.subVectors(Q,f),J.direction||J.worldDirection){!J.worldDirection&&C instanceof S.Node?z.setFromEuler(j.set(C.r3(),C.getRotationMode(),!0)):z.set(0,0,0,1);var L=Z.length();Z.fromArray(J.worldDirection||J.direction).applyQuaternion(z).setLength(L)}var h=0;if(M){var k,r,t,V=J.ratio||.8,b=J.xRatio||V,a=J.yRatio||V;if(m.copy(Z),i.isOrtho()){var W=-1/0;for(i._eye[0]=Z.x+e.x,i._eye[1]=Z.y+e.y,i._eye[2]=Z.z+e.z,k=ip(i),sm(k,k,Me(i)),H=0;P>H;H++)t=c[H],r=fm([t.x,t.y,t.z,1],k),W=Math.max(W,Math.max(Math.abs(r[0])/b,Math.abs(r[1])/a));h=i.getOrthoWidth()*W}else{for(var v,Y,I=i.getNear(),w=10;w--;){for(i._eye[0]=Z.x+e.x,i._eye[1]=Z.y+e.y,i._eye[2]=Z.z+e.z,k=ip(i),sm(k,k,Me(i)),v=!0,Y=-1/0,H=0;P>H;H++){if(t=c[H],r=fm([t.x,t.y,t.z,1],k),r[3]<I&&w){Z.multiplyScalar(2),v=!1;break}Y=Math.max(Y,Math.max(Math.abs(r[0])/b,Math.abs(r[1])/a)-r[3])}if(v)break}Z.setLength(Y+Z.length())}Z.manhattanLength()<1e-6&&Z.copy(m)}else Z.setLength(J.distance);var D=Z.add(e);i._flyAnim&&i._flyAnim.stop(!0);var U=zq(J.animation);if(U){i.setEye(Q.x,Q.y,Q.z),i.setCenter(f.x,f.y,f.z);var s=(new Zh).subVectors(D,Q),n=(new Zh).subVectors(e,f);if(h)var B=i.getOrthoWidth();var o=new Zh,d=new Zh,u=U.action,F=U._37o,G=Q.clone(),x=f.clone();return U.action=function(W,F){o.copy(G).addScaledVector(s,W),d.copy(x).addScaledVector(n,W),i.setCenter(d.x,d.y,d.z),i.setEye(o.x,o.y,o.z),h&&i.setOrthoWidth((h-B)*W+B),u&&u(W,F)},U._37o=function(){delete i._flyAnim,F&&F()},{lastEye:Q,lastCenter:f,eye:D,center:e,orthoWidth:h,animation:i._flyAnim=Ti(U)}}return i.setEye(D.x,D.y,D.z),h&&i.setOrthoWidth(h),delete i._flyAnim,{lastEye:Q,lastCenter:f,eye:D,center:e,orthoWidth:h}}}(),getBoundingBox:function(){function s(q,a,F){V.fromArray(ec(F,a.getMat(F)));var A=F.getAnchor3d();q.push((new Zh).set(0-A.x,0-A.y,0-A.z).applyMatrix4(V)),q.push((new Zh).set(0-A.x,0-A.y,1-A.z).applyMatrix4(V)),q.push((new Zh).set(0-A.x,1-A.y,0-A.z).applyMatrix4(V)),q.push((new Zh).set(0-A.x,1-A.y,1-A.z).applyMatrix4(V)),q.push((new Zh).set(1-A.x,0-A.y,0-A.z).applyMatrix4(V)),q.push((new Zh).set(1-A.x,0-A.y,1-A.z).applyMatrix4(V)),q.push((new Zh).set(1-A.x,1-A.y,0-A.z).applyMatrix4(V)),q.push((new Zh).set(1-A.x,1-A.y,1-A.z).applyMatrix4(V))}var V=new Qk;return function(G){if(G=G||this.sm().getSelection(),G instanceof S.Node&&(G=[G]),0===G.length)return X;var Q=[];G.forEach(function(W){mo(W)&&s(Q,this,W)},this);var q=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];return Q.forEach(function(P){q[0]=Math.min(P.x,q[0]),q[1]=Math.min(P.y,q[1]),q[2]=Math.min(P.z,q[2]),d[0]=Math.max(P.x,d[0]),d[1]=Math.max(P.y,d[1]),d[2]=Math.max(P.z,d[2])}),{min:q,max:d}}}(),setBatchInfo:function($,m){var P=this._batchInfoMap[$];this._batchInfoMap[$]=m,this.fp("batchInfo",P,m)},getBatchInfo:function(h){return this._batchInfoMap[h]||ys[h]},setOrthoWidth:function(p){var H=this._orthoWidth;if(this._orthoWidth=p,this._syncEyeWithOrthoWidth){var $=p/this.getAspect(),n=$/2/Bl(this.getFovy()/2),j=(new Zh).fromArray(this.getEye()),C=(new Zh).fromArray(this.getCenter());j.sub(C).setLength(n).add(C),this.setEye(j.toArray())}this.fp("orthoWidth",H,p)},getCamera:function(p){var Q=this;p||(p=Q._mainCamera,p||(p=Q._mainCamera=new S.Camera)),p.s({"camera.type":Q.isOrtho()?"ortho":"perspective","camera.aspect":Q.getAspect(),"camera.fovy":Q.getFovy(),"camera.ortho.width":Q.getOrthoWidth(),"camera.near":Q.getNear(),"camera.far":Q.getFar()});var O=Q.getEye();return p.p3(O.slice()),p.lookAt(Q.getCenter(),Q.getUp()),p}}),function(){function W(F,r,m){var d=F[r];d&&d.releaseTexture(),F[r]=m}function C(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function F(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function G(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function u(){return{vs:G(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",F(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function A(){return{vs:G(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",F(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function g(v){return{vs:G(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+v+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",F(),"\n #define ENVMAP_TYPE_CUBE_UV \n",C(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var f=Gq.EnvmapRenderer=function(r){this.gv=r,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};f.prototype={},f.prototype.constructor=f,f.prototype.changeEnvmapType=function(B){"legacy"===B?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},f.prototype.invalidateEnvmap=function(W){var j=this.gv;if("legacy"!==j.getEnvmapType()){var m=j.getGL();m&&(W?(delete this._envmapHash[W],delete this._probeCaptureTime[W]):(this._envmapHash={},this._probeCaptureTime={}),j.iv())}},f.prototype.onBeforeRenderLegacy=function(n){this.assureTextureLegacy(n)},f.prototype.assureTextureLegacy=function(x){var O=this,m=O.gv,p=m.getEnvmap();if(p!==O._lastLegacyImage){if(O._envmapLegacy&&(x.deleteTexture(O._envmapLegacy),O._envmapLegacy=null),!p)return O._lastLegacyImage=p,void 0;var V=E.getImage(p);if(V&&V.tagName){V=E.resizeImagePOT(V,!0);var M=O._envmapLegacy=x.createTexture();x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_CUBE_MAP,M),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_MAG_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,V),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,V),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,V),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,V),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,V),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,V),x.bindTexture(x.TEXTURE_CUBE_MAP,x._emptyCubeTexture),O._lastLegacyImage=p}}},f.prototype.setEnvmapLegacy=function(D){D.uEnvMap=this._envmapLegacy},f.prototype.onBeforeRenderNew=function(n){this.assureTextureNew(n),this.resetUniformCache()},f.prototype.assureTextureNew=function(f){var G=this,o=G.gv,i=o.getEnvmap(),r=G._envmapHash,y=G._envmaps,K=f._renderInfo.frame;if(!(this._lastCaptureFrame>=K||o._picking))for(var $ in i){var l,N=i[$],b=N.type;switch(b){case"sphere":l=N.image,l!==r[$]&&(Wg=E.getImage(l),Wg&&(r[$]=l,W(y,$,G.fromEquirectangular(l))));break;case"cube":var C=N.images;if(C&&6===C.length&&(l=C.join(","),l!==r[$])){for(var t=!0,L=0;6>L;L++)if(!E.getImage(C[L])){t=!1;break}t&&(r[$]=l,W(y,$,G.fromCubemap(C)))}break;case"skybox":var q=o.getSkybox();if(q){var S=q.s("shape3d");if(l="sphere"===S?q._id+"_"+q.s("shape3d.image"):q._id+"_"+q.s("front.image"),l!==r[$]){var t;if("sphere"===S)t=E.getImage(q.s("shape3d.image"));else{t=!0;for(var d=["front","back","left","right","top","bottom"],L=0;6>L;L++)if(!E.getImage(q.s(d[L]+".image"))){t=!1;break}}t&&(r[$]=l,W(y,$,G.fromSkybox()))}}break;case"probe":var p=N.pos,T=N.size;if(l=p[0]+"_"+p[1]+"_"+p[2]+"_"+T,l!==r[$]){var m=this._probeCaptureTime[l],H=Date.now();m||(this._probeCaptureTime[l]=m=H),H-m>E.envmapProbeMinWaitTime&&!bp&&!ni||H-m>E.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[l],r[$]=l,W(y,$,G.fromSceneProbe(p,T,N.filter))):o.iv()}}}},f.prototype.resetUniformCache=function(){this._frameUniformCache={}},f.prototype.setEnvmap=function(J,x){var i=J.uuid,c=this._frameUniformCache,C=this._envmaps[x];C&&(C=C.texture),c[i]!==C&&(c[i]=C,J.uEnvMap=C)},f.prototype.fromEquirectangular=function(t){var i=S.Default.getImage(t);return this.rectSize=[1/i.width,1/i.height],t=this.gv.getTexture(t),this.fromTexture(t)},f.prototype.fromCubemap=function(g){var I=this.gv.getGL(),M=I.createTexture();I.activeTexture(I.TEXTURE0),I.bindTexture(I.TEXTURE_CUBE_MAP,M),I.texParameteri(I.TEXTURE_CUBE_MAP,I.TEXTURE_MAG_FILTER,I.LINEAR),I.texParameteri(I.TEXTURE_CUBE_MAP,I.TEXTURE_MIN_FILTER,I.LINEAR);for(var A=[],C=c/3,Z=0;6>Z;Z++)A[Z]=E.resizeImage(S.Default.getImage(g[Z]),C);return I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,A[0]),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,A[1]),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,A[2]),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,A[3]),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,A[4]),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,A[5]),I.bindTexture(I.TEXTURE_CUBE_MAP,I._emptyCubeTexture),this.fromTexture(M,!0)},f.prototype.fromTexture=function(g,R){var i=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var j=this.gv,G=j.getGL(),B=is.for(G).directState(),M=B.depth.enabled;B.scissor.enabled=!0,B.depth.enabled=!1;var n=j.getViewport(G);return this._textureToCubeUV(g,i,R),this._applyPMREM(i),i.unbind(G),j.setViewport(G,n[0],n[1],n[2],n[3]),B.depth.enabled=M,B.scissor.enabled=!1,i},f.prototype.fromSkybox=function(){return this._fromCamera(function(v){v.s({"camera.onlySky":!0})})},f.prototype.fromScene=function(l){return this._fromCamera(function(D){D.s({"camera.onlySky":!1}),l&&l(D)})},f.prototype.fromNode=function(e){var t=this.gv.getData3dUI(e),C=t._42;t._42=wh;var f=this.gv.getSkybox(),q=e.p3();if(f){var U=f.p3();f.p3(q)}var F=this.fromScene(function(Y){Y.p3(q)});return t._42=C,f&&f.p3(U),F},f.prototype.fromSceneProbe=function(F,a,m){var J=this.gv,A=J.getSkybox();if(A){var D=A.p3();A.p3(F)}if(m){var P=J.isVisible;J.isVisible=function(Y){var q=m(Y);return q!==p?q:P.call(J,Y)}}var v=this.fromScene(function(T){T.p3(F),T.s("camera.near",a)});return m&&(J.isVisible=P),A&&A.p3(D),v},f.prototype._fromCamera=function(u){var D=this.gv,R=D.getCamera();u&&u(R);var L=new Rj(D,c,c,{cube:!0}),k=D.getGL(),F=D.getViewport(k),v=this.setEnvmapByProbeId,p=this.onBeforeRender;this.setEnvmapByProbeId=function(m){m.envMap=k._emptyTexture},this.onBeforeRender=wh,R.attachRenderTarget(L),R.render(D),R.detachRenderTarget(),this.setEnvmapByProbeId=v,this.onBeforeRender=p,D.setViewport(k,F[0],F[1],F[2],F[3]);var V=this.fromTexture(L.texture,!0);return L.releaseTexture(),V},f.prototype._allocateTargets=function(){return new Rj(this.gv,3*l,3*l,{magFilter:Hh.NEAREST,minFilter:Hh.NEAREST})},f.prototype._textureToCubeUV=function(i,d,h){var Z,y=this.gv;h?null==(Z=this._cubemapShader)&&(this._cubemapShader=Z=this.createShader(u())):null==(Z=this._equirectShader)&&(this._equirectShader=Z=this.createShader(A()));var I=y.getGL();d.bind(I),this._setViewport(d,0,0,3*l,2*l);var f=y.getRenderState();f.useProgram(Z);var L=f.directUniforms(),W=f.directAttribs();L.envMap=i,h||(L.texelSize=this.rectSize);var k=V[0];W.position=jj(I,null,k.vs,X,3),W.uv=jj(I,null,k.uv,X,2),W.faceIndex=jj(I,null,k.faceIs,X,1),Kl(I,0,k.vs.length/3)},f.prototype._applyPMREM=function(X){for(var v,g,t,v=1;H>v;v++)g=Math.sqrt(Z[v]*Z[v]-Z[v-1]*Z[v-1]),t=D[(v-1)%D.length],this._blur(X,v-1,v,g,t)},f.prototype._setViewport=function(G,f,k,o,q){var A=this.gv;A.setViewport(A.getGL(),f,k,o,q),A.getRenderState().directState().scissor.box=[f,k,o,q]},f.prototype._blur=function(E,j,h,_,H){var i=this._pingPongRenderTarget;this._halfBlur(E,i,j,h,_,"latitudinal",H),this._halfBlur(i,E,h,h,_,"longitudinal",H)},f.prototype.createShader=function(K){var c=this.gv;return c.getPostProcessing().createShader(c.getGL(),K).program},f.prototype._halfBlur=function(U,q,F,P,H,L,B){var S=this.gv,Q=this._blurMaterial;if("latitudinal"===L||"longitudinal"===L){Q||(this._blurMaterial=Q=this.createShader(g($)));var Z=S.getGL();q.bind(Z);var Y=3,n=S.getRenderState();n.useProgram(Q);var r,N,C,o=n.directUniforms(),x=n.directAttribs(),D=j[F]-1,G=isFinite(H)?Math.PI/(2*D):2*Math.PI/(2*$-1),_=H/G,O=isFinite(H)?1+Math.floor(Y*_):$,a=[],y=0;for(r=0;$>r;++r)N=r/_,C=Math.exp(-N*N/2),a.push(C),0==r?y+=C:O>r&&(y+=2*C);for(r=0;r<a.length;r++)a[r]=a[r]/y;o.envMap=U.texture,o.samples=O,o.weights=a,o.latitudinal="latitudinal"===L,B&&(o.poleAxis=B),o.dTheta=G,o.mipInt=s-F;var f=j[P],N=3*Math.max(0,l-2*f),M=(0===P?0:2*l)+2*f*(P>s-b?P-s+b:0);
this._setViewport(q,N,M,3*f,2*f);var z=V[P];x.position=jj(Z,null,z.vs,X,3),x.uv=jj(Z,null,z.uv,X,2),x.faceIndex=jj(Z,null,z.faceIs,X,1),Kl(Z,0,z.vs.length/3),q.unbind(Z)}};var b=4,s=8,l=Math.pow(2,s),Q=[.125,.215,.35,.446,.526,.582],H=s-b+1+Q.length,$=20,e=(1+Math.sqrt(5))/2,T=1/e,D=[new Zh(1,1,1),new Zh(-1,1,1),new Zh(1,1,-1),new Zh(-1,1,-1),new Zh(0,e,T),new Zh(0,e,-T),new Zh(T,0,e),new Zh(-T,0,e),new Zh(e,T,0),new Zh(-e,T,0)],q=function(){for(var g=[],t=[],R=[],q=s,F=0;H>F;F++){var T=Math.pow(2,q);t.push(T);var C=1/T;F>s-b?C=Q[F-s+b-1]:0==F&&(C=0),R.push(C);for(var u=1/(T-1),X=-u/2,d=1+u/2,D=6,i=[],r=[],h=[],E=0;D>E;E++){var W=2*(E%3)/3-1,l=E>2?0:-1;i.push(W,l,0,W+2/3,l,0,W+2/3,l+1,0,W,l,0,W+2/3,l+1,0,W,l+1,0),r.push(X,X,d,X,d,d,X,X,d,d,X,d),h.push(E,E,E,E,E,E)}g.push({vs:new en(i),uv:new en(r),faceIs:new en(h)}),q>b&&q--}return{_lodPlanes:g,_sizeLods:t,_sigmas:R}}(),V=q._lodPlanes,j=q._sizeLods,Z=q._sigmas,c=E.EnvmapTextureSize}();var jq=["left","front","right","back","top","bottom"],rr=Gq._RenderList=function(){function V(){m.length=0,u.length=0,i={}}function Q(A){var t,r,l,P,e=A.gv,a=A.data,J=A.shapeModel;if(J){var Z,s,T,k=a.s("shape3d.transparent")||a.s("points.transparent");for(Kc(J)||(Z=Qn(J.transparent,a,e),J=[J]),l=0,P=J.length;P>l;l++)T=J[l],s=Qn(T.transparent,a,e),s===p&&(s=Z),s===p&&(s=k),s?r=!0:t=!0}for(l=0,P=jq.length;P>l;l++){var W=A[jq[l]];W&&(W.transparent?r=!0:t=!0)}e.isLabelVisible(a)&&(A.labelInfo&&(a.s(lp+".transparent")?r=!0:t=!0),A.label2Info&&(a.s(_m+".transparent")?r=!0:t=!0)),e.isNoteVisible(a)&&(A.noteInfo&&(a.s(Pl+".transparent")?r=!0:t=!0),A.note2Info&&(a.s(Io+".transparent")?r=!0:t=!0)),A._38o&&(r=t=!0),r||(t=!0),A._renderParams={opaque:t,transparent:r}}function C(S,A){A&&Q(S);var y=S.data,E=y._id;if(!i[E]){i[E]=!0;var k=S._renderParams;k&&k.visible!==!1&&(S={ui:S,data:y,z:0,id:E},k.opaque&&m.push(S),k.transparent&&u.push(S))}}function v(q,Q){if(u.length>1){for(var C,$,l=[0,0,0,0],g=0,W=u.length;W>g;g++)C=u[g].data,($=C._position)?(l[0]=$.x,l[1]=C._54O,l[2]=$.y,l[3]=1,fm(l,Q),u[g].z=l[2]/l[3]):u[g].z=0;u.sort(q||k)}}function d(c){c?(ng(O,P,c),ng(F,o,c),ng(h,N,c)):(O=this.batchModelMap={},P=this.batchIndexMap={},F=this.polylineModelMap={},o=this.polylineIndexMap={},h=this.wireframeModelMap={},N=this.wireframeIndexMap={}),this.markBatchInvalid()}function a(T){T?ng(O,P,T):(O=this.batchModelMap={},P=this.batchIndexMap={}),this.markBatchInvalid()}function c(t){t?ng(F,o,t):(F=this.polylineModelMap={},o=this.polylineIndexMap={}),this.markBatchInvalid()}function z(O){O?ng(h,N,O):(h=this.wireframeModelMap={},N=this.wireframeIndexMap={}),this.markBatchInvalid()}function w(){return this._batchInvalid}function W(){this._batchInvalid=!0}function I(){this._batchInvalid=null}var m=[],u=[],O={},P={},F={},o={},h={},N={},i={};return{opaque:m,transparent:u,init:V,push:C,batchModelMap:O,batchIndexMap:P,polylineModelMap:F,polylineIndexMap:o,wireframeModelMap:h,wireframeIndexMap:N,ivBatch:d,ivModelBatch:a,ivPolylineBatch:c,ivWireframeBatch:z,markBatchInvalid:W,isBatchInvalid:w,onUpdated:I,sort:v}},tr=Gq._RenderLists=function(){function n(){for(var A in E)E[A].init()}function w(){for(var d in E)E[d].onUpdated()}function z(F,A){F=F||"main";var t=E[F];return!t&&A&&(t=E[F]=new rr),t}function Q(A,O){var U=A.data.getRenderLayer(),s=z(U,!0);s.push(A,O)}function p(z){for(var x in E)z(E[x])}var E={};return{init:n,onUpdated:w,get:z,push:Q,each:p,lists:E}},Rj=Gq.RenderTarget=function(G,t,B,b){var I,g=this;null!=t&&t.canvas?(I=t,t=B,B=b,b=arguments[4]):I=G.getGL(),b=b||{},b.cube===!!b.cube,b.samples=b.cube?0:Math.min(G._glCapabilities.maxSamples,b.samples&&b.samples>1&&2===G._webGLVersion?b.samples:0),g.options=b,g.uuid=S.Math.generateUUID(),g.gv=G,g.init(G,I,b),g.format=b.format||Hh.RGBA,g.generateMipmaps=!!b.generateMipmaps,b.samples&&!G._glCapabilities._maxSamplesChecked?g.setSize(I,t||1,B||1):g.setSize(I,t,B)};b.assign(Gq.RenderTarget.prototype,{bind:function(E,f){var X=this.options;if(X.autoSize){var p=this.gv,L=p.getDevicePixelRatio(),Q=p.getWidth()*L,g=p.getHeight()*L;this.setSize(E,Q,g)}X.cube?hp(E,this.frame[f]):hp(E,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(B){eb(B),this.options.samples&&(B.bindFramebuffer(B.READ_FRAMEBUFFER,this._MSAAFbo),B.bindFramebuffer(B.DRAW_FRAMEBUFFER,this.frame),B.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,B.COLOR_BUFFER_BIT,B.NEAREST),B.bindFramebuffer(B.READ_FRAMEBUFFER,null),B.bindFramebuffer(B.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(d,G,h){var F=this,O=h.samples,f=h.cube,Z=F.texture=G.createTexture(),j=f?Hh.TEXTURE_CUBE_MAP:Hh.TEXTURE_2D;G.activeTexture(G.TEXTURE0),G.bindTexture(j,Z),G.texParameteri(j,G.TEXTURE_WRAP_S,h.wrapS||G.CLAMP_TO_EDGE),G.texParameteri(j,G.TEXTURE_WRAP_T,h.wrapT||G.CLAMP_TO_EDGE);var s=O?G.NEAREST:G.LINEAR;if(G.texParameteri(j,G.TEXTURE_MIN_FILTER,h.minFilter||s),G.texParameteri(j,G.TEXTURE_MAG_FILTER,h.magFilter||s),G.bindTexture(j,null),f){F.depth=[],F.frame=[];for(var x=0;6>x;x++)F.depth[x]=G.createRenderbuffer(),F.frame[x]=G.createFramebuffer()}else F.depth=G.createRenderbuffer(),F.frame=G.createFramebuffer();F.assureTexture()},assureTexture:function(){var U=this;U.gv._2Oi(U.uuid,U.texture,"default")},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(Z,E,s){var u=this;if(E=Math.round(E),s=Math.round(s),E&&s&&(u.width!==E||u.height!==s)){u.width=E,u.height=s;var c=Z.RENDERBUFFER,w=Z.FRAMEBUFFER,Y=u.options.samples,a=u.options.cube,B=a?Hh.TEXTURE_CUBE_MAP:Hh.TEXTURE_2D;if(Y){var R=u.gv._glCapabilities;if(!R._maxSamplesChecked){for(Z.bindRenderbuffer(c,u.depth),Z.getError();Y>1&&(Z.renderbufferStorageMultisample(c,Y,Z.DEPTH_COMPONENT16,E,s),Z.getError());)Y=Math.floor(Y>>1);1>=Y&&(Y=0,Z.texParameteri(B,Z.TEXTURE_MIN_FILTER,u.options.minFilter||Z.LINEAR),Z.texParameteri(B,Z.TEXTURE_MAG_FILTER,u.options.magFilter||Z.LINEAR),Z.renderbufferStorage(c,Z.DEPTH_COMPONENT16,E,s)),R._maxSamplesChecked=!0,R.maxSamples=u.options.samples=Y,Z.bindRenderbuffer(c,X)}}if(Y&&(u._MSAAFbo||(u._MSAAFbo=Z.createFramebuffer(),u._MSAARbO=Z.createRenderbuffer()),Z.bindRenderbuffer(c,u._MSAARbO),Z.renderbufferStorageMultisample(Z.RENDERBUFFER,Y,Z.RGBA8,E,s),Z.bindFramebuffer(w,u._MSAAFbo),Z.framebufferRenderbuffer(w,Z.COLOR_ATTACHMENT0,c,u._MSAARbO),Z.framebufferRenderbuffer(w,Z.DEPTH_ATTACHMENT,c,u.depth),Z.bindFramebuffer(w,null),Z.bindRenderbuffer(c,null)),Z.activeTexture(Z.TEXTURE0),Z.bindTexture(B,u.texture),a)for(var o=Z.TEXTURE_CUBE_MAP_POSITIVE_X,F=0;6>F;F++)u.setupFrameBufferTextureAndDepth(Z,u.frame[F],u.depth[F],o+F);else u.setupFrameBufferTextureAndDepth(Z,u.frame,u.depth,Z.TEXTURE_2D);if(u.generateMipmaps&&(2===gv._webGLVersion||or.isPOT(E)&&or.isPOT(s))){Z.generateMipmap(B);var W=u.options.minFilter||(Y?Z.NEAREST:Z.LINEAR);Z.texParameteri(B,Z.TEXTURE_MIN_FILTER,W===Z.NEAREST?Z.NEAREST_MIPMAP_NEAREST:Z.LINEAR_MIPMAP_LINEAR)}Z.bindTexture(B,null)}},setupFrameBufferTextureAndDepth:function(T,d,w,f){var n=this,F=n.format;T.texImage2D(f,0,F,this.width,this.height,0,F,T.UNSIGNED_BYTE,null),T.bindFramebuffer(T.FRAMEBUFFER,d),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,f,n.texture,0),this.setupRenderBufferStorage(T,w),T.bindFramebuffer(T.FRAMEBUFFER,null)},setupRenderBufferStorage:function(C,O){var S=this,R=C.RENDERBUFFER;C.bindRenderbuffer(R,O);var H=S.options.samples;H?C.renderbufferStorageMultisample(R,H,C.DEPTH_COMPONENT16,S.width,S.height):(C.renderbufferStorage(R,C.DEPTH_COMPONENT16,S.width,S.height),C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,R,O)),C.bindRenderbuffer(C.RENDERBUFFER,null)},toCanvas:function(){var A=this,J=A.gv.getGL();hp(J,A.frame);var j=A.width,c=A.height,M=new Uint8Array(4*j*c);J.readPixels(0,0,j,c,A.format,J.UNSIGNED_BYTE,M),eb(J);var w=i.createElement("canvas");w.width=j,w.height=c;var W=w.getContext("2d"),q=W.createImageData(j,c);return q.data.set(M),W.putImageData(q,0,0),w}});var Ni=Gq.Interactor=function(M){this.gv=this.g3d=M};de("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(j){this.gv.fi(j)},startDragging:function(O){Aj(this,O)}});var Dd=Gq.DefaultInteractor=function(Y){jl(Dd,this,[Y])};de("DefaultInteractor",Ni,{getState:function(){return this._62O},setState:function(V){this._62O=V},getDataInfoAt:function(X,Q){var I=this.gv,o=I.getDataInfoAt(X);if(!I.isBlockSelectable()||!o||!o.data)return o;if(!Q&&I.isSelected(o.data))return o;for(var Z=o.data;(Z=Z.getParent())&&Z instanceof S.Block&&I.isSelectable(Z);){var D=I.isSelected(Z);if(D&&Q)break;if(o={data:Z,part:o.part},D&&!Q)break}return o},handle_contextmenu:function(y){Bi(y)},handle_mousewheel:function(p){this.gv.handleScroll(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(K){2===K.axis&&this.gv.handleScroll(K,-K.detail)},handle_keydown:function(x){this.gv.handleKeyDown(x)},handle_mousedown:function(v){this.handle_touchstart(v)},handle_touchstart:function(I){Bi(I);var N=this,G=N.gv,T=Dj(I),Y=N.getDataInfoAt(I),g=Y?Y.data:X,v=Y?Y.part:X,b=G.sm(),x=Sm(I),S=$r(I);G.setFocus(I)&&(N._62O=X,N._57I=X,N.pendingClickThrough=X,N.__lastClientPoint__=Wc(I),g?Yd(I)?b.co(g)?b.rs(g):b.as(g):b.co(g)?g instanceof qk&&g.isClickThroughEnabled()&&Dj(I)&&(N.pendingClickThrough=Wc(I)):b.ss(g):T&&(Yd(I)?G.isRectSelectable()&&(N._62O=th):N._57I=Wc(I)),N._31Q&&(yl(N._31Q),delete N._31Q,delete N._32Q),N._62O||(G.isFirstPersonMode()&&(am(I)||Op(I)||S>2?N._62O="pan":G.isMouseRoamable()||qc(I)?(N._62O="roaming",N.foward=x&&Dj(I),N._32Q=vk(),N._31Q=hm(N.tick,N)):T||(N._62O="roaming")),N._62O||(T&&x&&Qs[v]?(N._62O=v,N.p3=g.p3()):T&&x&&mo(g)&&G.isSelected(g)?G.isMovable(g)?(N._62O="move",N.p3=g.p3(),N.movedata=g):G._39Q(g)&&(N._62O="none"):qc(I)&&(S>2?N._62O="pan":2===S&&(N.dist=He(I),N._62O="pinch")))),N.point=G.lp(I),Aj(N,I),re(I)?G.handleDoubleClick(I,g,v):G.handleClick(I,g,v))},tick:function(){var i=this,z=i.gv,F=z._moveStep;i.point&&z.isWalkable()&&(i._32Q&&(F*=(vk()-i._32Q)/50),z.walk(i.foward?F:-F),i._32Q=vk(),i._31Q=hm(i.tick,i))},handle_mouseup:function(d){this.handle_touchend(d)},handle_touchend:function(d){var S=this._57I;if(S&&(Fb(S,Wc(d))<=1&&this.gv.sm().cs(),this._57I=X),S=this.pendingClickThrough){if(Fb(S,Wc(d))<=1){var O=this.getDataInfoAt(d);O&&O.data instanceof qk&&O.data.isClickThroughEnabled()&&(O=this.getDataInfoAt(d,!0),O&&(d.clickThrough=!0,this.gv.sm().ss(O.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(Z){var w,t,B=this,f=B.gv,N=B._62O,l=B.point,G=f.dm(),m=f.lp(Z),r=m.x-l.x,c=m.y-l.y,d=f.getWidth(),W=f.getHeight();if(d&&W){var s=Wc(Z),Y=Ln(f,s,B.__lastClientPoint__),V=Fb({x:0,y:0},Y),j=-$*r/d,x=-$*c/W;if("roaming"===N)B.rotate(Z,j/2,x/2);else if(N===Ks||N===Ls||N===Ms)f._86O||G.beginTransaction(),f.fi({kind:f._86O?"betweenEditRotation":"beginEditRotation",event:Z}),f._86O=1,f.sm().each(function(z){if(mo(z)&&f.isRotationEditable(z)){var L=a(j)>a(x)?j:x;N===Ks?z.setRotationX(z.getRotationX()+L):N===Ls?z.setRotationY(z.getRotationY()+L):N===Ms&&z.setRotationZ(z.getRotationZ()+L)}});else if("move"===N||Qs[N]){if(N===Ns||N===Os||N===Ps)f._87O||G.beginTransaction(),f.fi({kind:f._87O?"betweenEditScale":"beginEditScale",event:Z}),f._87O=1;else{if(!f._moving){if(V<E.touchMoveThreshold)return;G.beginTransaction()}f.fi({kind:f._moving?"betweenMove":"beginMove",event:Z}),f._moving=1}var Q,o=B.p3,e=f.getPositionInfo(o),g=Me(f);Q=N===Hs?"x":N===Is?"y":N===Js?"z":N===Ns?"sx":N===Os?"sy":N===Ps?"sz":f.getMoveMode(Z,B.movedata),r=r/d*e.width,c=-1*c/W*e.height;var T,A,q=[g[0]*r,g[4]*r,g[8]*r],X=[g[1]*c,g[5]*c,g[9]*c],D=q[0]+X[0],v=q[1]+X[1],h=q[2]+X[2],K=[o[0]+D,o[1]+v,o[2]+h],J=Fi(f.getEye(),K,!0);if("xyz"===Q?(T=K,f.moveSelection(D,v,h)):"xz"===Q?(T=pg(f,o,[0,1,0],K),T&&f.moveSelection(T[0]-o[0],0,T[2]-o[2])):"xy"===Q?(T=pg(f,o,[0,0,1],K),T&&f.moveSelection(T[0]-o[0],T[1]-o[1],0)):"yz"===Q?(T=pg(f,o,[1,0,0],K),T&&f.moveSelection(0,T[1]-o[1],T[2]-o[2])):"x"===Q||"sx"===Q?(J[0]=0,T=pg(f,o,J,K),T&&(A=T[0]-o[0],"x"===Q?f.moveSelection(A,0,0):f.sm().each(function(J){mo(J)&&f.isSizeEditable(J)&&(w=J.getScaleX()+A/100,t=w/J.getScaleX(),J.setScaleX(w),am(Z)&&(J.setScaleY(J.getScaleY()*t),J.setScaleTall(J.getScaleTall()*t)))}))):"y"===Q||"sy"===Q?(J[1]=0,T=pg(f,o,J,K),T&&(A=T[1]-o[1],"y"===Q?f.moveSelection(0,A,0):f.sm().each(function(E){mo(E)&&f.isSizeEditable(E)&&(w=E.getScaleTall()+A/100,t=w/E.getScaleTall(),E.setScaleTall(w),am(Z)&&(E.setScaleY(E.getScaleY()*t),E.setScaleX(E.getScaleX()*t)))}))):("z"===Q||"sz"===Q)&&(J[2]=0,T=pg(f,o,J,K),T&&(A=T[2]-o[2],"z"===Q?f.moveSelection(0,0,A):f.sm().each(function(F){mo(F)&&f.isSizeEditable(F)&&(w=F.getScaleY()+A/100,t=w/F.getScaleY(),F.setScaleY(w),am(Z)&&(F.setScaleX(F.getScaleX()*t),F.setScaleTall(F.getScaleTall()*t)))}))),!T)return;B.p3=T}else if(N===th){var z=B.div;z||(z=B.div=_j(),vb(B.getView(),z),z.op=l,z.style.background=f.getRectSelectBackground()),f.fi({kind:f._rectSelecting?"betweenRectSelect":"beginRectSelect",event:Z}),f._rectSelecting=1,z.rect=$q(z.op,m),zd(z,z.rect)}else if("pinch"===N&&2===$r(Z)){f.fi({kind:f._pinching?"betweenPinch":"beginPinch",event:Z}),f._pinching=1;var A=He(Z);f._lastZoomLP||(f._lastZoomLP=Zb(Z)),f.handlePinch(A,B.dist),B.dist=A}else"pan"===N||am(Z)||Op(Z)?B.pan(Z,r,c):"none"===N||f.isFirstPersonMode()||B.rotate(Z,j,x);B.point=m}},pan:function(R,c,M){var U=this.gv;if(U.isPannable()){var H=U.getWidth(),v=U.getHeight();if(!H||!v)return;var X=U.getCenterInfo(),Q=c/H*X.width,w=-1*M/v*X.height;U.fi({kind:U._panning?"betweenPan":"beginPan",event:R}),U._panning=1,U.pan(-Q,-w)}},rotate:function(N,Y,a){var _=this.gv;_.isRotatable()&&(_.fi({kind:_._rotating?"betweenRotate":"beginRotate",event:N}),_._rotating=1,_.rotate(Y,a))},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(P){var i=this,S=i.gv,N=S.dm(),D=i.div;if(D){var n=S.getDatasInRect(D.rect);if(!n.isEmpty()){var Q=S.sm(),o=Q.toSelection(),T=am(P),Z=P.altKey;n.each(function(R){Q.co(R)?(!T||T&&Z)&&o.remove(R):(!Z||T&&Z)&&o.add(R)}),Q.ss(o)}cp(D)}S._moving&&(delete S._moving,S.fi({kind:"endMove",event:P}),S.onMoveEnded(),N.endTransaction()),S._panning&&(delete S._panning,S.fi({kind:"endPan",event:P}),S.onPanEnded()),S._rotating&&(delete S._rotating,S.fi({kind:"endRotate",event:P}),S.onRotateEnded()),S._86O&&(delete S._86O,S.fi({kind:"endEditRotation",event:P}),N.endTransaction()),S._87O&&(delete S._87O,S.fi({kind:"endEditScale",event:P}),N.endTransaction()),S._pinching&&(delete S._pinching,S.fi({kind:"endPinch",event:P}),S.onPinchEnded()),S._rectSelecting&&(delete S._rectSelecting,S.fi({kind:"endRectSelect",event:P}),S.onRectSelectEnded()),S._walking&&(delete S._walking,S.fi({kind:"endWalk",event:P}),S.onWalkEnded()),S._lastZoomLP=S._lastZoomHit=null,i.dist=i.point=i._62O=i.p3=i.movedata=i.div=i._57I=i.pendingClickThrough=i._32Q=i._31Q=i.foward=X,i.__lastClientPoint__=X}});var kq=Gq.MapInteractor=function(P){jl(kq,this,[P]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};de("MapInteractor",Ni,{setUp:function(){kq.superClass.setUp.call(this);var R=this.gv;this.__oldMinPhi__=R.getRotateMinPhi(),this.__oldMaxPhi__=R.getRotateMaxPhi(),R.setRotateMinPhi(this._minPhi),R.setRotateMaxPhi(this._maxPhi)},tearDown:function(){kq.superClass.tearDown.call(this);var L=this.gv;L.setRotateMinPhi(this.__oldMinPhi__),L.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(i){Bi(i)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta/40)},handle_DOMMouseScroll:function(w){2===w.axis&&this.gv.handleScroll(w,-w.detail)},handle_keydown:function(v){this.gv.handleKeyDown(v)},handle_mousedown:function(t){this.handle_touchstart(t)},handle_touchstart:function(y){Bi(y);var C=this,D=C.gv;if(D.setFocus(y)){var p=D.getDataInfoAt(y),x=p?p.data:X,d=p?p.part:X,i=C.editing={point:D.lp(y)};qc(y)?i.touch=!0:(i.touch=!1,i.clickLeft=Dj(y),i.pan=Op(y)?!0:"left"===this.panButton===i.clickLeft),x&&D._39Q(x)&&(i.preventDefault=!0),Aj(C,y),re(y)?D.handleDoubleClick(y,x,d):D.handleClick(y,x,d)}},handle_mouseup:function(v){this.handle_touchend(v)},handle_touchend:function(){},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(E){var Z=this,B=Z.gv,A=Z.editing;if(A){var r=B.lp(E),c=A.point,V=r.x-c.x,o=r.y-c.y;if(!A.moved){if(Math.abs(V)<Z.threshold&&Math.abs(o)<Z.threshold&&!(E.touches&&E.touches.length>1))return;A.moved=!0}if(!A.preventDefault)if(A.point=r,A.touch){var l=E.touches.length;if(2!==l)Z.pan(E,V,o);else{if(1>=l)return;var x=E.touches,M={x:x[0].clientX,y:x[0].clientY},Q={x:x[1].clientX,y:x[1].clientY},v={x:Q.x-M.x,y:Q.y-M.y},K=A.lastCenter,m=Math.atan2(v.y,v.x),e=A.theta,O=0;e==X?e=A.theta=m:(O=m-e,A.thetaStarted||Math.abs(O)>Z.touchRotateThreshold?(A.thetaStarted=!0,A.theta=m):O=0);var U=f*(M.y+Q.y)/2/B.getHeight(),g=A.phi,C=0;g==X?g=A.phi=U:(C=U-g,A.phiStarted||Math.abs(C)>Z.touchRotateThreshold?(A.phiStarted=!0,A.phi=U):C=0);var d,Y=Math.sqrt(v.x*v.x+v.y*v.y),a=A.vlen;if(a){var y=M.x-K.x,u=M.y-K.y,I=Q.x-K.x,D=Q.y-K.y,k=Math.sqrt(y*y+u*u),j=Math.sqrt(I*I+D*D),T=a/2,i=Z._sign2(k-T),n=Z._sign2(j-T);0>i*n||0===i&&0===n?(d=1,A.vlen=Y):(d||(d=Y/a),A.scaleStarted||Math.abs(d-1)>Z.touchScaleThreshold?(A.vlen=Y,A.scaleStarted=!0):d=1)}else a=A.vlen=Y,d=1;1!==d&&B.setZoom(d),(C||O)&&Z.rotate(E,O,-C),A.lastCenter={x:(Q.x+M.x)/2,y:(Q.y+M.y)/2}}}else if(A.pan)Z.pan(E,V,o);else{var L=B.getWidth(),q=B.getHeight();if(!L||!q)return;var R=-$*V/L,F=-$*o/q;Z.rotate(E,R,F)}}},_sign2:function(x){return Math.abs(x)<this._touchScaleCheckAccuracy?0:x>0?1:-1},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},getDataInfoAt:function(E,u){var h=this.gv,x=h.getDataInfoAt(E);if(!h.isBlockSelectable()||!x||!x.data)return x;if(!u&&h.isSelected(x.data))return x;for(var z=x.data,f=x.part;(z=z.getParent())&&z instanceof S.Block&&h.isSelectable(z);){var s=h.isSelected(z);if(s&&u)break;if(x={data:z,part:f},s&&!u)break}return x},handleWindowTouchEnd:function(K){var z=this,y=z.editing;if(z.editing=null,y){var E=z.gv;if(y.moved||!y.clickLeft&&!y.touch)E._panning=null,E._rotating=null,E.fi({kind:y.pan?"endPan":"endRotate",event:K});else{var Q=z.getDataInfoAt(K),U=Q&&Q.data;U instanceof qk&&U.isClickThroughEnabled()&&(Q=z.getDataInfoAt(K,!0),Q&&(U=Q.data)),U?E.sm().setSelection([U]):E.sm().clearSelection()}}},pan:function(a,z,j){var q=this,G=q.gv;if(G.isPannable()){var f=G.getWidth(),K=G.getHeight();if(f&&K){var $=G.getCenterInfo(),_=-z/f*$.width,u=1*j/K*$.height;G.fi({kind:G._panning?"betweenPan":"beginPan",event:a}),G._panning=1;var M=q.keepHorizon,r=q.editing.touch;if((r&&a.touches&&a.touches.length>1||!r&&am(a))&&(M=!M),!M)return G.pan(_,u);if(_||u){var c=Me(G),L=[c[0]*_,c[4]*_,c[8]*_],l=[c[1],0,c[9]],U=Math.sqrt(l[0]*l[0]+l[2]*l[2]);U&&(l=[l[0]/U*u,0,l[2]/U*u]);var Y=L[0]+l[0],E=L[1]+l[1],B=L[2]+l[2],s=G._center,Q=G._eye;s[0]+=Y,s[1]+=E,s[2]+=B,Q[0]+=Y,Q[1]+=E,Q[2]+=B,G.fp(kj,X,Q),G.fp(Yn,X,s)}}}},rotate:function(b,L,h){var A=this,Q=A.gv;if(Q.isRotatable()){var M=Q._center,W=Q._eye,G=Fi(W,M),Z=$g(B(G[0]*G[0]+G[2]*G[2]),G[1]),v=ag(Q,Z+h);h=v-Z,Q.fi({kind:Q._rotating?"betweenRotate":"beginRotate",event:b}),Q._rotating=1,Q.rotate(L,h)}}}),b.defineProperties(kq.prototype,{panButton:{get:function(){return this._panButton},set:function(Q){this._panButton=Q}},minPhi:{get:function(){return this._minPhi},set:function($){this.gv.setRotateMinPhi(this._minPhi=$)}},maxPhi:{get:function(){return this._maxPhi},set:function(T){this.gv.setRotateMaxPhi(this._maxPhi=T)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(N){this._keepHorizon=N}},threshold:{get:function(){return this._threshold},set:function(D){this._threshold=D}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(D){this._touchScaleThreshold=D}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(T){this._touchRotateThreshold=T}}});var Tr,Bs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",vg=32,ue=Gq.GlobeInteractor=function(Q,D){jl(ue,this,[Q]);var l,U=D.radius||6378137,F=this,c=null;Tr||(Tr=_j(),Tr.style.border="",Tr.style.backgroundImage="url("+Bs+")");var g=new nd,B=new Zh,Z=new Zh,O=new Zh,p=new Hp,w="number"==typeof U?{x:U,y:U,z:U}:U,J={center:new Zh(0,0,0),radius:w},r=function(u){Q._81O=null;var s=Q.getHitPosition(u,Q.getCenter(),B.copy(Q.getEye()).sub(Z.copy(Q.getCenter())).toArray());return p.origin.copy(Q.getEye()),p.direction.copy(s).sub(p.origin).normalize(),p.intersectEllipsoid(J)},G=function(b,D){Q._81O=null,p.origin.copy(Q.getEye());for(var R,N,q=Q.getCenter(),C=B.copy(Q.getEye()).sub(Z.copy(Q.getCenter())).toArray(),L=1,H=16,w=0,m=1,k={x:0,y:0};H--;){if(k.x=D.x+(b.x-D.x)*L,k.y=D.y+(b.y-D.y)*L,R=Q.getHitPosition(k,q,C),p.direction.copy(R).sub(p.origin).normalize(),N=p.intersectEllipsoid(J),N&&1===L)return{hit:N};N?w=L:m=L,L=(w+m)/2}return{hit:N,out:1>L}},C=function(A,H){if(c){var I=Date.now();c.deltaTime=c.lastTime?I-c.lastTime:1e3,c.lastTime=I,c.lastAxis=A,c.lastAngle=H}H&&(g.setFromAxisAngle(A,H),Q.setEye(B.copy(Q.getEye()).applyQuaternion(g).toArray()),Q.setCenter(B.copy(Q.getCenter()).applyQuaternion(g).toArray()),Q.setUp(B.copy(Q.getUp()).applyQuaternion(g).toArray()))};F._showCrossIcon=function(U){vb(F.getView(),Tr),zd(Tr,{x:U.clientX-vg/2,y:U.clientY-vg/2,width:vg,height:vg})},F._hideCrossIcon=function(){cp(Tr)},F._scrollImpl=function(d,A){c={point:Q.lp(d),screen:Wc(d),hit:r(d),type:"right"},c.hitNormalize=c.hit?c.hit.clone().normalize():new Zh;var e={clientX:c.screen.x,clientY:c.screen.y+10*A};F._handleMoveImpl(e),F._endMoveImpl(e)},F._startMoveImpl=function(i){l&&(l.stop(!0),l=null),c={point:Q.lp(i),screen:Wc(i),hit:r(i)},c.hitNormalize=c.hit?c.hit.clone().normalize():new Zh,qc(i)?1===i.touches.length?c.hit&&(c.type="left"):2===i.touches.length&&(c.type="touch2"):(Dj(i)?c.hit&&(c.type="left"):Pi(i)?c.type="right":Op(i)&&c.hit&&(c.type="middle"),!c.hit||"right"!==c.type&&"middle"!==c.type||F._showCrossIcon(i)),c.type&&Aj(F,i)},F._handleMoveImpl=function(t){if(c)switch(c.type){case"left":return F._handleLeft(t);case"right":return F._handleRight(t);case"middle":return F._handleMiddle(t);case"touch2":return F._handleTouch2(t)}},F._endMoveImpl=function(){if(c){if(this._hideCrossIcon(),"left"===c.type||"middle"===c.type){var W=1e3*(c.lastAngle/(c.deltaTime||30)),v=c.lastAxis,f=c.lastTime,D=function(){var u=Date.now(),y=(u-f)/1e3;return f=u,W*=Math.pow(Math.abs(F.decelerationRate),3*y),Math.abs(W)<.01?(W=0,l&&l.stop(),void 0):(C(v,W*y),void 0)};l=Ti({action:function(){D(arguments)},duration:5e3})}c=null}},F._handleLeft=function(I){if(!c.finished){var K=Wc(I),Q=G(K,c.lastScreen||c.screen);if(c.lastScreen=K,!Q.hit)return c.finished=!0,F._endMoveImpl(I),void 0;var D=Q.hit;D.normalize();var R=c.hitNormalize,w=Math.acos(D.dot(R)),z=D.cross(R).normalize();C(z,w),Q.out&&(c.finished=!0,F._endMoveImpl(I))}},F._handleRight=function(d){var v=c.lastScreen||c.screen,D=v.y;v=c.lastScreen=Wc(d);var m=v.y,$=m-D;if($){var J=Math.min(.5,$*F.scaleSpeed);B.copy(Q.getEye());var l=c.hit;l||(l=B.clone().divide(w).normalize().multiply(w)),Z.copy(B).lerp(l,J),Q.setEye(Z.toArray()),B.copy(Q.getUp()),Z.normalize();var R=B.clone().cross(Z).normalize();if(O.copy(Q.getCenter()),O.sub(R.multiplyScalar(O.dot(R))),Q.setCenter(O.toArray()),c.hit){var o=r(c.screen),h=c.hitNormalize;if(o){o.normalize();var N=Math.acos(o.dot(h)),k=o.cross(h).normalize();N&&C(k,N)}}}};var j=function(w){return Math.abs(w)<.01?0:w>0?1:-1};F._handleTouch2=function(P){var n=P.touches.length;if(2===n){var D=P.touches,W={x:D[0].clientX,y:D[0].clientY},E={x:D[1].clientX,y:D[1].clientY},g={x:E.x-W.x,y:E.y-W.y},F=c.lastCenter,G=Math.atan2(g.y,g.x),S=c.theta,r=0;S==X?S=c.theta=G:(r=G-S,c.thetaStarted||Math.abs(r)>.03?(c.thetaStarted=!0,c.theta=G):r=0);var B,o=Math.sqrt(g.x*g.x+g.y*g.y),l=c.vlen;if(l){var p=W.x-F.x,u=W.y-F.y,a=E.x-F.x,q=E.y-F.y,$=Math.sqrt(p*p+u*u),L=Math.sqrt(a*a+q*q),H=l/2,I=j($-H),A=j(L-H);0>I*A||0===I&&0===A?(B=1,c.vlen=o):(B||(B=o/l),c.scaleStarted||Math.abs(B-1)>.05?(c.vlen=o,c.scaleStarted=!0):B=1)}else l=c.vlen=o,B=1;var g=Z.copy(Q.getEye()).clone();1!==B&&Q.setEye(g.setLength((g.length()-U)/B+U).toArray()),r&&C(g.normalize(),r),c.lastCenter={x:(E.x+W.x)/2,y:(E.y+W.y)/2}}},F._handleMiddle=function(W){var E=Wc(W),Y=c.screen;c.screen=E;var n=(E.y-Y.y)/180*Math.PI*F.rollSpeed;Z.copy(Q.getCenter()).sub(B.copy(Q.getEye())).normalize(),B.copy(Q.getUp()).cross(Z).normalize(),Z.copy(Q.getEye()).sub(c.hit).applyAxisAngle(B,n).add(c.hit);var V=Z.clone();Z.copy(Q.getCenter()).sub(c.hit).applyAxisAngle(B,n).add(c.hit);var G=Z.clone(),b=Z.copy(Q.getUp()).applyAxisAngle(B,n).clone(),w=!1;n>0&&(O.copy(b),Z.copy(G).sub(V).normalize(),B.copy(V).multiplyScalar(-1).normalize(),B.dot(O)-Z.dot(O)>0&&(w=!0)),w||O.copy(c.hit).sub(V).dot(c.hitNormalize)>=0&&(w=!0),w||(Q.setEye(V.toArray()),Q.setCenter(G.toArray()),Q.setUp(b.toArray()));var i=-(E.x-Y.x)/180*Math.PI*F.rotateSpeed;C(c.hitNormalize,i)}};de("GlobeInteractor",Ni,{handle_contextmenu:function(T){Bi(T)},handle_mousewheel:function(H){this._scrollImpl(H,H.wheelDelta/40)},handle_DOMMouseScroll:function(S){2===S.axis&&this._scrollImpl(S,-S.detail)},handle_keydown:function(k){this.gv.handleKeyDown(k)},handle_mousedown:function($){this.handle_touchstart($)},handle_touchstart:function(L){Bi(L);var f=this.gv;if(f.setFocus(L)){var d=f.getDataInfoAt(L),t=d?d.data:X;t&&f.isInteractive(t)||this._startMoveImpl(L);var M=d?d.part:X;re(L)?f.handleDoubleClick(L,t,M):f.handleClick(L,t,M)}},handle_mouseup:function(q){this.handle_touchend(q)},handle_touchend:function(){},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(x){this._handleMoveImpl(x)},handleWindowMouseUp:function(N){this.handleWindowTouchEnd(N)},handleWindowTouchEnd:function(p){this._endMoveImpl(p)}}),b.defineProperties(ue.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(Z){this._rotateSpeed=Z}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(N){this._rollSpeed=N}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(d){this._scaleSpeed=d}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(b){this._decelerationRate=b}}});var sd=function(x){var L=2147483648|x;return[(255&L>>16)/255,(255&L>>8)/255,(255&L)/255,(255&L>>24)/255]},Ds=function(c){this.gv=c,this.gv.pickColorMap={_pickIdUsed:2e3}};Wi(Ds,b,{_iv:!0,iv:function(){this._iv=!0},get:function(Z,B,n){this.validate();var e=this,j=e.gv.getGL();if(!j)return X;var T,H,G=e._resolution,z=Math.round(Z.x*G),q=Math.ceil(Z.width*G),R=Math.ceil(Z.height*G),k=e.height-Math.round(Z.y*G)-R,m=x(q/2),K=new Uint8Array(4*q*R),P=0,V=K.length,N=B?X:new jn,E=B?X:{};if(hp(j,e.frame),j.readPixels(z,k,q,R,j.RGBA,j.UNSIGNED_BYTE,K),eb(j),B){for(;m>=P;P++)for(var f=m-P,S=m+P,J=f;S>=J;J++)for(var d=f;S>=d;d++)if((J===f||J===S||d===f||d===S)&&(T=e.info(K,4*(J*q+d)))){if(n&&n(T)===!1)continue;return T}}else for(;V>P;P+=4)if(T=e.info(K,P)){if(n&&n(T)===!1)continue;H=T.data,E[H._id]||(N.add(H),E[H._id]=H)}return N},info:function(y,m){return this.gv.pickColorMap[(y[m]<<16)+(y[m+1]<<8)+y[m+2]+((127&y[m+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var g=this,E=g.gv,d=E.getGL();if(d){var $=g._resolution=E._pickerResolution*E.getDevicePixelRatio(),v=Math.round($*E.getWidth()),G=Math.round($*E.getHeight()),r=d.RGBA,A=d.TEXTURE_2D,n=d.RENDERBUFFER,o=d.FRAMEBUFFER;if(g.texture||(g.texture=gm(d),g.render=d.createRenderbuffer(),g.frame=d.createFramebuffer()),(g.width!==v||g.height!==G)&&(d.activeTexture(d.TEXTURE0),Sb(d,g.texture),d.texImage2D(A,0,r,v,G,0,r,d.UNSIGNED_BYTE,X),Lg(d,d.TEXTURE_MIN_FILTER,d.LINEAR),d.bindRenderbuffer(n,g.render),d.renderbufferStorage(n,d.DEPTH_COMPONENT16,v,G),hp(d,g.frame),d.framebufferTexture2D(o,d.COLOR_ATTACHMENT0,A,g.texture,0),d.framebufferRenderbuffer(o,d.DEPTH_ATTACHMENT,n,g.render),Sb(d,X),d.bindRenderbuffer(n,X),eb(d),g.width=v,g.height=G),g._iv){g._iv=!1;var K=!1;E._40Q.each(function(A){!K&&A.isBatchInvalid()&&(K=!0)}),K&&E.updateScene(),hp(d,g.frame),d.clear(d.COLOR_BUFFER_BIT),E.overlappingBox.clear(),E.setViewport(d,0,0,v,G),E.renderPickScene(),eb(d)}}}});var Es=function(v){this.gv=v};Wi(Es,b,{gap:0,size:0,_42:function(w,J){var O=this,H=O.gv,d=H._gridGap,I=H._gridSize;if(H._gridVisible){if(O.gap!==d||O.size!==I){for(var A=[],q=H._gridSize/2,b=d*q,r=0;2*q+1>r;r++){var C=6*r,h=6*(2*q+1)+C;A[C]=-b,A[C+1]=0,A[C+2]=-b+r*d,A[C+3]=b,A[C+4]=0,A[C+5]=-b+r*d,A[h]=-b+r*d,A[h+1]=0,A[h+2]=-b,A[h+3]=-b+r*d,A[h+4]=0,A[h+5]=b}O.vs=new en(A),O.gap=d,O.size=I}nn(H),wn(w,J),Wm(w),Ic(w,J,1,H._gridColor,H._buffer.vs,O.vs),Kl(w,0,O.vs.length/3,w.LINES),Ck(w),$l(w,J)}else O.vs=O.gap=O.size=X}});var Fs=function(q){this.gv=q};Wi(Fs,b,{_42:function(B,Z){var c=this.gv,D=c._buffer.vs,j=c._axisXColor,I=c._axisYColor,N=c._axisZColor,O=c._originAxisVisible,P=c._centerAxisVisible;if(O||P){var e=Ao?B.TRIANGLES:B.TRIANGLE_FAN,r=B.LINES;if(nn(c),wn(B,Z),Wm(B),O){var L=c.getCenterInfo(),p=d(L.width,L.height)/5,m=.8*p,C=.05*p;Ic(B,Z,1.5,j,D,new en([0,0,0,p,0,0,m,C,0,m,0,C,m,-C,0,m,0,-C,m,C,0,0,0,0,0,p,0,C,m,0,0,m,C,-C,m,0,0,m,-C,C,m,0,0,0,0,0,0,p,C,0,m,0,C,m,-C,0,m,0,-C,m,C,0,m])),Kl(B,0,2,r),Kl(B,1,6,e),Ic(B,Z,X,I),Kl(B,7,2,r),Kl(B,8,6,e),Ic(B,Z,X,N),Kl(B,14,2,r),Kl(B,15,6,e)}if(P){var E=c._center,w=E[0],u=E[1],V=E[2],L=c.getPositionInfo(E);p=d(L.width,L.height)/20,Ic(B,Z,1.5,j,D,new en([w,u,V,w+p,u,V,w,u,V,w,u+p,V,w,u,V,w,u,V+p])),Kl(B,0,2,r),Ic(B,Z,X,I),Kl(B,2,2,r),Ic(B,Z,X,N),Kl(B,4,2,r)}Ck(B),$l(B,Z)}}});var Gs=function(n){this.gv=n},Hs="edit_tx",Is="edit_ty",Js="edit_tz",Ks="edit_rx",Ls="edit_ry",Ms="edit_rz",Ns="edit_sx",Os="edit_sy",Ps="edit_sz",Qs={};Qs[Hs]=101,Qs[Is]=102,Qs[Js]=103,Qs[Ks]=104,Qs[Ls]=105,Qs[Ms]=106,Qs[Ns]=107,Qs[Os]=108,Qs[Ps]=109,Wi(Gs,b,{_42:function(v,Z,i){var z=this,T=z.gv,P=T.sm().ld();if(P&&T.isEditable(P)&&!T.isEditHelperDisabled()&&mo(P)&&(!T.isFirstPersonMode()||!T.isMouseRoamable()&&!Iq)){nn(T);var p,h=T.isMovable(P),G=T.isRotationEditable(P),Q=T.isSizeEditable(P),w=T._axisXColor,r=T._axisYColor,D=T._axisZColor,u=T._editSizeColor,N=P.p3();
if(T.isOrtho()){var m=T.getCenterInfo();p=d(m.width,m.height)/8}else p=Fb(T.getEye(),N)/10;var B,O,J=p/(i?5:10),x=.7*p,U=.4*x,W=N[0],Y=N[1],R=N[2];B=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],h&&z._17O(v,Z,P,i,Hs,w,B,[W,Y-J,R,W+x,Y-J,R,W+x,Y,R,W+x,Y,R,W,Y,R,W,Y-J,R,W,Y-J,R+J,W+x,Y-J,R+J,W+x,Y-J,R,W+x,Y-J,R,W,Y-J,R,W,Y-J,R+J]),O=W+x,Q&&z._17O(v,Z,P,i,Ns,u,B,[O,Y-J,R,O+U,Y-J,R,O+U,Y,R,O+U,Y,R,O,Y,R,O,Y-J,R,O,Y-J,R+J,O+U,Y-J,R+J,O+U,Y-J,R,O+U,Y-J,R,O,Y-J,R,O,Y-J,R+J]),O+=U,G&&z._17O(v,Z,P,i,Ks,w,B,[O,Y-J,R,O+U,Y-J,R,O+U,Y,R,O+U,Y,R,O,Y,R,O,Y-J,R,O,Y-J,R+J,O+U,Y-J,R+J,O+U,Y-J,R,O+U,Y-J,R,O,Y-J,R,O,Y-J,R+J]),B=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],h&&z._17O(v,Z,P,i,Is,r,B,[W,Y,R,W,Y+x,R,W-J,Y+x,R,W-J,Y+x,R,W-J,Y,R,W,Y,R,W,Y,R,W,Y,R-J,W,Y+x,R-J,W,Y+x,R-J,W,Y+x,R,W,Y,R]),O=Y+x,Q&&z._17O(v,Z,P,i,Os,u,B,[W,O,R,W,O+U,R,W-J,O+U,R,W-J,O+U,R,W-J,O,R,W,O,R,W,O,R,W,O,R-J,W,O+U,R-J,W,O+U,R-J,W,O+U,R,W,O,R]),O+=U,G&&z._17O(v,Z,P,i,Ls,r,B,[W,O,R,W,O+U,R,W-J,O+U,R,W-J,O+U,R,W-J,O,R,W,O,R,W,O,R,W,O,R-J,W,O+U,R-J,W,O+U,R-J,W,O+U,R,W,O,R]),B=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],h&&z._17O(v,Z,P,i,Js,D,B,[W,Y,R,W,Y,R+x,W,Y-J,R+x,W,Y-J,R+x,W,Y-J,R,W,Y,R,W,Y-J,R,W-J,Y-J,R,W-J,Y-J,R+x,W-J,Y-J,R+x,W,Y-J,R+x,W,Y-J,R]),O=R+x,Q&&z._17O(v,Z,P,i,Ps,u,B,[W,Y,O,W,Y,O+U,W,Y-J,O+U,W,Y-J,O+U,W,Y-J,O,W,Y,O,W,Y-J,O,W-J,Y-J,O,W-J,Y-J,O+U,W-J,Y-J,O+U,W,Y-J,O+U,W,Y-J,O]),O+=U,G&&z._17O(v,Z,P,i,Ms,D,B,[W,Y,O,W,Y,O+U,W,Y-J,O+U,W,Y-J,O+U,W,Y-J,O,W,Y,O,W,Y-J,O,W-J,Y-J,O,W-J,Y-J,O+U,W-J,Y-J,O+U,W,Y-J,O+U,W,Y-J,O])}},_17O:function(V,c,S,Q,b,O,v,s){var m=this.gv,n=m._buffer,z=is.for(V),y=z.directUniforms(),l=z.directAttribs();if(m._picking){Q=m.pickColorMap;var N=Qs[b];Q[N]={data:S,part:b},y.uFixPickReverseColor=sd(N)}vm(V,c,X,!0,X,!0,X,!1),y.uDiffuse=O,l.aPosition=Xm(V,n.vs,new en(s),X),l.aNormal=Xm(V,n.ns,new en(v),X),Wm(V),Kl(V,0,12),Ck(V),Ii(V,c)}});var Rs=S.Raycaster=function(w){this.gv=w,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Ef("Raycaster",b,{intersect:function(e){var $=this,Q=$.gv,K=Q.getDataAt(e);return K?$.intersectObject(e,K):null},intersectObjects:function(j,N,w){var f,a,z,x,g=this,e=1/0,S=j.origin||(new Zh).fromArray(g.gv.getEye()),d=g.maxTriangleTest,W=[];N.forEach(function(g){w&&w(g)===!1||g.s("intersect")!==!1&&W.push(g)});var I=S.distanceToSquared2([0,0,0]);return W.sort(function(s,N){return(s.p3?S.distanceToSquared2(s.p3()):I)-(N.p3?S.distanceToSquared2(N.p3()):I)}),g.countTriangles=0,W.forEach(function(C){g.countTriangles>d||(f=g.intersectObject(j,C),f&&(a=S.distanceToSquared(f.world),e>a&&(z=C,x=f,e=a)))}),g.countTriangles=0,{data:z,intersect:x}},intersectObject:function(w,B){if(w instanceof Hp)return this._intersectObjectImpl(w,B);var D=this,e=D.gv,F=e.unproject(w),b=new Zh,v=e.getEye(),G=new Zh;if(e.isOrtho()){var A=new Zh(v);G.copy(e.getCenter()).sub(A).normalize();var t=b.copy(F).sub(A).dot(G);b.copy(G).setLength(-t).add(A.copy(F))}else b.copy(v),G.copy(F).sub(b).normalize();var a=new S.Math.Ray(b,G);return D._intersectObjectImpl(a,B)},_intersectObjectImpl:function(){function K(){var X=new Zh;return X.subVectors(W,r),J.subVectors(H,r),X.cross(J).normalize(),X}function T(p,d,P,l,X,r,I){return Zq.barycoordFromPoint(p,d,P,l,g),X.multiplyScalar(g.x),r.multiplyScalar(g.y),I.multiplyScalar(g.z),X.add(r).add(I),X.clone()}var A=new Qk,I=new Qk,y=new Hp,j=new Zh,z=new Zh,i=new Zh,v=new Zh,F=new Zh,H=new Zh,r=new Zh,W=new Zh,c=new Qf,E=new Qf,n=new Qf,J=new Zh,a={vs:vo,is:Te,uv:Db},g=new Zh,p=Jd.slice(0);return p.push("csg"),function($,B){var m=this.gv.getData3dUI(B),C=B.mat||m.mat;C?A.fromArray(C):A.identity(),I.getInverse(A),y.copy($).applyMatrix4(I);var t,Q,V,U="body",f=m.shapeModel;if(!f&&(B instanceof S.Polyline||B instanceof S.Edge)&&m.lineShapeModel&&(f=m.lineShapeModel),f||(f=Lh(m)),f||(S.CSGNode&&B instanceof S.CSGNode||S.CSGShape&&B instanceof S.CSGShape?(V=!0,f=[m.left,m.front,m.right,m.back,m.top,m.bottom,m.csg]):B instanceof S.Node&&!(B instanceof S.Shape)?(t=!0,f=a):(Q=!0,f=[m.left,m.front,m.right,m.back,m.top,m.bottom])),!f)return console.log("Can not find shape model."),null;Kc(f)||(f=[f]);var P,g,J,_,h,l,O,x,s,u,w,k,D,M,q,b,G=1/0,R=["","top_","bottom_"],e=!1,N=this.backfaceCulling,Y=[];for(gn(f,m,Y),P=0,g=Y.length;g>P;P++)if(D=Y[P])for(J=0,_=R.length;_>J;J++)if(M=R[J],O=D[M+"vs"],x=D[M+"is"],s=D[M+"uv"]||D[M+"tuv"],O){if(q=D[M+"boundingBox"]){var w=y.intersectBox(q);if(!w)continue;if(y.origin.distanceTo(w)>G)continue;b=!1}else D[M+"boundingBox"]=q=new S.Math.Box3,b=!0;for(h=0,l=x?x.length:O.length/3;l>h;h+=3)this.countTriangles++,x?(z.fromArray(O,3*x[h]),i.fromArray(O,3*x[h+1]),v.fromArray(O,3*x[h+2])):(z.fromArray(O,3*h),i.fromArray(O,3*(h+1)),v.fromArray(O,3*(h+2))),b&&(q.expandByPoint(z),q.expandByPoint(i),q.expandByPoint(v)),u=y.intersectTriangle(z,i,v,N,j),u&&(k=y.origin.distanceTo(u),G>k&&(G=k,F.copy(u),H.copy(z),r.copy(i),W.copy(v),""!==M?U=M.slice(0,-1):t?U=Jd[Math.floor(h/6)]:Q?U=Jd[P]:V&&(U=p[P]),s&&(e=!0,x?(c.fromArray(s,2*x[h]),E.fromArray(s,2*x[h+1]),n.fromArray(s,2*x[h+2])):(c.fromArray(s,2*h),E.fromArray(s,2*(h+1)),n.fromArray(s,2*(h+2))))))}if(!isFinite(G))return null;var d,o=F.clone().applyMatrix4(A);e&&(d=T(F,H,r,W,c,E,n));var L=K(H,r,W),X=K(H.applyMatrix4(A),r.applyMatrix4(A),W.applyMatrix4(A)),Z=y.direction.dot(L);return Z>0&&(L.multiplyScalar(-1),X.multiplyScalar(-1)),{world:o,local:F.clone(),worldNormal:X,normal:L,uv:d,part:U}}}()});var Ss=function(g,y){this.gv=g,this.s=function($,s,U){return s==X&&(s=U),s==X?y.getStyle($):Qn(s,y,g)},this.data=y};Wi(Ss,b,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:p,iv:function(){this._iv=!0},update:function(B,I,K){var d=this,A=d.data;if(B||(B=d.gv,I=B.getGL(),K=B._40Q),!d.needValidate(I)||!B.isVisible(A))return K.push(this,!1),void 0;var P,Z,q,o,n,F=A._id,O=A._47Q?null:d.s("batch"),p=A.getRenderLayer(),j=K.get(p,!0),$=j.batchIndexMap,u=j.batchModelMap,x=B.getBrightness(A),f=x!=X&&1!==x;P=gc($,u,A,O,B);var T=d.validate(P,O?B.getBatchInfo(O)||Xr:X);if(P&&(Z=$[F],q=Z.size=P.vs.length/3-Z.begin,n=P.rs))for(x=f?x:1,o=0;q>o;o++)n.push(x);var L=B.getWireframeGeometry(A);if(L)Mo(B,A,L);else if(mo(A)){var y=B.getWireframe(A);y&&Mo(B,A,y)}d.labelInfo=d.label2Info=d.noteInfo=d.note2Info=d._38o=X,d._24O(lp,"getLabel"),d._24O(_m,"getLabel2"),d._26O(Pl,"getNote"),d._26O(Io,"getNote2"),d._15O(),d.interactiveInfo=B.isInteractive(A)?{}:X,j.push(this,!0),T!==!1&&(d._iv=!1)},clearWireframeGeometryCache:function(){var r=this;qp(r),r.data.iv()},_46Q:function(g){var V=this,S=V.data,A=V.gv;if(A.isVisible(S)){var m=S._id,M=A._40Q.get(S._renderLayer,!0),u=M.batchIndexMap[m],v=M.polylineIndexMap[m],U=M.wireframeIndexMap[m];if(u||v||U){var B=dl(g,A.pickColorMap,A.isSelectable(S),S,se,!0);B&&(hi(B,u,M.batchModelMap),hi(B,v,M.polylineModelMap),hi(B,U,M.wireframeModelMap))}}},_42:function(w,P,z){function F(u,l,h){var v=l.getBrightness(h),T=h.s("alphaTest"),K=h.s("envmap"),F=is.for(u),o=F.directUniforms();v!=X&&1!==v&&(o.uBrightness=v),o.uAlphaTest=T,o.uUseEnvMap=K?!0:!1,o.uReflectivity=K||.01,o.roughness=h.s("roughness"),l._setEnvmapByProbeId(o,h.s("envmap.probe")),o.shadowReceive=!Q&&h.s("shadow.receive"),o.shadowCull=!Q&&!!h.s("shadow.cull"),o.uEnableBoxClip=h.s("3d.clipbox.enabled")&&!h.s("3d.clipbox");var e=y.s("3d.clip.direction");if(e){var k=y.s("3d.clip.percentage");0===k&&(I=!1);var A=y._formatClipUniforms(e,k,h);o.uClipPercent=A[1],o.uClipDirection=A[0]}else o.uClipDirection=0;u._blooming&&!h.s("bloom")&&(o.blackout=!0),Q||(l._flowObjects.length&&l.flowMap.resetDataFlowEnabld(h,o),dh(l,o,h.s("light.mask")))}var y=this,l=y.data,L=y.gv;if(L.isVisible(l)){var N,Q=L._picking;if(Q)N=L.pickColorMap;else{if(L.isTransparentMask(l)||L.isReflecting(w)&&l.s("3d.reflectable")===!1)return;N=p}if(Ss.getTitle===p){Ss.getTitle=0;for(var i in E)if(i.length===_m.length+1&&i[_m.length]===wl[4].toUpperCase()&&i[_m.length-1]===wl[_m.length+1].toUpperCase()){Ss.getTitle=lr;break}}if(!Ss.getTitle||pj[_m.length+2]){if(Ss.getHead===p){Ss.getHead=0;for(var i in o){var Y="box-sizing";6===i.length&&i[0]===wl[4]&&i[3]===Y[0]&&i[4]===Y[1]&&i[5]===Y[2]&&(Ss.getHead=eh)}}if(!Ss.getHead||pj[_m.length]){if(Ss.getTitle2===p){Ss.getTitle2=0;for(var i in o){var D="uv";6===i.length&&i[0]===Kg[1].toUpperCase()&&i[1]===D[0]&&(Ss.getTitle2=jm)}}if(!Ss.getTitle2||pj[Pd.length]){var C,b,t=l._id,m=L._40Q.get(l._renderLayer,!0),Z=m.batchIndexMap,v=m.batchModelMap,e=L.isSelectable(l),g=!1,I=!0,k=Z[t];if(Q&&(b=dl(w,N,e,l,se,k),b&&!L._45Q&&(hi(b,k,v),hi(b,m.polylineIndexMap[t],m.polylineModelMap),hi(b,m.wireframeIndexMap[t],m.wireframeModelMap))),k||(g||(g=!0,F(w,L,l)),I&&y._80o(w,P,z)),L.isLabelVisible(l)&&((C=y.labelInfo)&&(Q&&dl(w,N,e,l,lp),g||(g=!0,F(w,L,l)),y._28O(C,lp,z)),(C=y.label2Info)&&(Q&&dl(w,N,e,l,_m),g||(g=!0,F(w,L,l)),y._28O(C,_m,z))),L.isNoteVisible(l)&&((C=y.noteInfo)&&(Q&&dl(w,N,e,l,Pl),g||(g=!0,F(w,L,l)),y._29O(C,Pl,z)),(C=y.note2Info)&&(Q&&dl(w,N,e,l,Io),g||(g=!0,F(w,L,l)),y._29O(C,Io,z))),(C=y._38o)&&(g||(g=!0,F(w,L,l)),y._99O(w,P,C,N,e,z)),g){var h=is.for(w).directUniforms();h.uBrightness=1,h.uClipDirection=0,w._blooming&&(h.blackout=!1)}}}}}},_formatClipUniforms:function(k,l,Q){switch(k){case"left":k=2;break;case"top":k=3;break;case"bottom":k=4;break;case"front":k=5;break;case"back":k=6;break;case"right":default:k=1}if(0===k%2&&(l=1-l),Q instanceof S.Shape){var c=Q.s3(),t=Q.p3(),e=Q.getAnchor3d();l=3>k?(l-e.x)*c[0]+t[0]:5>k?(l-e.y)*c[1]+t[1]:(l-e.z)*c[2]+t[2]}else l-=.5;return[k,l]},prepare:function(){var L=this,V=L.data;if(!(V instanceof qk)){var S,R,N,T,U,E=L.gv,h=E.getGL(),k=V._id,C=L.s("batch"),i=E._batchIndexMap,j=E._batchModelMap,r=E.getBrightness(V),e=r!=X&&1!==r;if(L.needValidate(h)){if(S=gc(i,j,V,C,E),L.validate(S,C?E.getBatchInfo(C)||Xr:X),S&&(R=i[k],N=R.size=S.vs.length/3-R.begin,U=S.rs))for(r=e?r:1,T=0;N>T;T++)U.push(r);if(mo(V)){var D=E.getWireframeGeometry(V);if(D)Mo(E,V,D);else{var B=E.getWireframe(V);B&&Mo(E,V,B)}}L.labelInfo=L.label2Info=L.noteInfo=L.note2Info=L._38o=X,L._24O(lp,"getLabel"),L._24O(_m,"getLabel2"),L._26O(Pl,"getNote"),L._26O(Io,"getNote2"),L._15O(),L.interactiveInfo=E.isInteractive(V)?{}:X,L._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=p},getBoundingBox:function(){var v,N,Q,W,X,h;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;v||(v={vs:vo,is:Te,uv:Db},N=new Zh,Q=new Zh,W=new Zh,X=new Zh,h=new Zh);var F=this,c=F.data,s=F.shapeModel;if(s||c instanceof S.Shape||(s=Lh(F)),!s&&c instanceof S.Shape&&(F.prepare(),s=F.shapeModel),s||(c instanceof S.Node&&!(c instanceof S.Shape)?s=v:(F.left||F.front||F.right||F.back||F.top||F.bottom)&&(s=[F.left,F.front,F.right,F.back,F.top,F.bottom])),!s)return p;Kc(s)||(s=[s]);var y,G,D,V,q,w,d,O,T,Y,U,e,L=["","top_","bottom_"],l=new S.Math.Box3,C=!1;if(F._needRecoverPosition){X.set.apply(X,c.p3());var a=c.s3();h.set(1/(a[0]||1),1/(a[1]||1),1/(a[2]||1))}else X.set(0,0,0),h.set(1,1,1);for(y=0,G=s.length;G>y;y++)if(T=s[y])for(D=0,V=L.length;V>D;D++)if(Y=L[D],d=T[Y+"vs"],O=T[Y+"is"],d){if(e=Y+"boundingBox",U=T[e],!U)for(T[e]=U=new S.Math.Box3,q=0,w=O?O.length:d.length/3;w>q;q+=3)O?(N.fromArray(d,3*O[q]).sub(X).multiply(h),Q.fromArray(d,3*O[q+1]).sub(X).multiply(h),W.fromArray(d,3*O[q+2]).sub(X).multiply(h)):(N.fromArray(d,3*q).sub(X).multiply(h),Q.fromArray(d,3*(q+1)).sub(X).multiply(h),W.fromArray(d,3*(q+2)).sub(X).multiply(h)),!N.isNaN()&&U.expandByPoint(N),!Q.isNaN()&&U.expandByPoint(Q),!W.isNaN()&&U.expandByPoint(W);l.expandByBox(U),C=!0}return C?(this._cacheBoundingBox=l,b.freeze(l),b.freeze(l.min),b.freeze(l.max),Mm(F.gv,c),l):p}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Jq},_80o:function(){},dispose:function(){var $=this,x=$.data,B=x._pickId;if(B){var l=$.gv.pickColorMap;l[B]&&delete l[B]}},getBodyColor:function(q){var x=this.data,j=this.gv.getBodyColor(x);return j?j:q?x.getStyle(q):X},getCachedTexture:function(J){var _=this._cachedTextures;return _?_[J||"main"]:null},setCachedTexture:function(x,Q){var N=this._cachedTextures;return N||(N=this._cachedTextures={}),N[Q||"main"]=x,x},invalidateCachedTexture:function(X){var j=this._cachedTextures;if(j){for(var J in j)X.deleteTexture(j[J]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(v,A){var F=this,V=F.data,Z=F.gv,$=F.s,b=Z[A](V);if(b!=X){var D=$(v+".scale"),P=$(v+".max"),n=F[v+"Info"]={label:b,textureScale:$(v+".texture.scale"),color:Z[A+"Color"](V),font:$(v+".font"),align:$(v+".align"),background:Z[A+"Background"](V)},l=n.rect=ln(n,b);P>0&&P<l.width&&(n.labelWidth=l.width,l.width=P),l.x=l.y=0,l.width*=D,l.height*=D,n.mat=F._16O($(v+".autorotate"),$(v+".position"),l,$(v+".face"),$(v+".t3"),$(v+".r3"),$(v+".rotationMode"));var O=l.width/2,J=l.height/2;n.vs=new en([-O,J,0,-O,-J,0,O,-J,0,O,J,0]),l.width/=D,l.height/=D}},_26O:function(P,k){var I=this,O=I.data,s=I.gv,z=I.s,G=s[k](O);if(G!=X){var c=z(P+".scale"),b=this[P+"Info"]={note:G,textureScale:z(P+".texture.scale"),expanded:z(P+".expanded"),font:z(P+".font"),color:z(P+".color"),align:z(P+".align"),borderWidth:z(P+".border.width"),borderColor:z(P+".border.color"),background:s[k+"Background"](O)};if(b.expanded){var R=z(P+".max"),g=ln(b,G);g.width+=6,g.height+=2,R>0&&R<g.width&&(b.labelWidth=g.width,g.width=R);var a={x:-g.width/2,y:-8-g.height,width:g.width,height:g.height+8}}else a={x:-6,y:-18,width:12,height:18};b.mat=I._16O(z(P+".autorotate"),z(P+".position"),X,z(P+".face"),z(P+".t3"),z(P+".r3"),z(P+".rotationMode")),b.rect=a,1!==c&&(a=Nq(a),a.x*=c,a.height*=c,a.y=-a.height,a.width*=c);var L=a.x,H=a.y,i=a.width,x=a.height;b.vs=new en([L,-H,0,L,-H-x,0,L+i,-H-x,0,L+i,-H,0])}},eachShapeModel:function(p,a){function k(o){qn(o),o.vs&&p(o.vs,o.is,o.ns,o.uv),o.top_vs&&p(o.top_vs,o.top_is,o.top_ns,o.top_uv),o.bottom_vs&&p(o.bottom_vs,o.bottom_is,o.bottom_ns,o.bottom_uv),o.from_vs&&p(o.from_vs,o.from_is,o.from_ns,o.from_uv),o.to_vs&&p(o.to_vs,o.to_is,o.to_ns,o.to_uv)}function g(E){var w,u,T;if(Kc(E))for(u=0,T=E.length;T>u;u++)w=E[u],w&&g(w);else tc(E)?g(Lh(s,E),s):Mj(E)&&(E.shape3d?g(E.shape3d):k(E))}var s=this,t=s.data,a=a||s.shapeModel||Lh(s);a||(a=t instanceof S.Node&&!(t instanceof S.Shape)?{vs:vo,is:Te}:[s.left,s.front,s.right,s.back,s.top,s.bottom]),g(a)},_28O:function(u,q,B){if(B(this.s(q+".transparent"))){var v=u.rect,I=u.textureScale,i=v.width*I,y=v.height*I;if(i>=1&&y>=1){var M=mf(i,y);1!==I&&(M.translate(v.x,v.y),M.scale(I,I),M.translate(-v.x,-v.y)),Ag(M,u),M.restore(),op(this,q,u.mat,u.vs,!0)}}},_29O:function(H,F,n){if(n(this.s(F+".transparent"))){var X=H.rect,Z=H.textureScale,w=X.x,R=X.y,D=X.width*Z,I=X.height*Z;if(D>=1&&I>=1){X.x=X.y=0;var e=mf(D,I);1!==Z&&e.scale(Z,Z),Mr(e,H),e.restore(),X.x=w,X.y=R,op(this,F,H.mat,H.vs,!1)}}},_99O:function(k,P,K,L,q,j){if(K){var l=this,b=l.gv,n=l.data,Y=b._buffer,z=b._1O,W=K.icons,a=is.for(k),r=a.directAttribs();for(var _ in W){var s=W[_],N=K.rects[_];if(N&&j(Qn(s.transparent,n,b))){b._picking&&dl(k,L,q,n,_);var S=Qn(s.shape3d,n,b),p=S?[S]:Qn(s.names,n,b),H=p?p.length:0,E=Qn(s.textureScale,n,b)||1,Z=Qn(s.light,n,b);Z==X&&(Z=S?!0:!1),vm(k,P,Qn(s.blend,n,b),Z,Qn(s.opacity,n,b),Qn(s.reverseFlip,n,b),Qn(s.reverseColor,n,b),Qn(s.reverseCull,n,b));for(var U=0;H>U;U++){var I=p[U],x=N[U];if(bo(l,x.mat),S)bl(b,n,Lh(l,S),l);else{var e=ir(I);if(e){var i=x.width*E,O=x.height*E;if(i>=1&&O>=1){var v=mf(i,O);ch(v,e,Qn(s.stretch,n,b),0,0,i,O,n,b),v.restore(),gm(k,ts,z),Wm(k,P,z,Qn(s.discardSelectable,n,b),Y.uv,nc),r.aPosition=Xm(k,Y.vs,x.vs,X),r.aNormal=jj(k,Y.ns,uc,X),nb(k,Y.is,xi),Ri(k,0,xi.length),Ck(k,P,z)}}}hd(b)}Ii(k,P)}}}}});var Ts=function(s,$){jl(Ts,this,[s,$])};Wi(Ts,Ss,{_16O:function(Z,_,F,g,a,l,I,c,H){var s=this.data,v=s.getFinalScale3d(),m=Ap(_,v,F,g,c,H);if(s.hasOwnProperty("_anchor")||s.hasOwnProperty("_anchorElevation")){var q=s.getAnchor3d();m[0]-=(q.x-.5)*v[0],m[1]-=(q.y-.5)*v[1],m[2]-=(q.z-.5)*v[2]}return Wl(df(),m,s.p3(),g,a,l,I,Z,s.getFinalRotation3d(),s.getRotationMode())},clear:function(){var w=this;w.faceMat=w.mat=w.shapeModel=w.left=w.right=w.front=w.back=w.top=w.bottom=w.csg=X},needValidate:function($){if(this._iv)return this._validateFrameId=$._renderInfo.frame,!0;if(this.data._47Q){var f=$._renderInfo.frame;if(this._validateFrameId!==f)return this._validateFrameId=f,!0}return!1},validate:function(r,x){var V=this,I=V.gv,s=V.data,W=V.shapeName=V.s(Yp),B=Lh(V,W);if(V._updateAutoRotation(),V._updateFixSize2d(),V._updateOverlapping(),V.dispatchBoundingBoxChanged(),s._47Q){var T=s.getRenderLayer(),Q=I._40Q.get(T);Q&&Q.ivWireframeBatch(s)}var c=ec(s,I.getMat(s),B?V.s("shape3d.scaleable"):!0);if(s.appendAnchorMatrix3d(c),V.clear(),V.mat=s.mat=c,B||!W)if(V.shapeModel=B,r)if(B)ud(I,s,B,V,V.getBodyColor(),[c],r);else{var L=Ak(c);_p(I,s,r,x,c,L,cq,Fo),_p(I,s,r,x,c,L,Jo,Il),_p(I,s,r,x,c,L,yb,sb),_p(I,s,r,x,c,L,jc,Aq),_p(I,s,r,x,c,L,Vo,og),_p(I,s,r,x,c,L,ii,ig)}else B||(V._cubeUvs=null,V.vf(cq,0),V.vf(Jo,16),V.vf(Vo,8),V.vf(ii,24),V.vf(yb,32),V.vf(jc,40))},_updateAutoRotation:function(){var r=new Zg,X=new Qk,K=new Zh,i=new Zh,E=new Zh;return function(){var A=this,p=A.data,M=A.s("autorotate")||A.s("shape3d.autorotate");if(!M)return p._dynamicRotation&&delete p._dynamicRotation,void 0;var D=A.gv;E.copy(A.s("shape3d.autorotate.up")||D._up);var V;V="string"==typeof M?[M.indexOf("x")<0?D._eye[0]:D._center[0],M.indexOf("y")<0?D._eye[1]:D._center[1],M.indexOf("z")<0?D._eye[2]:D._center[2]]:D._eye;var d=D._center,I=p.p3();K.copy(I),i.set(V[0]-d[0],V[1]-d[1],V[2]-d[2]).add(K),X.lookAt(i,K,E),r.set(0,0,0,p.getRotationMode(),!0).setFromRotationMatrix(X);var L=p._dynamicRotation;L&&Math.abs(L[0]-r.x)<1e-5&&Math.abs(L[1]-r.y)<1e-5&&Math.abs(L[2]-r.z)<1e-5||(p._dynamicRotation=[r.x,r.y,r.z])}}(),_updateFixSize2d:function(){var Q=this,g=Q.data,$=Q.s("fixSizeOnScreen")||Q.s("shape3d.fixSizeOnScreen");if(!$)return g._dynamicScale3d&&delete g._dynamicScale3d,void 0;var a=Q.gv,G=ec(g,a.getMat(g)),f=$c([0,0,0],G),J=a.toViewPosition(f);if(!isNaN(J.x)&&!isNaN(J.y)){var o=$c([1,0,0],G),u=a.toViewPosition(o),d=$c([0,1,0],G),j=a.toViewPosition(d),H=u.x-J.x,y=j.y-J.y;if(H&&y){var Y,W,B=g._dynamicScale3d||[1,1,1],c=ir(g.s("shape3d.image"));if($[0]>0&&(Y=$[0]),$[1]>0&&(W=$[1]),!Y||!W){var R=$>0?$:1;Y||(Y=(rc(c,g)||g.getWidth())*R),W||(W=(Sn(c,g)||g.getTall())*R)}var l=Math.abs(H/Y),i=Math.abs(y/W);Math.abs(l-1)<.001&&Math.abs(i-1)<.001||(g._dynamicScale3d=[B[0]/l,B[1]/i,B[2]])}}},_updateOverlapping:function(){var B=this,j=B.s("hide.overlapping.group");if(!j)return B._rectOverlapping&&(B._rectOverlapping=p),void 0;var q,Q,a,T=B.gv,C=B.data,R=ec(C,T.getMat(C)),e=1/0,w=1/0,G=-1/0,I=-1/0,z=C.getAnchor3d(),o=z.x,y=z.y,A=z.z;for(q=0;8>q;q++){if(Q=$c([(q>>2)-o,(1&q>>1)-y,(1&q)-A],R),a=T.toViewPosition(Q),isNaN(a.x)||isNaN(a.y))return;e=Math.min(e,a.x),G=Math.max(G,a.x),w=Math.min(w,a.y),I=Math.max(I,a.y)}var k={x:e,y:w,w:G-e,h:I-w};B._rectOverlapping=T.overlappingBox.isOverlapping(j,k)},getVectorDynamicSize:function(){var D,I=this,P=I.s("shape3d"),L=I.data;if("billboard"===P||"plane"===P||(D=L._currentCubeElementId)!=X){var u,K,a=I.gv,s=ec(L,a.getMat(L)),c=L.getAnchor3d(),f=.5-c.x,z=.5-c.y,Y=.5-c.z,y=Math.min(I.s("vector.dynamic.maxsize"),a._glCapabilities.maxTextureSize)/a.getDevicePixelRatio(),B=function(H,h){H[0]+=f,H[1]+=z,H[2]+=Y,h[0]+=f,h[1]+=z,h[2]+=Y;var m=a.toViewPosition($c(H,s)),c=a.toViewPosition($c(h,s)),W=m.x-c.x,D=m.y-c.y;return Math.min(y,Math.sqrt(W*W+D*D))};if("billboard"===P)u=B([-.5,0,0],[.5,0,0]),K=B([0,-.5,0],[0,.5,0]);else if("plane"===P)u=B([-.5,0,0],[.5,0,0]),K=B([0,0,-.5],[0,0,.5]);else if(L._currentCubeElementId!=X){var w=3*Te[D+1],b=3*Te[D],i=3*Te[D+2];u=B([vo[w],vo[w+1],vo[w+2]],[vo[i],vo[i+1],vo[i+2]]),K=B([vo[w],vo[w+1],vo[w+2]],[vo[b],vo[b+1],vo[b+2]])}return[u,K]}},vf:function(g,u){var F=this;if(F.gv.getFaceVisible(F.data,g)){var T=Bp(F,g);T.mat&&(F.faceMat=!0);var V=T.uv;if(V){var H=F._cubeUvs;H||(H=F._cubeUvs=new en([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var D=0;8>D;D++)H[u+D]=V[D]}return T}},_billboardInView:function(){var u=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],W=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],k=new ml,J=new Zh,s=new Qk;return function(A){var G=this;if(!G.mat)return!0;var p=G.gv.getFrustum(),N="billboard"===A?u:W;k.makeEmpty(),s.fromArray(G.mat);for(var K=0,V=N.length;V>K;K+=3)k.expandByPoint(J.fromArray(N,K).applyMatrix4(s));return p.intersectsBox(k)}}(),_80o:function(x,z,n){var O=this;if(O._rectOverlapping)return!0;var S=O.shapeModel;if(S||!O.shapeName){var w=O.s("shape3d");if(("billboard"===w||"plane"===w)&&!O._billboardInView(w))return!0;var B=O.gv,A=O.data,V=B._cube,W=is.for(x),v=W.directAttribs();if(wi&&!Ko){var I=O.mat;if(I)for(var e=0;e<I.length;e++)O.mat[e]=I[I.length-e-1]}nn(B,O.mat),!x._picking&&O.s("shape3d.reflector")||O.s("effect.flow")||(S?bl(B,A,S,O,O.getBodyColor(),n):(v.aPosition=Xm(x,V.vs,X,X),v.aNormal=Xm(x,V.ns,X,X),pb(x,V.is),O._18O(x,z,"left",0,n),O._18O(x,z,"front",6,n),O._18O(x,z,"right",12,n),O._18O(x,z,"back",18,n),O._18O(x,z,"top",24,n),O._18O(x,z,"bottom",30,n))),hd(B),O.faceMat&&(O._18O(x,z,"left",0,n,!0),O._18O(x,z,"front",6,n,!0),O._18O(x,z,"right",12,n,!0),O._18O(x,z,"back",18,n,!0),O._18O(x,z,"top",24,n,!0),O._18O(x,z,"bottom",30,n,!0))}},_18O:function(H,q,W,t,R,i){var y=this[W];if(y){if(!R(y.transparent))return;if(i&&!y.mat||!i&&y.mat)return;var v=this.data.s("polygonOffset");v&&Dn(H,v),i&&nn(this.gv,y.mat);var Y=this,I=Y.data,p=is.for(H),u=p.directUniforms();I._currentCubeElementId=t;var h=Y.gv,m=h.getTexture(y.texture,I,W),D=y.uv,O=y.uvScale,U=y.uvOffset,z=y.uvRotation,x=y.discardSelectable;m?D?Wm(H,q,m,x,h._buffer.uv,Y._cubeUvs,U,O,z):Wm(H,q,m,x,h._cube.uv,X,U,O,z):Wm(H),vm(H,q,y.blend,y.light,y.opacity,y.reverseFlip,y.reverseColor,y.reverseCull),u.uDiffuse=y.color||G["color.empty"],Ri(H,t,6),Ii(H,q),Ck(H,q,m),i&&hd(h),v&&Dm(H),I._currentCubeElementId=null}},drawReflector:function(){var C=new Zh,Y=new Zh,A=new Zg,k=new Qk,v=new Zh,D=new Zh,m=new Zh,Z=new Zh,l=new Qk,d=new Qk,H=new Fc,s=new Gg,w=new Gg,h=function(I,u,o){I[o]=u[0],I[o+1]=u[1],I[o+2]=u[2]},N=function(T,c){h(T,c.getEye(),0),h(T,c.getCenter(),3),h(T,c.getUp(),6)},I=function(G,w){w._eye=[G[0],G[1],G[2]],w._center=[G[3],G[4],G[5]],w._up=[G[6],G[7],G[8]],w._18Q=X;var J=w._skybox;J&&(J.p3([G[0],G[1],G[2]]),w.getData3dUI(J).iv())};return function(h){var Q=this;Q._reflectorInfo=null;var E=Q.data;if(E._reflecting)return!1;var W=Q.gv;if(W._picking)return!1;var U=E instanceof bd,a=Q._reflectorRenderTarget,n=W._canvas.width,P=W._canvas.height;if(a?a.setSize(h,n,P):a=Q._reflectorRenderTarget=new Gq.RenderTarget(W,h,n,P),U){var _=E.getPointsMatrix3d().getElements(),$=E.p3();$[1]+=(1-E.getAnchorElevation())*E.getTall(),C.copy($c($,_))}else C.copy(E.p3());if(Y.copy(W.getEye()),k.makeRotationFromEuler(A.set(E.r3(),E.getRotationMode(),!0)),!Q._reflectNormal){var G;if(U&&E.getThickness()<0){if(!Q.shapeModel||!Q.shapeModel.top_vs)return!1;G={vs:Q.shapeModel.top_vs,ns:Q.shapeModel.top_ns}}else{if(G=Lh(Q,Q.s("shape3d")),!G)return!1;!G.ns&&G.length&&(G=G[0])}if(!G.ns||!G.vs)return!1;Q._reflectNormal=[G.ns[0],G.ns[1],G.ns[2]],Q._reflectorVbuffer=pn.Buffer.createVertexBuffer(h,new Float32Array(G.vs))}if(v.copy(Q._reflectNormal),v.applyMatrix4(k),D.subVectors(C,Y),D.dot(v)>0)return!1;D.reflect(v).negate(),D.add(C),m.copy(W.getCenter()).negate().add(C),m.reflect(v).negate(),m.add(C),Z.copy(W.getUp()),Z.reflect(v);var t=[0,0,0,0,0,0,0,0,0];N(t,W),W._eye=D.toArray(),W._center=m.toArray(),W._up=Z.toArray(),W._18Q=X;var J=W._skybox;J&&(J.p3(W._eye),W.getData3dUI(J).iv()),hp(h,a.frame),W.setViewport(h,0,0,a.width,a.height);var o=E.s("shape3d.reflector.background");if(o){var V=h.getParameter(h.COLOR_CLEAR_VALUE);ih(h,o)}else ih(h,[0,0,0,1]);is.for(h).glState.depth.mask=!0,h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);var F=E.s("shape3d.reflector.clip"),i=F===p?.003:F,c=ip(W),T=Me(W);H.setFromNormalAndCoplanarPoint(v,C.add(v.clone().multiplyScalar(i))),H.applyMatrix4(d.fromArray(T)),s.set(H.normal.x,H.normal.y,H.normal.z,H.constant),d.fromArray(c).getInverse(d),w.set(Math.sign(s.x),Math.sign(s.y),1,1).applyMatrix4(d),s.multiplyScalar(2/s.dot(w)),c[2]=s.x-c[3],c[6]=s.y-c[7],c[10]=s.z-c[11],c[14]=s.w-c[15];var b=W._computedProjectMatrix;W._computedProjectMatrix=c,E._reflecting=!0;var O=E.s("shape3d.reflector.shadow"),u={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===O?(u.createShadowMap=!1,u.renderShadow=!1):"scene"===O?u.createShadowMap=!1:u.useReflectorSelfShadowMap=!0,W.renderScene(u),W._computedProjectMatrix=b,l.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),l.multiply(d.fromArray(W._projectMatrix)),l.multiply(d.fromArray(W._viewMatrix)),o&&ih(h,V),eb(h),I(t,W);var R=E.s("shape3d.reflector.blur");if(R){var q=W.getPostProcessingModule("Blur");q&&q.drawImpl(h,a,R,R>=3,E.s("shape3d.reflector.blur.iterations"))}var B=h._compiledShader.reflector;B||(B=h._compiledShader.reflector=new pn.Shader(h,rp.Reflector.vs,rp.Reflector.fs)),B.bind(),h.activeTexture(h.TEXTURE0),Sb(h,a.texture),B.uniforms.tDiffuse=0,B.uniforms.color=aq(E.s("shape3d.reflector.color")||"rgb(128,128,128)"),B.uniforms.textureMatrix=l.toArray(),B.uniforms.modelMatrix=U?_:ec(E),B.uniforms.viewMatrix=Me(W),B.uniforms.projectionMatrix=ip(W);var y=Q._reflectorVbuffer;y.upload(),B.attributes.pos.pointer(y);var j=this.s("shape3d.transparent");if(j){var L=is.for(h).glState,e=L.depth.mask;L.depth.mask=!1}return h.drawArrays(h.TRIANGLES,0,y.data.length/3),j&&(L.depth.mask=e),E._reflecting=!1,h.useProgram(W._prg),Sb(h,X),!0}}()}),rp.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Us=function(P,G){jl(Us,this,[P,G])};Wi(Us,Ts,{_80o:function(){}});var Vs=function(h,s){jl(Vs,this,[h,s])};Wi(Vs,Ss,{_25Q:1,validate:function(F){var n=this;if(!n.s("geometry.cache")||!n.info){var P=n.gv,o=n.data,K=n.s,D=K("edge.width"),$=o._40I,N=o._41I;if(n.shapeModel=n.info=n.lineShapeModel=X,$&&N){var Z,v,f,s,S,l,J,h,G,O,u=o.isLooped(),B=K(Ug),p=E.getEdgeType(B);if(p){var z=p(o,yi(n,P,o,u,B),P,n._19Q);if(!z.points||z.points.isEmpty())return;l=n.info={},J=z.segments,S=z.points,h=S.size();for(var m=$.getElevation(),U=N.getElevation(),c=0;h>c;c++){var Y=S.get(c);Y.e==X&&(Y.e=m+(U-m)*c/(h-1))}G=kk(S.get(0)),O=kk(S.get(h-1));var q=h%2;0===q?(l.c1=kk(S.get(h/2-1)),l.c2=kk(S.get(h/2))):l.p3=kk(S.get((h-q)/2)),l.s1=G,l.s2=kk(S.get(1)),l.t1=kk(S.get(h-2)),l.t2=O}else{S=new jn,l=n.info={};var A=K("edge.offset"),i=K("edge.center"),w=K("edge.source.t3"),k=K("edge.target.t3"),C=ep(P,o,"source"),R=ep(P,o,"target");if(!C||!R)return P.invalidateData(o),delete n.info,!1;if(w&&(C[0]+=w[0],C[1]+=w[1],C[2]+=w[2]),k&&(R[0]+=k[0],R[1]+=k[1],R[2]+=k[2]),B===tk){J=K("edge.segments");var t=l.points=K(Vi)||gg;if(h=t.size()){G=kk(t.get(0)),O=kk(t.get(h-1)),!i&&A&&(f=Fi(G,C,!0),A=d(A,Fb(C,G)),C=[C[0]+f[0]*A,C[1]+f[1]*A,C[2]+f[2]*A],f=Fi(R,O,!0),A=d(A,Fb(O,R)),R=[R[0]-f[0]*A,R[1]-f[1]*A,R[2]-f[2]*A]);var q=h%2;0===q?(Z=kk(t.get(h/2-1)),v=kk(t.get(h/2))):l.p3=kk(t.get((h-q)/2)),l.s1=C,l.s2=G,l.t1=O,l.t2=R}else!i&&A&&(f=Fi(R,C,!0),s=Fb(C,R),A=Ro(A,s),C=[C[0]+f[0]*A,C[1]+f[1]*A,C[2]+f[2]*A],R=[R[0]-f[0]*A,R[1]-f[1]*A,R[2]-f[2]*A]),Z=C,v=R;S.add({x:C[0],y:C[2],e:C[1]}),S.addAll(t),S.add({x:R[0],y:R[2],e:R[1]})}else{var H=yi(n,P,o,u,B);if(n._19Q||(H=-H),u){var e=C[0],M=C[1],y=C[2],x=$.getTall()/2+H;Z=[e-H,M+x,y],v=[e+H,M+x,y],S.add({x:e-H,y:y,e:M}),S.add({x:e-H,y:y,e:M+x}),S.add({x:e+H,y:y,e:M+x}),S.add({x:e+H,y:y,e:M})}else{f=Fi(R,C,!0),s=Fb(C,R);var g={x:C[0],y:C[2]},j={x:R[0],y:R[2]},V=kb(X,g,j,H),L=V.x-g.x,W=V.y-g.y;A=Ro(A,s),f[0]*=A,f[1]*=A,f[2]*=A,Z=[C[0]+f[0]+L,C[1]+f[1],C[2]+f[2]+W],v=[R[0]-f[0]+L,R[1]-f[1],R[2]-f[2]+W],i?(S.add({x:C[0],y:C[2],e:C[1]}),S.add({x:Z[0],y:Z[2],e:Z[1]}),S.add({x:v[0],y:v[2],e:v[1]}),S.add({x:R[0],y:R[2],e:R[1]})):(S.add({x:Z[0],y:Z[2],e:Z[1]}),S.add({x:v[0],y:v[2],e:v[1]}))}}l.c1=Z,l.c2=v}l._lastPointsSegments={points:S,segments:J},l.list=K(Yp)===kc?n.createTubeModel(S,J,D/2,F):n.createLineModel(S,J,D,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=X}});var Ws=function(s,W){jl(Ws,this,[s,W]),this._needRecoverPosition=!0};Wi(Ws,Ts,{_80o:function(i,p,o){var x=this,q=x.mat;if(q&&(!x.s("shape3d.reflector")||i._picking)){var y=x.gv,H=x.shapeModel;nn(y,q),H?bl(y,x.data,H,x,x.getBodyColor(),o):(fo(x,i,p,"left",o),fo(x,i,p,"front",o),fo(x,i,p,"right",o),fo(x,i,p,"back",o),fo(x,i,p,"top",o),fo(x,i,p,"bottom",o)),hd(y)}},validate:function(o,s){var E,T,G=this,r=G.s,W=G.data,p=W._thickness/2,U=W.isClosePath(),A=W.getPoints(),M=W.getSegments(),i=r(nl),O=o&&o.uv;if(G.clear(),G.dispatchBoundingBoxChanged(),0>p){G.s("shape3d.reflector")&&(G._reflectNormal=null);try{var D=r("shape3d.image.projection");if(D&&D[4]){var k=W.p3(),z=k[0],b=k[2];D=[z+D[0],D[1]-b,z+D[2],D[3]-b]}T=G.shapeModel=Pe(A,M,r(wc),r(zg),i,r(Ep),W.getTall(),W.getShapeElevation(),U,D)}catch(f){T=G.shapeModel={}}r(Zj)?r("shape3d.image")||delete T.uv:(delete T.vs,delete T.ns,delete T.uv),r("shape3d.top.image")||delete T.top_uv,r("shape3d.bottom.image")||delete T.bottom_uv}else if(r(Yp)===kc)E=fl(A,M,i,U),T=G.shapeModel={vs:[]},r("shape3d.image")&&(T.uv=[],T.sum=r(Ep)||Kp(E)||1,T.len=0),r(wc)&&!U&&(T.top_vs=[],r("shape3d.top.image")&&(T.top_uv=[])),r(zg)&&!U&&(T.bottom_vs=[],r("shape3d.bottom.image")&&(T.bottom_uv=[])),G._12O(E,p);else{var x,S,l,m,j,q,H,t,e,L;if(E=fl(A,M,i,U),j=G.vf(Vo,O,!1,s),p&&(q=G.vf(ii,O,!1,s),H=U?X:G.vf(cq,O,!1,s),t=U?X:G.vf(Jo,O,!1,s),e=G.vf(yb,O,!1,s),L=G.vf(jc,O,!1,s)),p){for(var Q=0,w=E.length;w>Q;Q++)E[Q]=G._tryRemoveBezierPoints(E[Q],p);G._12O(E,p)}else j&&E.forEach(function(q){if(m=q.length,m>0)for(x=q[0],l=1;m>l;l++)S=q[l],G.addV(j.vs,x,S),x=S});G._20Q(E),o||(j&&(j.ns=ls(j.vs),dg(j,"vs"),dg(j,fr)),p&&(q&&(q.ns=ls(q.vs),dg(q,"vs"),dg(q,fr)),H&&(H.ns=ls(H.vs),dg(H,"vs"),dg(H,fr)),t&&(t.ns=ls(t.vs),dg(t,"vs"),dg(t,fr)),e&&(e.ns=ls(e.vs),dg(e,"vs"),dg(e,fr)),L&&(L.ns=ls(L.vs),dg(L,"vs"),dg(L,fr))))}var R=G.mat=W.getPointsMatrix3d().getElements();o&&(mj(G,R,o,T),G.clear())},_20Q:function(A){var w,y,o,q,R,j,F,W=this,D=W.front,$=W.back,f=W.top,N=W.bottom,I=D?D.tuv:X,J=$?$.tuv:X,M=f?f.tuv:X,e=N?N.tuv:X,a=0;(I||J||M||e)&&(w=W.s(Ep)||Kp(A)||1,A.forEach(function(E){if(y=E.length,y>0)for(j=E[0],o=1;y>o;o++)F=E[o],q=a/w,a+=Fb(j,F),R=a/w,W._14O(D,q,R),W._14O($,1-R,1-q),W._14O(f,q,R),W._14O(N,q,R),j=F}))},_14O:function(N,y,U){if(N){var f=N.uv,F=N.tuv;if(F){if(f)var C=f[0]+(f[6]-f[0])*y,u=f[1]+(f[7]-f[1])*y,P=f[2]+(f[4]-f[2])*y,c=f[3]+(f[5]-f[3])*y,M=f[2]+(f[4]-f[2])*U,J=f[3]+(f[5]-f[3])*U,W=f[0]+(f[6]-f[0])*U,B=f[1]+(f[7]-f[1])*U;else C=y,u=0,P=y,c=1,M=U,J=1,W=U,B=0;F.push(P,c,M,J,W,B,W,B,C,u,P,c)}}},_13O:function(l){var t=l.uv,b=l.tuv;b&&(t?b.push(t[2],t[3],t[4],t[5],t[6],t[7],t[6],t[7],t[0],t[1],t[2],t[3]):b.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(h,U){var X=h.length;if(4>X)return h;var j,_,i,f,P,r,C=!1,Z=function(g){return h[g]},z=function(y){return h[X-1-y]};for(P=0;1>=P;P++)for(r=P?z:Z,_=r(0),i=r(1),j=2;X-1>j;j++)if(f=r(j),!f.remove)if(f.b){var I=kb(_,i,f,U);I.adjust?(f.remove=!0,C=!0):(_=i,i=f)}else _=i,i=f;if(!C)return h;var M=[];for(j=0;X>j;j++)h[j].remove||M.push(h[j]);return M},_12O:function(R,v){var U,e,s,d,S,E=this.s("shape3d.point.epsilon"),H=this;
R.forEach(function(N){if(S=N.length,S>0)for(U={p:N[0],n:!0},d=1;S>d;d++)e=N[d],s=S-1>d?N[d+1]:X,s&&Math.abs(e.x-s.x)<E&&Math.abs(e.y-s.y)<E||H.addPoint(U,e,s,v,N)})},addPoint:function(p,$,q,D,v){var r,R,i,e,w,O,y,_,c,B=this,f=p.p,s=p.f,E=p.b,j=B.s("shape3d.side")||Xh,L=B.s("shape3d.start.angle"),K=B.s("shape3d.sweep.angle"),z=B.shapeModel,P=B.data.isClosePath();if(p.n&&(p.n=!1,s=P&&v.length>2?kb(v[v.length-2],f,$,D):kb(X,f,$,D),E=jd(f,s),z?z.top_vs&&B._10O(E,s,j,L,K,z.top_vs,z.top_uv):(r=B.left)&&(B.addV(r.vs,E,s),B._13O(r))),R=q?kb(f,$,q,D):P&&v.length>2?kb(f,$,v[1],D):kb(f,$,X,D),i=jd($,R),z){var I,N,k=z.vs,C=z.uv,b=z.sum;for(C&&(I=z.len/b,z.len+=Fb(f,$),N=z.len/b),O=B._9O(E,s,j,L,K),y=B._9O(i,R,j,L,K),_=0;j>_;_++)c=_+1,nh(k,O[c]),nh(k,y[_]),nh(k,O[_]),nh(k,y[_]),nh(k,O[c]),nh(k,y[c]),C&&(e=_/j,w=c/j,C.push(I,w,N,e,I,e,N,e,I,w,N,w));!q&&z.bottom_vs&&B._10O(i,R,j,L,K,z.bottom_vs,z.bottom_uv,!0)}else!q&&(r=B.right)&&(B.addV(r.vs,R,i),B._13O(r)),(r=B.front)&&B.addV(r.vs,s,R),(r=B.back)&&B.addV(r.vs,i,E),(r=B.top)&&B.addH(r.vs,s,R,i,E,!0),(r=B.bottom)&&B.addH(r.vs,E,i,R,s);p.p=$,p.f=R,p.b=i},_10O:function(o,c,z,n,i,G,U,J){var A,s,K=this,E=K.data,w=K._9O(o,c,z,n,i),l=(o.x+c.x)/2,C=(o.y+c.y)/2,D=E.getShapeElevation(),W=0;for(W=0;z>W;W++)J?(nh(G,w[W]),nh(G,w[W+1])):(nh(G,w[W+1]),nh(G,w[W])),nh(G,[l,D,C]),U&&(J?(A=$*(W+1)/z+n,s=$*W/z+n):(A=$*W/z+n,s=$*(W+1)/z+n),U.push(.5-.5*t(s),.5-.5*T(s),.5-.5*t(A),.5-.5*T(A),.5,.5))},_9O:function(Q,j,P,D,E){var J,k,e=this,z=e.data,Y=[],o=(Q.x+j.x)/2,K=(Q.y+j.y)/2,N=z.getTall()/2,L=z.getShapeElevation(),b=0;for(E==X&&(E=$);P>=b;b++)J=E*b/P+D,k=t(J),Y.push([o+(Q.x-o)*k,L+N*T(J),K+(Q.y-K)*k]);return Y},addV:function(R,C,m){var i=C.x,D=C.y,l=m.x,Z=m.y,L=this.data,f=L.getShapeElevation(),K=L.getTall()/2;R.push(i,f-K,D,l,f-K,Z,l,f+K,Z,l,f+K,Z,i,f+K,D,i,f-K,D)},addH:function(X,a,O,G,F,$){var H=this.data,U=H.getTall()/2,T=H.getShapeElevation()+($?U:-U);X.push(a.x,T,a.y,O.x,T,O.y,G.x,T,G.y,G.x,T,G.y,F.x,T,F.y,a.x,T,a.y)},vf:function($,c,p,s){var I,m=this,A=m.gv.getFaceVisible(m.data,$);return(p||A)&&(I=Bp(m,$,s),I.vs=[],I.tuv=A&&(I.texture||c)?[]:X,I.visible=A),I}});var Xs=function(w,m){jl(Xs,this,[w,m])},Ys={},Zs=function(L){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(L)};Wi(Xs,Ts,{validate:function(){var Z=this,N=Z.gv,o=Z.data,A=Z.s,R=aq(A("points.color")),Y=A("points.size"),D=A("points.uv.offset"),E=A("points.image");!E||Zs(E)||To.test(E)||(Ys[E]||(Ys[E]=Z._createCachedImage(E)),E=Ys[E]);var V,M,n=o._modelDirty,F=A("points.model");if(F){if(Z._lastShapeModel!==F||!Z.shapeModel){var U=Lh(Z,F);if(!U)return;var X=[],W={};Z.eachShapeModel(function(t){for(var R=0,A=t.length;A>R;R+=3){var q=t[R],s=t[R+1],M=t[R+2],w=""+q+"_"+s+"_"+M;W[w]||(W[w]=!0,X.push(q,s,M))}},U),Z._setShapeModelPoints(new en(X)),Z._lastShapeModel=F,n=!0}V=Z.shapeModel.vs.length,M=V/3}else{var f=o.getPoints();if(M=V=f.length,n||o._pointsDirty||!Z.shapeModel){for(var j=[],t=0;M>t;t++){var i=f[t];i&&j.push(i.x,i.e,i.y)}Z._setShapeModelPoints(new en(j)),o._pointsDirty=!1,Z._lastShapeModel=null,n=!0}}if(Z.info={mat:ec(o),size:Y,diffuse:R,opacity:A("points.opacity"),texture:E,alphaTest:A("points.transparent")?0:A("alphaTest"),uvScale:A("points.uv.scale"),uvOffset:D,discardSelectable:A("points.discard.selectable")},n||o._colorsDirty){var g=!1,I=o.getColors();if(I&&I.length>0)for(var O=[],t=0;M>t;t++)for(var G=I[t],K=G?(g=!0,aq(G)):R,$=4*t,q=0;4>q;q++)O[$+q]=K[q];Z.shapeModel.cs=g?new en(O):null,o._colorsDirty=!1}if(n||o._sizesDirty){var C=!1,s=o.getSizes();if(s&&s.length>0)for(var Q,m=[],t=0;M>t;t++)Q=s[t],Q>=0?(m.push(Q),C=!0):m.push(Y);Z.shapeModel.ss=C?new en(m):null,o._sizesDirty=!1}if(n||o._offsetsDirty){var _=!1,y=o.getUvoffsets();if(y&&y.length>0)for(var S,r,c,u=[],t=0;M>t;t++)S=2*t,r=y[S],c=y[S+1],r!=p&&c!=p?(u.push(r,c),_=!0):u.push(D[0],D[1]);Z.shapeModel.os=_?new en(u):null,o._offsetsDirty=!1}if(n||Z._lastPointNumber!==M){this.dispose();var B=N.pickColorMap,e=Z._startPickId=B._pickIdUsed;B._pickIdUsed=e+M;for(var j=[],t=0;M>t;t++){var L=e+t,P=sd(L);j.push(P[0],P[1],P[2],P[3]),B[L]||(B[L]={data:o,part:t})}Z.shapeModel.ps=new en(j),Z._lastPointNumber=M}o._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(y){var W=this,$=W.shapeModel,F=W.shapeModel={vs:y};if(!$)return F;var b=y.length,S=Math.round(b/3);return $.cs&&$.cs.length==4*S&&(F.cs=$.cs),$.ss&&$.ss.length==S&&(F.ss=$.ss),$.os&&$.os.length==2*S&&(F.os=$.os),$.ps&&$.ps.length==4*S&&(F.ps=$.ps),F},_createCachedImage:function(n){var w=128,Y=_i(),H=Y.getContext("2d");zl(Y,w,w,1),tm(H,{width:w,height:w,comps:[{type:n,background:"white",borderWidth:0,rect:[0,0,w,w]}]},0,0,w,w);var R=S.Math.generateUUID();return Vl[R]=Y,R},_80o:function(i,Q){var p=this,Z=p.gv,_=Z._picking;if(!_||Z.isSelectable(p.data)){var R=p.shapeModel,k=p.info;if(R&&R.vs&&R.vs.length){var H=is.for(i);H.useProgram(p._asureProgram(i));var N=H.directUniforms(),d=H.directAttribs();N.modelMatrix=k.mat,N.modelViewMatrix=sm([],Z._viewMatrix,k.mat),N.projectionMatrix=Z._projectMatrix,N.viewMatrix=Z._viewMatrix,N.scale=Z.getHeight()/2,N.size=k.size,N.diffuse=k.diffuse,N.opacity=k.opacity,N.map=Z.getTexture(k.texture,p.data),N.alphaTest=k.alphaTest,N.resolution=Z.getDevicePixelRatio(),N.discardSelectable=k.discardSelectable,N.uvScale=k.uvScale,d.uvOffset=!_&&R.os?jj(i,Z._buffer.os,R.os,X):k.uvOffset,N.blackout=i._blooming&&!p.data.s("bloom"),d.position=jj(i,Z._buffer.vs,R.vs,X),_?(N.picking=!0,d.pickColor=jj(i,Z._buffer.ps,R.ps,X),N.useColor=!1,d.color=null):(N.picking=!1,d.pickColor=null,R.cs?(N.useColor=!0,d.color=jj(i,Z._buffer.cs,R.cs,X)):(N.useColor=!1,d.color=null)),R.ss?(N.useSizeArray=!0,d.sizeArray=jj(i,Z._buffer.ss,R.ss,X)):(N.useSizeArray=!1,d.sizeArray=null),Kl(i,0,R.vs.length/3,i.POINTS),H.useProgram(Q),d.disable(),Z.shadowMap.enable&&Z.shadowMap.createShadow(),Z.flowMap.createFlow(N)}}},_asureProgram:function(k){return k._pointsShader||(k._pointsShader=this.gv._postProcessing.createShader(k,Xs.shaderSrc)),k._pointsShader.program},dispose:function(){Xs.superClass.dispose.call(this);var X=this._startPickId,e=this._lastPointNumber;if(X&&e){for(var b=this.gv.pickColorMap,s=0;e>s;s++){var k=X+s;b[k]&&delete b[k]}delete this._startPickId,delete this._lastPointNumber}}}),Xs.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var $s=function(f,r){jl($s,this,[f,r]),this._needRecoverPosition=!0};Wi($s,Ss,{_25Q:1,validate:function(F){var s=this,i=s.data,y=s.s,I=i.getPoints(),h=I.size();s.dispatchBoundingBoxChanged();var P=i.p3(),U=s.mat=df();qq(U,P),Br(U,i.getFinalRotation3d(),i.getRotationMode());var Y=i.getScale3d(),j=i._dynamicScale3d;if(j&&(Y[0]*=j[0],Y[1]*=j[1],Y[2]*=j[2]),Em(U,Y),qq(U,Ym(P)),(!s.s("geometry.cache")||!s.shapeModel)&&(s.shapeModel=s.info=s.lineShapeModel=X,h>1)){var x=s.info={},g=i.getSegments(),$=i.getThickness(),S=kk(I.get(0)),q=kk(I.get(h-1)),Q=h%2;0===Q?(x.c1=kk(I.get(h/2-1)),x.c2=kk(I.get(h/2))):x.p3=kk(I.get((h-Q)/2)),x.s1=S,x.s2=kk(I.get(1)),x.t1=kk(I.get(h-2)),x.t2=q,x.list=y(Yp)===kc?s.createTubeModel(I,g,$/2,F):s.createLineModel(I,g,$,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=X},_80o:function(e,M,l){var d=this,Y=d.shapeModel;if(Y){var W=d.gv;nn(W,d.mat),bl(W,d.data,Y,d,d.getBodyColor(),l),hd(W)}}});var _s=S.graph3d.PostProcessing=function(d){function u(){if(!N){var H=d.getGL();N=new Gq.RenderTarget(d,H,null,null,{samples:G.renderTextureSamples||1,minFilter:H.LINEAR,magFilter:H.LINEAR}),q=new pn.Shader(H,R.vs,R.fs),m=pn.Buffer.createIndexBuffer(H,new Uint16Array([0,2,1,1,2,3])),x=pn.Buffer.createVertexBuffer(H,new Float32Array([0,0,1,0,0,1,1,1]))}}var N,q,m,x,W=this,D={},w=!1;!function(){b.keys(_s).forEach(function(m){D[m]=new _s[m](d)})}(),W.getModule=function(s){return s?D[s]:W},W.getModuleList=function(){return b.keys(D)},W._serializable=!0,W.handleDataModleChange=function(Z,T){Z&&(W._serializable&&Z.setPostProcessingData(W.serialize()),Z.removeSerializeListener(W.onDataModelSerialize,W)),T&&(T.addSerializeListener(W.onDataModelSerialize,W),W.deserialize(T))},W.onDataModelSerialize=function(P){"serialize"===P.type?W._serializable&&(d.dm()._postProcessingData=W.serialize()):"deserialize"===P.type&&W.deserialize(d.dm())},W.isDeserializeDisabled=function(h){return!W._serializable||h.a("sceneBloom")!==p},W.isSerializable=function(){return W._serializable},W.setSerializable=function($){W._serializable=$,$||d.dm().setPostProcessingData(p)},W.serialize=function(){var Z,K,I,P,H={};for(K in D)if(I=D[K],P=I.serializeProperties){Z={},I.enable&&(Z.enable=!0);for(var f in P){var z=I[f];z!=P[f]&&(Z[f]=z)}b.keys(Z).length&&(H[K.toLowerCase()]=Z)}return H},W.deserialize=function(o){var m,x,K,d,$,C={},s={};for(m in D){K=D[m],d=K.serializeProperties;var O={},E="scene"+m,l=o.a(E);l!==p&&(O.enable=l);for(var $ in d)l=o.a(E+$[0].toUpperCase()+$.slice(1)),l!==p&&l!==d[$]&&(O[$]=l);Ub(O)||(s[m[0].toLowerCase()+m.slice(1)]=O)}if(Ub(s)&&(s=o.getPostProcessingData()),s)for(x in s)if(x&&(m=x[0].toUpperCase()+x.slice(1),K=D[m])){C[m]=!0,d=s[x];var F=!!d.enable;W.enableModule(m,F),m="scene"+m,o.a(m,F),K.resetProperties&&K.resetProperties();for($ in d)if("enable"!==$){var l=d[$];K[$]=l,o.a(m+$[0].toUpperCase()+$.slice(1),l)}}for(m in D)C[m]||(K=D[m],K.enable=!1,K.resetProperties&&K.resetProperties())},W.getRenderTarget=function(){return N},W.blitScreen=function(y,p,U,$,P){var z=d.getGL();if(z){y&&(y.bind(z),d.setViewport(z,0,0,y.width,y.height)),P&&P.clear===!1||z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT),u(),U||(U=q),U.bind(),z.activeTexture(z.TEXTURE0+0),Sb(z,p||z._emptyTexture);var C=U.uniforms;C.image=0;var t=1;if($)for(var G in $){var j=$[G];j instanceof WebGLTexture&&(z.activeTexture(z.TEXTURE0+t),Sb(z,j),j=t,t++),C[G]=j}if(m.upload(),x.upload(),U.attributes.pos.pointer(x),z.drawElements(z.TRIANGLES,6,z.UNSIGNED_SHORT,0),t>1)for(;--t>=0;)z.activeTexture(z.TEXTURE0+t),Sb(z,null);else Sb(z,null);y&&y.unbind(z)}},W.decodeShader=function(i){var c,h,n,d="",M="";for(n=0;n<i.length;n++)c=i[n],"%"===c?c="'":"a"===c?c='"':"]"===c&&(c="\\"),h=String.fromCharCode(c.charCodeAt(0)-1),n%2?M+=h:d=h+d;return M+d},W.createShader=function(F,H,N){var y,c;if("string"==typeof H){var U=H.indexOf("^#");y=W.decodeShader(H.substr(0,U)),c=W.decodeShader(H.substr(U+2))}else y=H.vs,c=H.fs;if(N){var E=N(y,c);E&&E.vs&&(y=E.vs),E&&E.fs&&(c=E.fs)}return new pn.Shader(F,y,c)},W.enableModule=function(d,c){var r,W,p,q=d.split(",");for(r=0,W=q.length;W>r;r++)p=q[r].trim(),D[p]&&(D[p].enable=c);w=!1;for(p in D)if(D[p].enable){w=!0;break}w&&u()};var R=W.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};W.render=function(o,V,e,j){if(w){N.setSize(o,V,e),N.bind(o);var y=o.getParameter(o.COLOR_CLEAR_VALUE);y&&0===y[0]&&0===y[1]&&0===y[2]&&0===y[3]?y=null:ih(o,[0,0,0,0]),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),d.setViewport(o,0,0,V,e),j=j||{};var S=j.renderAxis!==!1,L=j.renderEdit!==!1;j.renderAxis=j.renderEdit=!1,d.renderScene(j),N.unbind(o);for(var Q=0,p=d._glCapabilities.maxAttributes;p>Q;Q++)o.disableVertexAttribArray(Q);var u,T=N;for(u in D)T=D[u]._42(o,T)||T;d.setViewport(o,0,0,V,e),y&&ih(o,y);var P=W.getModule("Fxaa");return P&&P.enable?W.blitScreen(null,T.texture,P.getShader(o),{resolution:[1/V,1/e]}):W.blitScreen(null,T.texture),o.useProgram(d._prg),d._renderAxisAndEditHelper(S,L),!0}}},at=S.graph3d.PostProcessing.HueSaturation=function(D){function q(){n=!0;var R=D.getGL();c=new Gq.RenderTarget(D,R),V=D._postProcessing.createShader(R,at.hueSaturationShader),Z=pn.Buffer.createIndexBuffer(R,new Uint16Array([0,2,1,1,2,3])),z=pn.Buffer.createVertexBuffer(R,new Float32Array([0,0,1,0,0,1,1,1]))}var Z,z,V,c,Q=this,W=!1,n=!1,R=[],d=[],F=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var $=this.serializeProperties;for(var c in $)this[c]=$[c]},this.resetProperties(),b.defineProperties(Q,{enable:{get:function(){return W},set:function(c){!!W!=!!c&&(W=c,c&&!n&&q(),D.iv())}},hue:{get:function(){return R.map(function(b){return x(180*b)})},set:function(V){if(R!==V&&7===V.length){for(var b=0;7>b;b++)R[b]=V[b]/180;D.iv()}}},saturation:{get:function(){return d.map(function(H){return x(100*H)})},set:function(t){if(d!==t&&7===t.length){for(var w=0;7>w;w++)d[w]=t[w]/100;D.iv()}}},lightness:{get:function(){return F.map(function(z){return x(100*z)})},set:function(n){if(F!==n&&7===n.length){for(var o=0;7>o;o++)F[o]=n[o]/100;D.iv()}}}}),Q._42=function(M,r){if(W){n||q();var v=r.width,u=r.height;if(v&&u){c.setSize(M,v,u),hp(M,c.frame),D.setViewport(M,0,0,c.width,c.height),M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT),V.bind(),M.activeTexture(M.TEXTURE0+0),Sb(M,r.texture);var J=V.uniforms;return J.image=0,J.hue=R,J.saturation=d,J.lightness=F,Z.upload(),z.upload(),V.attributes.pos.pointer(z),M.drawElements(M.TRIANGLES,6,M.UNSIGNED_SHORT,0),Sb(M,null),eb(M),c}}}};at.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var bt=S.graph3d.PostProcessing.Bloom=function(a){function k(){var b=a.getGL();if(b)for(var f=a._postProcessing,d=0;W>d;d++)X[d]=f.createShader(b,bt._35Q,function(y,C){return{fs:C.replace(/DEFINE_VALUE/g,m[d]).replace("%OVERRIDE_ALPHA_DEFINE%",r?"#define OVERRIDE_ALPHA":"")}})}function o(){var o=a.getWidth(),P=a.getHeight();if(o&&P){x=[o,P],p=!0;var f,F=a.getGL(),l=Math.round(x[0]/2),e=Math.round(x[1]/2);for(q=new Gq.RenderTarget(a,F,l,e),f=0;W>f;f++)O.push(new Gq.RenderTarget(a,F,l,e)),S.push(new Gq.RenderTarget(a,F,l,e)),l=Math.round(l/2),e=Math.round(e/2);var u=a._postProcessing;c=u.createShader(F,bt._34Q),k(),y=u.createShader(F,bt._36Q,function(J,R){return{fs:R.replace(/NUM_MIPS/g,W)}}),$=u.createShader(F,bt.finalShader),A=pn.Buffer.createIndexBuffer(F,new Uint16Array([0,2,1,1,2,3])),Y=pn.Buffer.createVertexBuffer(F,new Float32Array([0,0,1,0,0,1,1,1]))}}var N,P,g,r,H,A,Y,d,F=this,I=!1,p=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var A=this.serializeProperties;for(var w in A)this[w]=A[w]},b.defineProperties(F,{enable:{get:function(){return I},set:function(s){!!I!=!!s&&(I=s,s&&!p&&o(),a.iv())}},strength:{get:function(){return N},set:function(g){N!==g&&(N=g,a.iv())}},threshold:{get:function(){return P},set:function(T){P!==T&&(P=T,a.iv())}},radius:{get:function(){return g},set:function(M){g!==M&&(g=M,a.iv())}},overrideAlpha:{get:function(){return r},set:function(G){!!r!=!!G&&(r=G,p&&k(),a.iv())}},selective:{get:function(){return H},set:function(b){!!H!=!!b&&(H=!!b,a.iv())}}}),this.resetProperties();var q,c,y,$,x=[256,256],O=[],S=[],W=5,m=[3,5,7,9,11],X=[];F._42=function(t,R){function U(O,$,S,D){hp(t,$.frame),a.setViewport(t,0,0,$.width,$.height),D?D(t):t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),n!==O&&O.bind();var I=0;for(var l in S){var y=S[l];y instanceof WebGLTexture&&(t.activeTexture(t.TEXTURE0+I),Sb(t,y),y=I,I++),O.uniforms[l]=y}for(n!==O&&(A.upload(),Y.upload(),O.attributes.pos.pointer(Y),n=O),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0);I--;)t.activeTexture(t.TEXTURE0+I),Sb(t,null);eb(t)}if(I&&(p||(o(),p))){var n;if(H){d||(d=new Gq.RenderTarget(a,t)),d.setSize(t,R.width,R.height),d.bind(t);var f=t.getParameter(t.COLOR_CLEAR_VALUE);f&&0===f[0]&&0===f[1]&&0===f[2]&&1===f[3]?f=null:ih(t,[0,0,0,1]),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),a.setViewport(t,0,0,R.width,R.height),t._blooming=!0,a.syncRenderState(),a.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),t._blooming=!1,f&&ih(t,f),d.unbind(t)}U(c,q,{smoothWidth:.01,luminosityThreshold:P,tDiffuse:H?d.texture:R.texture});var b,K=q,s=Math.round(x[0]/2),h=Math.round(x[1]/2);for(b=0;W>b;b++)U(X[b],O[b],{colorTexture:K.texture,direction:[1,0],texSize:[s,h]}),U(X[b],S[b],{colorTexture:O[b].texture,direction:[0,1],texSize:[s,h]}),s=Math.round(s/2),h=Math.round(h/2),K=S[b];return U(y,O[0],{blurTexture1:S[0].texture,blurTexture2:S[1].texture,blurTexture3:S[2].texture,blurTexture4:S[3].texture,blurTexture5:S[4].texture,bloomStrength:N,bloomRadius:g,bloomTintColor:[1,1,1]}),U($,R,{image:O[0].texture},function(r){is.for(r).glState.blend.apply({enabled:!0,equation:r.FUNC_ADD,func:[r.SRC_ALPHA,r.ONE]})}),is.for(t).glState.blend.apply({equation:t.FUNC_ADD,func:[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA]}),R}}};bt._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",bt._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",bt._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",bt.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var ct=S.graph3d.PostProcessing.Dof=function(g){function K(){s=!0;var D=g.getGL();B=new Gq.RenderTarget(g,D),M=g._postProcessing.createShader(D,ct._38Q),H=pn.Buffer.createIndexBuffer(D,new Uint16Array([0,2,1,1,2,3])),m=pn.Buffer.createVertexBuffer(D,new Float32Array([0,0,1,0,0,1,1,1]))}var B,M,H,m,V,l,G,c,t=this,q=!1,s=!1,f=or.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var X=this.serializeProperties;for(var L in X)this[L]=X[L]},b.defineProperties(t,{enable:{get:function(){return q},set:function(o){!!q!=!!o&&(q=o,o&&!s&&K(),g.iv())}},image:{get:function(){return l},set:function(T){l!==T&&(l=T,V&&(g.deleteTexture(f),V=null),g.iv())}},maxblur:{get:function(){return G},set:function(L){G!==L&&(G=L,g.iv())}},aperture:{get:function(){return c},set:function(D){c!==D&&(c=D,g.iv())}}}),this.resetProperties(),t._42=function(x,p){function n(M,F,t,w){hp(x,F.frame),g.setViewport(x,0,0,F.width,F.height),w?w(x):x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),N!==M&&M.bind();var P=0;for(var L in t){var G=t[L];G instanceof WebGLTexture&&(x.activeTexture(x.TEXTURE0+P),Sb(x,G),G=P,P++),M.uniforms[L]=G}for(N!==M&&(H.upload(),m.upload(),M.attributes.pos.pointer(m),N=M),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0);P--;)x.activeTexture(x.TEXTURE0+P),Sb(x,null);eb(x)}if(q){s||K();var N;if(!V){var X=ir(this.image);if(!X||!X.comps&&!X.tagName)return p;S.Default.setImage(f,X),V=g.getTexture(f)}var k=p.width,j=p.height;if(k&&j)return B.setSize(x,k,j),n(M,B,{tColor:p.texture,tDepth:V,aspect:k/j,aperture:this.aperture,maxblur:this.maxblur}),B}}};ct._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";var dt=S.graph3d.PostProcessing.Blur=function(z){function P(){x=!0;var t=z.getGL();G=new Gq.RenderTarget(z,t),_=z._postProcessing.createShader(t,dt.hBlurShader),u=z._postProcessing.createShader(t,dt.vBlurShader)}var _,u,G,N,d,Y,T,Q,E,q=this,K=!1,x=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var y=this.serializeProperties;for(var m in y)this[m]=y[m]},b.defineProperties(q,{enable:{get:function(){return K},set:function(t){!!K!=!!t&&(K=t,t?z.addRenderLayerListener(m,this):z.removeRenderLayerListener(m,this),t&&!x&&P(),z.iv())
}},downSample:{get:function(){return T},set:function(c){T!==c&&(T=c,z.iv)}},value:{get:function(){return Y},set:function(m){Y!==m&&(Y=m,z.iv())}},iterations:{get:function(){return Q},set:function(l){Q!==l&&(Q=l,z.iv())}},layer:{get:function(){return E},set:function(V){E!==V&&(E=V,z.iv())}}}),this.resetProperties();var m=function(g){if(K&&g.layer===E&&"post"===g.phase){var P=z.getGL();if(!z._picking&&!z.isReflecting(P)){var j=z._postProcessing.getRenderTarget();j.unbind(P);for(var r=0,y=z._glCapabilities.maxAttributes;y>r;r++)P.disableVertexAttribArray(r);q.drawImpl(P,j),j.bind(P),P.useProgram(z._prg)}}};q._42=function(){},q.drawImpl=function(w,J,t,M,q){x||P();var S,v;if(J?(S=J.width,v=J.height):(S=z._viewport[2],v=z._viewport[3]),S&&v){var D=z._postProcessing;"boolean"!=typeof M&&(M=T),t==X&&(t=Y),q==X&&(q=Q),q=Math.max(1,Math.round(q));var B=is.for(w).glState.depth,R=B.enabled;if(B.enabled=!1,M){t/=2;var O=[S,v];S/=2,v/=2,N||(N=new Gq.RenderTarget(z,w),d=D.createShader(w,dt.downSampleShader)),N.setSize(w,S,v),D.blitScreen(N,J.texture,d,{texelSize:[1/O[0],1/O[1]]}),J.setSize(w,S,v)}else N&&N.setSize(0,0);G.setSize(w,S,v);for(var l=[],s=0;q>s;s++)l.push(t),t=Math.max(1,Math.floor(t/2));for(var s=0;q>s;s++){var V=l[q-s-1],b=M&&0===s?N.texture:J.texture;D.blitScreen(G,b,_,{value:V/S}),M&&s===q-1&&J.setSize(w,O[0],O[1]),D.blitScreen(J,G.texture,u,{value:V/v})}return B.enabled=R,J}}};dt.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",dt.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",dt.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var et=S.graph3d.PostProcessing.Fxaa=function(Z){var f,r=this,s=!1;b.defineProperties(r,{enable:{get:function(){return s},set:function(S){!!s!=!!S&&(s=S,Z.iv())}}}),r.getShader=function(r){if(f)return f;var V=Z.getPostProcessingModule();return f=V.createShader(r,{vs:V.blitScreenShaderSrc.vs,fs:V.decodeShader(et.ShaderSourceFs)})},r._42=function(){}};et.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",Vm(E,{accordionViewExpandIcon:eh(Gd),accordionViewCollapseIcon:eh(Gd,!0),accordionViewLabelColor:Hf,accordionViewLabelFont:Pn,accordionViewTitleBackground:Jl,accordionViewSelectBackground:$k,accordionViewSelectWidth:3,accordionViewSeparatorColor:p,splitViewDividerSize:1,splitViewDividerBackground:Jl,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:nj,rect:[2,2,12,12],background:Gd}]},propertyViewLabelColor:di,propertyViewLabelSelectColor:Hf,propertyViewLabelFont:Pn,propertyViewExpandIcon:eh(ps),propertyViewCollapseIcon:eh(ps,!0),propertyViewBackground:Cq,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Nf,propertyViewColumnLineColor:Nf,propertyViewSelectBackground:$k,listViewLabelColor:di,listViewLabelSelectColor:Hf,listViewLabelFont:Pn,listViewRowLineVisible:!1,listViewRowLineColor:Nf,listViewSelectBackground:$k,treeViewLabelColor:di,treeViewLabelSelectColor:Hf,treeViewLabelFont:Pn,treeViewExpandIcon:eh(Ie),treeViewCollapseIcon:eh(Ie,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Nf,treeViewSelectBackground:$k,treeViewDoubleClickToToggle:!0,tableViewLabelColor:di,tableViewLabelSelectColor:Hf,tableViewLabelFont:Pn,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Nf,tableViewColumnLineColor:Nf,tableViewSelectBackground:$k,treeTableViewLabelColor:di,treeTableViewLabelSelectColor:Hf,treeTableViewLabelFont:Pn,treeTableViewExpandIcon:eh(Ie),treeTableViewCollapseIcon:eh(Ie,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Nf,treeTableViewColumnLineColor:Nf,treeTableViewSelectBackground:$k,tableHeaderLabelColor:di,tableHeaderLabelFont:Pn,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:vr,tableHeaderBackground:Cq,tableHeaderMoveBackground:Zc,tableHeaderInsertColor:$k,tableHeaderSortDescIcon:hl(ps,!0),tableHeaderSortAscIcon:hl(ps),tabViewTabGap:1,tabViewLabelColor:Hf,tabViewLabelFont:Pn,tabViewTabBackground:Jl,tabViewSelectWidth:3,tabViewSelectBackground:$k,tabViewMoveBackground:Zc,tabViewInsertColor:$k,toolbarLabelColor:di,toolbarLabelSelectColor:Hf,toolbarLabelFont:Pn,toolbarBackground:Cq,toolbarSelectBackground:$k,toolbarItemGap:8,toolbarSeparatorColor:ee},!0);var ft={translateX:1,sortColumn:1},gt={sortable:1,sortOrder:1,sortFunc:1},ht={focusData:1},it={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},jt={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},kt=function(E,j){j.add(E),E.hasChildren()&&E.eachChild(function(u){kt(u,j)})},lt=function(L,$,B,s,J,Z,b,w,R,m,u){var j,c=B.getValueType(m),e=B.getAlign(m);if(B.getEnumValues(m)){var T=B.toEnumLabel($,m),a=As||0,k=0,S=Z,z=E.getTextSize(s,T).width;return j=ir(B.toEnumIcon($,m)),j&&(k=Z+As/2,"center"===e?k+=(w-(a+z))/2:"right"===e&&(k=k+w-(a+z)),dj(L,j,k,b+R/2,m,u),S=k+As/2),T!=X&&(j?Oj(L,T,s,J,S,b,w-(S-Z),R):Oj(L,T,s,J,Z,b,w,R,e)),void 0}return $=B.formatValue($),$!=X?c===Ur?(Ve(L,Z,b,w,R,$),void 0):c===vj||!c&&Pk($)?(j=ir($?ws:wo),dj(L,j,Z+w/2,b+R/2,m,u),void 0):(Oj(L,$,s,J,Z,b,w,R,e),void 0):void 0},mt=function(L,e){var u=e.view,$=om(L),d=e.column||e.property;u.getDataModel().beginTransaction(),e.editor=L,L.info=e,u.setCurrentEditor(L),u.getView().insertBefore($,u._79O),zd(L,e.editorRect),L.setFocus?L.setFocus():zf(L),L.commitValue=function(G,J){L._17Q&&(L=L._17Q),J||u.setValue(e.data,d,L.getValue?L.getValue():L.value),L.close&&L.close(),cp($)},d.onEditorCreated&&d.onEditorCreated(e)},nt=function(n,a,I,Z,V){var K=Kf(n,I),s=a.value,Q=a.view,d=V.getValueType(a.data);return K.onblur=K.onchange=function(){Q.endEditing()},"input"===n?(s=V.formatValue(s),s!=X&&(K.value=s),K.onkeydown=function(u){ff(u)?Q.endEditing():ib(u)&&Q.endEditing(!0)},(d===Di||d===lg)&&q(K,hf,E.numberListener)):n===th&&Z.forEach(function(I){var y=i.createElement("option");y.innerHTML=V.toEnumLabel(I),y.value=I,V.isEnumEqual(s,I)&&(y.selected=!0),vb(K,y)}),mt(K,a),K},ot=S.widget={},pt=function(n,u,B){Wi(K+".widget."+n,u,B)};Vm(cm,{ms_value:function($){$.getValue=function(a){var g=this.getItemById(a),Y=g.element;return tc(Y)?Y:Y?Y.getValue?Y.getValue():Y.value:g.selected},$.setValue=function(o,$){var l=this.getItemById(o);if(l){var U=l.element;U&&!tc(U)?U.setValue?U.setValue($):U.value=$:Pk($)?(l.selected=$,this.iv()):(l.element=$,this.iv())}},$.v=function(w,h){var p=this;if(2===arguments.length)p.setValue(w,h);else{if(!Mj(w))return p.getValue(w);for(var E in w)p.setValue(E,w[E])}return p}},_46o:function(W){W._icon=X,W._accessType=X,W._valueType=X,W._editable=!1,W._batchEditable=!0,W._align=cq,W._nullable=!0,W._emptiable=!1,W.setParent=Ir,W.formatValue=function($){var x=this,G=x._valueType;return x.getEnumValues()?x.toEnumLabel($):G===vj?!!$:$!=X&&G===Di?s($):$},W.setEnum=function(d,K,B,Q,T,w,i){var p=this;d&&!Kc(d)&&d.values&&(Q=d.editable,B=d.icons,K=d.labels,T=d.strict,w=d.maxHeight,i=d.dropDownWidth,d=d.values),Sd(d)&&(d=d._as),Sd(K)&&(K=K._as),Sd(B)&&(B=B._as),p._enumValues=d,p._enumLabels=K,p._enumIcons=B,p._enumEditable=Q,p._enumStrict=T==X?!0:T,p._enumMaxHeight=w,p._enumDropDownWidth=i,d&&d.length&&po(d[0])&&(p._valueType=lg),p.fp("enum",!1,!0)},W.getEnumDropDownWidth=function(){return this._enumDropDownWidth},W.getEnumMaxHeight=function(){return this._enumMaxHeight},W.isEnumEditable=function(){return this._enumEditable},W.getEnumValues=function(){return this._enumValues},W.getEnumLabels=function(){return this._enumLabels},W.getEnumIcons=function(){return this._enumIcons},W.isEnumStrict=function(){return this._enumStrict},W.isEnumEqual=function(d,k){return this._enumStrict?d===k:d==k},W.toEnumLabel=function(X,d){var b=this,j=b.getEnumValues(d),E=b.getEnumLabels(d);if(j&&E)for(var f=0;f<j.length;f++)if(b.isEnumEqual(X,j[f]))return E[f];return X},W.toEnumIcon=function(z,Q){var x=this,w=x.getEnumValues(Q),t=x.getEnumIcons(Q);if(w&&t)for(var f=0;f<w.length;f++)if(x.isEnumEqual(z,w[f]))return t[f];return p}},_45o:function(h){h._87o=function(J,v,M,g,t,A){if(J){var P=this,j=P._90I,a=_j(1);P._columnLineVisible&&(t-=1),P._rowLineVisible&&(A-=1),0>=t||0>=A||(P._90I||(j=P._90I={}),j[v]||(j[v]=new jn),zd(a,P.tx()+M,P.ty()+g,t,A),vb(a,J),P._view.insertBefore(a,P._79O),J.onParentAdded&&J.onParentAdded(a),j[v].add(a))}},h._76o=function(){var t=this,D=t._90I;if(D){for(var s in D)D[s].each(function(o){cp(o)});delete t._90I}},h._77o=function(k){var n=this;if(n._90I){var f=n._90I[k];f&&(f.each(function(y){cp(y)}),delete n._90I[k])}}},_47o:function(x){x.getValue=function(R,O){return O.getValue?O.getValue(R,O,this):lr(R,O.getAccessType(),O.getName())},x.setValue=function(h,D,v){if(D.isEmptiable(h)||""!==v||(v=p),D.isNullable(h)||v!=X){var z=this,q=D.getName(h),b=D.getAccessType(h),d=D.getValueType(h);d===Di&&tc(v)?v=js(v):d===lg&&tc(v)?v=parseFloat(v):d===vj&&tc(v)&&(v="true"===v),z._batchEditable&&D._batchEditable&&z.isSelected(h)?z.sm().each(function(P){D.setValue?D.setValue(P,D,v,z):Ei(P,b,q,v)}):D.setValue?D.setValue(h,D,v,z):Ei(h,b,q,v)}},x.setCurrentEditor=function(w){this.endEditing(),this._currentEditor=w,this.redraw()},x.isEditing=function($,m){var h=this,d=h._currentEditor;if(!d)return!1;if(m){var w=d.info;return w?(w.column||w.property)===m&&w.data===$:!1}return!0},x.endEditing=function(m){var $=this,q=$._currentEditor;q&&(delete $._currentEditor,q.commitValue&&q.commitValue(q.info,m),$.redraw(),$.getDataModel().endTransaction())},x.beginEditing=function(H){this.endEditing();var G=this,W=H.column||H.property;if(W.beginEditing)W.beginEditing(H);else{var v=H.data,P=H.value,D=G.getSelectBackground(v),g=W.getEnumValues(v),T=W.getSlider(v),I=W.getColorPicker(v);if(T){var m=dp(ot.Slider,T);return m.setValue(P),m.getView().onblur=function(){G.endEditing()},m.isInstant()&&(m.onValueChanged=function(){G.setValue(v,W,m.getValue())}),mt(m,H),void 0}if(I||W.getValueType(v)===Ur){var w=dp(ot.ColorPicker,I);return w.setValue(P),w.onClosed=function(){G.endEditing()},w.isInstant()&&(w.onValueChanged=function(g,z){G.setValue(v,W,z)}),mt(w,H),w.open(),void 0}if(g){if(ot.ComboBox){var j=new ot.ComboBox;j.setValue(P),j.setValues(g),j.setLabels(W.getEnumLabels(v)),j.setIcons(W.getEnumIcons(v)),j.setEditable(W.isEnumEditable(v)),j.setStrict(W.isEnumStrict(v)),j.setMaxHeight(W.getEnumMaxHeight(v)),j.setDropDownWidth(W.getEnumDropDownWidth(v)),j.onClosed=function(){G.endEditing()},mt(j,H),j.open()}else nt(th,H,D,g,W);return}var Y=W.getValueType(v);if(Y===vj||Pk(P))return G.setValue(v,W,!P),void 0;if(W.getItemEditor(v)){var h=Fg(W.getItemEditor(v)),S=new h(v,W,G,H),i=S.getView();return i._17Q=S,S.setValue(P),Qc(i),mt(i,H),S.editBeginning&&S.editBeginning(),void 0}nt("input",H,D,X,W)}}},_44o:function(s){s.init=function(L){var W=this,l=W.th=new Et(L),p=W._view=Mn(1,W);W.tv=W._tableView=L,vb(p,l.getView()),vb(p,L.getView()),l.mp(function(m){m.property===mn&&W.iv()}),W.iv()},s.getTableView=function(){return this.tv},s.getTableHeader=function(){return this.th},s.getDataModel=function(){return this.tv.dm()},s.getColumnModel=function(){return this.tv.getColumnModel()},s.setColumns=function(O){this.tv.setColumns(O)},s.addColumns=function(w){this.tv.addColumns(w)},s.endEditing=function(){this.tv.endEditing()},s.validateImpl=function(){var F=this,R=F.th,E=gd(R),C={x:0,y:0,width:F.getWidth(),height:E};zd(R,C),C.y=E,C.height=P(0,F.getHeight()-E),zd(F.tv,C)}},ms_vs:function(e){e._41o=function(){return this._29I.height<this._59I},e._43o=function(){var U=this;U._41o()&&(U._58I||(td(function(){U._94O()},Eb),U.iv()),U._58I=new Date)},e._94O=function(){var Y=this;if(Y._58I){var F=new Date;F.getTime()-Y._58I.getTime()>=Eb?(delete Y._58I,Y.iv()):td(function(){Y._94O()},Eb)}},e._93I=function(){var M=this,y=M._27I;if(M._58I||!M._autoHideScrollBar){y||vb(M._79O,y=M._27I=_j());var L=M._29I,J=L.height,_=M._59I,p=M.getScrollBarSize(),f=L.width-p-2,Q=J*(-M.ty()/_),e=J*(J/_),E=y.style;_>J?(ub>e&&(Q=Q+e/2-ub/2,0>Q&&(Q=0),Q+ub>J&&(Q=J-ub),e=ub),E.visibility=_c,E.background=M.getScrollBarColor(),E.borderRadius=p/2+Dp,zd(y,f,Q,p,e)):E.visibility=Ik}else y&&(y.style.visibility=Ik)}},ms_hs:function(M){M._40o=function(){return this._29I.width<this._91I},M._42o=function(){var L=this;L._40o()&&(L._95O||(td(function(){L._94I()},Eb),L.iv()),L._95O=new Date)},M._94I=function(){var s=this;if(s._95O){var C=new Date;C.getTime()-s._95O.getTime()>=Eb?(delete s._95O,s.iv()):td(function(){s._94I()},Eb)}},M._92I=function(){var I=this,c=I._28I;if(I._95O||!I._autoHideScrollBar){c||vb(I._79O,c=I._28I=_j());var E=I._29I,r=E.width,s=I._91I,O=I.getScrollBarSize(),q=E.height-O-2,n=r*(-I.tx()/s),p=r*(r/s),L=c.style;s>r?(ub>p&&(n=n+p/2-ub/2,0>n&&(n=0),n+ub>r&&(n=r-ub),p=ub),L.visibility=_c,L.background=I.getScrollBarColor(),L.borderRadius=O/2+Dp,zd(c,n,q,p,O)):L.visibility=Ik}else c&&(c.style.visibility=Ik)}}}),Eq(ws,Qm(16,16,[{type:zo,rect:[1,1,14,14],background:$k},{type:sk,rect:[1,1,14,14],width:1,color:nk},{type:Zi,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Eq(wo,Qm(16,16,{type:sk,rect:[1,1,14,14],width:1,color:nk})),Eq(jk,Qm(16,16,[{type:ed,rect:[2,2,12,12],borderWidth:1,borderColor:nk,background:"#FFF"},{type:ed,rect:[4,4,8,8],background:$k}])),Eq(_f,Qm(16,16,{type:ed,rect:[2,2,12,12],borderWidth:1,borderColor:nk})),cm._15Q=function(V){V._29I=dm,V._59I=0,V._91I=0,V._5o=function(F){var e=this;e._30I=new jn,e._rows=new jn,e._rowMap={},e._31I=0,e._14I=0,e._view=Mn(1,e),e._canvas=_i(e._view),vb(e._view,e._79O=_j()),e.dm(F?F:new pf)},V.getCheckIcon=function(r){var t=this.sm(),x=t.co(r);return t.sg()?ir(x?jk:_f):ir(x?ws:wo)},V.checkData=function(i){var N=this.sm(),E=N.co(i);N.sg()&&E||(this._32o=1,E?N.rs(i):N.as(i),delete this._32o)},V.getDataAt=function(P){P.target&&(P=this.lp(P));var V=x(P.y/this._rowHeight),d=this._rows;return 0>V||V>=d.size()?X:d.get(V)},V.onDataDoubleClicked=function(){},V.onDataClicked=function(){},V.adjustTranslateX=function(){return 0},V.adjustTranslateY=function(M){var I=this.getHeight()-this._59I;return I>M&&(M=I),M>0?0:s(M)},V.onPropertyChanged=function(y){var f=this,p=y.property;it[p]?f.ivm():ht[p]||f.redraw(),p===Sg?f._42o():p===of&&f._43o()},V.getLabel=function(H){return H.toLabel()},V.getLabelFont=function(){return this._labelFont},V.getLabelColor=function(o){var q=this;if(q.isCheckMode()){if(q._focusData===o)return q._labelSelectColor}else if(q.isSelected(o))return q._labelSelectColor;return q._labelColor},V.getStartRowIndex=function(){return this._31I},V.getEndRowIndex=function(){return this._14I},V.getRowDatas=function(){return this._rows},V.getRowIndex=function(u){return this._rowMap[u._id]},V.getRowSize=function(){return this._rows.size()},V.getViewRect=function(){return Nq(this._29I)},V.isVisible=function(p){return this._visibleFunc?this._visibleFunc(p):!0},V.getCurrentSortFunc=function(){return this._sortFunc},V.setDataModel=function(l){var M=this,K=M._dataModel,H=M._selectionModel;K!==l&&(K&&(K.umm(M.handleDataModelChange,M),K.umd(M.handleDataPropertyChange,M),K.umh(M.handleHierarchyChange,M),H||K.sm().ums(M.handleSelectionChange,M)),M._dataModel=l,l.mm(M.handleDataModelChange,M),l.md(M.handleDataPropertyChange,M),l.mh(M.handleHierarchyChange,M),H?H._21I(l):l.sm().ms(M.handleSelectionChange,M),M.fp("dataModel",K,l))},V.validateModel=function(){var h=this;h._rows.clear(),h._rowMap={},h.buildChildren(h._dataModel._roots);var F=h._rows=h._rows.toList(h.isVisible,h),v=0,d=h.getCurrentSortFunc(),K=F.size();for(d&&F.sort(d);K>v;v++)h._rowMap[F.get(v)._id]=v},V.buildChildren=function(P){var e=this;P.each(function(t){e._rows.add(t),e.buildChildren(t._children)})},V.handleDataModelChange=function(){this.ivm()},V.handleDataPropertyChange=function(y){"parent"===y.property?this.ivm():this.invalidateData(y.data)},V.handleHierarchyChange=function(){this.ivm()},V.handleSelectionChange=function(j){j.datas.each(this.invalidateData,this),this.onSelectionChanged(j)},V.onSelectionChanged=function(s){var c=this,B=c.sm();!c.isAutoMakeVisible()||1!==B.size()||"set"!==s.kind&&"append"!==s.kind||c._32o||c.makeVisible(B.ld())},V.handleBackgroundClick=function(j){Dj(j)&&!this.isCheckMode()&&this.sm().cs()},V.makeVisible=function(I){I&&(this._23I=I,this.iv())},V.scrollToIndex=function(W){var Q=this,w=Q._29I,N=w.height,m=Q._rowHeight,b=m*W;W>=0&&W<Q._rows.size()&&N>0&&(b+m>w.y+N?Q.ty(-b+N-m):b<w.y&&Q.ty(-b))},V.autoScroll=function(e,j){var u=this,x=u._rowHeight,z=x,f=x/4,r=u._29I,P=u.lp(e),_={x:u.tx(),y:u.ty()};return x>0&&r&&(P.x-r.x<z?u.translate(f,0):r.x+r.width-P.x<z&&u.translate(-f,0),P.y-r.y<z?u.translate(0,f):r.y+r.height-P.y<z&&u.translate(0,-f)),_.x=u.tx()-_.x,_.y=u.ty()-_.y,j&&(j.x+=_.x,j.y+=_.y),_},V.getTopRowOrderSelection=function(){var W=this.sm().getTopSelection(),m={},$=new jn;return W.each(function(f){m[f._id]=f}),this._rows.each(function(y){m[y._id]&&$.add(y)}),$},V.getRowOrderSelection=function(){var N=new jn;return this._rows.each(function(d){this.isSelected(d)&&N.add(d)},this),N},V.ivm=function(){this.invalidateModel()},V.invalidateModel=function(){var S=this;S._96I||(S._96I=1,S._32I=1,delete S._24I),S.iv()},V.redraw=function(){var q=this;q._32I||(q._32I=1,delete q._24I,q.iv())},V.invalidateData=function(j){var t=this;hb?t.redraw():t._32I||(t._24I||(t._24I={}),t._24I[j._id]=j,t.iv())},V.getFocusData=function(){return this._focusData},V.setFocusDataById=function(V){this.setFocusData(this.dm().getDataById(V))},V.setFocusData=function(X){var L=this,j=L._focusData;j!==X&&(L._focusData=X,L.fp("focusData",j,X),j&&L.invalidateData(j),X&&(L.invalidateData(X),L.isAutoMakeVisible()&&L.makeVisible(X)))},V.drawRowBackground=function(m,v,N,p,Y,x,i){var $=this,J=$.isCheckMode();(v===$._focusData&&J||N&&!J)&&Ve(m,p,Y,x,i,$.getSelectBackground(v))},V.drawData=function(X,z,j){var v=this,y=v._rowHeight,i=y*j,Q=v._29I,n=Q.x,p=Q.width;X.save(),X.beginPath(),X.rect(n,i,p,y),X.clip(),v._87o(v.drawRow(X,z,v.isSelected(z),n,i,p,y),j,n,i,p,y),X.restore(),v._rowLineVisible&&Ve(X,n,i+y-1,p,1,v._rowLineColor)},V._12I=function(B){var m=this,d=m._31I,R=m._29I,$=R.x,s=R.y,h=R.width,n=R.height;for(B.beginPath(),B.rect($,s,h,n),B.clip(),B.clearRect($,s,h,n),m._76o(),m._93db(B);d<m._14I;d++)m.drawData(B,m._rows.get(d),d);m._92db(B)},V._13I=function(v){for(var i,U=this,X=U._rowHeight,$=U._29I,T=$.x,p=$.width,h=U._31I,H=U._30I;h<U._14I;h++)i=U._rows.get(h),U._24I[i._id]&&H.add({data:i,index:h});H.isEmpty()||(v.beginPath(),H.each(function(N){v.rect(T,N.index*X,p,X)}),v.clip(),H.each(function(Q){v.clearRect(T,Q.index*X,p,X)}),H.each(function(D){U._77o(D.index)}),U._93db(v),H.each(function(E){U.drawData(v,E.data,E.index)}),U._92db(v),H.clear())},V.preValidateModel=function(){this.endEditing&&this.endEditing()},V.validateImpl=function(){var S=this,L=S._canvas,C=S.getWidth(),c=S.getHeight(),r=S._rowHeight,d=S._32I;(C!==L.clientWidth||c!==L.clientHeight)&&(zl(L,C,c),d=1),S._96I&&(S.preValidateModel(),S.validateModel());var K=S._29I,D={x:-S.tx(),y:-S.ty(),width:C,height:c},n=S._rows.size(),G=dk(L),g=S._23I;d||bq(D,K)||(d=1),S._29I=D,S._59I=n*r,S._31I=x(D.y/r),S._14I=I((D.y+D.height)/r),S._31I<0&&(S._31I=0),S._14I>n&&(S._14I=n),S._99I&&d&&S._99I();var f=S.tx(),v=S.ty();(S._40o()||S._41o())&&(S._59I+=S.getScrollBarSize(),S._99I&&d&&(S._91I+=S.getScrollBarSize())),wi&&!Ko&&(G.save(),xn(G,C/kc.length,c/kc.length,1)),xn(G,f,v,1),d?S._12I(G):S._24I&&S._13I(G),S._93I(),S._92I(),G.restore(),S._32I=S._24I=S._96I=X,g&&(S.scrollToIndex(S.getRowIndex(g)),delete S._23I),S.tx(S.tx()),S.ty(S.ty())},V.canHandleSelectMode=function(){return!0}},cm._48o=function(t){t._rootVisible=!0,t._rootData=X,t._35o=function(){this._expandMap={},this._levelMap={}},t.validateModel=function(){var t=this,k=t._rootData;t._rows.clear(),t._levelMap={},t._rowMap={},t._currentLevel=0,k?t._rootVisible?t.isVisible(k)&&t.buildData(k):t.buildChildren(k):t.buildChildren(),delete t._currentLevel},t.buildData=function(S){var c=this,d=S._id,m=c._rows;c._rowMap[d]=m.size(),m.add(S),c._levelMap[d]=c._currentLevel,c.isExpanded(S)&&(c._currentLevel++,c.buildChildren(S),c._currentLevel--)},t.buildChildren=function(b){var x=this,E=b?b._children:x._dataModel._roots,u=x.getCurrentSortFunc();u&&x.isChildrenSortable(b)?E.toList(x.isVisible,x).sort(u).each(x.buildData,x):E.each(function(R){x.isVisible(R)&&x.buildData(R)})},t.getLevel=function(G){return this._levelMap[G._id]},t.getToggleIcon=function(z){var c=this,v=c._loader,t=c._collapseIcon;return v&&!v.isLoaded(z)?t:z.hasChildren()?c.isExpanded(z)?c._expandIcon:t:X},t.isCheckMode=function(){return this._checkMode!=X},t.isChildrenSortable=function(){return!0},t.handleDataModelChange=function(D){var k=this;D.kind===Uc?delete k._expandMap[D.data._id]:D.kind===ef&&(k._expandMap={}),k.ivm()},t.toggle=function(G){var t=this;t.isExpanded(G)?t.collapse(G):t.expand(G)},t.isExpanded=function(U){return 1===this._expandMap[U._id]},t.expand=function(V){var X=this,c=X._loader;X.isExpanded(V)||(c&&!c.isLoaded(V)&&c.load(V),X._expandMap[V._id]=1,X.ivm(),X.onExpanded(V))},t.onExpanded=function(){},t.collapse=function(U){var x=this;x.isExpanded(U)&&(delete x._expandMap[U._id],x.ivm(),x.onCollapsed(U))},t.onCollapsed=function(){},t.expandAll=function(Q){if(Q)this.expand(Q),Q.eachChild(function(l){this.expandAll(l)},this);else{var _=this;_._dataModel.each(function(v){v.hasChildren()&&(_._expandMap[v._id]=1)}),_.ivm()}},t.collapseAll=function(){this._expandMap={},this.ivm()},t.makeVisible=function(q){if(q){var g=this;if(!g._rootData||q.isDescendantOf(g._rootData)){for(var X=q._parent;X;)g.expand(X),X=X._parent;g._23I=q,g.iv()}}},t.checkData=function(I){var w,A=this,n=A._checkMode,o=A.sm(),x=o.co(I);if(!o.sg()||!x){if(A._32o=1,n===xr)x?o.rs(I):o.as(I);else if(n===ze)w=new jn(I),w.addAll(I._children);else if("descendant"===n)w=new jn,kt(I,w);else if("all"===n&&(w=new jn,kt(I,w),!x))for(var H=I._parent;H;)w.add(H),H=H._parent;w&&(x?o.rs(w):o.as(w)),delete A._32o}},t.drawTree=function(k,v,q,S,Q,U,A){var e=this,O=e._indent,d=e._levelMap[v._id],r=e.getIconWidth(v),_=ir(e.getToggleIcon(v));
_?(S+=O*d,dj(k,_,S+O/2,Q+A/2,v,e),S+=O):S+=O*(d+1),e._checkMode&&(dj(k,e.getCheckIcon(v),S+O/2,Q+A/2,v,e),S+=O),e.drawIcon(k,v,S,Q,r,A),e.drawLabel(k,v,S+r,Q,A)}},cm._14Q=function(O){O.getIcon=function(f){return f.getIcon()},O.getIconWidth=function(m){return this.getIcon(m)?this._indent:0},O.drawIcon=function(y,C,Z,_,Q,k){if(Q){var q=this,r=q.getBodyColor(C),h=ir(q.getIcon(C),r);h&&(k-=q.isRowLineVisible()?1:0,ch(y,h,ti,Z,_,Q,k,C,q,r),oo(y,q.getBorderColor(C),Z,_,Q,k))}},O.drawLabel=function(o,q,y,M,m){var W=this;Oj(o,W.getLabel(q),W.getLabelFont(q),W.getLabelColor(q),y,M,0,m)}},cm._50o=function(d){d._98I=function(){var C=this,b=C._39o=new pf;C._60I=new jn,b.mm(C._17o,C),b.md(C._18o,C),b.mh(C._19o,C)},d.setColumns=function(t){this._39o.clear(),this.addColumns(t)},d.addColumns=function(K){var y=this._39o;K.forEach(function(a){if(!(a instanceof rt)){var A=Fg(a.className);a=dp(A?A:rt,a)}y.add(a)})},d.onColumnClicked=function(){},d.onCheckColumnClicked=function(){},d._3Q=function(U){for(var u,G=0,t=this._60I,D=t.size();D>G;G++)if(u=t.get(G),u.column===U)return u;return X},d.getColumnAt=function(M){var E=this._4Q(M);return E?E.column:X},d._4Q=function(O){for(var N=this,m=O.target?N.lp(O).x:O.x,S=N._60I,B=0;B<S.size();B++){var L=S.get(B),R=L.startX;if(m>=R&&m<R+L.column.getWidth())return L}return X},d.getToolTip=function(d){var v=this,B=v.getDataAt(d),g=v.getColumnAt(d);return B&&g?g.getToolTip(B,v):X},d.adjustTranslateX=function(P){var T=this.getWidth()-this._91I;return T>P&&(P=T),P>0?0:s(P)},d._99I=function(){var k=this,o=k._29I,A=k._60I;A.clear(),k._91I=0,k._39o._roots.each(function(r){if(r.isVisible()){var V=k._91I+r.getWidth();k._91I<=o.x+o.width&&V>=o.x&&A.add({column:r,startX:k._91I}),k._91I=V}})},d.drawData=function(r,C,v){var q=this,R=q._rowHeight,k=R*v,x=q.isSelected(C),A=q._29I,f=A.x,n=A.width;q.drawRowBackground(r,C,x,f,k,n,R),q._60I.each(function(_){var Z=_.column,D=_.startX,W=Z.getWidth();W>0&&!q.isEditing(C,Z)&&(r.save(),r.beginPath(),r.rect(D,k,W,R),r.clip(),q._87o(q.drawCell(r,C,x,Z,D,k,W,R),v,D,k,W,R),q._columnLineVisible&&Ve(r,D+W-1,k,1,R,q._columnLineColor),r.restore())}),q._rowLineVisible&&Ve(r,f,k+R-1,n,1,q._rowLineColor)},d.drawCell=function(Z,B,p,c,T,l,O,e){var N=this;if(c.drawCell)return c.drawCell(Z,B,p,c,T,l,O,e,N);var J=N.getValue(B,c);lt(Z,J,c,N.getLabelFont(B,c,J),N.getLabelColor(B,c,J),T,l,O,e,B,N)},d.getColumnModel=function(){return this._39o},d._17o=function(){this.redraw()},d._18o=function(h){var I=this;h.data===I._sortColumn&&gt[h.property]?I.ivm():(I._42o(),I.redraw())},d._19o=function(){this.redraw()},d.getCurrentSortFunc=function(){var E=this,r=E._sortColumn;if(r&&r.isSortable()){var R=r.getSortFunc(),b=ao===r.getSortOrder()?1:-1;return R||(R=bk),function(o,H){return R.call(E,E.getValue(o,r),E.getValue(H,r),o,H)*b}}return E._sortFunc},d.isCellEditable=function(L,P,c){return P.isEditable()&&this.isEditable()?P.isCellEditable?P.isCellEditable(L,P,c,this):!0:!1},d._37O=function(r,g){if(Dj(g))for(var O=this,V=O.lp(g),Z=O._60I,S=O._rowHeight,m=O._29I,E=m.x,U=m.y,j=m.width,f=m.height,p=0;p<Z.size();p++){var l=Z.get(p),A=l.startX,F=l.column,u=F.getWidth();if(F!==O._31o&&F!==O._4o&&V.x>=A&&V.x<A+u&&O.isCellEditable(r,F,g)){var n={x:A,y:O.getRowIndex(r)*S,width:u,height:S},y={x:n.x+O.tx(),y:n.y+O.ty(),width:n.width,height:n.height},L=0,c=0;return n.x<E?L=n.x-E:n.x+n.width>E+j&&(L=n.x+n.width-E-j),L&&(O.tx(O.tx()-L),y.x-=L),n.y<U?c=n.y-U:n.y+S>U+f&&(c=n.y+S-U-f),c&&(O.ty(O.ty()-c),y.y-=c),O.beginEditing({data:r,column:F,value:O.getValue(r,F),event:g,rect:n,editorRect:y,view:O}),void 0}}}},ot.BaseItemEditor=function(U,V,g,N){this._data=U,this._column=V,this._master=g,this._editInfo=N},pt("BaseItemEditor",b,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var qt=S.Tab=function(){jl(qt,this)};Ef("Tab",$m,{ms_ac:["view","closable","disabled","visible"],_icon:X,_closable:!1,_disabled:!1,_visible:!0,setParent:Ir});var rt=S.Column=function(){jl(rt,this)};Ef("Column",$m,{_46o:1,ms_ac:["accessType","valueType",_c,cs,Tn,zm,"align",Ur,"sortOrder",vh,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:ao,_sortFunc:X,_sortable:!0,_clickable:!0,setWidth:function(b){16>b&&(b=16);var j=this._width;this._width=b,this.fp(zm,j,b)},getToolTip:function(W,F){return this.formatValue(F.getValue(W,this))}});var st=S.Property=function(){jl(st,this)};Ef("Property",$m,{_46o:1,ms_ac:["accessType","valueType",cs,Tn,"categoryName",Ur,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:X,getToolTip:function(q,B,c){var F=this;return B?F.formatValue(c.getValue(q,F)):c.getPropertyName(F)}}),ot.AccordionView=function(){var E=this;E._20o={},E._21o=new jn,E._10o=X,E._9o=X,E._11o=X,E._view=Mn(0,E),E.iv()},pt("AccordionView",b,{ms_v:1,ms_fire:1,ms_ac:[$p,kp,"titleHeight",Eh,ak,"titleBackground","selectWidth",Jm,"orientation","separatorColor"],_expandIcon:E.accordionViewExpandIcon,_collapseIcon:E.accordionViewCollapseIcon,_titleHeight:hh,_labelColor:E.accordionViewLabelColor,_labelFont:E.accordionViewLabelFont,_titleBackground:E.accordionViewTitleBackground,_selectBackground:E.accordionViewSelectBackground,_selectWidth:E.accordionViewSelectWidth,_orientation:"v",_separatorColor:E.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(Z,R,h,W){var U=this,B=_j(),m={content:R,div:B,canvas:_i(B),icon:W};if(U._20o[Z])throw Z+" already exists";var d=m.downEventFunc=function(D){Bi(D)},g=m.upEventFunc=function(B){Bi(B),Dj(B)&&(U._10o===Z?U.collapse():U.expand(Z))};[Im,Cs].forEach(function(K){q(B,K,d)}),[Gk,pi].forEach(function(R){q(B,R,g)}),B.style.cursor=be,vb(U._view,B),U._20o[Z]=m,U._21o.add(Z),h&&U.expand(Z),U.iv()},remove:function(Q){var S=this,_=S._20o[Q];if(_){var C=_.div;cp(C),[Im,Cs].forEach(function(p){O(C,p,_.downEventFunc)}),[Gk,pi].forEach(function(s){O(C,s,_.upEventFunc)}),delete S._20o[Q],S._21o.remove(Q),S.iv()}},clear:function(){var Q=this;Q._21o.toArray().forEach(Q.remove,Q),Q._20o={},Q._21o.clear(),Q.iv()},isExpanded:function(i){return this._10o===i},expand:function(P){var G=this;G._20o[P]&&G._10o!==P&&(G._10o=P,G.onExpanded(P),G.iv())},onExpanded:function(){},collapse:function(){var M=this;M._10o&&(M.onCollapsed(M._10o),delete M._10o,M.iv())},onCollapsed:function(){},initCanvas:function(k,g,j){zl(k,g,j);var P=dk(k);return xn(P,0,0,1),P.clearRect(0,0,g,j),P},drawTitle:function(h,u,k,J,Q){var K=this,$=ir(Q.icon),N=K.isExpanded(u),U=K._titleHeight,y=K._titleBackground,M=K._selectWidth,P=K._separatorColor,_=ir(N?K._expandIcon:K._collapseIcon),n=M+4;Ve(h,0,0,k,J,y),N&&M&&Ve(h,0,0,M,J,K._selectBackground),(N||K._21o.get(K._21o.size()-1)!==u)&&Ve(h,0,J-1,k,1,P?P:Ab(y)),$&&(dj(h,$,n+rc($)/2,U/2),n+=rc($)+2),Oj(h,u,K.getLabelFont(u),K.getLabelColor(u),n,0,0,U),_&&dj(h,_,k-rc(_)/2-4,U/2)},validateImpl:function(){var Y=this,r=Y._view,I=0,G=0,K=Y.getWidth(),Q=Y.getHeight(),O=Y._titleHeight,c=Y._21o.size()*O,m=Y._11o,R=Y._9o;delete Y._11o,delete Y._9o,Y._21o.each(function(b){var w,U,r=Y._20o[b],e=r.content,d=Y._10o===b;oe(Y)?(zd(r.div,I,0,O,Q),w=Y.initCanvas(r.canvas,O,Q),Pb(w,0,Q),iq(w,-fs),Y.drawTitle(w,b,Q,O,r),w.restore(),d?(U=P(0,K-c),e&&(Y._11o=e,Y._9o=om(e),zd(e,I+O,0,U,Q)),I+=O+U):I+=O):(zd(r.div,0,G,K,O),w=Y.initCanvas(r.canvas,K,O),Y.drawTitle(w,b,K,O,r),w.restore(),d?(U=P(0,Q-c),e&&(Y._11o=e,Y._9o=om(e),zd(e,0,G+O,K,U)),G+=O+U):G+=O)});var S=Y._9o;m&&m!==Y._11o&&m.endEditing&&m.endEditing(),S&&S!==R&&vb(r,S),R&&R!==S&&cp(R)}}),ot.SplitView=function(g,y,E,c){var W=this,i=W._dividerDiv=_j(),n=W._60O=_i(),$=W._61O=_i(),D=n.style,b=$.style;W._view=Mn(1,W),vb(W._view,i),D.msTouchAction=Or,D.pointerEvents=Or,D.cursor=be,b.msTouchAction=Or,b.pointerEvents=Or,b.cursor=be,g&&W.setLeftView(g),y&&W.setRightView(y),E&&W.setOrientation(E),c!=X&&W.setPosition(c),W.setStatus(ji),new tt(W)},pt("SplitView",b,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:E.splitViewDividerSize,_dividerBackground:E.splitViewDividerBackground,_dragOpacity:E.splitViewDragOpacity,_toggleIcon:E.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(L,e){var B=this,i=B._position;isNaN(L)||(e||(B._82O=0>L?-1:L>1?1:0),B._position=L,B.fp(rn,i,L))},getLeftView:function(){return this._leftView},setLeftView:function(y){var F=this,u=F._leftView,H=F._view;if(F._leftView!==y){if(u&&u!==F._rightView){var K=om(u);K.parentNode===H&&cp(K)}if(F._leftView=y,y){var m=om(y);m.parentNode!==H&&H.insertBefore(m,F._dividerDiv)}F.fp("leftView",u,y)}},getRightView:function(){return this._rightView},setRightView:function(l){var Z=this,p=Z._rightView,o=Z._view;if(Z._rightView!==l){if(p&&p!==Z._leftView){var x=om(p);x.parentNode===o&&cp(x)}if(Z._rightView=l,l){var F=om(l);F.parentNode!==o&&o.insertBefore(F,Z._dividerDiv)}Z.fp("rightView",p,l)}},validateImpl:function(){var W=this,w=W._draggable,K=W._position,h=W.getWidth(),x=W.getHeight(),j=W._dividerSize,H=W._dividerBackground,A=Iq?18:8,E=W._dividerDiv,V=W._82O,M=W._60O,m=W._61O,T=W._toggleIcon,z=W._status,p=E.style,B=null,o=Iq?20:4,I=T.comps[0];j>=A||0===j?W._coverDiv&&(cp(W._coverDiv),delete W._coverDiv):W._coverDiv||(W._coverDiv=_j(),Ao&&(W._coverDiv.style.background=ac),vb(E,W._coverDiv)),W._togglable?M.parentNode||(vb(E,M),vb(E,m)):(cp(M),cp(m));var J=W._coverDiv,a=W._leftView,n=W._rightView;if(oe(W)){if(j>h&&(j=h),z===ji)if(1===V)var $=d(K,h),G=P(0,h-j-$);else-1===V?(G=d(-K,h),$=P(0,h-j-G)):($=s((h-j)*K),G=P(0,h-j-$));else"cl"===z?($=0,G=P(0,h-j)):"cr"===z&&(G=0,$=P(0,h-j));a&&zd(a,0,0,$,x),n&&zd(n,$+j,0,G,x),zd(E,$,0,j,x),W._22o=$,J&&(zd(J,j/2-A/2,0,A,x),J.style.cursor=w?$n:""),E.style.cursor=w?$n:"";var D=E.clientHeight/2,v=E.clientWidth;zl(M,v,v),zd(M,0,D-v-o,v,v),B=dk(M),xn(B,0,0,1),I.rotation=-fs,tm(B,T,0,0,v,v),B.restore(),zl(m,v,v),zd(m,0,D+o,v,v),B=dk(m),xn(B,0,0,1),I.rotation=fs,tm(B,T,0,0,v,v),B.restore()}else{if(j>x&&(j=x),z===ji)if(1===V)var e=d(K,x),X=P(0,x-j-e);else-1===V?(X=d(-K,x),e=P(0,x-j-X)):(e=s((x-j)*K),X=P(0,x-j-e));else"cl"===z?(e=0,X=P(0,x-j)):"cr"===z&&(X=0,e=P(0,x-j));a&&zd(a,0,0,h,e),n&&zd(n,0,e+j,h,X),zd(E,0,e,h,j),W._22o=e,J&&(zd(J,0,j/2-A/2,h,A),J.style.cursor=w?Yk:""),p.cursor=w?Yk:"";var O=E.clientWidth/2,v=E.clientHeight;zl(M,v,v),zd(M,O-v-o,0,v,v),B=dk(M),xn(B,0,0,1),I.rotation=0,tm(B,T,0,0,v,v),B.restore(),zl(m,v,v),zd(m,O+o,0,v,v),B=dk(m),xn(B,0,0,1),I.rotation=f,tm(B,T,0,0,v,v),B.restore()}p.background=H}});var tt=function(R){this.sv=R,this.addListeners()};Wi(tt,b,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(l){var S=this,Y=S.sv,s=Y._dividerDiv,g=Y._60O,O=Y._61O,M=Y._status,x=l.target;if(x===g)M===ji?Y.setStatus("cl"):"cr"===M&&Y.setStatus(ji);else if(x===O)M===ji?Y.setStatus("cr"):"cl"===M&&Y.setStatus(ji);else if(Sm(l)&&(x===s||x===Y._coverDiv)&&(Bi(l),Y.isDraggable())){Y.getLeftView(),Y.getRightView();var r=S.maskDiv=_j();if(r.style.left=0,r.style.top=0,r.style.width=Y.getWidth()+"px",r.style.height=Y.getHeight()+"px",Y.getView().appendChild(r),!Y.isContinuousLayout()){var R=S.resizeDiv=_j();R.style.left=s.style.left,R.style.top=s.style.top,R.style.width=s.style.width,R.style.height=s.style.height,R.style.opacity=Y.getDragOpacity(),R.style.background=Y.getDividerBackground(),vb(S.getView(),R)}S._lastAbsPosition=Y._22o,S._86o=oe(Y)?Wc(l).x:Wc(l).y,Aj(S,l)}},handleWindowTouchMove:function(w){Sm(w)&&this.update(w,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(g){var z=this;z.update(g,!0),z.sv.setStatus(ji),z.maskDiv&&cp(z.maskDiv),z.resizeDiv&&cp(z.resizeDiv),z.maskDiv=z.resizeDiv=X},handle_mousedown:function(C){Dj(C)&&this.handle_touchstart(C)},handleWindowMouseMove:function(N){this.handleWindowTouchMove(N)},handleWindowMouseUp:function(e){this.handleWindowTouchEnd(e)},update:function(y,H){var Z=this,A=Z.sv,x=oe(A)?A.getWidth():A.getHeight(),V=A._dividerSize,G=Z._lastAbsPosition-Z._86o;oe(A)?(G+=Wc(y).x,G>x-V&&(G=x-V),0>G&&(G=0),Z.resizeDiv&&(Z.resizeDiv.style.left=G+Dp)):(G+=Wc(y).y,G>x-V&&(G=x-V),0>G&&(G=0),Z.resizeDiv&&(Z.resizeDiv.style.top=G+Dp)),H&&x!==V&&(1===A._82O?A.setPosition(G,1):-1===A._82O?A.setPosition(G-x+V,1):A.setPosition(G/(x-V),1))}}),ot.TabView=function(){var c=this,E=c._view=Mn(1,c),A=c._91O=_j(1),w=c._tabModel=new pf,Z=w.sm(),I=c.invalidate;c._7o=new jn,c._canvas=_i(A),vb(E,A),vb(E,c._92O=_j(1)),Z.setSelectionMode(mh),Z.ms(c.handleSelectionChange,c),w.mm(I,c),w.mh(I,c),w.md(I,c),c._interactor=new ut(c),c.iv()},pt("TabView",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Eh,ak,"tabHPadding","tabBackground","selectWidth",Jm,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:yb,_tabHeight:hh,_tabGap:E.tabViewTabGap,_labelColor:E.tabViewLabelColor,_labelFont:E.tabViewLabelFont,_tabBackground:E.tabViewTabBackground,_selectWidth:E.tabViewSelectWidth,_selectBackground:E.tabViewSelectBackground,_moveBackground:E.tabViewMoveBackground,_insertColor:E.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(q,$,p){var Q,t=this._tabModel;return q instanceof qt?(Q=q,$&&Q.setView($)):(Q=new qt,Q.setName(q),Q.setView($)),t.add(Q),p&&t.sm().ss(Q),Q},getLabel:function(P){return P.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(n){this._23o=n,this.iv()},get:function(b){var G=this,z=G._tabModel;if(po(b))return z._roots.get(b);if(tc(b)){var o;return z.each(function(H){b===G.getLabel(H)&&(o=H)}),o}return b instanceof qt?b:X},select:function(s){this._tabModel.sm().ss(this.get(s))},remove:function(z){var o=this;if(z=o.get(z)){var G=o._tabModel,n=G._roots.indexOf(z);o._tabModel.remove(z),o.selectByIndex(--n)}},getCurrentTab:function(){return this._8o},hideTabView:function(A,r){r.parentNode===this._92O&&(Id(r)?(r.style.display=Ui,r._tab_=A):cp(r),On())},showTabView:function(d,Z){Id(Z)&&(Z.style.display="block",Z._tab_=d),Z.parentNode!==this._92O&&(vb(this._92O,Z),On())},_24o:function(){var l,A=this,f=A._8o,s=A._9o,m=A._tabModel.sm().ld();m&&(l=om(m.getView())),l!==s&&(s&&(f.getView()&&f.getView().endEditing&&f.getView().endEditing(),A.hideTabView(f,s)),l&&A.showTabView(m,l)),A._8o=m,A._9o=l,f!==m&&A.onTabChanged(f,m)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(o,K){this.selectByIndex(--K)},selectByIndex:function(Z){var G=this,P=G._tabModel,Q=P.size();if(Q&&!P.sm().ld()){Z==X&&(Z=0),Z>=Q&&(Z=Q-1),0>Z&&(Z=0);for(var J=Z;J>=0;J--){var D=G.get(J);if(!D.isDisabled())return G.select(D),D}for(J=Z+1;Q>J;J++)if(D=G.get(J),!D.isDisabled())return G.select(D),D}},getTabWidth:function(G){var I=this.getTabHPadding(),Y=4+2*I,T=ir(G.getIcon());T&&(Y+=rc(T,G)+4);var H=this.getLabel(G);return H&&(Y+=Ll(this.getLabelFont(G),H).width+4),G.isClosable()&&(Y+=10),Y},drawTab:function(z,H,j,M,F,c,d){var s,A=this,E=A._tabPosition,V=this.getTabHPadding(),J=j+4+V,$=A._selectWidth,R=ir(H.getIcon()),q=H.isDisabled(),B=A.getLabelColor(H),O=A.getLabelFont(H),g=A.getLabel(H),y=A._selectBackground,n=E===cq+"-vertical",_=E===Jo+"-vertical";(n||_)&&(J=M+4+V),q&&(z.globalAlpha=um),Ve(z,j,M,F,c,d),H===A._8o&&$&&(E===yb?Ve(z,j,M+c-$,F,$,y):E===cq?Ve(z,j+F-$,M,$,c,y):E===Jo?Ve(z,j,M,$,c,y):n?Ve(z,j+F-$,M,$,c,y):_?Ve(z,j,M,$,c,y):Ve(z,j,M,F,$,y));var C=F/2;if(n&&(Pb(z,C,M+c/2),iq(z,f),Pb(z,-C,-M-c/2)),R){var m=Sn(R,H),Y=rc(R,H);if(n||_){var P=j+F/2,o=J+m/2;Pb(z,P,o),iq(z,fs),Pb(z,-P,-o),dj(z,R,j+F/2,J+m/2,H,A),Pb(z,P,o),iq(z,-fs),Pb(z,-P,-o),J+=m+4}else dj(z,R,J+Y/2,M+c/2,H,A),J+=Y+4}return n||_?(Pb(z,F/2,J+F/2),iq(z,fs),Pb(z,-F/2,-J-F/2),Oj(z,g,O,B,j,J,c,F),Pb(z,F/2,J+F/2),iq(z,-fs),Pb(z,-F/2,-J-F/2)):Oj(z,g,O,B,J,M,F,c),n&&(Pb(z,C,M+c/2),iq(z,-f),Pb(z,-C,-M-c/2)),H.isClosable()&&(s=_?{x:j+F-12,y:M+c-12,width:12,height:12}:{x:j+F-12,y:M+2,width:12,height:12},this.drawCloseIcon(H,z,B,s)),q&&(z.globalAlpha=1),s},drawCloseIcon:function(u,X,S,K){var p=K.x,V=K.y;X.strokeStyle=S,X.lineWidth=1,X.beginPath(),X.moveTo(p+2,V+8),X.lineTo(p+8,V+2),X.moveTo(p+8,V+8),X.lineTo(p+2,V+2),X.stroke()},getTabAt:function(Z){var $=this._interactor._8Q(Z);return $?$.tab:null},validateImpl:function(){var j=this;j._24o();var O,G=j._canvas,I=j._tabPosition,u=j._91O,y=j._92O,t=j._tabModel,S=j.getWidth(),d=j.getHeight(),f=j._tabHeight,w=j._7o,a=j._tabGap,o=I===yb,x=I===cq,Y=I===Jo,e=I===cq+"-vertical",k=I===Jo+"-vertical",z=j._23o,H=0;if((x||Y)&&t._roots.each(function(A){H=P(j.getTabWidth(A),H)}),o?(zd(u,0,0,S,f),O={x:0,y:f,width:S,height:P(0,d-f)}):x?(zd(u,0,0,H,d),O={x:H,y:0,width:P(0,S-H),height:d}):Y?(zd(u,S-H,0,H,d),O={x:0,y:0,width:P(0,S-H),height:d}):e?(zd(u,0,0,f,d),O={x:f,y:0,width:P(0,S-f),height:d}):k?(zd(u,S-f,0,f,d),O={x:0,y:0,width:P(0,S-f),height:d}):(zd(u,0,d-f,S,f),O={x:0,y:0,width:S,height:P(0,d-f)}),zd(y,O),e||k){j._9o&&(O.x=0,zd(j._8o.getView(),O)),zl(G,f,d);var Z=dk(G),q=0;if(xn(Z,0,j.ty(),1),Z.clearRect(0,0,f,d),w.clear(),t._roots.each(function(I){if(I.isVisible()){var r,y=j.getTabWidth(I);if(!z||z.tab!==I){var x=j.getTabBackground(I);r=j.drawTab(Z,I,0,q,f,y,x)}w.add({_75o:r,tab:I,startY:q,endY:q+y,height:y}),q+=y+a}}),j._23Q=P(0,q-a),z){var r=z.position;j.drawTab(Z,z.tab,0,z.startY,f,z.height,j._moveBackground),Ve(Z,0,r,f,1,j._insertColor)}if(Z.restore(),j._selectionChanged){j._selectionChanged=!1;for(var p=j.ty(),E=0;E<w.size();E++){var J=w.get(E);if(J.tab===j._8o){if(J.endY+p<0){j.ty(-J.startY);break}if(J.startY+p>d){j.ty(d-J.endY);break}}}}j.ty(j.ty())}else if(x||Y){j._9o&&(O.x=0,zd(j._8o.getView(),O)),zl(G,H,d);var Z=dk(G),q=0;if(xn(Z,0,j.ty(),1),Z.clearRect(0,0,H,d),w.clear(),t._roots.each(function(m){if(m.isVisible()){var e;if(!z||z.tab!==m){var J=j.getTabBackground(m);e=j.drawTab(Z,m,0,q,H,f,J)}w.add({_75o:e,tab:m,startY:q,endY:q+f,height:f}),q+=f+a}}),j._23Q=P(0,q-a),z){var r=z.position;j.drawTab(Z,z.tab,0,z.startY,H,z.height,j._moveBackground),Ve(Z,0,r,H,1,j._insertColor)}if(Z.restore(),j._selectionChanged){j._selectionChanged=!1;for(var p=j.ty(),E=0;E<w.size();E++){var J=w.get(E);if(J.tab===j._8o){if(J.endY+p<0){j.ty(-J.startY);break}if(J.startY+p>d){j.ty(d-J.endY);break}}}}j.ty(j.ty())}else{j._9o&&(O.y=0,zd(j._8o.getView(),O)),zl(G,S,f);var Z=dk(G),i=0;if(xn(Z,j.tx(),0,1),Z.clearRect(0,0,S,f),w.clear(),t._roots.each(function(h){if(h.isVisible()){var b,g=j.getTabWidth(h);if(!z||z.tab!==h){var $=j.getTabBackground(h);b=j.drawTab(Z,h,i,0,g,f,$)}w.add({_75o:b,tab:h,startX:i,endX:i+g,width:g}),i+=g+a}}),j._64I=P(0,i-a),z){var r=z.position;j.drawTab(Z,z.tab,z.startX,0,z.width,f,j._moveBackground),Cp(Z,j._insertColor,r,0,f)}if(Z.restore(),j._selectionChanged){j._selectionChanged=!1;for(var v=j.tx(),E=0;E<w.size();E++){var J=w.get(E);if(J.tab===j._8o){if(J.endX+v<0){j.tx(-J.startX);break}if(J.startX+v>S){j.tx(S-J.endX);break}}}}j.tx(j.tx())}for(var h=[],$=y.children,E=0;E<$.length;E++){var n=$[E],L=n._tab_;L&&!t.contains(L)&&h.push(n)}h.forEach(function(o){y.removeChild(o)})}});var ut=function(A){this.tv=A,this.addListeners()};Wi(ut,b,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(H){this.handleScroll(H,10*(H.wheelDelta/40))},handle_DOMMouseScroll:function(v){this.handleScroll(v,10*-v.detail)},handleScroll:function(L,x){Bi(L);var M=this.tv,d=M._tabPosition;!M._40o()||d!==yb&&d!==jc||M.tx(this.tv.tx()+x),!M._41o()||d!==cq&&d!==Jo&&d!==cq+"-vertical"&&d!==Jo+"-vertical"||M.ty(this.tv.ty()+x)},_8Q:function(R){var S,q,u=this.tv,Z=u._tabPosition,$=u._7o;if(Z===yb||Z===jc){var r=u.lp(R).x;for(S=0;S<$.size();S++)if(q=$.get(S),q.startX<=r&&r<=q.endX)return q}else if(Z===cq||Z===Jo||Z===cq+"-vertical"||Z===Jo+"-vertical"){var p=u.lp(R).y;for(S=0;S<$.size();S++)if(q=$.get(S),q.startY<=p&&p<=q.endY)return q}return X},isClickable:function(c){var X=this.tv,O=X._tabPosition,p=this._73o=this._8Q(c);return!X._40o()||O!==yb&&O!==jc?!X._41o()||O!==cq&&O!==Jo&&O!==cq+"-vertical"&&O!==Jo+"-vertical"?p&&(!p.tab.isDisabled()||X.isMovable()):!0:!0},handle_mousemove:function(T){var I=this;Gr?I._74o=I._8Q(T):I.getView().style.cursor=I.isClickable(T)?be:""},handle_mousedown:function(V){this.handle_mousemove(V),this.handle_touchstart(V)},handle_touchstart:function(K){var G=this,Y=G.tv,h=Y._tabPosition;Bi(K),Dj(K)&&G.isClickable(K)&&(h===yb||h===jc?(G.x=Wc(K).x,G.lp=Y.lp(K),G.tx=Y.tx()):(G.y=Wc(K).y,G.lp=Y.lp(K),G.ty=Y.ty()),Aj(G,K))},handle_mouseup:function(V){this.handle_touchend(V)},handle_touchend:function(Z){if(Op(Z)){var o=this._73o;if(!o)return;var V=this.tv,F=V.getTabModel(),N=o.tab;if(!N.isDisabled()&&N.isClosable()){var g=function(){var l=F._roots.indexOf(N);F.remove(N),V.onTabClosed(N,l)};V.onTabClosing(N,g)&&g()}}},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(b){var Y,T=this,$=T.tv,k=$._tabPosition,G=T._73o;if(k===yb||k===jc){if(Y=Wc(b).x-T.x,!T._25o&&!T.moving&&a(Y)>2&&($._40o()&&!Yd(b)?T._25o=1:G&&$.isMovable()&&(T.moving=1)),T._25o)$.tx(T.tx+Y);else if(T.moving){var l=T.lp.x+Y,_=$._tabGap/2;$._7o.each(function(B){var s=B.endX,D=l-B.startX<s-l;l>=B.startX&&s>=l&&$._7Q({tab:G.tab,startX:G.startX+Y,width:G.width,front:D,insertTab:B.tab,position:D?P(0,B.startX-_):d($._64I,s+_)})})}}else if(Y=Wc(b).y-T.y,!T._25o&&!T.moving&&a(Y)>2&&($._41o()&&!Yd(b)?T._25o=1:G&&$.isMovable()&&(T.moving=1)),T._25o)$.ty(T.ty+Y);else if(T.moving){var v=T.lp.y+Y,_=$._tabGap/2;$._7o.each(function(x){var O=x.endY,N=v-x.startY<O-v;v>=x.startY&&O>=v&&$._7Q({tab:G.tab,startY:G.startY+Y,height:G.height,front:N,insertTab:x.tab,position:N?P(0,x.startY-_):d($._23Q,O+_)})})}},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)},handleWindowTouchEnd:function(){var M=this,o=M.tv,S=o._tabPosition,A=o.getTabModel(),i=A._roots,O=M._73o;if(M.moving){var r=o._23o;if(r&&r.insertTab!==r.tab){var q=r.tab,f=i.remove(q),p=i.indexOf(r.insertTab);p>=0&&(r.front||p++,p<=i.size()&&(i.add(q,p),A._38I(q,f,p)))}o._7Q(X),delete M.moving}else if(!M._25o&&O){q=O.tab;var B=M._74o;if(!B||B.tab===q)if(!q.isDisabled()&&Ue(O._75o,M.lp)){var V=function(){var Y=i.indexOf(q);A.remove(q),o.onTabClosed(q,Y)};o.onTabClosing(q,V)&&V()}else q.isDisabled()||o._8o===q||A.sm().ss(q)}M._25o=M._73o=M._74o=S===yb||S===jc?M.x=M.lp=M.tx=X:M.y=M.lp=M.ty=X}}),ot.PropertyView=function(u){var N=this;N._view=Mn(1,N),N._canvas=_i(N._view),vb(N._view,N._79O=_j()),N._rows=new jn,N._28o=new jn,N._26o={},N._26Q={};var l=N._propertyModel=new pf,k=N.ivm;l.mm(k,N),l.md(k,N),l.mh(k,N),N.dm(u?u:new pf),new vt(N)},pt("PropertyView",b,{ms_ac:[Eh,Lj,ak,cs,Tn,"categorizable",Fl,vh,Bj,$p,kp,Gb,lh,Xq,"selectRowIndex",Jm,"background",jb,zs,tj,Gj,wl],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:dm,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:As,_background:E.propertyViewBackground,_expandIcon:E.propertyViewExpandIcon,_collapseIcon:E.propertyViewCollapseIcon,_scrollBarColor:Yj,_scrollBarSize:jh,_autoHideScrollBar:oj,_selectBackground:E.propertyViewSelectBackground,_rowHeight:xs,_rowLineVisible:E.propertyViewRowLineVisible,_rowLineColor:E.propertyViewRowLineColor,_10I:.5,_columnLineVisible:E.propertyViewColumnLineVisible,_columnLineColor:E.propertyViewColumnLineColor,_labelColor:E.propertyViewLabelColor,_labelSelectColor:E.propertyViewLabelSelectColor,_labelFont:E.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(u){0>u&&(u=0),u>1&&(u=1);var p=this,c=p._10I;p._10I=u,p.fp("columnPosition",c,u)},getPropertyName:function(E){return E.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(L,E,x){return x===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(G,q){return q===this._selectRowIndex?this._labelSelectColor:G.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(M){var t=this.getHeight()-this._59I;return t>M&&(M=t),M>0?0:s(M)},isExpanded:function(x){if(!x)return!0;var V=this._26o[x];return V?V.isExpanded:!(this._26Q[x]===!1)},toggle:function(f){var P=this;P.isExpanded(f)?P.collapse(f):P.expand(f)},expandAll:function(){this.validate();for(var f in this._26o)this.expand(f)},expand:function(Y){if(Y&&Y!==Ui){var E=this,T=E._26o[Y];T&&!T.isExpanded&&(T.isExpanded=!0,E.onExpanded(Y),E.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var i in this._26o)this.collapse(i)},collapse:function(P){if(P&&P!==Ui){var y=this,W=y._26o[P];W&&W.isExpanded&&(W.isExpanded=!1,y.onCollapsed(P),y.ivm())}},onCollapsed:function(){},getCategoryName:function(y){if(!this.isCategorizable())return Ui;var n=y.getCategoryName();return n?n:Ui},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(Z){var z=this,V=z._dataModel;V!==Z&&(V&&(V.umd(z.handlePropertyChange,z),z._selectionModel||V.sm().ums(z.handleSelectionChange,z)),z._dataModel=Z,Z.md(z.handlePropertyChange,z),z._selectionModel?z._selectionModel._21I(Z):Z.sm().ms(z.handleSelectionChange,z),z.fp(Zd,V,Z))},isVisible:function(K){return this._visibleFunc?this._visibleFunc(K):!0},onPropertyChanged:function(A){var K=this,M=A.property;jt[M]?K.ivm():K.iv(),M===of&&K._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:gg},handlePropertyChange:function(y){this._27o===y.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var q=this;q._96I||(q.setSelectRowIndex(-1),q._96I=1,q.iv())},redraw:function(){this.iv()},validateModel:function(){var S=this,N=S._rows,f=S._28o,E={},X=new jn,V=S._27o;S.updateCurrentData(),V!==S._27o&&S.endEditing(),N.clear(),f.clear(),S.getRawProperties().each(function(Q){if(S.isVisible(Q)){X.add(Q);var y=S.getCategoryName(Q);E[y]||(f.add(y,y===Ui?0:p),E[y]={isExpanded:S.isExpanded(y),properties:new jn})}}),S._sortFunc&&X.sort(S._sortFunc);for(var t in S._26o)S._26Q[t]=S.isExpanded(t);S._26o=E,f.each(function(P){P!==Ui&&N.add(P);var u=E[P];u.isExpanded&&X.each(function(H){S.getCategoryName(H)===P&&(u.properties.add(H),N.add({property:H,data:S._27o}))},S)})},validateImpl:function(){var $=this;$._76o(),$._96I&&($.validateModel(),delete $._96I);var w=$._canvas,L=$.getWidth(),d=$.getHeight(),B=-$.ty(),i=$._rowHeight,t=$._indent,R=L-t,G=$._rows,j=G.size(),v=$._9I=t+R*$._10I,W=$._59I=j*i;zl(w,L,d),$._29I={x:0,y:B,width:L,height:d},$._31I=x(B/i),$._14I=I((B+d)/i),$._31I<0&&($._31I=0),$._14I>j&&($._14I=j);var Z,C=dk(w),E=$._background;xn(C,0,-B,1),C.beginPath(),C.rect(0,B,L,d),C.clip(),C.clearRect(0,B,L,d),$._93db(C),E&&Ve(C,0,0,t,W,E);for(var T=$._31I;T<$._14I;T++){var M=G.get(T),B=i*T;if(tc(M))E&&Ve(C,t,B,R,i,E),Z=ir($.isExpanded(M)?$._expandIcon:$._collapseIcon),Z&&ch(C,Z,ti,0,B,t,i),C.save(),C.beginPath(),C.rect(t,B,R,i),C.clip(),$.drawCategoryName(C,M,T,t,B,R,i),C.restore();else{var k=M.property,g=M.data,Z=ir(k.getIcon()),Y=$._selectRowIndex===T?$.getSelectBackground():X;if(Z&&ch(C,Z,ti,0,B,t,i),Y&&Ve(C,t,B,R,i,Y),C.save(),C.beginPath(),C.rect(t,B,v-t,i),C.clip(),$.drawPropertyName(C,k,T,t,B,v-t,i),C.restore(),!$.isEditing(g,k)){var P=v+1,O=L-v-1;C.save(),C.beginPath(),C.rect(P,B,O,i),C.clip(),$._87o($.drawPropertyValue(C,k,$.getValue(g,k),T,P,B,O,i,g),T,P,B,O,i),C.restore()}}$._rowLineVisible&&Ve(C,t,B+i-1,R,1,$._rowLineColor)}$._columnLineVisible&&(Ve(C,v,0,1,W,$._columnLineColor),Ve(C,L-1,0,1,W)),$._92db(C),$._93I(),C.restore(),$.ty($.ty())},drawCategoryName:function(M,V,E,u,g,D,v){Oj(M,V,this.getCategoryFont(V),this.getCategoryColor(V),u,g,D,v)},drawPropertyName:function(M,i,U,g,F,J,X){return i.drawPropertyName?(i.drawPropertyName(M,i,U,g,F,J,X,this),void 0):(Oj(M,this.getPropertyName(i),this.getPropertyFont(i,U),this.getPropertyColor(i,U),g,F,J,X),void 0)},drawPropertyValue:function(S,q,z,Q,v,Z,x,T,c){return q.drawPropertyValue?q.drawPropertyValue(S,q,z,Q,v,Z,x,T,c,this):(lt(S,z,q,this.getLabelFont(q,z,Q),this.getLabelColor(q,z,Q),v,Z,x,T,c,this),void 0)},isPropertyEditable:function(Y){return Y.isEditable()&&this.isEditable()},setProperties:function(X){this._propertyModel.clear(),this.addProperties(X)},addProperties:function(z){if(z){var y=this._propertyModel;z.forEach(function(R){if(!(R instanceof st)){var h=Fg(R.className);R=dp(h?h:st,R)}y.add(R)})}},getRowIndexAt:function(Q){var X=this,W=x(X.lp(Q).y/X._rowHeight);return W>=0&&W<X._rows.size()?W:-1},getPropertyAt:function(U){var W=this,J=W.getRowIndexAt(U);return J>=0?W._rows.get(J).property:X},getToolTip:function(M){var y=this,B=y.getPropertyAt(M),P=y._27o;return B&&P?B.getToolTip(P,y._9I<y.lp(M).x,y):X}});var vt=function(l){this.pv=l,this.addListeners()};Wi(vt,b,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(g){this.getView().style.cursor=g},clear:function(){var W=this;W._62O=W.cp=W.ty=W.p=X,W.setCursor(xr)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(R){var u=this,d=u.pv;Bi(R),d.setFocus(R)&&(Dj(R)?(u.cp=Wc(R),u.ty=d.ty(),u.p=d.getColumnPosition(),u.handle_touchmove(R)):d.setSelectRowIndex(d.getRowIndexAt(R)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(f){this.handle_touchend(f)},handle_touchend:function(R){var i=this;if(i.cp&&!i._62O){var L=i.pv,o=L.lp(R),A=o.x,Z=o.y,q=L._indent,F=L.getRowIndexAt(R),M=L._9I;if(F>=0){var K=L._rowHeight,D=K*F,S=L._rows.get(F),U=S.property;if(tc(S))ir(L.isExpanded(S)?L._expandIcon:L._collapseIcon)&&A>=0&&q>=A&&Z>=D&&D+K>=Z?L.toggle(S):re(R)&&L.toggle(S);else if(A>M&&L.isPropertyEditable(U,R)){var I={x:M+1,y:D,width:L.getWidth()-M-1,height:K},h={x:I.x+L.tx(),y:I.y+L.ty(),width:I.width,height:I.height},s=0,V=L._29I;I.y<V.y?s=I.y-V.y:I.y+K>V.y+V.height&&(s=I.y+K-V.y-V.height),s&&(L.ty(L.ty()-s),h.y-=s),L.beginEditing({data:S.data,property:U,value:L.getValue(S.data,U),event:R,rect:I,editorRect:h,view:L})}}L.setSelectRowIndex(F)}i.clear()},handleWindowMouseMove:function(t){this.handleWindowTouchMove(t)},handleWindowTouchMove:function(j){var x=this,m=x.pv,h=x.ty,P=x.cp,F=Wc(j),y=x._62O;if("p"===y)m.setTranslateY(h+F.y-P.y);else if("c"===y){var S=m.getWidth()-m._indent;if(S>16){var J=x.p-(P.x-F.x)/S,s=16/S;s>J&&(J=s),J>1-s&&(J=1-s),m.setColumnPosition(J)}}else"s"===y&&m.setTranslateY(h+(P.y-F.y)*m._59I/m._29I.height)},handle_mousemove:function(Z){this.handle_touchmove(Z)},handle_touchmove:function(Q){if(!Gr&&Dj(Q)){var f=this,P=f.pv,E=a(P.lp(Q).x-P._9I)<=(Iq?8:3);f.cp?f._62O||(E?(f._62O="c",Aj(f,Q)):a(Wc(Q).y-f.cp.y)>=2&&(f._62O=f.isV(Q)?"s":"p",Aj(f,Q))):(E?f.setCursor($n):f.setCursor(xr),f.isV(Q)&&P._43o())}},isV:function(R){var n=this.pv,M=n._29I;return n._41o()&&M.x+M.width-n.lp(R).x<Zp},handle_mousewheel:function(X){this.handleScroll(X,X.wheelDelta/40)},handle_DOMMouseScroll:function(A){2===A.axis&&this.handleScroll(A,-A.detail)},handleScroll:function(h,W){var D=this.pv;Bi(h),D.endEditing(),D.translate(0,W*D.getRowHeight())},handle_keydown:function(L){var H=this.pv,Q=H._rows.size(),d=H._selectRowIndex+(Nk(L)?-1:1);(Nk(L)||Ae(L))&&(0>d&&(d=0),d>=Q&&(d=Q-1),H.setSelectRowIndex(d))}}),ot.ListView=function(S){this._5o(S),new wt(this)},pt("ListView",b,{ms_ac:[Eh,Lj,ak,jb,Fl,zs,tj,vh,Bj,Gb,lh,Xq,cb,Jm],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:As,_rowHeight:xs,_rowLineVisible:E.listViewRowLineVisible,_rowLineColor:E.listViewRowLineColor,_scrollBarColor:Yj,_scrollBarSize:jh,_autoMakeVisible:Hc,_autoHideScrollBar:oj,_selectBackground:E.listViewSelectBackground,_labelColor:E.listViewLabelColor,_labelSelectColor:E.listViewLabelSelectColor,_labelFont:E.listViewLabelFont,isCheckMode:function(){return this._checkMode
},setCheckMode:function(p){var $=this,O=$._checkMode;$._checkMode=p,$.fp(Pd,O,p)},drawRow:function(h,L,p,d,R,j,x){var l=this,v=0,V=l._indent,n=l.getIconWidth(L);l.drawRowBackground(h,L,p,d,R,j,x),l._checkMode&&(dj(h,ir(l.getCheckIcon(L)),v+V/2,R+x/2,L,l),v+=V),l.drawIcon(h,L,v,R,n,x),l.drawLabel(h,L,v+n,R,x)}});var wt=function(E){this.list=E,this.addListeners()};Wi(wt,b,{ms_listener:1,getView:function(){return this.list._view},clear:function(T){var n=this,Y=n.list;T&&"d"===n._62O&&!n.dragCancel&&Y.handleDragAndDrop(T,"end"),Y.draggingData&&(Y.draggingData=null,Y.redraw()),n.dragCancel=n._62O=n._isV=n._isH=n.cp=n.tx=n.ty=X},handle_mousedown:function(d){this.handle_touchstart(d)},handle_touchstart:function(N){var $=this,M=$.list;if(Bi(N),M.setFocus(N)){var T=M.getDataAt(N);$.cp=Wc(N),$.tx=M.tx(),$.ty=M.ty(),Dj(N)?T&&M.handleDragAndDrop&&!$.isV(N)&&!$.isH(N)&&(M.draggingData=T,M.redraw(),M.handleDragAndDrop(N,"prepare")):(T?$._33o(N,T):this._cancelDataDoubleSelect(),$.clear(N))}},handleWindowMouseUp:function(L){this.clear(L)},handleWindowTouchEnd:function(q){this.clear(q)},handle_mouseup:function(V){this.handle_touchend(V)},handle_touchend:function($){var Q=this,T=Q.list;if(!Q._isV&&!Q._isH&&Q.cp&&!Q._62O){var i=T.getDataAt($);i?(T.isCheckMode()?Q._34o($,i):Q._33o($,i),re($)?T.onDataDoubleClicked(i,$):T.onDataClicked(i,$)):(Q._cancelDataDoubleSelect(),T.handleBackgroundClick($))}Q.clear($)},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowTouchMove:function(M){var c=this,h=c.list,_=c._62O,o=c.tx,x=c.ty,E=c.cp,s=Wc(M),f=h._29I;"p"===_?h.setTranslate(o+s.x-E.x,x+s.y-E.y):"v"===_?h.ty(x+(E.y-s.y)*h._59I/f.height):"h"===_?h.tx(o+(E.x-s.x)*h._91I/f.width):"d"===_&&(c.dragCancel||h.handleDragAndDrop(M,"between"))},handle_mousemove:function(_){this.handle_touchmove(_)},handle_touchmove:function(S){if(!Gr&&Dj(S)){var P=this,F=P.list;if(P._isV=P.isV(S),P._isH=P.isH(S),P.cp){if(!P._62O){if(Fb(Wc(S),P.cp)<2)return;P._isV?P._62O="v":P._isH?P._62O="h":F.draggingData&&!this.dragCancel?(P._62O="d",F.handleDragAndDrop(S,"begin")):P._62O="p",P._62O&&"d"!==P._62O&&F.draggingData&&(F.draggingData=null,F.redraw()),Aj(P,S)}}else P._isV&&F._43o(),P._isH&&F._42o()}},isV:function(B){var P=this.list,U=P._29I;return P._41o()&&U.x+U.width-P.lp(B).x<Zp},isH:function(w){var Z=this.list,g=Z._29I;return Z._40o()&&g.y+g.height-Z.lp(w).y<Zp},handle_mousewheel:function(h){this.handleScroll(h,h.wheelDelta/40,h.wheelDelta!==h.wheelDeltaX)},handle_DOMMouseScroll:function(p){this.handleScroll(p,-p.detail,1)},handleScroll:function(G,c,_){var d=this.list;Bi(G),d.endEditing&&d.endEditing(),_&&d._41o()?d.translate(0,c*d.getRowHeight()):d._40o()&&d.translate(10*c,0)},handle_keydown:function(D){if(!E.isInput(D.target)){var s,i=this.list,u=i.sm(),I=i._rows,v=I.size();if(qb(D))i.selectAll();else if(Am(D))i.handleDelete&&i.handleDelete(D);else if(ib(D))"d"!==this._62O||this.dragCancel||(i.handleDragAndDrop(D,"cancel"),this.dragCancel=!0);else if(tn(D))i.isCheckMode()&&(s=i.getFocusData(),s&&i.checkData(s));else if(Nk(D)||Ae(D)){var S=i.isCheckMode();if(s=S?i.getFocusData():u.ld()){var o=i.getRowIndex(s);o>=0&&(Nk(D)?0!==o&&(s=I.get(o-1),S?i.setFocusData(s):u.ss(s)):o!==v-1&&(s=I.get(o+1),S?i.setFocusData(s):u.ss(s)))}else v>0&&(s=I.get(0),S?i.setFocusData(s):u.ss(s))}}},_34o:function(E,W){var K=this.list,I=K.lp(E).x;return I>=0&&I<=K._indent?(K.checkData(W),void 0):(K.setFocusData(W),void 0)},_33o:function(Z,F){var d=this.list,V=d.sm(),x=V.ld();if(!d.canHandleSelectMode(Z,F))return this._cancelDataDoubleSelect(),void 0;if(Yd(Z))d.isSelected(F)?V.rs(F):V.as(F);else if(am(Z))if(x)for(var L=d.getRowIndex(x),K=d.getRowIndex(F);L!==K;)L+=K>L?1:-1,V.as(d._rows.get(L));else V.ss(F);else Dj(Z)?(V.contains(F)?d.handleDataDoubleSelect&&(this._handleDataDoubleSelect(Z,F),re(Z)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),V.ss(F)):V.contains(F)||V.ss(F)},_handleDataDoubleSelect:function(u,i){this._cancelDataDoubleSelect(),this._doubleSelectTimer=td(function(){this.list.handleDataDoubleSelect(u,i),this._doubleSelectTimer=p}.bind(this),E.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(zr(this._doubleSelectTimer),this._doubleSelectTimer=p)}}),ot.TreeView=function(o){var s=this;s._35o(),s._5o(o),new xt(s)},pt("TreeView",b,{ms_ac:[Eh,Lj,ak,"rootVisible",Pd,"rootData",vh,Bj,Gb,lh,Xq,Fl,jb,zs,tj,$p,kp,cb,Jm,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:X,_indent:As,_rowHeight:xs,_rowLineVisible:E.treeViewRowLineVisible,_rowLineColor:E.treeViewRowLineColor,_scrollBarColor:Yj,_scrollBarSize:jh,_autoHideScrollBar:oj,_expandIcon:E.treeViewExpandIcon,_collapseIcon:E.treeViewCollapseIcon,_autoMakeVisible:Hc,_selectBackground:E.treeViewSelectBackground,_labelColor:E.treeViewLabelColor,_labelSelectColor:E.treeViewLabelSelectColor,_labelFont:E.treeViewLabelFont,_doubleClickToToggle:E.treeViewDoubleClickToToggle,drawRow:function(h,M,A,N,P,q,S){var Y=this;Y.drawRowBackground(h,M,A,N,P,q,S),Y.drawTree(h,M,A,0,P,q,S)},isOnToggleIcon:function(e){var f=this.getDataAt(e);if(f){var s=this.getIndent(),o=this.lp(e).x;if(ir(this.getToggleIcon(f))){var v=s*this.getLevel(f);if(o>=v&&v+s>=o)return!0}}return!1}});var xt=function(j){jl(xt,this,[j])};Wi(xt,wt,{toggle:function(j,n,K,z){var D=this.list,R=D.lp(j).x;if(ir(D.getToggleIcon(n))){var A=K*z;if(R>=A&&A+K>=R)return D.toggle(n),!0}return D.isDoubleClickToToggle()&&re(j)?(D.toggle(n),!0):!1},_34o:function(d,X){var c=this.list,u=c.lp(d).x,H=c._levelMap[X._id],P=c._indent,f=P*(H+1);return u>=f&&f+P>=u?(c.checkData(X),void 0):(this.toggle(d,X,P,H)||c.setFocusData(X),void 0)},_33o:function(E,l){var t=this,N=t.list;if(!t.toggle(E,l,N._indent,N.getLevel(l)))if(am(E)){var b=N.sm();if(b.size()>0){for(var D=N._rows,I=null,j=0,g=D.size();g>j;j++)if(N.isSelected(D.get(j))){I=j;break}for(var B=null,j=D.size()-1;j>=0;j--)if(N.isSelected(D.get(j))){B=j;break}var R,O,o=N.getRowIndex(l);for(I>o?(R=o-1,O=I):o>B?(R=B,O=o):(R=I,O=B);R!==O;)R++,b.as(N._rows.get(R))}else b.ss(l)}else xt.superClass._33o.call(t,E,l)},handle_keydown:function(O){if(Rg(O)||Ye(O)){var o=this.list,Z=o._rows,A=o.isCheckMode(),l=o.sm(),T=A?o.getFocusData():l.ld();T?T.hasChildren()&&(Rg(O)?o.collapse(T):o.expand(T)):Z.size()>0&&(T=Z.get(0),A?o.setFocusData(T):l.ss(T))}else xt.superClass.handle_keydown.call(this,O)}});var yt=ot.TableView=function(P){this._98I(),this._5o(P),new zt(this)};pt("TableView",b,{ms_ac:[Eh,Lj,ak,"sortMode",cs,Tn,jb,zs,tj,Gj,wl,"sortColumn",vh,Bj,Gb,lh,Xq,cb,Jm],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Eg,_editable:!0,_batchEditable:!1,_rowHeight:xs,_rowLineVisible:E.tableViewRowLineVisible,_rowLineColor:E.tableViewRowLineColor,_columnLineVisible:E.tableViewColumnLineVisible,_columnLineColor:E.tableViewColumnLineColor,_scrollBarColor:Yj,_scrollBarSize:jh,_autoHideScrollBar:oj,_autoMakeVisible:Hc,_selectBackground:E.tableViewSelectBackground,_labelColor:E.tableViewLabelColor,_labelSelectColor:E.tableViewLabelSelectColor,_labelFont:E.tableViewLabelFont,getCheckColumn:function(){var r=this;if(!r._31o){var d=r._31o=new rt;d.setEditable(!0),d.setWidth(40),d.getValue=r.getCheckColumValue,d.drawCell=r.drawCheckColumnCell}return r._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(g){var u=this,Q=u._39o,p=u.getCheckColumn();g!==u.isCheckMode()&&(g?Q.add(p,0):Q.remove(p),u.fp(Pd,!g,g))},getCheckColumValue:function(b,U,K){return K.isSelected(b)},drawCheckColumnCell:function(Y,u,q,s,y,M,t,J,N){dj(Y,N.getCheckIcon(u),y+t/2,M+J/2,u,N)}});var zt=function(O){jl(zt,this,[O])};Wi(zt,wt,{_34o:function(E,g){var Z=this.list,i=Z._31o;if(Z.isCellEditable(g,i,E)){var u=Z._3Q(i),H=Z.lp(E).x;if(u&&H>=u.startX&&H<u.startX+i.getWidth())return Z.checkData(g),void 0}Z._37O(g,E),Z.setFocusData(g)},_33o:function(P,r){this.list._37O(r,P),zt.superClass._33o.apply(this,arguments)}});var At=ot.TreeTableView=function(p){var a=this,e=a._4o=new rt;a._35o(),a._98I(),a._5o(p),e.setDisplayName("Name"),e.setEditable(!0),e.setWidth(180),e.drawCell=Bt,e.getValue=Ct,a._39o.add(e),new Dt(a)},Bt=function(f,o,x,G,P,p,O,X,k){k.drawTree(f,o,x,P,p,O,X)},Ct=function(w,x,J){return J.getLabel(w)};pt("TreeTableView",b,{ms_ac:[Eh,Lj,ak,"sortMode",cs,Tn,Fl,Pd,"rootData","rootVisible",vh,Bj,"sortColumn",$p,kp,Gb,lh,Xq,cb,tj,jb,zs,Gj,wl,Jm,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Eg,_checkMode:X,_editable:!0,_batchEditable:!1,_indent:As,_rowHeight:xs,_rowLineVisible:E.treeTableViewRowLineVisible,_rowLineColor:E.treeTableViewRowLineColor,_columnLineVisible:E.treeTableViewColumnLineVisible,_columnLineColor:E.treeTableViewColumnLineColor,_expandIcon:E.treeTableViewExpandIcon,_collapseIcon:E.treeTableViewCollapseIcon,_scrollBarColor:Yj,_scrollBarSize:jh,_autoHideScrollBar:oj,_autoMakeVisible:Hc,_selectBackground:E.treeTableViewSelectBackground,_labelColor:E.treeTableViewLabelColor,_labelSelectColor:E.treeTableViewLabelSelectColor,_labelFont:E.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Dt=function(q){jl(Dt,this,[q])};Wi(Dt,wt,{_34o:function(u,_){var M=this.list,b=M._4o,Z=M._3Q(b),D=M.lp(u).x;if(Z){var K=M._indent,Y=Z.startX+K*M.getLevel(_);if(ir(M.getToggleIcon(_))&&D>=Y&&Y+K>=D)return M.toggle(_),void 0;if(M.isCellEditable(_,b)&&(Y+=K,D>=Y&&Y+K>=D))return M.checkData(_),void 0}M._37O(_,u),M.setFocusData(_)},_33o:function(A,d){var n=this.list,P=n.lp(A).x;if(ir(n.getToggleIcon(d))){var b=n._3Q(n._4o);if(b){var j=n._indent,N=b.startX+j*n.getLevel(d);if(P>=N&&N+j>=P)return n.toggle(d),void 0}}n._37O(d,A),Dt.superClass._33o.apply(this,arguments)}});var Et=ot.TableHeader=function(g){var u=this,_=u._view=Mn(1,u),C=u._39o=g.getColumnModel(),n=u.iv;u.tv=u._tableView=g,u._60I=new jn,u._canvas=_i(_),_.style.background=E.tableHeaderBackground||"",_.style.height=wr+Dp,C.mm(n,u),C.md(n,u),C.mh(n,u),g.mp(function(J){ft[J.property]&&u.iv()},u),new Ft(u),u.iv()};pt("TableHeader",b,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Eh,ak,Fl,"moveBackground","insertColor",Gj,wl,"resizable","movable"],_checkIcon:wo,_movable:!0,_resizable:!0,_labelColor:E.tableHeaderLabelColor,_labelFont:E.tableHeaderLabelFont,_columnLineColor:E.tableHeaderColumnLineColor,_columnLineVisible:E.tableHeaderColumnLineVisible,_sortDescIcon:E.tableHeaderSortDescIcon,_sortAscIcon:E.tableHeaderSortAscIcon,_moveBackground:E.tableHeaderMoveBackground,_insertColor:E.tableHeaderInsertColor,_indent:As,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(u){return u.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(N){return N.getColor()||this._labelColor},getLabelAlign:function(Y){return Y._align},onPropertyChanged:function(){this.iv()},_5Q:function(a){this._61I=a,this.iv()},getLogicalPoint:function(z){return Bm(z,this._canvas,this.tv.tx())},validateImpl:function(){var E=this,I=E._canvas,C=E.getWidth(),e=E.getHeight(),l=E.tv,D=E._60I,o=E._61I,h=-l.tx(),b=0;(C!==I.clientWidth||e!==I.clientHeight)&&zl(I,C,e),D.clear(),E._39o._roots.each(function(T){if(T.isVisible()){var N=b+T.getWidth();h+C>=b&&N>=h&&D.add({column:T,startX:b}),b=N}});var _=dk(I);if(xn(_,-h,0,1),_.beginPath(),_.rect(h,0,C,e),_.clip(),_.clearRect(h,0,C,e),D.each(function(m){var O=m.column,f=m.startX,$=O.getWidth();$>0&&(_.save(),_.beginPath(),_.rect(f,0,$,e),_.clip(),o&&o.column===O||E.drawColumn(_,O,f,0,$,e),E._columnLineVisible&&Ve(_,f+$-1,0,1,e,E._columnLineColor),_.restore())}),o){var t=o.column,b=o.startX,d=o.position,y=t.getWidth();_.save(),_.beginPath(),_.rect(b,0,y,e),_.clip(),_.fillStyle=E._moveBackground,_.fill(),E.drawColumn(_,t,b,0,y,e),_.restore(),Cp(_,E._insertColor,d,0,e)}_.restore()},_6Q:function(z){var I=this.tv;return I._31o===z&&I.sm().getSelectionMode()===No},drawColumn:function(H,m,Y,g,i,V){var n=this,E=n.tv,Z=ir(m.getIcon()),y=n.getLabelAlign(m);if(n._6Q(m)){var t=ir(n._checkIcon);dj(H,t,Y+i/2,g+V/2,m,n)}else{var o=n.getLabel(m),F=n.getLabelFont(m),L=n.getLabelColor(m),W=Ll(F,o).width,j=Z?n._indent:0;y===cq?(Z&&ch(H,Z,ti,Y,g,j,V),Oj(H,o,F,L,Y+j,g,i,V,cq)):y===Jo?(Z&&ch(H,Z,ti,Y+i-W-j,g,j,V),Oj(H,o,F,L,Y,g,i,V,Jo)):(Z&&ch(H,Z,ti,Y+(i-W-j)/2,g,j,V),Oj(H,o,F,L,Y+(i-W+j)/2,g,0,V,cq))}if(m.isSortable()&&E.getSortColumn()===m&&(Z=ir(m.getSortOrder()===ao?n._sortAscIcon:n._sortDescIcon))){var A=rc(Z,m)/2+2;dj(H,Z,y===Jo?Y+A:Y+i-A,g+V/2,m,E)}}});var Ft=function(y){var L=this;L.th=y,L.tv=y._tableView,L.addListeners()};Wi(Ft,b,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(A){this.getView().style.cursor=A},handle_mousemove:function(c){if(!Gr){var Y=this;delete Y._29o,Y.setCursor(xr);for(var N=Y.th,F=N._60I,t=N.lp(c).x,V=F.size()-1;V>=0;V--){var e=F.get(V),J=e.column,r=e.startX+J.getWidth();if(N.isResizable()&&a(r-t)<=(Iq?10:3))return Y._29o=e,Y.setCursor($n),void 0;t>e.startX&&r>t&&(Y._29o=e),(J.isClickable()||J.isSortable()||N.isMovable()||Y.tv.getCheckColumn&&J===Y.tv.getCheckColumn())&&t>e.startX&&r>t&&Y.setCursor(be)}}},handle_mousedown:function(x){this.handle_touchstart(x)},handle_touchstart:function(c){var l=this;Bi(c),l.tv.endEditing(),l.handle_mousemove(c),l._29o&&(l.x=Wc(c).x,l.lx=l.th.lp(c).x,l.w=l._29o.column.getWidth(),Aj(l,c))},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(w){var z=this,q=z.th,A=z.getView().style.cursor,R=z._29o,L=Wc(w).x-z.x;if(z.resizing||z.moving||(A===$n?z.resizing=1:q.isMovable()&&A===be&&a(L)>2&&(z.moving=1)),z.resizing)R.column.setWidth(z.w+L);else if(z.moving){var x=z.lx+L;q._60I.each(function(r){var g=r.startX,$=g+r.column.getWidth();if(x>=g&&$>=x){var c={column:R.column,startX:R.startX+L,front:$-x>x-g,insertColumn:r.column};c.position=c.front?g:$,q._5Q(c)}})}},_16Q:function(v,l){var r=this,h=r.tv,G=r.th,b=G._checkIcon;if(G._6Q(v)){var U=ir(b),W=r.lx,A=v.getWidth(),E=rc(U,v);if(W>=l+A/2-E&&l+A/2+E>=W){G.setCheckIcon(b===ws?wo:ws);var o=h.sm(),k=h._rows;return b===ws?o.rs(k):o.ss(k),h.onCheckColumnClicked(v),!0}}return!1},handleWindowMouseUp:function(e){this.handleWindowTouchEnd(e)},handleWindowTouchEnd:function(m){var O=this,d=O.tv,M=O.th,$=O._29o;if(O.moving){var p=M._61I;if(p&&p.insertColumn!==p.column){var g=p.column,C=d.getColumnModel()._roots,h=C.remove(g),A=C.indexOf(p.insertColumn);A>=0&&(p.front||A++,A<=C.size()&&(C.add(g,A),d.getColumnModel()._38I(g,h,A)))}M._5Q(X),delete O.moving}else if(!O.resizing&&$){g=$.column;var H=M.lp(m).x,U=$.startX,G=!0;if(M.onColumnClicked){var c=M.onColumnClicked(g,m,U);c===!1&&(G=!1)}if(G&&H>=U&&H<=U+g.getWidth()&&!O._16Q(g,U)){if(g.isSortable()){var y=d.getSortMode(),t=g.getSortOrder();y===Eg?d.getSortColumn()===g?(t===oc&&d.setSortColumn(X),g.setSortOrder(t===ao?oc:ao)):d.setSortColumn(g):"bistate"===y&&(d.getSortColumn()===g?g.setSortOrder(t===ao?oc:ao):d.setSortColumn(g))}d.onColumnClicked(g,m,U)}}O._29o=O.resizing=O.x=O.lx=O.w=X}}),ot.TablePane=function(M){this.init(new yt(M))},pt("TablePane",b,{ms_v:1,_44o:1}),ot.TreeTablePane=function(P){this.init(new At(P))},pt("TreeTablePane",b,{ms_v:1,_44o:1}),ot.Toolbar=function(w){var Q=this,n=Q._view=Mn(1,Q),h=n.style;h.background=E.toolbarBackground||"",h.height=hh+Dp,Q._canvas=_i(n),Q._30o=new jn,Q._90I=new jn,Q.setItems(w||[]),n.handleGroupSelectedChanged=function(e){if(e.isSelected()){var j=e.getGroupId();null!=j&&Q._items.forEach(function(Y){var W=Y.element;W&&W!==e&&W.setSelected&&W.getGroupId&&W.getGroupId()===j&&W.setSelected(!1)})}},new Gt(Q)},pt("Toolbar",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[sf,Eh,ak,Lj,Jm,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:E.toolbarLabelColor,_labelSelectColor:E.toolbarLabelSelectColor,_labelFont:E.toolbarLabelFont,_selectBackground:E.toolbarSelectBackground,_itemGap:E.toolbarItemGap,_separatorColor:E.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(w){var h=this.getItemInfoAt(w);return h?h.item.toolTip:X},getLabelColor:function(p){return p&&p.selected&&p.type!==ws&&p.type!==Oe?this._labelSelectColor:this._labelColor},onPropertyChanged:function(W){this.iv(),W.property===sf&&this._items.forEach(function($){Xg($)})},redraw:function(){this.iv()},addItem:function(K,D){var N=this._items;D==X?N.push(K):N.splice(D,0,K),this.fp(sf,X,N)},removeItem:function(K){if(K)for(var I=this._items,o=0;o<I.length;o++)K===I[o]&&(I.splice(o,1),this.fp(sf,X,I))},removeItemById:function(i){if(i!=X)for(var T=this._items,m=0;m<T.length;m++)if(i===T[m].id){var w=T.splice(m,1)[0];return this.fp(sf,X,T),w}},getItemById:function(s){if(s!=X)for(var f=this._items,Z=0;Z<f.length;Z++){var e=f[Z];if(s===e.id)return e}},setItemVisible:function(X,p){var v=this.getItemById(X);v&&(v.visible=p)},getItemInfos:function(){return this._30o},getItemInfoAt:function(b){var K=this,i=0,f=K._30o,W=K.lp(b),h=W.x,o=W.y;if(o>=0&&o<=K.getHeight())for(;i<f.size();i++){var L=f.get(i);if(L.startX<=h&&h<=L.endX)return L}return X},drawItem:function(N,M,q,X,g){if(M.visible===!1)return 0;if(Uq(M.visible)&&!M.visible())return 0;var G=this,C=M.disabled;C&&(N.globalAlpha=um);var r=G.drawItemImpl(N,M,q,X,g),m=G._itemGap;return C&&(N.globalAlpha=1),this._currentItem!==M||"separator"===M||M.separator===!0||M.unfocusable||oo(N,G._separatorColor,q-m/2,0,r+m,X),r},drawItemImpl:function(b,g,v,G,k){var y=this,W=y._view,p=y._itemGap,N=G/2,z=g.type,K=g.element,w=g.label;tc(K)&&(w=K,K=X);var P,D=y.getLabelFont(g),M=y.getLabelColor(g),j=g.selected,a=ir(g.icon),_=rc(a,g),I=0,L=_+(w?Ll(D,w).width:0);if("separator"===g||g.separator===!0)return Cp(b,y._separatorColor,v,G/4,N),1;if(K){a&&dj(b,a,v+_/2,N,g,y),Oj(b,w,D,M,v+_,0,0,G);var e=om(K);k||y._90I.add(e),e.parentNode!==W&&vb(W,e),K.iv&&K.iv(),K.validate&&K.validate();var T=e.getBoundingClientRect(),U=T.width,f=e.style;return Qc(e),f.left=y.tx()+v+L+Dp,f.top=(G-T.height)/2+Dp,L+U}return z===Oe?P=ir(j?jk:_f):z===ws&&(P=ir(j?ws:wo)),P?(I=rc(P,g),dj(b,P,v+I/2,N,g,y),v+=I,L+=I):j&&Ve(b,v-p/2,0,L+p,G,y.getSelectBackground(g)),a&&dj(b,a,v+_/2,N,g,y),Oj(b,w,D,M,v+_,0,0,G),L},validateImpl:function(){var L=this,D=L._canvas,w=L.getWidth(),U=L.getHeight(),B=L._30o,c=L._items;zl(D,w,U);var E=dk(D),v=L._itemGap,S=v/2;xn(E,L.tx(),0,1),E.clearRect(0,0,w,U);var f=L._90I;L._90I=new jn,B.clear(),c.forEach(function(X){var R=L.drawItem(E,X,S,U);B.add({item:X,startX:S,endX:S+R,width:R}),R&&(S+=R+v)}),f.each(function(X){L._90I.contains(X)||cp(X)});var Z=L._64I;L._64I=P(0,S-v/2),E.restore(),L._stickToRight?(L._65O=0,E=dk(D),S=w-L._64I+v/2,xn(E,0,0,1),E.clearRect(0,0,w,U),B.clear(),c.forEach(function(o){var n=L.drawItem(E,o,S,U,!0);B.add({item:o,startX:S,endX:S+n,width:n}),n&&(S+=n+v)}),E.restore()):L.tx(L.tx()),Z!==L._64I&&L.onSumWidthChanged(Z,L._64I)},onSumWidthChanged:function(){},handleClick:function(p,F){var H=this,Q=p.type,e=p.action,s=p.groupId,c=p.selected;p.disabled||(s!=X?c||(p.selected=!0,this._items.forEach(function(G){G.groupId===s&&p!==G&&(G.selected=!1)}),e&&p.action(p,H,F)):Q===ws||"toggle"===Q?(p.selected=!c,e&&p.action(p,H,F)):e&&p.action(p,H,F)),On(),H.iv()}});var Gt=function($){this.tb=$,this.addListeners()};Wi(Gt,b,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(f){this.handleScroll(f,10*(f.wheelDelta/40))},handle_DOMMouseScroll:function(o){this.handleScroll(o,10*-o.detail)},handleScroll:function(K,g){Bi(K);var O=this.tb;O.isScrollable()&&!O._stickToRight&&(O.tx(O.tx()+g),ui())},handle_mousemove:function(X){var t=this;Gr||t.setItem(X)},handle_mouseout:function(W){var z=this;W.target===z.getView()?z.tb.setCurrentItem(X):z.handle_mousemove(W)},handle_mousedown:function(V){this.handle_mousemove(V),this.handle_touchstart(V)},handle_touchstart:function(M){var u=this,t=u.tb,H=M.target;Dj(M)&&(H===u.getView()||H===t._canvas)&&(Bi(M),t.setFocus(M)&&(this.setItem(M,!0),(t.isScrollable()||u.info&&!u.info.item.disabled)&&(u.x=Wc(M).x,u.tx=t.tx(),Aj(u,M))))},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(o){var W=this,U=W.tb;if(!U._stickToRight){var h=Wc(o).x-W.x;!W._25o&&a(h)>2&&U.isScrollable()&&(W._25o=1),W._25o&&U.tx(W.tx+h)}},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(n){var T=this,q=T.tb,Y=T.info,o=T.tb.getItemInfoAt(n);if(!T._25o&&Y){var $=Y.item;o&&o.item===$&&q.handleClick($,n)}T._25o=T.x=T.tx=X,T.setItem()},setItem:function(Q,h){var C=this,e=C.tb,j=C.info=Q?e.getItemInfoAt(Q):X,f=j?j.item:X;e.setCurrentItem(f),h&&f&&Uq(f.onDown)&&f.onDown(Q)}}),ot.BorderPane=function(){this._view=Mn(1,this),this.iv()},pt("BorderPane",b,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(l,t){this._12o("leftView",l),t!=X&&this.setLeftWidth(t)},getRightView:function(){return this._rightView},setRightView:function(B,h){this._12o("rightView",B),h!=X&&this.setRightWidth(h)},getTopView:function(){return this._topView},setTopView:function(D,c){this._12o("topView",D),c!=X&&this.setTopHeight(c)},getBottomView:function(){return this._bottomView},setBottomView:function(p,D){this._12o("bottomView",p),D!=X&&this.setBottomHeight(D)},getCenterView:function(){return this._centerView},setCenterView:function(M){this._12o("centerView",M)},_12o:function(v,M){var w=this,n="_"+v,J=w._view,q=w[n];q!==M&&(q&&(q.getView?cp(q.getView()):cp(q)),w[n]=M,M&&(M.getView?vb(J,M.getView(),1):vb(J,M,1)),w.fp(v,q,M))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var z=this,d=z._topView,w=z._bottomView,F=z._leftView,H=z._rightView,k=z._centerView,E=z.getWidth(),B=z.getHeight(),Q=0,K=0,W=E,b=B,v=0,n=0,M=0,V=0;d&&(v=z._topHeight==X?gd(d):z._topHeight,K=v),w&&(n=z._bottomHeight==X?gd(w):z._bottomHeight,b=B-n),F&&(M=z._leftWidth==X?Qe(F):z._leftWidth,Q=M),H&&(V=z._rightWidth==X?Qe(H):z._rightWidth,W=E-V);var J=P(0,W-Q),Z=P(0,b-K);d&&zd(d,0,0,E,v),w&&zd(w,0,b,E,n),F&&zd(F,0,K,M,Z),H&&zd(H,W,K,V,Z),k&&zd(k,Q,K,J,Z)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);