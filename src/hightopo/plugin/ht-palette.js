!function(m,W,k){"use strict";var O="px",g="0",r="innerHTML",T="className",$=ht.Default,H=ht.Color,y=ht.Node,q="position",X="top",j="left",s=$.animate,n=$.getInternal(),h="width",g="0",U="none",o="max-height",F="font",D="background",f="border-box",t="user-select",G="box-sizing",C="overflow",w=$.isTouchable,n=$.getInternal(),P=H.titleIconBackground,z=$.scrollBarInteractiveSize,B=/msie 9/.test(m.navigator?m.navigator.userAgent.toLowerCase():""),K=null,R=function(){return document},i=function(p){return R().createElement(p)},Q=function(){return i("div")},p=function(){var t=Q(),p=t.style;return p.msTouchAction=U,p.cursor="default",w&&p.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",K),p.position="absolute",p.left=g,p.top=g,t},v=function(){return i("canvas")},l=function(){return document.body},J=function(X,m,z){X.style.setProperty(m,z,K)},x=function(H,O){H.style.removeProperty(O)},d=function(Y,m,u){$.def(ht.widget[Y],m,u)},b=function(y,q){y.appendChild(q)},S=function(I,n){I.removeChild(n)},_=n.addEventListener;n.removeEventListener,n.addMethod($,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:P,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:P}]},paletteTitleLabelColor:$.labelSelectColor,paletteTitleLabelFont:$.labelFont,paletteContentLabelFont:$.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:$.widgetTitleHeight,paletteTitleBackground:H.titleBackground,paletteTitleHoverBackground:H.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:k,paletteItemHoverBorderColor:H.highlight,paletteItemSelectBackground:H.highlight},!0);var c=".palette-item:hover{border: 1px solid "+$.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+$.paletteTitleHoverBackground+" !important}",E=document.createElement("style");w||(E.styleSheet?E.styleSheet.cssText=c:E.appendChild(R().createTextNode(c))),R().getElementsByTagName("head")[0].appendChild(E);var V=function(U){var y=this;y.$22h=U,y.addListeners()};$.def(V,W,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var N=this;N.$36h&&l().removeChild(N.$36h),N.$23h=N.$24h=N.$25h=N.$35h=N.$36h=K},handle_touchstart:function(Y){for(var p,k=this,g=k.$22h,d=Y.target,l=g.sm(),O=g.dm(),w="palette-header",z="palette-header-tool",c="palette-item",V=!1,P=!1,Z=!1;d&&(d[T]||"").indexOf(w)<0&&(d[T]||"").indexOf(c)<0;)d=d.parentNode;if(d&&d[T].indexOf(z)>=0?V=!0:d&&d[T].indexOf(w)>=0?Z=!0:d&&d[T].indexOf(c)>=0&&(P=!0),$.isLeftButton(Y))if(k.$27h(Y))k.$24h=$.getClientPoint(Y),k.$25h=g.ty();else if(V){$.preventDefault(Y),p=d.parentNode.$11h;var e=O.getDataById(p),K=e.s("tools")[d.toolIndex];K.action&&K.action.call(g)}else if(Z){$.preventDefault(Y),p=d.$11h;var e=O.getDataById(p);e.isExpanded()?e.setExpanded(!1):e.setExpanded(!0)}else if(P){p=d.$11h;var D=O.getDataById(p);l.ss(D),g.handleDragAndDrop&&($.preventDefault(Y),D.s("draggable")&&(g.handleDragAndDrop(Y,"prepare"),k.$35h=0)),D.s("draggable")||($.preventDefault(Y),k.$24h=$.getClientPoint(Y),k.$25h=g.ty())}else $.preventDefault(Y),k.$24h=$.getClientPoint(Y),k.$25h=g.ty();else k.$26h(Y)},handle_mousedown:function(A){this.handle_touchstart(A)},handle_mousewheel:function(K){this.handleScroll(K,K.wheelDelta/40,K.wheelDelta!==K.wheelDeltaX)},handle_DOMMouseScroll:function(o){this.handleScroll(o,-o.detail,1)},handleScroll:function(A,i,C){var p=this.$22h;$.preventDefault(A),C&&p._41o()&&p.ty(p.ty()+20*i)},handle_mouseup:function(m){this.handle_touchend(m)},handle_touchend:function(i){var M=this;M.$37h(i),M.$26h(i)},handleWindowMouseUp:function(C){this.handleWindowTouchEnd(C)},handleWindowTouchEnd:function(v){var d=this;d.$37h(v),d.$26h(v)},$37h:function(P){var Q=this,z=Q.$22h;2===Q.$35h&&(Q.$35h=3,z.handleDragAndDrop(P,"end"))},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(T){var M=this,H=M.$22h,i=M.$23h,r=M.$24h,C=M.$25h,R=$.getClientPoint(T),j=H._29I,I=M.$36h;if(1===M.$35h||2===M.$35h){if(M.$35h=2,H.handleDragAndDrop(T,"between"),w){var F=T.touches[0];T=F?F:T.changedTouches[0]}I.style.left=T.pageX-parseInt(I.width)/2+O,I.style.top=T.pageY-parseInt(I.height)/2+O}else"p"===i?H.ty(C+R.y-r.y):"v"===i&&H.ty(C+(r.y-R.y)/j.height*H._59I)},handle_mousemove:function(o){this.handle_touchmove(o)},handle_touchmove:function(Y){if(!$.isDragging()&&$.isLeftButton(Y)){var m=this,n=m.$22h,f=m.$27h(Y);if(m.$24h){if(!m.$23h){if($.getDistance($.getClientPoint(Y),m.$24h)<2)return;m.$23h=f?"v":"p",$.startDragging(m)}}else if(f)n._43o();else if(0===m.$35h){if(m.$35h=1,n.handleDragAndDrop(Y,"begin"),w){var N=Y.touches[0];Y=N?N:Y.changedTouches[0]}var U=m.$36h=new Image,s=n.$10h[n.sm().ld().getId()].querySelector(".image-box"),G=parseInt(s.style.width),J=parseInt(s.style.height);U.draggable=!1,U.src=s.toDataURL(),U.width=G,U.height=J,U.style.position="absolute",U.style.left=Y.pageX-G/2+O,U.style.top=Y.pageY-J/2+O,l().appendChild(U),$.startDragging(m)}}},$27h:function(U){var _=this.$22h,J=_.getView(),P=J.getBoundingClientRect(),b=_._29I,c=U.clientX-P.left+J.scrollLeft;return _._41o()&&b.x+b.width-c<z}}),ht.widget.Palette=function(m){var Z=this,e=Z._view=n.createView(null,Z);Z.$9h={},Z.$10h={},Z.$4h={},Z._29I={x:0,y:0,width:0,height:0},Z._59I=0,Z.dm(m?m:new ht.DataModel),e[T]="ht-widget-palette",Z.$29h=new V(Z),J(e,D,$.paletteContentBackground),J(e,C,"auto"),J(e,G,f),J(e,"-moz-"+G,f),J(e,"-webkit-"+t,U),J(e,"-moz-"+t,U),J(e,"-ms-"+t,U),J(e,t,U),J(e,"position","absolute"),J(e,"overflow","hidden"),b(e,Z._79O=p()),_(e,"dragstart",function($){$.dataTransfer&&($.dataTransfer.setData("Text","nodeid:"+$.target.$11h),$.dataTransfer.effectAllowed="all",Z.$29h.$26h())})},d("Palette",W,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_bnb:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:$.autoHideScrollBar,_scrollBarSize:$.scrollBarSize,_scrollBarColor:$.scrollBarColor,getViewRect:function(){return this._29I},ty:function(Q){return Q==K?this.getTranslateY():(this.setTranslateY(Q),void 0)},setTranslateY:function(Y){if(this.$32h==K){var r=this,G=r.$33h(Y),F=r.$30h;r.$30h=G,r.fp("translateY",F,G)}},getTranslateY:function(){return this.$30h},setLayout:function(x){var m,l,d=this,L=d._layout;d._layout=x,"smallicons"===x?m=l=20:"iconsonly"===x?m=l=50:(m=70,l=50),d.setItemImageWidth(m),d.setItemImageHeight(l),d.setItemImagePadding(4),d.fp("layout",L,x)},getDataAt:function(Q){for(var v=Q.target;v&&v.$11h==K;)v=v.parentNode;return v&&v.$11h!=K?this.getDataModel().getDataById(v.$11h):void 0},$20h:function(){var q=16;return w&&(q*=1.2),q},$19h:function(){return $.paletteTitleHeight},$18h:function(){var P=$.paletteSeparatorWidth,p=$.paletteTitleBackground,d=$.paletteSeparatorColor||$.brighter(p);return P+O+" solid "+d},$17h:function(e){J(e,"cursor","pointer"),J(e,"display","inline-block"),J(e,"margin-right",(w?8:4)+O),J(e,"vertical-align",X)},$1h:function(w){var I=this,e=Q(),S=Q(),p=i("span");e[T]="palette-header",J(e,q,"relative"),J(e,D,$.paletteTitleBackground),J(e,"color",$.paletteTitleLabelColor),J(e,X,g),J(e,G,f),J(e,"-moz-"+G,f),J(e,"padding","0 5px 0 0"),J(e,"border-top",I.$18h()),J(e,h,"100%"),J(e,"cursor","pointer"),J(e,"white-space","nowrap"),J(e,C,"hidden"),J(e,F,$.paletteTitleLabelFont),J(e,"line-height",I.$19h()+O),e.$11h=w.getId();var o=v(),l=I.$19h(),B=I.$20h();I.$17h(o),n.setCanvas(o,B,l),b(e,o);var Z=w.s("tools");if(Z)for(var V=0;V<Z.length;V++){var P=v();I.$17h(P),n.setCanvas(P,B,l),P[T]="palette-header-tool palette-header-tool"+w.getId()+"-"+V,P.style.position="absolute",P.style.right=(B+10)*V+"px",P.toolIndex=V,b(e,P)}return o[T]="palette-toggle-icon-"+w.getId(),S[T]="palette-content",J(S,"max-height",0+O),J(S,F,$.paletteContentLabelFont),J(S,C,"hidden"),S.$11h=w.getId(),I.$9h[w.getId()]=S,p[r]=w.getName(),J(p,F,$.paletteTitleLabelFont),b(e,o),b(e,p),[e,S]},$2h:function(H){var p=this,M=p._layout,d=B&&H.s("draggable")?i("a"):Q(),Z=v(),V=Q(),N=H.getName()||"",D=H.s("title")||H.getToolTip()||N,w=p._itemMargin;Z[T]="image-box";var u=p.getItemImageWidth(),f=p.getItemImageHeight();return n.setCanvas(Z,u,f),b(d,Z),V[r]=N,V[T]="label-box","iconsonly"!==M&&b(d,V),d[T]="palette-item",J(d,"vertical-align",X),J(d,"cursor","pointer"),J(d,"border-radius",5+O),J(d,"border","1px solid transparent"),J(d,"text-align","center"),J(d,"display","inline-block"),J(d,"margin-left",w+O),J(d,"margin-top",w+O),J(d,"color",$.paletteContentLabelColor),"smallicons"===M?(J(Z,"vertical-align","middle"),J(d,"margin-left",2+O),J(d,"margin-top",2+O),J(d,"padding",2+O),J(d,"text-align",j),J(V,"display","inline-block"),J(V,"min-width",p.$21h+p._itemMargin+O)):"largeicons"===M&&(J(V,"max-width",u+O),J(V,"overflow","hidden")),d.$11h=H.getId(),D&&(d.title=D),H.s("draggable")&&!p.handleDragAndDrop&&(B?(d.href="#",J(d,"text-decoration",U)):d.draggable="true"),d},$16h:function(Y,J,s,Q){var l=n.initContext(Y);n.translateAndScale(l,0,0,1),l.clearRect(0,0,s,s);var g=(s-Q)/2;$.drawStretchImage(l,$.getImage(J),"fill",0,g,Q,Q),l.restore()},$15h:function(H){var p=this,V=H.getId(),N=p._view.querySelector(".palette-toggle-icon-"+V),G=H.isExpanded()?$.paletteCollapseIcon:$.paletteExpandIcon;if(N&&G){var v=p.$19h(),Y=p.$20h();p.$16h(N,G,v,Y)}},_drawToolsIcon:function(C){var l=this,h=C.s("tools");if(h)for(var v=0;v<h.length;v++){var P=l._view.querySelector(".palette-header-tool"+C.getId()+"-"+v),i=h[v].icon,r=l.$19h(),u=l.$20h();l.$16h(P,i,r,u)}},$14h:function(k){var a=this,w=k.getId(),L=a.$10h[w].querySelector(".image-box"),P=k.getImage(),N=k.s("image.stretch");if(L&&P){var c=n.initContext(L),u=a.getItemImagePadding();u="smallicons"===a._layout?u/2:u;var A=a.getItemImageWidth()-2*u,d=a.getItemImageHeight()-2*u;n.translateAndScale(c,0,0,1),c.clearRect(0,0,A,d),$.drawStretchImage(c,$.getImage(P),N,u,u,A,d,k,a,a.getBodyColor(k)),c.restore()}},validateImpl:function(){var J,R,n,w=this,G=w.$9h,m=w._layout,X=w.$10h,z=w.$4h,p=w._view,c=w.dm();if(w.$13h&&(delete w.$13h,z={},c.each(function(R){z[R.getId()]=R})),"smallicons"===m)for(var u in z){var H=z[u];if(H instanceof y){var k=H.getName()||"",D=$.getTextSize($.paletteContentLabelFont,k).width;w.$21h!=K&&w.$21h>D||(w.$21h=D)}}for(var u in z){n=z[u];var L,l;if(c.contains(n)){if(n instanceof ht.Group){var A,d=w.$1h(n),N=X[n.getId()];N&&(A=N.nextSibling,S(p,A),S(p,N)),R=c.getSiblings(n).indexOf(n);var h=p.children[2*R]||w._79O;h&&h.parentNode?(p.insertBefore(d[0],h),p.insertBefore(A||d[1],h)):(p.appendChild(d[0]),p.appendChild(A||d[1])),X[n.getId()]=d[0],J=G[n.getId()]=A||d[1],l=n.$12h;var V=n.s("promptText");l||(n.$12h=i("div"),n.$12h[r]=V||"",l=n.$12h),0===n.getChildren().size()?J.contains(l)||b(J,l):J.contains(l)&&S(J,l)}else if(L=n.getParent()){var P=w.$2h(n),I=X[n.getId()];J=G[L.getId()],I&&S(I.parentNode,I),R=c.getSiblings(n).indexOf(n);var Z=J.children[R];Z?J.insertBefore(P,Z):b(J,P),X[n.getId()]=P,w.$14h(n)}}else{var U=X[n.getId()],a=U.parentNode;if(n instanceof ht.Group){var f=U.nextSibling;S(p,U),S(p,f),delete G[n.getId()]}else S(a,U),0===a.children.length&&(L=c.getDataById(a.$11h),L&&(l=L.$12h,l&&!a.contains(l)&&b(a,l)));delete X[n.getId()]}}w.$4h={};var T=function(){var I=w._59I,_=0;w.$32h!=K&&(clearInterval(w.$32h),_=0,delete w.$32h),w.$32h=setInterval(function(){w.$31h(),I===w._59I?(_++,_>=2&&(clearInterval(w.$32h),delete w.$32h)):(_=0,I=w._59I)},30)};for(var M in G)if(J=G[M],n=c.getDataById(G[M].$11h),w.$15h(n),w._drawToolsIcon(n),n.isExpanded()){if(J.style.maxHeight===0+O){var x=J.scrollHeight+w._itemMargin+O;s(J).duration(200).set(o,x).set("padding-bottom",w._itemMargin+O).end(function(){return function(){T()}}(x))}else J.style.maxHeight=J.scrollHeight+O;J.style.paddingBottom=w._itemMargin+O}else J.style.maxHeight!==0+O&&s(J).duration(200).set(o,g).set("padding-bottom",g).end(function(){return function(){T()}}(J));w.$28h(),w.$31h()},$31h:function(){for(var K=this,N=K._view,U=0,k=N.children,C=0;C<k.length;C++){var q=k[C];q.className&&q.className.indexOf("palette-")>=0&&(U+=q.offsetHeight)}K._59I=U,K.$30h=K.$33h(K.ty());var A=K.ty();N.scrollTop=-A,K._29I={x:0,y:-A,width:N.clientWidth,height:N.clientHeight},J(K._79O,X,-A+O),K._93I()},$33h:function(u){var z=this,e=z._29I.height-z._59I;return e>u&&(u=e),u>0?0:Math.round(u)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(G){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(G.property)<0&&this.redraw(),"translateY"===G.property&&(this.iv(),this._43o())},findDataByName:function(f){for(var X=this.dm().getDatas(),K=0;K<X.size();K++){var T=X.get(K);if(T.getName()===f)return T}},setDataModel:function(H){var Q=this,i=Q._dataModel,a=Q._selectionModel;i!==H&&(i&&(i.umm(Q.$6h,Q),i.umd(Q.$8h,Q),i.umh(Q.$7h,Q),a||i.sm().ums(Q.$28h,Q)),Q._dataModel=H,H.mm(Q.$6h,Q),H.md(Q.$8h,Q),H.mh(Q.$7h,Q),a?a._21I(H):H.sm().ms(Q.$28h,Q),Q.sm().setSelectionMode("single"),Q.fp("dataModel",i,H))},$6h:function(j){var R=this,u=R._view,B=j.data,M=R.$4h;"add"===j.kind?M[B.getId()]=B:"remove"===j.kind?M[B.getId()]=B:"clear"===j.kind&&(R.$10h={},R.$9h={},R.$4h={},u[r]=""),R.iv()},$7h:function(v){var I=this,P=v.data;I.$4h[P.getId()]=P,I.iv()},$8h:function(J){var I=this,N=J.data,m=J.property;"expanded"===m?I.iv():(I.$4h[N.getId()]=N,I.iv())},$28h:function(){var X,i=this,U=i.sm(),P="palette-item",M=U.ld();this.dm().each(function(l){X=i.$10h[l.getId()],X&&X[T].indexOf(P)>=0&&(l===M?J(X,D,$.paletteItemSelectBackground):x(X,D))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);