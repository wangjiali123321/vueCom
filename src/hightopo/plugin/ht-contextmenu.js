!function(K,H){"use strict";var $="ht",v=K[$],X="position",V="absolute",u="px",g="left",N="top",B="innerHTML",U="className",x="width",z="height",C="0",j="display",Q="none",A="visibility",J="user-select",k="margin",Y="padding",d=null,s=v.Color,f=v.Default,P=f.getInternal(),i=K.setTimeout,E=K.setInterval,c=K.clearTimeout,b=K.clearInterval,h=K.parseInt,y=f.isLeftButton,G=f.isDragging,S=f.startDragging,w=f.getDistance,p=f.isTouchable,o=s.widgetIconHighlight,e=s.widgetIconBorder,t=s.widgetIconGradient,W=function(){return document},m=function(r,X){return r.querySelectorAll(X)},L=function(S){var b=W().createElement(S);return"ul"===S&&(M(b,X,"relative"),M(b,k,C),M(b,Y,C),M(b,"list-style",Q),M(b,"box-sizing","border-box"),M(b,"-moz-box-sizing","border-box"),M(b,j,"inline-block"),M(b,"vertical-align","text-bottom"),M(b,"border","1px solid "+f.contextMenuBorderColor),M(b,"box-shadow","0 0 16px 1px "+f.contextMenuShadowColor),M(b,"overflow","hidden"),f.contextMenuBorderRadius&&M(b,"border-radius",f.contextMenuBorderRadius+u)),b},n=function(K){var A=K.touches[0];return A?A:K.changedTouches[0]},I=function(){return L("div")},Z=function(){return L("canvas")},M=function(B,W,g){B.style.setProperty(W,g,d)},F=function(G,Z,u){f.def(v.widget[G],Z,u)},D=function(O,A){O.appendChild(A)},r=function(p,o){p.removeChild(o)},O=P.addEventListener,T=P.removeEventListener;P.addMethod(f,{contextMenuCheckIcon:{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:e},{type:"shape",points:[13,3,7,12,4,8],borderWidth:2,borderColor:o}]},contextMenuRadioIcon:{width:16,height:16,comps:[{type:"circle",rect:[2,2,12,12],borderWidth:1,borderColor:e},{type:"circle",rect:[4,4,8,8],borderWidth:1,borderColor:o,gradient:f.imageGradient,gradientColor:t,background:o}]},contextMenuLabelFont:(p?"16":"13")+"px arial, sans-serif",contextMenuLabelColor:"#000",contextMenuBackground:"#fff",contextMenuDisabledLabelColor:"#888",contextMenuHoverBackground:"#648BFE",contextMenuHoverLabelColor:"#fff",contextMenuSeparatorWidth:1,contextMenuSeparatorColor:"#E5E5E5",contextMenuScrollerColor1:"#FDFDFD",contextMenuScrollerColor2:"#D3D3D3",contextMenuScrollerBorderColor:"#C3C3C3",contextMenuBorderColor:"#C3C3C3",contextMenuShadowColor:"rgba(128, 128, 128, 0.5)",contextMenuBorderRadius:5,contextMenuSubmenuMark:"▶"},!0);var R=function(o){var x=this,I=o._view;if(x.$11b=o,x.addListeners(),O(I,"contextmenu",function(C){C.preventDefault()}),!p){var E=x.$37b=x.$36b.bind(x);O(I,"mouseover",E),O(I,"mouseout",E)}};f.def(R,H,{ms_listener:1,getView:function(){return this.$11b._view},handle_touchstart:function(g){if(f.preventDefault(g),y(g)){for(var s=this,Z=s.$11b,B=s.getView(),J=B.children,x=0;x<J.length;x++){var H=J[x],k=H.$24b,I=H.$25b;if(k&&k.contains(g.target))return Z.scrollUp(H),s.$28b=i(function(){s.$29b=E(function(){Z.scrollUp(H)},100)},500),S(s,g),void 0;if(I&&I.contains(g.target))return Z.scrollDown(H),s.$28b=i(function(){s.$29b=E(function(){Z.scrollDown(H)},100)},500),S(s,g),void 0}p&&(g=n(g)),s.$30b={x:g.pageX,y:g.pageY}}},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchend:function(Q){if(y(Q)){var f=this,t=f.$30b,W=p?{x:n(Q).pageX,y:n(Q).pageY}:{x:Q.pageX,y:Q.pageY};if(!t||w(t,W)>1)return delete f.$30b,void 0;for(var Z=f.getView(),k=f.$11b,Y=Q.target,e=d,x=d,N=k._items,E=Z.$26b,j=0;j<E.length;j++)if(x=E[j],x.contains(Y)){e=x.getAttribute("data-id");break}if(e&&N){var c=k.$17b(N,function(G){return G._id===e});if(c){var D=!1;c.disabled instanceof Function?D=c.disabled.call(k,c):c.disabled===!0&&(D=!0),D||(c.items?p&&f.$36b(x,!0):k.$1b(c,Q))}}delete f.$30b}},$36b:function(O,C){if(!G()){var t,P=this,v=P.$11b,F=P.getView(),n=v.$20b||F.children[0],W=v.$19b,h=F.$26b,b=F.children,Y=O.target,r=F.getBoundingClientRect(),S=f.getWindowInfo(),j=S.width,Q=S.height,o=function($){for(var l=0;l<b.length;l++){var V=b[l],D=new RegExp($+"$"),J=V[U];if(J&&(D.test(J)||J.indexOf($+" ")>=0))return V}},d=function(d){for(var E=0;E<h.length;E++){var f=h[E],w=new RegExp(d+"$"),Z=f[U];if(Z&&(w.test(Z)||Z.indexOf(d+" ")>=0))return f}},Z=function(p){var D=d("menu-item"+p.$45b),L=D.getBoundingClientRect(),a=L.top-r.top,V=L.left-r.left;M(p,N,a+u),M(p,g,V+L.width+u);var l=p.getBoundingClientRect(),W=l.top,Z=l.left,_=l.height,f=l.width,y=W+_+2,o=Z+f+2;y>Q&&M(p,N,a+Q-y+u),o>j&&M(p,g,V-f+u)};if(C)t=O;else{if("mouseover"===O.type){for(var l=0;l<h.length;l++){var k=h[l];if(k.contains(Y)){t=k;break}}if(!t&&W){var B=W.parentNode,q=o("submenu"+W.getAttribute("data-id"));(q&&q.contains(Y)||B&&B.contains(Y))&&(t=W)}}else if("mouseout"===O.type){for(var D=!1,i=O.relatedTarget,l=0;l<b.length;l++){var R=b[l];if("hidden"!==R.style.visibility&&R.contains(i)){D=!0;break}}if(D)return}!t&&n&&(t=d("menu-item"+(n.$45b||"NaN")))}if(t!=W){if(W)for(var L=W;L;){if(L[U]=L[U].replace(" menu-item-hover",""),L[U].indexOf("disabled")<0){var J=v.getItemByProperty("_id",L.getAttribute("data-id"));null!=J.background?J.background instanceof Function?M(L,"background-color",J.background.call(v,J)):M(L,"background-color",J.background):M(L,"background-color",f.contextMenuBackground),M(L,"color",f.contextMenuLabelColor)}var H=o("submenu"+L.getAttribute("data-id"));H&&M(H,A,"hidden");var V=L.parentNode;L=d("menu-item"+(V.$45b||"NaN"))}if(t){for(var x=t,c=[];x;){x[U]+=" menu-item-hover",x[U].indexOf("disabled")<0&&(M(x,"background-color",f.contextMenuHoverBackground),M(x,"color",f.contextMenuHoverLabelColor));var p=o("submenu"+x.getAttribute("data-id"));p&&(M(p,A,"visible"),c.push(p));var V=x.parentNode;x=d("menu-item"+(V.$45b||"NaN"))}c.reverse(),c.forEach(function(a){Z(a)})}}v.$19b=t,v.$20b=t?t.parentNode:F.children[0]}},handle_mouseup:function($){this.handle_touchend($)},handleWindowTouchEnd:function(){var C=this;C.$28b!=d&&(c(C.$28b),delete C.$28b),C.$29b!=d&&(b(C.$29b),delete C.$29b),delete C.$34b,delete C.$30b,delete C.$35b},handleWindowMouseUp:function(c){this.handleWindowTouchEnd(c)},handle_mousemove:function(u){this.handle_touchmove(u)},handle_touchmove:function(a){if(!G()&&y(a)){for(var Q=this,R=Q.getView().children,W=d,U=0;U<R.length;U++){var N=R[U];if(N.contains(a.target)){W=N;break}}var r=Q.$30b,u=p?{x:n(a).pageX,y:n(a).pageY}:{x:a.pageX,y:a.pageY};W&&r&&w(r,u)>2&&(S(Q,a),Q.$34b=W,Q.$35b=W.$18b)}},handleWindowTouchMove:function(w){w.preventDefault();var V=this,I=V.$11b,L=V.$34b,b=V.$35b,M=V.$30b;if(M&&L){var O=p?{x:n(w).pageX,y:n(w).pageY}:{x:w.pageX,y:w.pageY},_=O.y-M.y;_>0?I.scrollUp(L,L.$18b-(b-_)):I.scrollDown(L,b-_-L.$18b)}},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},$10b:function(n,Z){n.preventDefault();for(var t=this,F=t.getView().children,J=d,W=0;W<F.length;W++){var x=F[W];if(x.contains(n.target)){J=x;break}}if(J){var m=this.$11b,r=m.getRowHeight();Math.abs(Z)>.05&&(Z>0?m.scrollUp(J,Z*r):0>Z&&m.scrollDown(J,-Z*r))}},handle_mousewheel:function(p){this.$10b(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(n){this.$10b(n,-n.detail)},$44b:function(D){this.getView().contains(D.target)||this.$11b.hide()},$41b:function(R){this.$11b.show(R)},$4b:function(F,V){var f=this.$11b;if(V=V||f._items,V&&V.length&&F.keyCode){var P=[F.keyCode];F.shiftKey&&P.push(16),F.ctrlKey&&P.push(17),F.altKey&&P.push(18),/mac/.test(K.navigator?K.navigator.userAgent.toLowerCase():"")?F.metaKey&&P.push(17):F.metaKey&&P.push(91),P.sort();var W=P.join(),Z=f.$17b(V,function(L){if(L.key){var X=L.key.slice(0);return X.sort(),W===X.join()}});if(Z){Z.preventDefault!==!1&&F.preventDefault();var a=!1;Z.disabled instanceof Function?a=Z.disabled.call(f,Z):Z.disabled===!0&&(a=!0),a||f.$1b(Z,F)}}},$39b:function(S){var c=this,a=n(S);c.$32b={x:a.pageX,y:a.pageY}},$38b:function(T){var z=this,j=n(T);z.$31b={x:j.pageX,y:j.pageY},z.$33b=i(function(){z.$31b&&(z.$32b?w(z.$31b,z.$32b)<10&&z.$11b.show(T):z.$11b.show(T)),delete z.$33b,delete z.$31b,delete z.$32b},600)},$40b:function(){var m=this;m.$33b!=d&&(c(m.$33b),delete m.$33b,delete m.$31b,delete m.$32b)}}),v.widget.ContextMenu=function(H){var y=this,g=y._view=P.createView(null,y);g[U]="ht-widget-contextmenu",y.setItems(H),y.$13b=new R(y),M(g,"font",f.contextMenuLabelFont),M(g,X,V),M(g,"cursor","default"),M(g,"-webkit-"+J,Q),M(g,"-moz-"+J,Q),M(g,"-ms-"+J,Q),M(g,J,Q),M(g,"box-sizing","border-box"),M(g,"-moz-box-sizing","border-box"),f.baseZIndex!=d&&M(g,"z-index",h(f.baseZIndex)+2+""),y.$3b=function(P){y.$13b.$4b(P)}},F("ContextMenu",H,{$5b:0,_items:d,$21b:d,_enableGlobalKey:!1,ms_v:1,enableGlobalKey:function(){var i=this,s=i._enableGlobalKey;s===!1&&(O(W(),"keydown",i.$3b),i._enableGlobalKey=!0)},disableGlobalKey:function(){this._enableGlobalKey=!1,T(W(),"keydown",this.$3b)},setItems:function(x){this._items=x},getItems:function(){return this._items},setVisibleFunc:function(y){this.$16b=y},setLabelMaxWidth:function(p){this.$43b=p},$1b:function(Y,E){var w=this;if("check"===Y.type)Y.selected=!Y.selected;else if("radio"===Y.type){var S=Y.groupId;w.$17b(w._items,function(A){A.groupId===S&&(A.selected=!1)}),Y.selected=!0}if(w.hide(),Y.action)Y.action.apply(Y.scope||w,[Y,E]);else if(Y.href){var c=Y.linkTarget||"_self";K.open(Y.href,c)}},getItemById:function(p){return this.getItemByProperty("id",p)},setItemVisible:function(X,b){var v=this.getItemById(X);v&&(v.visible=b)},getItemByProperty:function(A,s,C){var N=this;if(C=C||N._items,!C||0===C.length)return d;var E=N.$17b(C,function(O){return O[A]===s});return E||d},scrollUp:function(w,f){var k=this;if(f=f==d?20:f,f=h(f),0!==f){var l=0;w.$18b>f&&(l=w.$18b-f),k.$42b(w,l),w.scrollTop=l,w.$18b=l}},scrollDown:function(Q,S){var j=this;if(S=S==d?20:S,S=h(S),0!==S){var Y=Q.$22b,N=Q.$23b,z=Y-N;N+Q.$18b+S<Y&&(z=Q.$18b+S),j.$42b(Q,z),Q.scrollTop=z,Q.$18b=z}},$42b:function(O,z){z=z==d?O.$18b:z;var f=O.$24b,n=O.$25b;f&&(M(f,"top",z+u),0==z?M(f,j,Q):M(f,j,"block")),n&&(M(n,"bottom",-z+u),z==O.$22b-O.$23b?M(n,j,Q):M(n,j,"block"))},getRowHeight:function(){return this._view.querySelector(".menu-item").offsetHeight},$17b:function(a,b){for(var U=0;U<a.length;U++){var B=a[U];if(b(B))return B;if(B.items){var k=this.$17b(B.items,b);if(k)return k}}},$2b:function(Q,K){for(var c=this,E=0;E<Q.length;E++){c.$5b++;var J=Q[E];if(J.visible!==!1)if(f.isFunction(J.visible)&&J.visible()===!1)this._clearItemId(J);else if(!c.$16b||c.$16b.call(c,J)){var N=L("li"),T=c.$5b+"";if(M(N,"white-space","nowrap"),M(N,j,"block"),"separator"===J||J.separator===!0){var h=I();h[U]="separator",M(h,z,f.contextMenuSeparatorWidth+u),M(h,"background",f.contextMenuSeparatorColor),D(N,h)}else{J._id=T,N.setAttribute("data-id",T);var d=L("span"),O=L("span"),i=Z(),P=I();if(M(d,j,"inline-block"),M(d,z,"1.2em"),M(O,j,"inline-block"),M(O,z,"1.2em"),M(O,"line-height","1.2em"),i[U]="prefix",M(i,j,"inline-block"),M(i,x,"1em"),M(i,z,"1em"),M(i,"vertical-align","middle"),M(i,k,"0 0.2em"),"check"===J.type&&J.selected?i[U]+=" check-prefix":"radio"===J.type&&J.selected&&(i[U]+=" radio-prefix"),D(N,i),J.icon){var o=Z();o[U]="contextmenu-item-icon",M(o,j,"inline-block"),M(o,z,"1.2em"),M(o,x,"1.2em"),M(o,"margin-right","0.2em"),M(o,"float","left"),o.$50b=J.icon,o._item=J,D(d,o)}if(O[B]=J.label,D(d,O),D(N,d),P[U]="suffix",M(P,j,"inline-block"),M(P,"margin-left","1em"),M(P,"margin-right","0.4em"),M(P,"text-align","right"),M(P,"font-size","75%"),J.items&&(P[B]=f.contextMenuSubmenuMark),J.suffix&&(P[B]=J.suffix),D(N,P),N[U]="menu-item menu-item"+T,null!=J.background?J.background instanceof Function?M(N,"background-color",J.background.call(c,J)):M(N,"background-color",J.background):M(N,"background-color",f.contextMenuBackground),M(N,"color",f.contextMenuLabelColor),M(N,Y,"3px 0"),J.disabled instanceof Function){var W=J.disabled.call(c,J);W&&(N[U]+=" disabled",M(N,"color",f.contextMenuDisabledLabelColor))}else J.disabled&&(N[U]+=" disabled",M(N,"color",f.contextMenuDisabledLabelColor));if(J.items){c.$21b||(c.$21b=new v.List);var a=L("ul");a[U]="submenu"+T,a.$45b=T,M(a,A,"hidden"),M(a,X,V),D(c._view,a),c.$21b.add(a),c.$2b(J.items,a)}}D(K,N)}else this._clearItemId(J);else this._clearItemId(J)}},rebuild:function(){var j=this,q=j._items,r=j._view;if(r&&(r[B]="",j.$21b=d,j.$5b=0,j.$19b=d,j.$20b=d,r.$26b=d,q&&0!==q.length)){var i=L("ul",j._r);D(r,i),j.$2b(q,i)}},addTo:function(N){if(N){var B=this,n=B.$13b;if(B.$12b=N,B.$9b=function(W){n.$44b(W)},B.$27b=function(J){n.$41b(J)},p){var b=B.$6b=function(O){n.$38b(O)},P=B.$7b=function(M){n.$39b(M)},h=B.$8b=function(H){n.$40b(H)};O(N,"touchstart",b,!0),O(N,"touchmove",P),O(N,"touchend",h)}else O(N,"contextmenu",B.$27b)}},showOnView:function(o,D,N){o=o.getView?o.getView():o;var s=f.getWindowInfo(),H=o.getBoundingClientRect();this.show(H.left+s.left+D,H.top+s.top+N)},show:function(K,w,s){var k=this,s=s==d?!0:!1,q=k._view;if(q){if(k.invalidate(),1===arguments.length){var G=K;if(p){var $=n(G);K=$.pageX,w=$.pageY}else K=G.pageX,w=G.pageY}var c=f.getWindowInfo(),L=c.width,F=c.height,t=c.left,r=c.top,Q={pageX:K,pageY:w,clientX:K-t,clientY:w-r,target:1,originEvent:G},J=Q.clientX,l=Q.clientY,b=function(W){W.style.height=F-6+u;var v=I(),A=I(),z=function(s){M(s,X,V),M(s,"text-align","center"),M(s,x,"100%"),M(s,"font-size",10+u),M(s,"padding","2px 0"),M(s,"border","0px solid "+f.contextMenuScrollerBorderColor),M(s,"background-color",f.contextMenuScrollerColor1),s.style.backgroundImage="-webkit-linear-gradient(top, "+f.contextMenuScrollerColor1+", "+f.contextMenuScrollerColor2+")",s.style.backgroundImage="linear-gradient(to bottom, "+f.contextMenuScrollerColor1+", "+f.contextMenuScrollerColor2+")"};v[U]="menu-arrow-item menu-arrow-item-top",A[U]="menu-arrow-item menu-arrow-item-bottom",z(v),M(v,"top",C),M(v,"left",C),M(v,"border-bottom-width",1+u),v[B]="▲",z(A),M(A,"bottom",C),M(A,"left",C),M(A,"border-top-width",1+u),A[B]="▼",W.$24b=v,W.$25b=A,W.$18b=W.scrollTop,W.$22b=W.scrollHeight,W.$23b=W.clientHeight,D(W,v),D(W,A),k.$42b(W)};k.beforeShow&&k.beforeShow(Q);var e=k._items;if(e&&(G&&G.preventDefault(),e.length)){k.rebuild(),f.appendToScreen(q),q.$26b=m(q,".menu-item");var y=q.children[0];y.offsetHeight>F&&b(y);var v=l+(s?1:0),Y=J+(s?1:0),P=function(D){for(var Y=0,V=0,X=0,c=k.$43b;X<D.children.length;X++){var f=D.children[X];if(f.getAttribute("data-id")){var h=f.children[1],Q=f.children[2],N=h.children;if(c){var e=N[0];N.length>1&&(e=N[1]),e.offsetWidth>c&&(e[B]="<marquee scrollamount='3'>"+e[B]+"</marquee>",e.children[0].style.verticalAlign="text-bottom",M(e,x,c+u),M(e,j,"inline-block"))}var W=h.offsetWidth,g=Q.offsetWidth;W>Y&&(Y=W),g>V&&(V=g)}}for(X=0;X<D.children.length;X++){var f=D.children[X];if(f.getAttribute("data-id")){var h=f.children[1],Q=f.children[2],w=h.children[0],O=h.children[1];!O&&w.style.width&&M(w,x,Y+u),M(h,x,Y+u),M(Q,x,V+u)}}};P(y);var Z=l+3+q.offsetHeight,z=J+3+q.offsetWidth;Z>F?M(q,N,v-(Z-F)+r+u):M(q,N,v+r+u),z>L?M(q,g,Y-(z-L)+t+u):M(q,g,Y+t+u);var S=k.$21b;S&&S.each(function(w){P(w),w.offsetHeight>F&&b(w)}),k.$9b&&O(W(),p?"touchstart":"mousedown",k.$9b,!0),k.afterShow&&k.afterShow(Q),k.$47b()}}},isShowing:function(){return this._view?this._view.parentNode!=d:!1},getRelatedView:function(){return this.$12b},hide:function(){var P=this,C=P._view;C&&C.parentNode&&(r(C.parentNode,C),T(W(),p?"touchstart":"mousedown",P.$9b,!0),P.afterHide&&P.afterHide())},dispose:function(){var b=this,E=b.$12b,I=b._view;I&&(I.parentNode&&r(I.parentNode,I),b.disableGlobalKey(),E&&(p?(T(E,"touchstart",b.$6b,!0),T(E,"touchmove",b.$7b),T(E,"touchend",b.$8b)):T(E,"contextmenu",b.$27b)),b._view=b._items=b.$21b=b.$19b=b.$12b=b.beforeShow=b.afterShow=b.afterHide=b.$9b=b.$3b=b.$6b=b.$7b=b.$8b=b.$27b=d)},$46b:function(B,u,A,c,x){var M=P.initContext(B);P.translateAndScale(M,0,0,1),M.clearRect(0,0,A,c),f.drawStretchImage(M,f.getImage(u),"fill",0,0,A,c,x,this),M.restore()},$47b:function(){var A,g,j,F=this,e=F._view;if(F.isShowing()){var E=m(e,".check-prefix");for(j=0;j<E.length;j++){var Y=E[j];A=Y.clientWidth,g=Y.clientHeight,Y.$48b=A,Y.$49b=g,P.setCanvas(Y,A,g)}var S=m(e,".radio-prefix");for(j=0;j<S.length;j++){var u=S[j];A=u.clientWidth,g=u.clientHeight,u.$48b=A,u.$49b=g,P.setCanvas(u,A,g)}var _=m(e,".contextmenu-item-icon");for(j=0;j<_.length;j++){var r=_[j];A=r.clientWidth,g=r.clientHeight,r.$48b=A,r.$49b=g,P.setCanvas(r,A,g)}}},validateImpl:function(){var c,M,P,j=this,C=j._view;if(j.isShowing()){var t=m(C,".check-prefix");for(P=0;P<t.length;P++){var H=t[P];c=H.$48b,M=H.$49b,c&&M&&j.$46b(H,f.contextMenuCheckIcon,c,M)}var v=m(C,".radio-prefix");for(P=0;P<v.length;P++){var K=v[P];c=K.$48b,M=K.$49b,c&&M&&j.$46b(K,f.contextMenuRadioIcon,c,M)}var e=m(C,".contextmenu-item-icon");for(P=0;P<e.length;P++){var i=e[P];c=i.$48b,M=i.$49b,c&&M&&j.$46b(i,f.getImage(i.$50b),c,M,i._item)}}},_clearItemId:function(p){var u=this;delete p._id,p.items&&p.items.forEach(function($){u._clearItemId($)})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);