!function(Z,C){"use strict";var x="position",h="absolute",U="relative",v="px",m="left",S="right",p="top",b="bottom",c="display",l="none",H="block",B=ht.Default,R=B.getInternal(),M=Math.floor,u=Math.ceil,y=Math.PI,e=null,n=Z.parseInt,E=function(L){return L.getContext("2d")},$=function(){return document},A=function(p){return $().createElement(p)},X=function(){return A("canvas")},w=function(X,Q,l){X.style.setProperty(Q,l,e)},r=function(s,Y,O){B.def(ht.widget[s],Y,O)},t=function(f,u){f.appendChild(u)},K=function(k,m){k.removeChild(m)},R=B.getInternal(),f=R.addEventListener,O=R.removeEventListener;ht.widget.RulerFrame=function(G){var c=this,s=c._view=R.createView(null,c),g=c.$1k=X(),B=c.$2k=X(),J=c.$3k=X(),a=c.$4k=X();c._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},c._topRulerConfig={visible:!0},c._rightRulerConfig={visible:!1},c._bottomRulerConfig={visible:!1},c._leftRulerConfig={visible:!0},t(s,g),t(s,J),t(s,B),t(s,a),w(s,x,U),w(s,"box-sizing","border-box"),w(s,"-moz-box-sizing","border-box"),w(g,x,h),w(B,x,h),w(J,x,h),w(a,x,h),c.$14k=function(){c.$13k=1,c.iv()},c.$15k=function(d){if(c._topRulerConfig.guideVisible||c._rightRulerConfig.guideVisible||c._bottomRulerConfig.guideVisible||c._leftRulerConfig.guideVisible||c._defaultRulerConfig.guideVisible||(c._topRulerConfig.guideTipVisible||c._rightRulerConfig.guideTipVisible||c._bottomRulerConfig.guideTipVisible||c._leftRulerConfig.guideTipVisible||c._defaultRulerConfig.guideTipVisible)&&c._component){var G=s.getBoundingClientRect();c.$16k={x:d.clientX-G.left,y:d.clientY-G.top},c.$5k()}},c.setComponent(G)},r("RulerFrame",C,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(U){var r=this,n=r._component,A=r.getView();if(A){if(r._component=U,r.fp("component",n,U),n){var N=r.getComponentView(n);K(A,N),O(A,"mousemove",r.$15k),r.removeComponentPropertyChangeListener(n,r.$14k)}if(U){var I=r.getComponentView(U);t(A,I),w(I,x,h),f(A,"mousemove",r.$15k),r.addComponentPropertyChangeListener(U,r.$14k)}}},addComponentPropertyChangeListener:function(j,x){j&&j.mp&&j.mp(x)},removeComponentPropertyChangeListener:function(o,k){o&&o.ump&&o.ump(k)},getComponentHZoom:function(L){return L&&L.getZoom?L.getZoom():1},getComponentVZoom:function(G){return G&&G.getZoom?G.getZoom():1},getComponentViewRect:function(o){return o&&o.getViewRect?o.getViewRect():void 0},getComponentView:function(U){return U&&U.getView?U.getView():U},invalidateComponent:function(j){j&&j.iv&&j.iv()},validateComponent:function(n){n&&n.validate&&n.validate()},$7k:function(_,x,W,C,k,F,I,B,L,Q,p,Y){if(x.visible){var X=this._defaultRulerConfig,z="borderStyle",i="borderColor",Z="borderWidth",j="background",h=x[z]||X[z],n=x[i]||X[i],b=x[Z]||X[Z],T=x.size!=e?x.size:X.size,$=x[j]||X[j],o=T+b,N=this.$6k(b,h,n,_,W,k,o,I,B,L,Q,p,Y);w(_,k,"0px"),F?R.setCanvas(_,C-N,T):R.setCanvas(_,T,C-N),w(_,"background",$),w(_,c,H)}else w(_,c,l),w(this.getComponentView(this._component),k,"0px")},$6k:function(i,O,z,h,r,X,$,U,d,F,T,q,K){var f=0;return w(h,r,i+"px "+O+" "+z),w(this.getComponentView(this._component),X,$+v),U?(w(h,d,F+v),f+=F):w(h,d,"0px"),T?(w(h,q,K+v),f+=K):w(h,q,"0px"),f},validateImpl:function(){var E=this,W=E._component,j=E.$1k,M=E.$2k,B=E.$3k,H=E.$4k,F=E._view,l=E._defaultRulerConfig,o=E._topRulerConfig,h=E._rightRulerConfig,L=E._bottomRulerConfig,P=E._leftRulerConfig,n=l.size;if(F&&W){var J=o.size!=e?o.size:n,t=h.size!=e?h.size:n,T=L.size!=e?L.size:n,y=P.size!=e?P.size:n;E.$7k(j,o,"border-bottom",F.offsetWidth,p,!0,P.visible,m,y,h.visible,S,t),E.$7k(M,h,"border-left",F.offsetHeight,S,!1,o.visible,p,J,L.visible,b,T),E.$7k(B,L,"border-top",F.offsetWidth,b,!0,P.visible,m,y,h.visible,S,t),E.$7k(H,P,"border-right",F.offsetHeight,m,!1,o.visible,p,J,L.visible,b,T),E.$13k?delete E.$13k:E.invalidateComponent(W),E.validateComponent(W),E.$5k()}},$5k:function(){function r(k,O,K,r,n,X){if(O.visible){var u=E(k),f=O[g]||a,y=O[M]!=e?O[M]:H,D=O[P]||L,l=O[v]||m,s=O.size!=e?O.size:W,$l=O[x]||c,Nb=O[R]||j,Jp=O[d]||Z,_g=O[B]!=e?O[B]:F,ml=O[p]!=e?O[p]:o,nh=O[T]!=e?O[T]:_,Fp=O[I]!=e?O[I]:b,Bj=O[w]!=e?O[w]:i,Qf=O[N]!=e?O[N]:V,ac=O[$]||Dk,Fb=O[q]||fh;y&&(f=Y[X]=Y.$8k(Y[X]||f,O[Q]||h,O[S]||C,r?A:U,Nb)),K.call(Y,u,J,G,t,z,s,r?A:U,f,D,l,n,$l,Jp);var Op=Y.$16k;(_g||ml)&&Op&&(r?Y.$9k(u,Op.x,s,ac,Fb,_g,ml,nh,Fp,Bj,Qf):Y.$10k(u,Op.y,s,ac,Fb,_g,ml,nh,Fp,Bj,Qf,n))}}var Y=this,O=Y.$1k,l=Y.$2k,k=Y.$3k,K=Y.$4k,f=Y._topRulerConfig,y=Y._rightRulerConfig,s=Y._bottomRulerConfig,D=Y._leftRulerConfig,X=Y._defaultRulerConfig,u=Y._component,n=Y.getComponentViewRect(u),A=Y.getComponentHZoom(u),U=Y.getComponentVZoom(u),J=n.x*A,t=J+n.width*A,G=n.y*U,z=G+n.height*U,W=Y._defaultRulerConfig.size,g="defaultMajorTickSpacing",Q="maxPhysicalMajorTickSpacing",S="minPhysicalMajorTickSpacing",M="tickSpacingAdaptable",P="majorTickTextFont",v="majorTickTextColor",x="majorTickColor",d="minorTickColor",B="guideVisible",p="guideTipVisible",T="guideTipBorderColor",I="guideTipTextColor",w="guideTipTextFont",N="guideTipBackground",$="guideColor",q="guideWidth",R="minMajorTickSpacing",a=X[g],h=X[Q],C=X[S],H=X[M],L=X[P],m=X[v],c=X[x],j=X[R],Z=X[d],F=X[B],o=X[p],_=X[T],b=X[I],i=X[w],V=X[N],Dk=X[$],fh=X[q];Y._view&&u&&(r(O,f,Y.$11k,!0,!1,"_currentTopMajorTickSpacing"),r(l,y,Y.$12k,!1,!0,"_currentRightMajorTickSpacing"),r(k,s,Y.$11k,!0,!0,"_currentBottomMajorTickSpacing"),r(K,D,Y.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(E,s,$,g,h){return $>E*g?E=M(s/g/h)*h:E*g>s&&(E=u($/g/h)*h),E},getHTipText:function(L){var P=this,S=P._component,d=0,K=P._view.getBoundingClientRect();return S.lp?d=n(S.lp({x:L.x+K.left,y:L.y}).x):d-=n(this.getComponentView(S).style.left)||0,d},$9k:function(N,o,O,r,K,b,c,e,Y,i,$){var T=this,L=T._component;N.save(),R.translateAndScale(N,0,0,1);var W=o-(n(this.getComponentView(L).style.left)||0),t=0;if(o=T.getHTipText(T.$16k),b&&(N.beginPath(),N.fillStyle=r,N.rect(W,t,K,O),N.fill()),c){N.beginPath(),N.textAlign="center",N.textBaseline="middle",N.font=i;var h=N.measureText(o).width+6;N.fillStyle=$,N.rect(W-h/2,t,h,O),N.fill(),N.strokeStyle=e,N.stroke(),N.beginPath(),N.fillStyle=Y,N.fillText(o,W,t+O/2)}N.restore()},getVTipText:function(A){var j=this,T=j._component,e=0,d=j._view.getBoundingClientRect();return T.lp?e=n(T.lp({x:A.x,y:A.y+d.top}).y):e-=n(this.getComponentView(T).style.top)||0,e},formatScaleText:function(U){return Math.round(U)},$10k:function(_,a,Y,e,z,u,c,f,o,$,v,U){var F=this,p=F._component;_.save(),R.translateAndScale(_,0,0,1);var i=Y/2,A=a-(n(this.getComponentView(p).style.top)||0);if(a=F.getVTipText(F.$16k),u&&(_.beginPath(),_.fillStyle=e,_.rect(i-Y/2,A,Y,z),_.fill()),c){_.translate(i,A),_.rotate((U?90:-90)*y/180),_.translate(-i,-A),_.beginPath(),_.textAlign="center",_.textBaseline="middle",_.font=$;var Q=_.measureText(a).width+6;_.fillStyle=v,_.rect(i-Q/2,A-Y/2,Q,Y),_.fill(),_.strokeStyle=f,_.stroke(),_.fillStyle=o,_.fillText(a,i,A)}_.restore()},$11k:function(Y,B,g,H,K,q,Q,m,a,z,e,L,c){Y.save(),g=0;var W=B,C=H,r=(W+C)/2;B=0,H=C-W,R.translateAndScale(Y,0,0,1);var N=0,J=0,D=n(q/2),o=q-D,u=e?0:D,l=m*Q,j=l/10;B-=l,H+=l,Y.clearRect(B,0,H-B,q),Y.beginPath(),Y.fillStyle=c;var G=M(r/j)*j-W;for(N=G;H>N;N+=j)Y.rect(N,g+u,1,o);for(N=G;N>B;N-=j)Y.rect(N,g+u,1,o);for(Y.fill(),u=e?0:1,Y.beginPath(),Y.fillStyle=L,G=M(r/l)*l-W,N=G;H>N;N+=l)Y.rect(N,g+u,1,q-1);for(N=G;N>B;N-=l)Y.rect(N,g+u,1,q-1);Y.fill();var p=n(/\d+px/.exec(a)[0]),f=(p||10)/2;Y.textBaseline="middle",u=e?q-f-2:f+2,Y.beginPath(),Y.fillStyle=z,Y.font=a;var U=M(r/l)*l/Q;for(N=G,J=U;H>N;N+=l,J+=m){var k=this.getHScaleText?this.getHScaleText(N):J;Y.fillText(this.formatScaleText(k),N+2,g+u)}for(N=G,J=U;N>B;N-=l,J-=m){var k=this.getHScaleText?this.getHScaleText(N):J;Y.fillText(this.formatScaleText(k),N+2,g+u)}Y.restore()},$12k:function(x,W,F,N,H,L,$,Q,e,I,w,f,A){function v(Z,j,w,H,N,S){N=G.getVScaleText?G.getVScaleText(w):N,N=G.formatScaleText(N),x.translate(Z+j,w),x.rotate(-H),x.translate(-Z-j,-w),x.fillText(N,Z+j+(S?2:1),w),x.translate(Z+j,w),x.rotate(H),x.translate(-Z-j,-w)}x.save(),W=0;var J=F,q=H,u=(J+q)/2;F=0,H=q-J,R.translateAndScale(x,0,0,1);var U=0,G=this,O=0,d=n(L/2),D=L-d,z=w?0:d,p=Q*$,k=p/10;F-=p,H+=p,x.clearRect(W,0,L,H-F),x.beginPath(),x.fillStyle=A;var K=M(u/k)*k-J;for(U=K;H>U;U+=k)x.rect(W+z,U,D,1);for(U=K;U>F;U-=k)x.rect(W+z,U,D,1);for(x.fill(),z=w?0:1,x.beginPath(),x.fillStyle=f,K=M(u/p)*p-J,U=K;H>U;U+=p)x.rect(W+z,U,L-1,1);for(U=K;U>F;U-=p)x.rect(W+z,U,L-1,1);x.fill();var S=n(/\d+px/.exec(e)[0]),b=(S||10)/2,t=90*y/180;x.textBaseline="middle",z=w?L-b:b+2,t=w?-t:t,x.beginPath(),x.fillStyle=I,x.font=e;var B=M(u/p)*p/$;for(U=K,O=B;H>U;U+=p,O+=Q)v(W,z,U,t,O,w);for(U=K,O=B;U>F;U-=p,O-=Q)v(W,z,U,t,O,w);x.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var I=this,s=I._component,q=I._view;s&&I.removeComponentPropertyChangeListener(s,I.$14k),q&&(O(q,"mousemove",I.$15k),K(q.parentNode,q),I._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);