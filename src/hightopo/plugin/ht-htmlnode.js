!function(Y){"use strict";var I="ht",B=Y[I],f=function(){return document},n=function(){return f().body},b=function(C,H,y){C.style.setProperty(H,y,null)},Z=function(Z){return f().createElement(Z)},t=function(){return Z("div")},D=function(){var w=Z("canvas");return w},l=function(R,v){b(R,"-webkit-transform",v),b(R,"-ms-transform",v),b(R,"transform",v)},$=function(u,o){b(u,"-webkit-transform-origin",o),b(u,"-ms-transform-origin",o),b(u,"transform-origin",o)},y=function(r,e){r.appendChild(e)},c=function(I,Q){I.removeChild(Q)},S=Y.parseInt,d=B.Default,Q=d.getInternal(),E=Q.addEventListener,R=(Q.removeEventListener,Math.PI),W="white-space",K="visibility",P="left",s="top",i="width",w="height",u="position",A="display",T="z-index",o="px",H="0 0",L="absolute",p="visible",k="hidden",q="none",m="block",U="nowrap",N="rgba(0, 0, 0, 0.005)";d.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var O=B.graph.GraphView.prototype,X=O._42;O.adjustHtmlNodeIndex=!0,O._42=function(j,M){if(X.call(this,j,M),this.adjustHtmlNodeIndex)for(var L=this.getDataModel()._datas._as,G=L.length,f=1,o=0;G>o;o++){var u=L[o];if(u instanceof v){var y=this.getDataUI(u);b(y.$2f,T,f+""),b(y.$3f,T,f+1+""),f+=2}}};var J=B.HtmlNodeUI=function(Q,a){var n=this;J.superClass.constructor.call(n,Q,a);var V=n.$2f=t(),R=n.$3f=D();b(V,u,L),b(V,K,k),b(V,W,U),R.draggable=!1,b(R,u,L),b(R,A,q),$(R,H),E(V,"change",function(z){var e=z.target,p=e.bind||e.getAttribute("bind"),h=e.type&&"checkbox"===e.type?e.checked:e.value,E=a.getContext();p&&E&&(E[p]=h,n.$4f=JSON.stringify(E))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(F){E(V,F,this.$9f.bind(this))},n)};d.def(J,Q.ui().NodeUI,{_visible:!0,$11f:function(){var t=this,k=t.$3f,N=t._data,$=N.getDraggerImageWidth(),E=N.getDraggerImageHeight(),h=N.getDraggerImage(),G=Q.initContext(k);G.beginPath(),Q.setCanvas(k,$,E),Q.translateAndScale(G,0,0,1),G.clearRect(0,0,$,E),d.drawImage(G,d.getImage(h),0,0,$,E),G.restore()},_80o:function(h){J.superClass._80o.call(this,h);var I=this,Y=I._data,a=Y._padding,d=2*a,e=I.$2f,D=I.$3f,c=I.gv,x=c.getZoom(),Z=c.getTranslateX(),F=c.getTranslateY(),X=c.getView(),G=I._83o,f=Y._width,n=Y._height,$=G.position,g=G.rotation,v=(f-d)/Y.$5f*x,H=(n-d)/Y.$6f*x,V=I._html,U=Y._html,E=Y.getHtmlType();if("html"===E){var M=Y.getContext()||{},C=I.$4f,_=Y.$10f,B=JSON.stringify(M);V&&C&&V===U&&C===B||(I.$4f=B,I._html=U,e.innerHTML=_?_(M):U)}else if(null!=E){var W=Y.getHtml();"ht"===E&&(W=W.getView()),V&&V===W&&e.contains(V)||(I._html=W,e.innerHTML="",y(e,W))}if(!e.parentNode){var r=c.$1f;if(!r){var Q=t();b(Q,u,L),b(Q,T,"0"),r=c.$1f=Q;var z=c._canvas.nextSibling;z?X.insertBefore(Q,z):y(X,Q)}y(r,e),y(r,D),Y.onContentInitialized&&Y.onContentInitialized(e)}if(Y._scalable){var O=Y.$5f,j=Y.$6f;l(e,"rotate("+180*(g/R)+"deg) scale("+v+","+H+")"),b(e,i,""),b(e,w,""),b(e,P,($.x-O/x/2)*x+Z+o),b(e,s,($.y-j/x/2)*x+F+o)}else{var kp=S(e.style.width),ae=S(e.style.height),ai=S((f-d)*x),Yd=S((n-d)*x),Mn="100%",Uc=e.children[0];b(Uc,i,Mn),b(Uc,w,Mn),(kp!==ai||ae!==Yd)&&(b(e,i,ai+o),b(e,w,Yd+o),"ht"===E&&U.invalidate()),l(e,"rotate("+180*(g/R)+"deg)"),b(e,P,($.x-ai/x/2)*x+Z+o),b(e,s,($.y-Yd/x/2)*x+F+o)}var Bc=I.dragRect;c.isMovable(Y)&&c.isSelected(Y)&&Bc?(h.save(),h.fillStyle=N,h.fillRect(Bc.x,Bc.y,Bc.width,Bc.height),h.restore(),b(D,P,Bc.x*x+Z+o),b(D,s,Bc.y*x+F+o),l(D,"scale("+x+","+x+")"),b(D,A,m),I.$11f()):b(D,A,q),b(e,K,this._visible?p:k)},dispose:function(){var M=this.gv.$1f;this.$2f.parentNode===M&&M.removeChild(this.$2f),this.$3f.parentNode===M&&M.removeChild(this.$3f)},_84o:function(H){this._visible=H,b(this.$2f,K,H?p:k),b(this.$3f,A,H?m:q)},_3O:function(){var D=this,b=D.gv,O=D._data;J.superClass._3O.call(D);var f=O.getRect();b.isEditable(O)&&(D.dragRect={x:f.x+f.width+O._padding,y:f.y+10,width:O.getDraggerImageWidth(),height:O.getDraggerImageHeight()},D._68o(D.dragRect))},rectIntersects:function(A){var T=this._79o();return B.Default.intersection(T,A)?!0:void 0},$9f:function(b){var o=this.gv,r=this._data;o.sm().contains(r)&&b.stopPropagation()}});var v=B.HtmlNode=function(){v.superClass.constructor.call(this)};B.Default.def(v,B.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:B.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(f){var w=this,u=w._html;w._html=f,"html"===w.getHtmlType()&&"Handlebars"in Y&&(w.$10f=Handlebars.compile(f)),w.$13f(),w.fp("html",u,f)},setContext:function(y){var R=this,e=R._context;R._context=y,R.fp("context",e,y),R.$13f()},setScalable:function(W){var F=this,E=F._scalable;F._scalable=W,F.fp("scalable",E,W),F.$13f()},getHtmlType:function(){var p=this._html;return p?"string"==typeof p?"html":p.getView?"ht":"dom":null},$13f:function(){var Z=this,j=Z._html,s=Z.$10f;if(j){var e=t(),o=!1,l=Z.getHtmlType();if(b(e,u,L),b(e,W,U),b(e,K,k),"html"===l?(e.innerHTML=s?s(Z.getContext()||{}):j,o=!0):"ht"===l?(y(e,j.getView()),o=!0):"dom"===l&&(y(e,j),o=!0),o){var w=2*Z._padding;y(n(),e),Z.$5f=e.scrollWidth,Z.$6f=e.scrollHeight,Z._width=Z.$5f+w,Z._height=Z.$6f+w,Z._originWidth=Z._width,Z._originHeight=Z._height,c(n(),e)}}},getUIClass:function(){return B.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);