!function(c,Y,M){"use strict";var I="ht",F=c[I],s=F.Default,h=F.graph,B=s.getInternal(),J=B.ui(),f=J.NodeUI.prototype,D=J.ShapeUI.prototype,i=h.GraphView,N=i.prototype,P=J.EdgeUI.prototype,X=F.Node,m=F.Shape,v=F.Edge,r=F.Group,O=s.isTouchable,g=s.preventDefault,u=c.setTimeout,E=s.grow,T=s.isDragging,y=s.getDistance,j=null,e=F.List,A="undefined"!=typeof Float32Array?Float32Array:Array,z=Math,q=z.PI,w="Crossing",b="No Crossing",K=q/2,S=2*q,H=z.atan2,l=z.sqrt,C=z.pow,d=z.sin,Q=z.cos,n=z.min,G=z.max,x=z.abs,V=z.ceil,t=z.round,o=s.unionPoint,L=s.unionRect,p=s.containsPoint,R=s.clone,k="rgb(52, 152, 219)",W="red",_={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},U={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var O=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],$=0;$<O.length;$++){var y=O[$];y=0===$%2?y/400*U.width:y/100*U.height,O[$]=y}return U.width>120&&(O[4]=U.width-26,O[6]=U.width-40,O[10]=U.width-40,O[12]=U.width-26,O[18]=33),O}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},$={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:k,rotation:.61},{type:"circle",rect:[200,120,70,70],background:k,rotation:.61},{type:"circle",rect:[200,220,70,70],background:k,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:k},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:k}]},Z={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:W,rotation:.61}]},a={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:k},{type:"circle",rect:[0,210,90,90],background:k},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:k}]},Yq={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:W},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:W}]},Uq={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:k}]},Fb={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:W}]},Vq={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},kg={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},ws=function(R){var z=R.touches[0];return z?z:R.changedTouches[0]},Rh=function(b,x,X,Y){return H(Y-x,X-b)},Qb=function(Q,g){return{x:Q.x*g,y:Q.y*g}},Rb=function(h,V){h.each(function(n){return h.isSelected(n)?V(n):void 0})},dc=function(s,C){s.reverseEach(function($){return s.isSelected($)?C($):void 0})},Fp=function(p,d,X){var K,E,t,A,q,T=this,o=d,L=T.gv;if(p instanceof m){t=p.getSegments();var f=L.getDataUI(p);q=f._55O.$15l,t&&t.size()||(t=bm(q)),p.isClosePath()&&t.indexOf(5)<0&&(t=new e(t._as),t.add(5)),K=el(p,f,o),E=q[K]}else{var O=L.getDataUI(p);q=Dh(O,p.s("edge.points")),t=p.s("edge.segments"),t&&t.size()||(t=bm(q)),q=q._as,K=el(p,O,o),E=q[K]}if(t&&(A=t.get(o)),2===A||1===A||5===A){var R=q[K+1];5===A&&(R=q[0]);var J=We(E,X,R);return J}return X},wp=function(L,q,d,Y){var A=q/2,m=d/2,T=om(L,-A,-m,Y),o=om(L,A,-m,Y),I=om(L,-A,m,Y),e=om(L,A,m,Y),k=om(L,0,-m,Y),F=om(L,A,0,Y),X=om(L,0,m,Y),v=om(L,-A,0,Y);return[T,o,I,e,k,F,X,v]},We=function(e,m,t){var g={x:m.x-e.x,y:m.y-e.y},i={x:t.x-e.x,y:t.y-e.y},k=l(C(t.x-e.x,2)+C(t.y-e.y,2)),f={x:i.x/k,y:i.y/k},G=g.x*f.x+g.y*f.y,Q={x:f.x*G,y:f.y*G};return{x:e.x+Q.x,y:e.y+Q.y}},om=function(x,O,M,A){var f=Q(A)*O-d(A)*M,n=d(A)*O+Q(A)*M;return x?{x:x.x+f,y:x.y+n}:{x:f,y:n}},Id=function(S,R){return R>2*S?S:R/2},_g=function(g,E,v,b){var H=y(g,E);return v=b?n(v,H):Id(v,H),H?v/=H:v=0,{x:g.x+(E.x-g.x)*v,y:g.y+(E.y-g.y)*v}},Xc=function(L,I){var h,X,_=L.gv,r=L._data,v=r._40I,H=r._41I,x=r.s("edge.offset"),n=r.s("edge.source.position"),o=r.s("edge.target.position"),Y=r.s("edge.source.offset.x"),b=r.s("edge.source.offset.y"),y=r.s("edge.target.offset.x"),c=r.s("edge.target.offset.y"),p=r.s("edge.source.anchor.x"),d=r.s("edge.source.anchor.y"),E=r.s("edge.target.anchor.x"),Z=r.s("edge.target.anchor.y");if(I?(h=B.getEdgeAgentPosition(_,v,n,Y,b,p,d),X=B.getEdgeAgentPosition(_,H,o,y,c,E,Z)):(h=B.getEdgeAgentPosition(_,v,n,0,0,p,d),X=B.getEdgeAgentPosition(_,H,o,0,0,E,Z)),"points"===r.s("edge.type")&&x&&!r.s("edge.center")&&h){var k=r.s("edge.points")||new e,G=k.size(),l=_g(h,G?k.get(0):X,x,G),C=_g(X,G?k.get(G-1):h,x,G);h=l,X=C}return[h,X]},Dh=function(Q,u,F){var a=Q._78o,R=Q._data,n=R.s("edge.type"),X=[a.sourcePoint,a.targetPoint];return"points"===n?F&&(X=Xc(Q)):X=a.center?n?F?Xc(Q):Xc(Q,!0):F?Xc(Q):[a.c1,a.c2]:F?Xc(Q):Xc(Q,!0),u=new e(u?u._as:j),u.add(X[0],0),u.add(X[1]),u},os=function(C){return C=new e(C._as),C.removeAt(0),C.removeAt(C.size()-1),C},bm=function(U){U._as||(U=new e(U));var C=new e;C.add(1);for(var f=1;f<U.size();f++)C.add(2);return C},ts=function(H,u){return{x:(H.x+u.x)/2,y:(H.y+u.y)/2}},te=function(V,O){return{x:V.x+1*(O.x-V.x)/4,y:V.y+1*(O.y-V.y)/4}},Kf=function(G,S){return{x:G.x+3*(S.x-G.x)/4,y:G.y+3*(S.y-G.y)/4}},Pd=function(T,g,P,j){var c=g.x+g.width/2,e=g.y+g.height/2,I=l(c*c+e*e),J=H(e,c)+P;return{x:j.x+I*Q(J),y:j.y+I*d(J)}},di=N.validateImpl,pc=N.isRectEditable,Ne=N.isPointEditable,Mp=N._42,bd=D._79o,rk=P._79o,Jo=D._48O,fc=D._47O,mj=f._48O,Gh=f._80o,Hn=D._80o,qh=f.getSelectWidth,zb=f._47O,vs=P._47O,Wr=N.isEditable,ud=["northwest","north","northeast","east","southeast","south","southwest","west"],il=function(Z,I,A,K,i,P,t,E,B,Y){var q=Z.x,s=Z.y,m=Z.width,l=Z.height,H={x:q+m/2,y:s+l/2};K=K||0,I=om(H,I.x-H.x,I.y-H.y,-K),t&&!E&&(I.x+=B,I.y+=Y);var D=.01;if("northwest"===A?(I.x+i>q+m-D&&(I.x=q+m-i-D),I.y+i>s+l-D&&(I.y=s+l-i-D),Z=o(I,{x:q+m,y:s+l})):"north"===A?(I.y+i>s+l-D&&(I.y=s+l-i-D),Z=o({x:q,y:I.y},{x:q+m,y:s+l})):"northeast"===A?(I.x<q+i+D&&(I.x=q+i+D),I.y+i>s+l-D&&(I.y=s+l-i-D),Z=o({x:q,y:I.y},{x:I.x,y:s+l})):"west"===A?(I.x+i>q+m-D&&(I.x=q+m-i-D),Z=o({x:I.x,y:s},{x:q+m,y:s+l})):"east"===A?(I.x<q+i+D&&(I.x=q+i+D),Z=o({x:q,y:s},{x:I.x,y:s+l})):"southwest"===A?(I.x+i>q+m-D&&(I.x=q+m-i-D),I.y<s+i+D&&(I.y=s+i+D),Z=o({x:I.x,y:s},{x:q+m,y:I.y})):"south"===A?(I.y<s+i+D&&(I.y=s+i+D),Z=o({x:q,y:s},{x:q+m,y:I.y})):"southeast"===A&&(I.x<q+i+D&&(I.x=q+i+D),I.y<s+i+D&&(I.y=s+i+D),Z=o({x:q,y:s},I)),"keepRatio"===P&&(!t&&E||t&&!E)&&("northeast"===A||"southeast"===A||"northwest"===A||"southwest"===A)){var v=Z.width,r=Z.height,Q=v/m,C=r/l,c=n(Q,C);Z.width=m*c,Z.height=l*c,"northeast"===A?Z.y=s+(l-Z.height):"northwest"===A?(Z.y=s+(l-Z.height),Z.x=q+(m-Z.width)):"southwest"===A&&(Z.x=q+(m-Z.width))}Z.x-=H.x,Z.y-=H.y;var R=Pd(j,Z,K,H);return Z.x=R.x-Z.width/2,Z.y=R.y-Z.height/2,Z},pn=function(i,B,y,P){var c=i.getRotation(),W=B,a=W.x,T=W.y,X=W.width,f=W.height,u={x:a+W.width/2,y:T+W.height/2};P=om(u,P.x-u.x,P.y-u.y,-c),"northwest"===y?W=o(P,{x:a+X,y:T+f}):"north"===y?W=o({x:a,y:P.y},{x:a+X,y:T+f}):"northeast"===y?W=o({x:a,y:P.y},{x:P.x,y:T+f}):"west"===y?W=o({x:P.x,y:T},{x:a+X,y:T+f}):"east"===y?W=o({x:a,y:T},{x:P.x,y:T+f}):"southwest"===y?W=o({x:P.x,y:T},{x:a+X,y:P.y}):"south"===y?W=o({x:a,y:T},{x:a+X,y:P.y}):"southeast"===y&&(W=o({x:a,y:T},P)),i.setRect(W),W.x-=u.x,W.y-=u.y;var b=Pd(i,W,c,u);i.p(b.x,b.y)},Bj=function(c,k,I,M,x,h,H,O){var V=j;h?(V=om(j,x.x-k.x,x.y-k.y,-I),V.x-=H.x,V.y-=H.y):V=om(j,x.x-k.x,x.y-k.y,0);var u={x:k.x+V.x,y:k.y+V.y};O&&(u=O(u.x,u.y)),u.e=c.getPoints().get(M).e,c.setPoint(M,u);var F=c.getWidth(),$=c.getHeight(),f=c.p().x-F/2,Y=c.p().y-$/2;f-=k.x,Y-=k.y;var a=Pd(c,{x:f,y:Y,width:F,height:$},I,k);c.p(a.x,a.y)},el=function(D,Q,b){var K,E;if(D instanceof m?(K=D.getPoints(),E=D.getSegments()):D instanceof v&&"points"===D.s("edge.type")&&(K=D.s("edge.points"),E=D.s("edge.segments"),K=Dh(Q,K)),E&&E.size()||(E=bm(K)),D instanceof m&&D.isClosePath()&&E.indexOf(5)<0&&(E=new e(E._as),E.add(5)),E)for(var B=-1,X=0;X<E.size();X++){if(X===b)return B;var g=E.get(X);1===g?B+=1:2===g?B+=1:3===g?B+=2:4===g&&(B+=3)}},gs=function(u,s,S){var B,e;if(u instanceof m?(B=u.getPoints(),e=u.getSegments()):u instanceof v&&"points"===u.s("edge.type")&&(B=u.s("edge.points"),e=u.s("edge.segments"),B=Dh(s,B)),e&&e.size()||(e=bm(B)),e)for(var E=-1,g=0;g<e.size();g++){var i=e.get(g);if(1===i?E+=1:2===i?E+=1:3===i?E+=2:4===i&&(E+=3),E===S)return g}},Nn=function(j,z){var S=[j[0]-z[0],j[1]-z[1],j[2]-z[2]];return S},ee=function(){var M=new A(16);return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M},_i=function(N,L){var $=N[0],o=N[1],n=N[2];return N[0]=L[0]*$+L[4]*o+L[8]*n+L[12],N[1]=L[1]*$+L[5]*o+L[9]*n+L[13],N[2]=L[2]*$+L[6]*o+L[10]*n+L[14],N},pi=function(P,M){if(M){var J=d(M),i=Q(M),z=P[0],s=P[1],H=P[2],Z=P[3],j=P[8],q=P[9],l=P[10],A=P[11];P[0]=z*i-j*J,P[1]=s*i-q*J,P[2]=H*i-l*J,P[3]=Z*i-A*J,P[8]=z*J+j*i,P[9]=s*J+q*i,P[10]=H*J+l*i,P[11]=Z*J+A*i}},fe=function(d,Q){for(var S=d.s("grid.row.count"),b=d.s("grid.column.count"),i=0;S>i;i++)for(var E=0;b>E;E++){var P=d.getCellRect(i,E);if(p(P,Q))return{rowIndex:i,columnIndex:E,rect:P,grid:d}}return null},_m=function(Z,N,c,r,$,M){var W={},t=c-Z,p=r-N,E=z.sqrt(t*t+p*p),P=t/E,d=p/E,w=(-Z+$)*P+(-N+M)*d;return 0>=w?(W.x=Z,W.y=N):w>=E?(W.x=c,W.y=r):(W.x=Z+w*P,W.y=N+w*d),t=$-W.x,p=M-W.y,W.z=z.sqrt(t*t+p*p),W},Qc=function(f,o){var m,G,Y,g,h,B,x,e,b=f.getPoints(),M=f.getSegments(),t=f.p(),E=f.getRotation();if(!M||!(M.indexOf(3)>0||M.indexOf(4)>0)){for(e=0;e<=b.size()-1;e++)if(e===b.size()-1?(h=b.get(0),g=b.get(e)):(g=b.get(e),h=b.get(e+1)),g=om(t,g.x-t.x,g.y-t.y,E),h=om(t,h.x-t.x,h.y-t.y,E),B=_m(g.x,g.y,h.x,h.y,o.x,o.y),x=B.z,x<(f.s("shape.border.width")||10)){G=g,Y=h,m=e;break}if(m!=j){var F=_m(G.x,G.y,Y.x,Y.y,o.x,o.y),s=y(G,F);return{attachIndex:m,attachOffset:s}}}},Oo=function(s){for(var R=s._data,f=R.p(),F=R.getRotation(),B=R.getPoints(),H=j,n=[],J=0;J<B.size();J++)H=B.get(J),n.push(om(f,H.x-f.x,H.y-f.y,F));s._55O.$15l=n};s.setImage("xeditinteractor_parentIcon",$),s.setImage("xeditinteractor_hostIcon",Z),s.setImage("xeditinteractor_edgeIcon",a),s.setImage("xeditinteractor_removeIcon",Yq),s.setImage("xeditinteractor_sourceIcon",Uq),s.setImage("xeditinteractor_targetIcon",Fb),s.setImage("xeditinteractor_elevationIcon",Vq),s.setImage("xeditinteractor_tallIcon",kg),N._editPointSize=O?24:9,N._edgeHelpers=["parent","remove","source","target"],N._leftTopHelpers=["parent"],N._rightTopHelpers=["host"],N._leftBottomHelpers=["edge"],N._rightBottomHelpers=["remove"],ud=ud.concat(ud).concat(ud),P._79o=function(){var r=this,H=r.gv,b=H.getZoom(),K=H._editInteractor,N=rk.call(r);if(!N)return null;var T=Xc(r,!0),f=T[0],l=T[1],e={x:N.x,y:N.y,width:N.width,height:N.height},g=o(f,l);if(K instanceof h.XEditInteractor){e=L(e,g);var A=r._55O,F=H.getEditPointSize()/b+2,W=0;A&&A._43O&&(W+=F/2,E(e,W))}return e},P._47O=function(P){var W=this,S=W.gv,x=S._editInteractor;x instanceof h.XEditInteractor||vs.call(W,P)},P.rectIntersects=function(t){var l=this,Z=l._data,B=l.gv,Q=B.getZoom(),u=l._55O,c=B._editInteractor;if(c instanceof h.XEditInteractor&&B.isEditable(Z)&&u&&u._43O&&"points"===Z.s("edge.type")){var o=Z.s("edge.points"),U=Z.s("edge.segments");o=Dh(l,o),U&&U.size()||(U=bm(o)),o=o._as;var M=!1,R=O?5:1,V=t.x+R,C=t.y+R,k={x:V,y:C};if(c._edge===Z&&c._hoverSegmentIndex>=0){var I=B._editInteractor._hoverSegmentIndex,m=U.get(I),x=el(Z,l,I),$=j;if(x!=j&&x>=0){var X=o[x],S=B.getSegmentHoverWidth()/Q;if(2===m||1===m){var q=o[x+1];$=md(new bs(X.x,X.y),new bs(q.x,q.y),new bs(k.x-S,k.y-S),new bs(k.x+2*S,k.y+2*S)),$.$62l===w&&(M=!0)}else if(3===m){var F=o[x+1],q=o[x+2];$=mf(new bs(X.x,X.y),new bs(F.x,F.y),new bs(q.x,q.y),new bs(k.x-S,k.y-S),new bs(k.x+2*S,k.y+2*S)),$.$62l===w&&(M=!0)}else if(4===m){var D=o[x+1],Y=o[x+2];q=o[x+3],$=Oj(new bs(X.x,X.y),new bs(D.x,D.y),new bs(Y.x,Y.y),new bs(q.x,q.y),new bs(k.x-S,k.y-S),new bs(k.x+2*S,k.y+2*S)),$.$62l===w&&(M=!0)}}}if(M)return!0}return j},D._47O=function(i){var q=this,U=q.gv,F=U._editInteractor;F instanceof h.XEditInteractor||fc.call(q,i)},D.rectIntersects=function(E){var t=this,k=t._data,v=t.gv,i=v.getZoom(),Y=t._55O,d=v._editInteractor;if(d instanceof h.XEditInteractor&&v.isEditable(k)&&Y&&Y._43O){var s=Y.$15l,K=!1,Z=O?5:1,T=E.x+Z,M=E.y+Z,I={x:T,y:M};if(s&&s.length===k.getPoints().size()||(Oo(t),s=Y.$15l),d._shape===k&&d._hoverSegmentIndex>=0){var e=k.getSegments();e&&e.size()||(e=bm(s));var f=v._editInteractor._hoverSegmentIndex,g=e.get(f),x=el(k,t,f),J=j;if(x!=j&&x>=0){var _=s[x],F=v.getSegmentHoverWidth()/i;if(2===g||1===g){var r=s[x+1];J=md(new bs(_.x,_.y),new bs(r.x,r.y),new bs(I.x-F,I.y-F),new bs(I.x+2*F,I.y+2*F)),J.$62l===w&&(K=!0)}else if(3===g){var X=s[x+1],r=s[x+2];J=mf(new bs(_.x,_.y),new bs(X.x,X.y),new bs(r.x,r.y),new bs(I.x-F,I.y-F),new bs(I.x+2*F,I.y+2*F)),J.$62l===w&&(K=!0)}else if(4===g){var Q=s[x+1],L=s[x+2];r=s[x+3],J=Oj(new bs(_.x,_.y),new bs(Q.x,Q.y),new bs(L.x,L.y),new bs(r.x,r.y),new bs(I.x-F,I.y-F),new bs(I.x+2*F,I.y+2*F)),J.$62l===w&&(K=!0)}}}if(K)return!0}return j},D._48O=function(){var t=this,V=t.gv,D=V._editInteractor;D instanceof h.XEditInteractor?(f._48O.call(t),t._55O._43O&&Oo(t)):Jo.call(t)},D._79o=function(){var U=this,K=U.gv,S=K.getZoom(),A=K._editInteractor,r=bd.call(U);if(r){var T={x:r.x,y:r.y,width:r.width,height:r.height};if(A instanceof h.XEditInteractor){var C=U._55O,P=K.getEditPointSize()/S+2,u=0;C&&C._43O&&(u+=P/2,E(T,u))}return T}},f._47O=function(q){var n=this,A=n.gv,x=A._editInteractor;if(x instanceof h.XEditInteractor);else{var b=n._55O;b&&b._98o&&zb.call(n,q)}},f.getSelectWidth=function(){var e=this,K=e.gv,A=K._editInteractor,U=e._data;return K.isEditable(U)&&A instanceof h.XEditInteractor?0:qh.call(e)},f._80o=function(r){var Z=this,i=Z.gv._editInteractor;if(Gh.call(Z,r),i&&i._debug){r.save(),r.beginPath(),r.lineWidth=1,r.strokeStyle="green";var b=Z._79o();b&&(r.rect(b.x,b.y,b.width,b.height),r.stroke()),r.restore()}},D._80o=function(S){var X=this,C=X.gv._editInteractor;if(Hn.call(X,S),C&&C._debug){S.save(),S.beginPath(),S.lineWidth=1,S.strokeStyle="green";var o=X._79o();S.rect(o.x,o.y,o.width,o.height),S.stroke(),S.restore()}},f._48O=function(){var N=this,R=N.gv,b=N._data,Z=R._editInteractor,O=N._55O,f=b.p(),p=b.getRotation();if(Z instanceof h.XEditInteractor){if(O._42O){var J=wp(f,b.getWidth(),b.getHeight(),p),C=J[0],k=J[1],E=J[2],X=J[3],y=J[4],Q=J[5],G=J[6],K=J[7];O.$45l=[C,y,k,Q,X,G,E,K]}}else mj.call(N)},N.getResizeMode=function(){return this.$25l||"normal"},N.setResizeMode=function(K){var E=this.$25l;this.$25l=K,this.fp("resizeMode",E,K)},N.getSnapAngle=function(){return this.$26l||Math.PI/36},N.setSnapAngle=function(k){var h=this.$26l;this.$26l=k,this.fp("snapAngle",h,k)},N.getSnapSpacing=function(){return this.$27l},N.setSnapSpacing=function(J){var q=this.$27l;this.$27l=J,this.fp("snapSpacing",q,J)},N.getPointSnapSpacing=function(){return this._pointSnapSpacing},N.setPointSnapSpacing=function(k){var l=this._pointSnapSpacing;this._pointSnapSpacing=k,this.fp("pointSnapSpacing",l,k)},N.setHelperEditableFunc=function(D){var i=this._helperEditableFunc;this._helperEditableFunc=D,this.fp("helperEditableFunc",i,D)},N.getHelperEditableFunc=function(){return this._helperEditableFunc},N.setLeftTopHelpers=function(l){var d=this._leftTopHelpers;this._leftTopHelpers=l,this.fp("leftTopHelpers",d,l)},N.getLeftTopHelpers=function(){return this._leftTopHelpers},N.setLeftTopHelpersAlign=function(r){var p=this._leftTopHelpersAlign;this._leftTopHelpersAlign=r,this.fp("leftTopHelpersAlign",p,r)},N.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},N.setRightTopHelpers=function(i){var B=this._rightTopHelpers;this._rightTopHelpers=i,this.fp("rightTopHelpers",B,i)},N.getRightTopHelpers=function(){return this._rightTopHelpers},N.setRightTopHelpersAlign=function(X){var P=this._rightTopHelpersAlign;this._rightTopHelpersAlign=X,this.fp("rightTopHelpersAlign",P,X)},N.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},N.setLeftBottomHelpers=function(F){var u=this._leftBottomHelpers;this._leftBottomHelpers=F,this.fp("leftBottomHelpers",u,F)},N.getLeftBottomHelpers=function(){return this._leftBottomHelpers},N.setLeftBottomHelpersAlign=function(V){var i=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=V,this.fp("leftBottomHelpersAlign",i,V)},N.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},N.setRightBottomHelpers=function(d){var h=this._rightBottomHelpers;this._rightBottomHelpers=d,this.fp("rightBottomHelpers",h,d)},N.getRightBottomHelpers=function(){return this._rightBottomHelpers},N.setRightBottomHelpersAlign=function(l){var c=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=l,this.fp("rightBottomHelpersAlign",c,l)},N.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},N.setEdgeHelpers=function(H){var Q=this._edgeHelpers;this._edgeHelpers=H,this.fp("edgeHelpers",Q,H)},N.getEdgeHelpers=function(){return this._edgeHelpers},N.isHelperEditable=function(j,r){return j instanceof v&&("host"===r||"edge"===r||"elevation"===r||"tall"===r)?!1:j instanceof X&&("source"===r||"target"===r)?!1:"pointElevation"===r?this._helperEditableFunc?this._helperEditableFunc(j,r):!1:this._helperEditableFunc?this._helperEditableFunc(j,r):!0},N.getEditHelperSize=function(){return this._editHelperSize||(O?28:16)},N.setEditHelperSize=function(W){var y=this._editHelperSize;this._editHelperSize=W,this.fp("editHelperSize",y,W)},N.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},N.setEditRectBorderColor=function(v){var P=this.$28l;this.$28l=v,this.fp("editRectBorderColor",P,v)},N.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},N.setNodeBorderColor=function(i){var c=this.$29l;this.$29l=i,this.fp("nodeBorderColor",c,i)},N.getEditRectBorderStyle=function(){return this.$30l||"dashed"},N.setEditRectBorderStyle=function(r){var S=this.$30l;this.$30l=r,this.fp("editRectBorderStyle",S,r)},N.getControlPointBackground=function(){return this.$31l||"#ff0"},N.setControlPointBackground=function(N){var G=this.$31l;this.$31l=N,this.fp("controlPointBackground",G,N)},N.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},N.setControlPointBorderColor=function(o){var t=this.$32l;this.$32l=o,this.fp("controlPointBorderColor",t,o)},N.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},N.setJoinPointBackground=function(s){var C=this.$33l;this.$33l=s,this.fp("joinPointBackground",C,s)},N.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},N.setJoinPointBorderColor=function(W){var D=this.$34l;this.$34l=W,this.fp("joinPointBorderColor",D,W)},N.getDirectionLineColor=function(){return this.$35l||"#888"},N.setDirectionLineColor=function(X){var g=this.$35l;this.$35l=X,this.fp("directionLineColor",g,X)},N.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},N.setSegmentHoverColor=function(w){var Y=this.$36l;this.$36l=w,this.fp("segmentHoverColor",Y,w)},N.getSegmentHoverWidth=function(){return this.$22l||(O?16:8)},N.setSegmentHoverWidth=function(v){var L=this.$22l;this.$22l=v,this.fp("segmentHoverWidth",L,v)},N.getSnapPointBorderColor=function(){return this.$38l||"#f00"},N.setSnapPointBorderColor=function(l){var Z=this.$38l;this.$38l=l,this.fp("snapPointBorderColor",Z,l)},N.getEditRectPadding=function(){return this.$39l!=j?this.$39l:6},N.setEditRectPadding=function(Z){var V=this.$39l;this.$39l=Z,this.fp("editRectPading",V,Z)},N.isRectEditable=function(n){var w=this,H=w._editInteractor;return H instanceof h.XEditInteractor?w._rectEditableFunc?w._rectEditableFunc(n):!0:pc.call(w,n)},N.isPointEditable=function(A){var J=this,d=J._editInteractor;return d instanceof h.XEditInteractor?J._pointEditableFunc?J._pointEditableFunc(A):!0:Ne.call(J,A)},N.validateImpl=function(){var J=this,w=J.$14l,E=J._editInteractor;if(w){var g=J.getWidth(),Y=J.getHeight();(g!==w.clientWidth||Y!==w.clientHeight)&&(E&&(E._68I=1),B.setCanvas(w,g,Y),J._32I=1)}di.call(this)},N.isEditable=function(N){var J=Wr.call(this,N),L=this._editInteractor;if(L instanceof h.XEditInteractor&&N instanceof v){if(!N.s("2d.editable"))return!1;var g=this.getEditableFunc();J=g?g(N):!0}return J},N._42=function(s,f){var V=this,F=V._editInteractor;Mp.call(V,s,f),F instanceof h.XEditInteractor&&F._68I&&F._42()},N.isSnapPoint=function(){return!0};var Ze=function(m){arguments.length>0&&this.$58l(m)},Fo=Ze.prototype;Fo.$58l=function(n){this.$62l=n,this.points=new Array},Fo.$56l=function(p){this.points.push(p)},Fo.$57l=function(P){this.points=this.points.concat(P)};var bs=function(o,P){arguments.length>0&&this.$58l(o,P)},wh=bs.prototype;wh.$58l=function(n,$){this.x=n,this.y=$},wh.add=function(k){return new bs(this.x+k.x,this.y+k.y)},wh.addEquals=function(j){return this.x+=j.x,this.y+=j.y,this},wh.$55l=function(X){return new bs(this.x*X,this.y*X)},wh.eq=function(J){return this.x==J.x&&this.y==J.y},wh.lt=function(V){return this.x<V.x&&this.y<V.y},wh.lte=function(c){return this.x<=c.x&&this.y<=c.y},wh.gt=function(y){return this.x>y.x&&this.y>y.y},wh.gte=function(E){return this.x>=E.x&&this.y>=E.y},wh.lerp=function(P,j){return new bs(this.x+(P.x-this.x)*j,this.y+(P.y-this.y)*j)},wh.distanceFrom=function(x){var t=this.x-x.x,F=this.y-x.y;return l(t*t+F*F)},wh.min=function(r){return new bs(n(this.x,r.x),n(this.y,r.y))},wh.max=function(W){return new bs(G(this.x,W.x),G(this.y,W.y))},wh.toString=function(){return this.x+","+this.y};var jk=function(){this.$58l(arguments)},Lo=jk.prototype;jk.TO=1e-6,jk.AC=6,Lo.$58l=function(M){this.co=new Array;for(var j=M.length-1;j>=0;j--)this.co.push(M[j])},Lo.$55l=function(v){for(var X=new jk,W=0;W<=this.$50l()+v.$50l();W++)X.co.push(0);for(var W=0;W<=this.$50l();W++)for(var S=0;S<=v.$50l();S++)X.co[W+S]+=this.co[W]*v.co[S];return X},Lo.$59l=function(){for(var I=this.$50l();I>=0&&x(this.co[I])<=jk.TO;I--)this.co.pop()},Lo.$50l=function(){return this.co.length-1},Lo.$51l=function(){var X;switch(this.$59l(),this.$50l()){case 0:X=new Array;break;case 1:X=this.$52l();break;case 2:X=this.$53l();break;case 3:X=this.$54l();break;case 4:X=this.$63l();break;default:X=new Array}return X},Lo.$52l=function(){var r=new Array,b=this.co[1];return 0!=b&&r.push(-this.co[0]/b),r},Lo.$53l=function(){var y=new Array;if(2==this.$50l()){var $=this.co[2],J=this.co[1]/$,m=this.co[0]/$,F=J*J-4*m;if(F>0){var n=l(F);y.push(.5*(-J+n)),y.push(.5*(-J-n))}else 0==F&&y.push(.5*-J)}return y},Lo.$63l=function(){var z=new Array;if(4==this.$50l()){var t=this.co[4],j=this.co[3]/t,Z=this.co[2]/t,i=this.co[1]/t,S=this.co[0]/t,J=new jk(1,-Z,j*i-4*S,-j*j*S+4*Z*S-i*i).$54l(),Q=J[0],g=j*j/4-Z+Q;if(x(g)<=jk.TO&&(g=0),g>0){var $=l(g),d=3*j*j/4-$*$-2*Z,f=(4*j*Z-8*i-j*j*j)/(4*$),W=d+f,v=d-f;if(x(W)<=jk.TO&&(W=0),x(v)<=jk.TO&&(v=0),W>=0){var c=l(W);z.push(-j/4+($+c)/2),z.push(-j/4+($-c)/2)}if(v>=0){var c=l(v);z.push(-j/4+(c-$)/2),z.push(-j/4-(c+$)/2)}}else if(0>g);else{var f=Q*Q-4*S;if(f>=-jk.TO){if(0>f&&(f=0),f=2*l(f),d=3*j*j/4-2*Z,d+f>=jk.TO){var n=l(d+f);z.push(-j/4+n/2),z.push(-j/4-n/2)}if(d-f>=jk.TO){var n=l(d-f);z.push(-j/4+n/2),z.push(-j/4-n/2)}}}}return z},Lo.$54l=function(){var A=new Array;if(3==this.$50l()){var h=this.co[3],N=this.co[2]/h,o=this.co[1]/h,e=this.co[0]/h,B=(3*o-N*N)/3,M=(2*N*N*N-9*o*N+27*e)/27,V=N/3,X=M*M/4+B*B*B/27,m=M/2;if(x(X)<=jk.TO&&(X=0),X>0){var s,a,f=l(X);s=-m+f,a=s>=0?C(s,1/3):-C(-s,1/3),s=-m-f,s>=0?a+=C(s,1/3):a-=C(-s,1/3),A.push(a-V)}else if(0>X){var Z=l(-B/3),T=H(l(-X),-m)/3,k=Q(T),u=d(T),D=l(3);A.push(2*Z*k-V),A.push(-Z*(k+D*u)-V),A.push(-Z*(k-D*u)-V)}else{var s;s=m>=0?-C(m,1/3):C(-m,1/3),A.push(2*s-V),A.push(-s-V)}}return A};var zf=function(G,K){arguments.length>0&&this.$58l(G,K)},Vo=zf.prototype;Vo.$58l=function(X,N){this.x=X,this.y=N},Vo.length=function(){return l(this.x*this.x+this.y*this.y)},Vo.$60l=function(K){return this.x*K.x+this.y*K.y};var Lf=function($,H,M,x){var k,p=(x.x-M.x)*($.y-M.y)-(x.y-M.y)*($.x-M.x),m=(H.x-$.x)*($.y-M.y)-(H.y-$.y)*($.x-M.x),s=(x.y-M.y)*(H.x-$.x)-(x.x-M.x)*(H.y-$.y);if(0!=s){var C=p/s,F=m/s;C>=0&&1>=C&&F>=0&&1>=F?(k=new Ze(w),k.points.push(new bs($.x+C*(H.x-$.x),$.y+C*(H.y-$.y)))):k=new Ze(b)}else k=0==p||0==m?new Ze("C"):new Ze("P");return k},vi=function(e,c,u,p,C){var h,A,z,t,$,d,f,i=p.min(C),E=p.max(C),G=new Ze(b);h=c.$55l(-2),z=e.add(h.add(u)),h=e.$55l(-2),A=c.$55l(2),t=h.add(A),$=new bs(e.x,e.y),f=new zf(p.y-C.y,C.x-p.x),d=p.x*C.y-C.x*p.y;for(var M=new jk(f.$60l(z),f.$60l(t),f.$60l($)+d).$51l(),r=0;r<M.length;r++){var H=M[r];if(H>=0&&1>=H){var k=e.lerp(c,H),x=c.lerp(u,H),L=k.lerp(x,H);p.x==C.x?i.y<=L.y&&L.y<=E.y&&(G.$62l=w,G.$56l(L)):p.y==C.y?i.x<=L.x&&L.x<=E.x&&(G.$62l=w,G.$56l(L)):L.gte(i)&&L.lte(E)&&(G.$62l=w,G.$56l(L))}}return G},mf=function(T,J,s,r,x){var q=r.min(x),U=r.max(x),K=new bs(U.x,q.y),k=new bs(q.x,U.y),u=vi(T,J,s,q,K),Q=vi(T,J,s,K,U),D=vi(T,J,s,U,k),j=vi(T,J,s,k,q),l=new Ze(b);return l.$57l(u.points),l.$57l(Q.points),l.$57l(D.points),l.$57l(j.points),l.points.length>0&&(l.$62l=w),l},Oq=function(H,T,O,u,D,S){var M,E,W,q,$,U,I,L,R,h,_=D.min(S),v=D.max(S),F=new Ze(b);M=H.$55l(-1),E=T.$55l(3),W=O.$55l(-3),q=M.add(E.add(W.add(u))),$=new zf(q.x,q.y),M=H.$55l(3),E=T.$55l(-6),W=O.$55l(3),q=M.add(E.add(W)),U=new zf(q.x,q.y),M=H.$55l(-3),E=T.$55l(3),W=M.add(E),I=new zf(W.x,W.y),L=new zf(H.x,H.y),h=new zf(D.y-S.y,S.x-D.x),R=D.x*S.y-S.x*D.y;for(var n=new jk(h.$60l($),h.$60l(U),h.$60l(I),h.$60l(L)+R).$51l(),j=0;j<n.length;j++){var k=n[j];if(k>=0&&1>=k){var A=H.lerp(T,k),B=T.lerp(O,k),t=O.lerp(u,k),V=A.lerp(B,k),G=B.lerp(t,k),o=V.lerp(G,k);D.x==S.x?_.y<=o.y&&o.y<=v.y&&(F.$62l=w,F.$56l(o)):D.y==S.y?_.x<=o.x&&o.x<=v.x&&(F.$62l=w,F.$56l(o)):o.gte(_)&&o.lte(v)&&(F.$62l=w,F.$56l(o))}}return F},Oj=function(n,s,y,A,H,M){var S=H.min(M),v=H.max(M),D=new bs(v.x,S.y),W=new bs(S.x,v.y),R=Oq(n,s,y,A,S,D),B=Oq(n,s,y,A,D,v),C=Oq(n,s,y,A,v,W),T=Oq(n,s,y,A,W,S),z=new Ze(b);return z.$57l(R.points),z.$57l(B.points),z.$57l(C.points),z.$57l(T.points),z.points.length>0&&(z.$62l=w),z},md=function(j,s,x,c){var K=x.min(c),B=x.max(c),t=new bs(B.x,K.y),a=new bs(K.x,B.y),Q=Lf(K,t,j,s),d=Lf(t,B,j,s),$=Lf(B,a,j,s),R=Lf(a,K,j,s),n=new Ze(b);return n.$57l(Q.points),n.$57l(d.points),n.$57l($.points),n.$57l(R.points),n.points.length>0&&(n.$62l=w),n},Yr=h.XEditInteractor=function(t){var l=this,S=l._view=document.createElement("canvas");S.className="editCanvas",S.style.position="absolute",Yr.superClass.constructor.call(l,t)};s.def(Yr,h.Interactor,{ms_edit:1,setUp:function(){var c=this,H=c.gv,t=H.getView(),V=c._view;Yr.superClass.setUp.call(c),H.setEditInteractor(c),H.$14l=V,H._79O?t.insertBefore(V,H._79O):t.appendChild(V);var $=c.$49l=c.$11l.bind(c);H.dm().md($),H.sm().ms($),H.mp($)},tearDown:function(){var o=this,h=o.gv,W=h.getView(),Q=o.$49l;Yr.superClass.tearDown.call(o),h.setEditInteractor(j),h.$14l=j,W.removeChild(o._view),h.dm().umd(Q),h.sm().ums(Q),h.ump(Q)},clear:function(){var l=this,S=l.gv;delete l._hoverSegmentIndex,delete l._edge,delete l._shape,delete S._editing,delete l.$10l,delete l.$13l,delete l.$9l,delete l._removePointIndex,delete l._lp,l.$12l="",delete l.$40l,delete l.$67l,delete l.$72l,delete l.$73l,delete l.$75l,delete l.$1l,delete l.$3l,delete l.$2l,delete l.$92l,delete l.$93l,delete l.$94l,l.clearDragging()},handle_keydown:function(L){this.$48l!==L.shiftKey&&(this.$48l=L.shiftKey,this.handle_mousemove(L,M,!0))},handle_keyup:function(x){this.$48l!==x.shiftKey&&(this.$48l=x.shiftKey,this.handle_mousemove(x,M,!0))},handle_touchstart:function(X){this.handle_mousemove(X),this.handle_mousedown(X)},handle_mousedown:function(e){g(e);var P=this,z=P.$13l,F=P.gv,$=F.dm(),q=F.sm(),x=F.getZoom(),W=F.lp(e),f=s.isDoubleClick(e),L=s.isLeftButton(e),B=P.$7l,n=P._shape,O=P._hoverSegmentIndex,o=P._edge,p=P.$87l,l=P.$88l,M=function(){P._68I||p===P.$87l&&l===P.$88l||P.$43l()};if(7!==P.$67l&&(delete P.$87l,delete P.$88l),L&&(n||o)&&O>=0&&f&&(n&&q.contains(n)||o&&q.contains(o))){var G=Fp.call(P,n||o,O,W);return P.addShapePoint(n||o,O,G),u(function(){P.handle_mousemove(e)},40),void 0}if(L&&(n||o)&&P._removePointIndex>=0&&f)return P.removeShapePoint(),P.$5l=1,u(function(){P.handle_mousemove(e)},40),void 0;if(!L||!F._editing)return M(),void 0;if(n&&z>=0){var N=n.getPoints().get(z),T=n.p(),i=om(T,N.x-T.x,N.y-T.y,-B+n.getRotation());h=om(T,W.x-T.x,W.y-T.y,-B),P.$24l={x:h.x-i.x,y:h.y-i.y},P.startDragging(e),$.beginTransaction(),P.fi({kind:"beginEditPoint",event:e,data:n,index:z}),P.$88l=z,P.$87l=n}else if(P.$10l){var J=F.sm().getSelection(),d=P.$6l,C=P.$1l={},U=P.$3l={},D=P.$16l[_[P.$10l]],V={x:d.x,y:d.y},Y={x:d.x+d.width/2,y:d.y+d.height/2};P.$24l={x:W.x-D.x/x,y:W.y-D.y/x},P.$2l=R(P.$8l),P.$4l=R(d),J.each(function(i){if(i instanceof X){var I=i.p(),S=i.getWidth(),f=i.getHeight(),$=om(Y,I.x-Y.x,I.y-Y.y,-B);C[i.getId()]={x:I.x-S/2,y:I.y-f/2,width:S,height:f},U[i.getId()]={x:($.x-V.x)/d.width,y:($.y-V.y)/d.height}}}),P.startDragging(e),$.beginTransaction(),P.fi({kind:"beginEditRect",event:e,direction:P.$10l})}else if(o&&z>=0){var A=Dh(F.getDataUI(o),o.s("edge.points")),N=A.get(z);P.$24l={x:W.x-N.x,y:W.y-N.y},P.startDragging(e),$.beginTransaction(),P.fi({kind:"beginEditPoint",event:e,data:o,index:z}),P.$88l=z,P.$87l=o}else if(P.$40l){var d=P.$6l,Y={x:d.x+d.width/2,y:d.y+d.height/2},Q=R(P.$23l);Q.x/=x,Q.y/=x;var k=om(Y,Q.x-Y.x,Q.y-Y.y,-B),h=om(Y,W.x-Y.x,W.y-Y.y,-B);P.$24l={x:h.x-k.x,y:h.y-k.y},P.startDragging(e),$.beginTransaction(),P.fi({kind:"beginEditRotation",event:e,data:P._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(P.$67l)>=0){var r=P.$67l;(7===r||8===r||9===r)&&$.beginTransaction(),P.startDragging(e)}else if(P.$71l&&f&&P.$79l(P.$71l,W)){var I=q.toSelection();$.beginTransaction(),I.each(function(U){$.remove(U)}),$.endTransaction()}M()},$11l:function(){var G=this,A=G.gv;A._editing&&(G.$13l==j||G._shape==j&&G._edge==j)&&(G.$73l==j||1!==G.$67l&&5!==G.$67l&&6!==G.$67l)||(G.$5l=1),G._68I=1},$46l:function(T){var S=this,j=S.gv,Q=j.lp(T),W=[];return dc(j,function(K){var t=j.getDataUI(K);if(t){var V=t._79o();p(V,Q)&&W.push(K)}}),W},$47l:function(j){var R=this,X=R.$13l,i=R.gv.dm();R.$10l?(R.fi({kind:"endEditRect",event:j,direction:R.$10l}),i.endTransaction()):R._shape&&X>=0?(R.fi({kind:"endEditPoint",event:j,data:R._shape,index:X}),i.endTransaction()):R._edge&&X>=0?(R.fi({kind:"endEditPoint",event:j,data:R._edge,index:X}),i.endTransaction()):R.$23l&&R.$40l&&(R.fi({kind:"endEditRotation",event:j}),i.endTransaction())},handleWindowTouchEnd:function(f){this.handleWindowMouseUp(f)},handleWindowMouseUp:function(C){var S=this,K=S.gv,h=K.dm(),L=S._shape,Q=S._edge,Z=S.$13l,k=S.$40l,o=S.$9l,B=S.$10l,u=S.$67l;if((L||Q)&&Z>=0&&o>=0){var z,R;if(L){var N=L.p(),E=L.getRotation();z=L.getPoints(),R=z.get(o),Bj(L,N,E,Z,R,!1)}else if(z=Dh(K.getDataUI(Q),Q.s("edge.points"),!0),R=z.get(o),0===Z){var A=z.get(0);Q.s("edge.source.offset.x",R.x-A.x),Q.s("edge.source.offset.y",R.y-A.y)}else if(Z===z.size()-1){var T=z.get(z.size()-1);Q.s("edge.target.offset.x",R.x-T.x),Q.s("edge.target.offset.y",R.y-T.y)}else"points"===Q.s("edge.type")&&(z.set(Z,R),Q.s("edge.points",os(z)))}S.$47l(C);var b=S.$73l;1===u?(h.beginTransaction(),b?K.sm().each(function(y){if(y.setHost&&K.isHelperEditable(y,"host")){y.setHost(b);
var P=S.$75l,r=S.$74l;P&&(y.s("attach.row.index",P.rowIndex),y.s("attach.column.index",P.columnIndex)),r&&(y.s("attach.index",r.attachIndex),y.s("attach.offset",r.attachOffset),y.s("attach.offset.relative",!1),y.s("attach.offset.opposite",!1))}}):K.sm().each(function(B){B.setHost&&K.isHelperEditable(B,"host")&&(B.setHost(j),B.s("attach.row.index",M),B.s("attach.column.index",M),B.s("attach.index",M),B.s("attach.offset",M),B.s("attach.offset.relative",!1),B.s("attach.offset.opposite",!1))}),h.endTransaction()):2===u?(h.beginTransaction(),b?K.sm().each(function($){$.setParent&&K.isHelperEditable($,"parent")&&$.setParent(b)}):K.sm().each(function(i){i.setParent&&K.isHelperEditable(i,"parent")&&i.setParent(j)}),h.endTransaction()):3===u?b&&(h.beginTransaction(),K.sm().each(function(J){if(K.isHelperEditable(J,"edge")&&J instanceof X&&b instanceof X){var L=new F.Edge;h.add(L),L.setSource(J),L.setTarget(b),S.onEdgeCreated&&S.onEdgeCreated(C,L)}}),h.endTransaction()):5===u||6===u?b&&(h.beginTransaction(),K.sm().each(function(c){c instanceof v&&b instanceof X&&(5===u&&K.isHelperEditable(c,"source")?c.setSource(b):6===u&&K.isHelperEditable(c,"source")&&c.setTarget(b))}),h.endTransaction()):(7===u||8===u||9===u)&&h.endTransaction(),(B||k)&&S.$43l(!0),O?(S.clear(),delete S.$64l,S._68I||S.$43l()):(S.handle_mousemove(C,!0),u&&!S._68I&&S.$43l())},handleWindowTouchMove:function(A){this.handleWindowMouseMove(A)},handleWindowMouseMove:function(u){this._78I(u)},handle_mousemove:function(f,I,d){if(!this._pause){if(!d){var r=O?ws(f):f;this.$61l={clientX:r.clientX,clientY:r.clientY}}if(I===!0||!T()){var y=this,E=y.gv,G=!1,g=j;y.clear(),E.sm().size()>0&&(g=E.lp(d?y.$61l:f),G=y._79I(f,g)),G&&(E._editing=1),y.$12l!==y.$65l&&(y.$65l=y.$12l,y.setCursor(y.$12l)),y.$40l!==y.$64l&&(y.$64l=y.$40l,y._68I||y.$43l()),y._hoverSegmentIndex!==y.$66l&&(y.$66l=y._hoverSegmentIndex,y._68I||y.$43l())}}},_78I:function(n){this.autoScroll(n);var C=this,P=C.gv,Z=P.lp(n),U=P.getZoom(),i=C.$13l;if((C._shape||C._edge)&&i>=0){var c,g,D,Q=C._shape,O=C._edge,o=C.$24l,Y=P.getPointSnapSpacing(),d=function(h,C){return Y==j||isNaN(Y)?{x:h,y:C}:{x:t(h/Y)*Y,y:t(C/Y)*Y}};if(Q){c=Q.getPoints();var r=Q.p(),h=Q.getRotation(),L=0;g=om(r,Z.x-r.x,Z.y-r.y,-h),Bj(Q,r,h,i,Z,!0,o,d),C.fi({kind:"betweenEditPoint",event:n,data:Q,index:i})}else if(O){c=Dh(P.getDataUI(O),O.s("edge.points"),!0),Z.x-=o.x,Z.y-=o.y,g=Z;var p,G,J=O.s("edge.offset"),A=c.size(),I=A>2;if(0===i){var k=c.get(0);J&&(k=_g(k,c.get(1),-J,I),Z=_g(Z,c.get(1),-J,I)),p=Z.x-k.x,G=Z.y-k.y,D=d(p,G),O.s("edge.source.offset.x",D.x),O.s("edge.source.offset.y",D.y)}else if(i===A-1){var e=c.get(A-1);J&&(e=_g(e,c.get(A-2),-J,I),Z=_g(Z,c.get(A-2),-J,I)),p=Z.x-e.x,G=Z.y-e.y,D=d(p,G),O.s("edge.target.offset.x",D.x),O.s("edge.target.offset.y",D.y)}else"points"===O.s("edge.type")&&(D=d(Z.x,Z.y),D.e=c.get(i).e,c.set(i,D),O.s("edge.points",os(c)));C.fi({kind:"betweenEditPoint",event:n,data:O,index:i})}if(delete C.$9l,P.isSnapPoint(Q)||P.isSnapPoint(O))for(L=0;L<c.size();L++)if(L!==i){var W=c.get(L);if(y(W,g)<P.getEditPointSize()/U){C.$9l=L;break}}}else if(C.$10l){var o=C.$24l;Z.x-=o.x,Z.y-=o.y;var $=P.sm().getSelection(),R=C.$1l,z=C.$7l,V=C.$10l,w=C.$4l,M=C.$2l,E=P.getEditRectPadding()/U,F=2*E,f=P.getSnapSpacing(),a=f!=j&&!isNaN(f),N=il(M,Z,V,z,2*E,P.getResizeMode(),a,!0),b=C.$6l;if(a){var T=N.width-F,_=N.height-F,B=t(T/f)*f,en=t(_/f)*f,Lj=B-T,uo=en-_;("west"===V||"northwest"===V||"southwest"===V)&&(Lj=-Lj),("north"===V||"northwest"===V||"northeast"===V)&&(uo=-uo),N=il(M,Z,V,z,2*E,P.getResizeMode(),a,!1,Lj,uo)}C.$8l=N,b.x=N.x+E,b.y=N.y+E,b.width=N.width-F,b.height=N.height-F;var ye=N.x+N.width/2,Sf=N.y+N.height/2,eg=b.x,co=b.y,_e=b.width/w.width,qs=b.height/w.height;$.each(function(a){if(a instanceof X&&P.isEditable(a)&&P.isRectEditable(a)){var G=R[a.getId()],E=C.$3l[a.getId()],l={x:G.x+G.width/2,y:G.y+G.height/2},w=0,M=0,Q=V,N=180*x(z-a.getRotation())/q;"northeast"===V?N>=315||45>N?(w=G.width*_e+G.x,M=G.height*(1-qs)+G.y,Q="northeast"):N>=45&&135>N?(w=G.width*(1-qs)+G.x,M=G.height*(1-_e)+G.y,Q="northwest"):N>=135&&225>N?(w=G.width*(1-_e)+G.x,M=G.height*qs+G.y,Q="southwest"):(w=G.width*qs+G.x,M=G.height*_e+G.y,Q="southeast"):"north"===V?N>=315||45>N?(M=G.height*(1-qs)+G.y,Q="north"):N>=45&&135>N?(w=G.width*(1-qs)+G.x,Q="west"):N>=135&&225>N?(M=G.height*qs+G.y,Q="south"):(w=G.width*qs+G.x,Q="east"):"northwest"===V?N>=315||45>N?(w=G.width*(1-_e)+G.x,M=G.height*(1-qs)+G.y,Q="northwest"):N>=45&&135>N?(w=G.width*(1-qs)+G.x,M=G.height*_e+G.y,Q="southwest"):N>=135&&225>N?(w=G.width*_e+G.x,M=G.height*qs+G.y,Q="southeast"):(w=G.width*qs+G.x,M=G.height*(1-_e)+G.y,Q="northeast"):"west"===V?N>=315||45>N?(w=G.width*(1-_e)+G.x,Q="west"):N>=45&&135>N?(M=G.height*_e+G.y,Q="south"):N>=135&&225>N?(w=G.width*_e+G.x,Q="east"):(M=G.height*(1-_e)+G.y,Q="north"):"southwest"===V?N>=315||45>N?(w=G.width*(1-_e)+G.x,M=G.height*qs+G.y,Q="southwest"):N>=45&&135>N?(w=G.width*qs+G.x,M=G.height*_e+G.y,Q="southeast"):N>=135&&225>N?(w=G.width*_e+G.x,M=G.height*(1-qs)+G.y,Q="northeast"):(w=G.width*(1-qs)+G.x,M=G.height*(1-_e)+G.y,Q="northwest"):"east"===V?N>=315||45>N?(w=G.width*_e+G.x,Q="east"):N>=45&&135>N?(M=G.height*(1-_e)+G.y,Q="north"):N>=135&&225>N?(w=G.width*(1-_e)+G.x,Q="west"):(M=G.height*_e+G.y,Q="south"):"south"===V?N>=315||45>N?(M=G.height*qs+G.y,Q="south"):N>=45&&135>N?(w=G.width*qs+G.x,Q="east"):N>=135&&225>N?(M=G.height*(1-qs)+G.y,Q="north"):(w=G.width*(1-qs)+G.x,Q="west"):"southeast"===V&&(N>=315||45>N?(w=G.width*_e+G.x,M=G.height*qs+G.y,Q="southeast"):N>=45&&135>N?(w=G.width*qs+G.x,M=G.height*(1-_e)+G.y,Q="northeast"):N>=135&&225>N?(w=G.width*(1-_e)+G.x,M=G.height*(1-qs)+G.y,Q="northwest"):(w=G.width*(1-qs)+G.x,M=G.height*_e+G.y,Q="southwest"));var g=om(l,w-l.x,M-l.y,a.getRotation());pn(a,G,Q,{x:g.x,y:g.y});var B=eg+b.width*E.x,S=co+b.height*E.y,o={x:B,y:S};o=om({x:ye,y:Sf},o.x-ye,o.y-Sf,z),a.p(o.x,o.y)}}),C.fi({kind:"betweenEditRect",event:n,direction:V})}else if(C.$23l&&C.$40l){var vo=C.$8l,Gh=vo.width,ae=vo.height,r={x:vo.x+Gh/2,y:vo.y+ae/2},o=C.$24l,Be=C.$23l,Uj=Be.x/U-r.x,mq=Be.y/U-r.y,Lh=l(Uj*Uj+mq*mq),Sc=Math.asin(o.x/Lh),qo=P.sm().getSelection(),Bg=K+H(Z.y-r.y,Z.x-r.x)-Sc,Mi=P.getSnapAngle(),Bg=t(Bg/Mi)*Mi;0>Bg&&(Bg+=S);var Pn=Bg-C.$7l,Op=[r.x,0,r.y];qo.each(function(F){if(P.isEditable(F)&&P.isRotationEditable(F)&&P.isVisible(F)){var S=Nn(F.p3(),Op),J=ee();pi(J,-Pn),F.setRotation(F.getRotation()+Pn),_i(S,J),F.p3(Op[0]+S[0],Op[1]+S[1],Op[2]+S[2])}}),C.$7l=Bg,C.fi({kind:"betweenEditRotation",event:n})}else if([1,2,3,5,6].indexOf(C.$67l)>=0)C.$72l=n,C.$78l||(C.$78l=1,u(function(){s.isDragging()&&C.$43l(),delete C.$78l},12));else if(7===C.$67l){if(C.$87l instanceof m){var Q=C.$87l,im=C.$88l,_n=s.clone(Q.getPoints().get(im)),Jh=Z.y-_n.y;_n.e||(_n.e=0),C.$92l||(C.$92l=_n.e),_n.e=C.$92l-Jh,Q.setPoint(im,_n)}else if(C.$87l instanceof v){var O=C.$87l,im=C.$88l,c=Dh(P.getDataUI(O),O.s("edge.points")),_n=c.get(im),Jh=Z.y-_n.y;_n.e||(_n.e=0),C.$92l||(C.$92l=_n.e),_n.e=C.$92l-Jh,c.set(im,_n),O.s("edge.points",os(c))}}else if(8===C.$67l){var qo=P.sm().getSelection(),lo=C.$93l;lo||(lo=C.$93l={}),qo.each(function($){if($.p3){var _=$.p3(),H=lo[$.getId()];H==j&&(H=lo[$.getId()]=_[1]),$.p3([_[0],H-(Z.y-C.$90l.y/U),_[2]])}})}else if(9===C.$67l){var qo=P.sm().getSelection(),dc=C.$94l;dc||(dc=C.$94l={}),qo.each(function(M){if(M.s3){var G=M.s3(),r=dc[M.getId()];r==j&&(r=dc[M.getId()]=G[1]);var q=r-(Z.y-C.$91l.y/U);0>q&&(q=.01),M.s3([G[0],q,G[2]])}})}},$79l:function(g,m){var I=this,Q=I.gv,V=Q.getZoom(),y=Q.getEditHelperSize(),i=g.x/V,h=g.y/V,D=y/V,s=D/2;return p({x:i-s,y:h-s,width:D,height:D},m)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(u,J){for(var k=this,n=k.gv,X=n.getZoom(),T=n.getEditPointSize(),W=T/X,L=W/2,y=k.$46l(u),c=0;c<y.length;c++){var r,M,x=y[c],B=n.getDataUI(x);if(B&&B._55O){var q=B._55O;if(q._43O&&x instanceof v){if(r=x.s("edge.points"),r=Dh(B,r),M=x.s("edge.segments"),M&&M.size()||(M=bm(r)),k.$42l(x,J,r._as,M,"edge"))return!0;if("points"===x.s("edge.type")&&k.$41l(x,J,r._as,M,"edge"))return}if(q._43O&&x instanceof m&&q.$15l&&q.$15l.length===x.getPoints().size()){if(r=q.$15l,M=x.getSegments(),M&&M.size()||(M=bm(r)),k.$42l(x,J,r,M,"shape"))return!0;if(k.$41l(x,J,r,M,"shape"))return}}}if(k.$16l){var r,d=k.$16l,F=d[3].x-d[7].x,K=d[3].y-d[7].y,O=l(F*F+K*K),Q=d[1].x-d[5].x,f=d[1].y-d[5].y,U=l(Q*Q+f*f),e={x:J.x*X,y:J.y*X};if(k._80I(e,0,d[0],"northwest",O,U)||k._80I(e,1,d[1],"north",O,U)||k._80I(e,2,d[2],"northeast",O,U)||k._80I(e,7,d[7],"west",O,U)||k._80I(e,3,d[3],"east",O,U)||k._80I(e,6,d[6],"southwest",O,U)||k._80I(e,5,d[5],"south",O,U)||k._80I(e,4,d[4],"southeast",O,U))return!0}if(k.$23l){var $=k.$23l,b=$.x/X,o=$.y/X;if(p({x:b-L,y:o-L,width:W,height:W},J))return k.$40l=1,k.$12l=k.getHelperCursor("rotation")||"crosshair",!0}return k.$68l&&k.$79l(k.$68l,J)?(k.$67l=1,k.$12l=k.getHelperCursor("host")||"crosshair",!0):k.$69l&&k.$79l(k.$69l,J)?(k.$67l=2,k.$12l=k.getHelperCursor("parent")||"crosshair",!0):k.$70l&&k.$79l(k.$70l,J)?(k.$67l=3,k.$12l=k.getHelperCursor("edge")||"crosshair",!0):k.$71l&&k.$79l(k.$71l,J)?(k.$67l=4,k.$12l=k.getHelperCursor("remove")||"crosshair",!0):k.$82l&&k.$79l(k.$82l,J)?(k.$67l=5,k.$12l=k.getHelperCursor("source")||"crosshair",!0):k.$83l&&k.$79l(k.$83l,J)?(k.$67l=6,k.$12l=k.getHelperCursor("target")||"crosshair",!0):k._pointElevationHelperPoint&&k.$79l(k._pointElevationHelperPoint,J)?(k.$67l=7,k.$12l=k.getHelperCursor("pointElevation")||"crosshair",!0):k.$90l&&k.$79l(k.$90l,J)?(k.$67l=8,k.$12l=k.getHelperCursor("elevation")||"crosshair",!0):k.$91l&&k.$79l(k.$91l,J)?(k.$67l=9,k.$12l=k.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(E,R,Y,u,C,T){var A=this,H=A.gv,f=H.getEditPointSize(),O=f/2,Z=H.sm(),n=H.isDirectionEditable;if(n&&1===Z.size()){var r=Z.ld();if(n=n.bind(H),r instanceof X){if(!n(r,u))return!1;if("east"===u){if(n(r,"northeast")&&n(r,"southeast")&&2*f>=T)return!1}else if("west"===u){if(n(r,"northwest")&&n(r,"southwest")&&2*f>=T)return!1}else if("north"===u){if(n(r,"northwest")&&n(r,"northeast")&&2*f>=C)return!1}else if("south"===u&&n(r,"southwest")&&n(r,"southeast")&&2*f>=C)return!1}}else{if(2*f>=C&&("north"===u||"south"===u))return!1;if(2*f>=T&&("east"===u||"west"===u))return!1}if(p({x:Y.x-O,y:Y.y-O,width:f,height:f},E)){if(A.$10l!==u){var d=180*A.$7l/q,a="";d>=337.5||22.5>d?a="north":d>=22.5&&67.5>d?a="northeast":d>=67.5&&112.5>d?a="east":d>=112.5&&157.5>d?a="southeast":d>=157.5&&202.5>d?a="south":d>=202.5&&247.5>d?a="southwest":d>=247.5&&292.5>d?a="west":d>=292.5&&337.5>d&&(a="northwest");var v=ud.indexOf(a),a=ud[R-(1-v)+8];switch(a){case"northwest":A.$12l="nwse-resize";break;case"northeast":A.$12l="nesw-resize";break;case"southwest":A.$12l="nesw-resize";break;case"southeast":A.$12l="nwse-resize";break;case"north":A.$12l="ns-resize";break;case"east":A.$12l="ew-resize";break;case"south":A.$12l="ns-resize";break;case"west":A.$12l="ew-resize"}A.$10l=u}return!0}return!1},$42l:function(M,d,K,n,r){var j,x=this,b=x.gv,Y=b.getEditPointSize(),e=Y/b.getZoom(),P=-1,C={x:d.x,y:d.y,width:0,height:0},i=function(q){"shape"===r?x._shape=M:x._edge=M,x._removePointIndex=q},o=function(D){"shape"===r?x._shape=M:x._edge=M,x.$13l=D,x.$12l="crosshair"};for(E(C,e/2),P=K.length-1,j=n.size()-1;j>=0;j--){var s=n.get(j);if(1===s||2===s)P-=1;else if(3===s){var u=K[P-1];if(p(C,u))return o(P-1),!0;P-=2}else if(4===s){var z=K[P-1],t=K[P-2];if(p(C,z))return o(P-1),!0;if(p(C,t))return o(P-2),!0;P-=3}}for(P=K.length-1,j=n.size()-1;j>=0;j--){var s=n.get(j),B=K[P];if(p(C,B))return i(P),o(P),!0;1===s||2===s?P-=1:3===s?P-=2:4===s&&(P-=3)}return!1},$41l:function(K,W,z,c,G){var d=this,j=d.gv,Z=-1,F=0,Y={x:W.x,y:W.y,width:0,height:0},r=function(o,R){d._hoverSegmentIndex=R,d._lp=W,"shape"===G?d._shape=K:d._edge=K};for(E(Y,j.getSegmentHoverWidth()/2/j.getZoom()),K instanceof m&&K.isClosePath()&&c.indexOf(5)<0&&(c=new e(c._as),c.add(5));F<c.size();F++){var g=c.get(F);if(1===g){var V=z[Z],o=z[Z+1];if(V){var Q=md(new bs(V.x,V.y),new bs(o.x,o.y),new bs(Y.x,Y.y),new bs(Y.x+Y.width,Y.y+Y.height));if(Q.$62l===w&&Q.points.length>0)return r(Q,F),!0}Z+=1}else if(2===g){var V=z[Z],o=z[Z+1],Q=md(new bs(V.x,V.y),new bs(o.x,o.y),new bs(Y.x,Y.y),new bs(Y.x+Y.width,Y.y+Y.height));if(Q.$62l===w&&Q.points.length>0)return r(Q,F),!0;Z+=1}else if(3===g){var V=z[Z],h=z[Z+1],v=z[Z+2],Q=mf(new bs(V.x,V.y),new bs(h.x,h.y),new bs(v.x,v.y),new bs(Y.x,Y.y),new bs(Y.x+Y.width,Y.y+Y.height));if(Q.$62l===w)return r(Q,F),!0;Z+=2}else if(4===g){var V=z[Z],H=z[Z+1],N=z[Z+2],v=z[Z+3],Q=Oj(new bs(V.x,V.y),new bs(H.x,H.y),new bs(N.x,N.y),new bs(v.x,v.y),new bs(Y.x,Y.y),new bs(Y.x+Y.width,Y.y+Y.height));if(Q.$62l===w)return r(Q,F),!0;Z+=3}else if(5===g){var V=z[Z],o=z[0];if(V){var Q=md(new bs(V.x,V.y),new bs(o.x,o.y),new bs(Y.x,Y.y),new bs(Y.x+Y.width,Y.y+Y.height));if(Q.$62l===w&&Q.points.length>0)return r(Q,F),!0}}}return!1},addShapePoint:function(J,R,h){var L=this,q=L.gv,H=q.dm();if(H.beginTransaction(),0===arguments.length&&(J=L._shape||L._edge,R=L._hoverSegmentIndex,h=L._lp),J instanceof m||J instanceof v){var T=el(J,q.getDataUI(J),R);if(!isNaN(R)&&h&&!isNaN(T)){var Z=h;if(J instanceof m){var o=J.p(),D=J.getRotation(),n=J.toSegments();n&&n.size()||(n=bm(J.getPoints())),J.isClosePath()&&n.indexOf(5)<0&&(n=new e(n._as),n.add(5));var V=n.get(R),C="addPoint",M="removePointAt";if(2===V||1===V){var p={x:Z.x,y:Z.y};n.add(V,R),p=om(o,p.x-o.x,p.y-o.y,-D),J[C](p,T+1)}else if(3===V){var l=J.getPoints(),c=l.get(T),$=l.get(T+2),p={x:Z.x,y:Z.y};p=om(o,p.x-o.x,p.y-o.y,-D);var Q=ts(c,p),I=ts(p,$);n.removeAt(R),n.add(3,R),n.add(3,R),J.setPoint(T+1,p),J[C](I,T+2),J[C](Q,T+1)}else if(4===V){var l=J.getPoints(),c=l.get(T),$=l.get(T+3),p={x:Z.x,y:Z.y};p=om(o,p.x-o.x,p.y-o.y,-D);var Q=te(c,p),I=Kf(c,p),b=te(p,$),N=Kf(p,$);n.removeAt(R),n.add(4,R),n.add(4,R),J[M](T+1),J[M](T+1),J[C](p,T+1),J[C](N,T+2),J[C](b,T+2),J[C](I,T+1),J[C](Q,T+1)}else if(5===V){var p={x:Z.x,y:Z.y};n.add(2,R),p=om(o,p.x-o.x,p.y-o.y,-D),J[C](p,T+1)}J.isClosePath()&&n.remove(5),J.setSegments(n);var s=J.getWidth(),P=J.getHeight(),S=J.p().x-s/2,A=J.p().y-P/2;S-=o.x,A-=o.y;var g=Pd(J,{x:S,y:A,width:s,height:P},D,o);J.p(g.x,g.y)}else if(J instanceof v){if("points"!==J.s("edge.type"))return H.endTransaction(),void 0;var l=J.s("edge.points");n=J.s("edge.segments"),l=Dh(q.getDataUI(J),l),n&&n.size()||(n=bm(l)),n=new e(n._as.slice(0)),l=new e(l._as.slice(0));var V=n.get(R);if(2===V||1===V){var p={x:Z.x,y:Z.y};n.add(V,R),l.add(p,T+1)}else if(3===V){var c=l.get(T),$=l.get(T+2),p={x:Z.x,y:Z.y},Q=ts(c,p),I=ts(p,$);n.removeAt(R),n.add(3,R),n.add(3,R),l.set(T+1,p),l.add(I,T+2),l.add(Q,T+1)}else if(4===V){var c=l.get(T),$=l.get(T+3),p={x:Z.x,y:Z.y},Q=te(c,p),I=Kf(c,p),b=te(p,$),N=Kf(p,$);n.removeAt(R),n.add(4,R),n.add(4,R),l.removeAt(T+1),l.removeAt(T+1),l.add(p,T+1),l.add(N,T+2),l.add(b,T+2),l.add(I,T+1),l.add(Q,T+1)}J.s("edge.points",os(l)),J.s("edge.segments",n)}}}H.endTransaction()},removeShapePoint:function(U,i){var M=this,C="removeAt",T=M.gv,o=T.dm();if(o.beginTransaction(),0===arguments.length&&(U=M._shape||M._edge,i=M._removePointIndex),i>=0&&(U instanceof m||U instanceof v)){var Q=gs(U,M.gv.getDataUI(U),i),h=i;if(U instanceof m){var V=U.p(),H=U.toSegments();H&&H.size()||(H=bm(U.getPoints()));var x=H.get(Q),d="removePointAt";if(1===x&&0===h)if(U.getPoints().size()>1){var a=H.get(Q+1);H[C](Q+1),3===a?U[d](h+1):4===a&&(U[d](h+2),U[d](h+1)),U[d](h)}else U.dm().remove(U);else 2===x||1===x?(H[C](Q),U[d](h)):3===x?(H[C](Q),U[d](h),U[d](h-1)):4===x&&(H[C](Q),U[d](h),U[d](h-1),U[d](h-2));U.setSegments(H);var Y=U.getWidth(),z=U.getHeight(),k=U.p().x-Y/2,$=U.p().y-z/2;k-=V.x,$-=V.y;var t=Pd(U,{x:k,y:$,width:Y,height:z},U.getRotation(),V);U.p(t.x,t.y)}else if(U instanceof v){if("points"!==U.s("edge.type"))return o.endTransaction(),void 0;var J=U.s("edge.points");if(H=U.s("edge.segments"),J&&(J=Dh(M.gv.getDataUI(U),J),H&&H.size()||(H=bm(J))),0===i||i===J.size()-1)return o.endTransaction(),void 0;H=new e(H._as.slice(0)),J=new e(J._as.slice(0));var x=H.get(Q);2===x||1===x?(H[C](Q),J[C](h)):3===x?(H[C](Q),J[C](h),J[C](h-1)):4===x&&(H[C](Q),J[C](h),J[C](h-1),J[C](h-2)),U.s("edge.segments",H),U.s("edge.points",os(J))}}o.endTransaction()},changeShapeSegment:function(M,X,P){var t=this,p=t.gv,E=p.dm();if(E.beginTransaction(),1!==arguments.length||isNaN(M)||(P=M,M=t._shape||t._edge,X=t._hoverSegmentIndex),M instanceof m||M instanceof v){var D=el(M,t.gv.getDataUI(M),X);if(!isNaN(X)&&!isNaN(D))if(M instanceof m){var z=M.p(),I=M.toSegments();I&&I.size()||(I=bm(M.getPoints()));var w=I.get(X),j=M.toPoints();if(1===P||2===P)1===w||2===w?I.set(X,P):3===w?(I.set(X,P),j.removeAt(D+1)):4===w&&(I.set(X,P),j.removeAt(D+1),j.removeAt(D+1));else if(3===P){var $=function(){var L=j.get(D),J=j.get(D+1),f=ts(L,J);I.set(X,3),j.add(f,D+1)};2===w||1===w?$():4===w&&(j.removeAt(D+1),j.removeAt(D+1),$())}else if(4===P){var S=function(){var U=j.get(D),r=j.get(D+1),c=te(U,r),G=Kf(U,r);I.set(X,4),j.add(c,D+1),j.add(G,D+2)};2===w||1===w?S():3===w&&(j.removeAt(D+1),S())}M.setSegments(I),M.setPoints(j);var B=M.getWidth(),J=M.getHeight(),x=M.p().x-B/2,d=M.p().y-J/2;x-=z.x,d-=z.y;var b=new Pd(M,{x:x,y:d,width:B,height:J},M.getRotation(),z);M.p(b.x,b.y)}else if(M instanceof v){if("points"!==M.s("edge.type"))return E.endTransaction(),void 0;var j=M.s("edge.points");I=M.s("edge.segments"),j&&(j=Dh(t.gv.getDataUI(M),j),I&&I.size()||(I=bm(j))),I=new e(I._as.slice(0)),j=new e(j._as.slice(0));var w=I.get(X);if(1===P||2===P)1===w||2===w?I.set(X,P):3===w?(I.set(X,P),j.removeAt(D+1)):4===w&&(I.set(X,P),j.removeAt(D+1),j.removeAt(D+1));else if(3===P){var $=function(){var $=j.get(D),H=j.get(D+1),A=ts($,H);I.set(X,3),j.add(A,D+1)};2===w||1===w?$():4===w&&(j.removeAt(D+1),j.removeAt(D+1),$())}else if(4===P){var S=function(){var p=j.get(D),B=j.get(D+1),b=te(p,B),c=Kf(p,B);I.set(X,4),j.add(b,D+1),j.add(c,D+2)};2===w||1===w?S():3===w&&(j.removeAt(D+1),S())}M.s("edge.points",os(j)),M.s("edge.segments",I)}}E.endTransaction()},getDefaultSegments:function($){var Q=this.gv,J=Q.getDataUI($);if($ instanceof v){var t=$.s("edge.points");return t=Dh(J,t),bm(t)}if($ instanceof m){var t=$.getPoints(),k=$.getSegments();return k&&k.size()>0?k:bm(t)}},$43l:function(A){var O=this;A&&(O.$5l=1),O._68I=1,O._42()},_42:function(){var d=this;if(d._68I){delete d._68I;var f=d.gv,y=d.$5l,Y=f.getZoom(),w=f.getEditPointSize(),q=w/2,$=new e,G=d._view,M=d._edge,H=d._shape,n=G.getContext("2d"),P=f.tx(),I=f.ty(),T=j,K=f.getEditPointBackground(),i=f.getControlPointBackground(),h=f.getControlPointBorderColor(),u=f.getEditPointBorderColor(),Z=f.getEditRectBorderColor(),N=f.getDirectionLineColor(),x=f.getSegmentHoverColor(),C=f.getSnapPointBorderColor(),z=f.getJoinPointBackground(),t=f.getJoinPointBorderColor(),D=f.getSegmentHoverWidth(),J=[5,5],p=f.getEditRectBorderStyle();Rb(f,function(T){f.isSelected(T)&&f.isVisible(T)&&$.add(T)}),n.clearRect(0,0,V(G.width),V(G.height)),n.save(),B.translateAndScale(n,P,I,1);var _=j,Q={x:0,y:0,width:0,height:0},c=0,A=0,b=0,O=0,g=0,a=0,Zn=0,Sd=0,jd=0,Kb=0,Od=[];if(y?(delete d.$6l,delete d.$8l,delete d.$7l,delete d.$16l,delete d.$23l):(_=d.$6l,T=d.$7l),delete d.$68l,delete d.$69l,delete d.$71l,delete d.$70l,delete d.$82l,delete d.$83l,delete d._pointElevationHelperPoint,delete d.$90l,delete d.$91l,delete d.$75l,delete d.$74l,$.each(function(D){var Z=f.getDataUI(D);if(Z){var d=Z._55O;if(f.isEditable(D))d._56O&&D instanceof X&&A++,Od.push(D),d._42O&&D instanceof X&&c++,f.isHelperEditable(D,"host")&&O++,f.isHelperEditable(D,"parent")&&b++,f.isHelperEditable(D,"remove")&&g++,f.isHelperEditable(D,"edge")&&a++,f.isHelperEditable(D,"source")&&Zn++,f.isHelperEditable(D,"target")&&Sd++,f.isHelperEditable(D,"elevation")&&jd++,f.isHelperEditable(D,"tall")&&Kb++;else if(D instanceof r&&D.isExpanded()){var J=!0,F=f.getEditableFunc();F&&(J=F(D)),J&&(f.isHelperEditable(D,"host")&&O++,f.isHelperEditable(D,"parent")&&b++,f.isHelperEditable(D,"remove")&&g++,f.isHelperEditable(D,"edge")&&a++,f.isHelperEditable(D,"source")&&Zn++,f.isHelperEditable(D,"target")&&Sd++,f.isHelperEditable(D,"elevation")&&jd++,f.isHelperEditable(D,"tall")&&Kb++,Od.push(D))}}}),n.beginPath(),n.lineWidth=1,n.strokeStyle=f.getNodeBorderColor(),Od.forEach(function(B){var g=f.getDataUI(B),i=g._55O;if(y)if(T==j&&(T=B instanceof v?0:B instanceof r&&B.isExpanded()?0:B.getRotation(),d.$7l=T),_==j){var t,P,b;if(B instanceof r&&B.isExpanded()||B instanceof v){var D=f.getDataUIBounds(B);P=D.width,b=D.height,t={x:D.x+P/2,y:D.y+b/2}}else t=B.p(),P=B.getWidth(),b=B.getHeight();_={x:t.x,y:t.y,width:0,height:0},Q.x=t.x-P/2,Q.y=t.y-b/2,Q.width=P,Q.height=b,_=L(_,Q)}else{var t,P,b,V,R=_.x+_.width/2,h=_.y+_.height/2,p={x:R,y:h};if(B instanceof r&&B.isExpanded()||B instanceof v){V=0;var D=f.getDataUIBounds(B);P=D.width,b=D.height,t={x:D.x+P/2,y:D.y+b/2}}else t=B.p(),P=B.getWidth(),b=B.getHeight(),V=B.getRotation();var I={x:t.x-P/2,y:t.y-b/2,width:P,height:b},s={x:I.x,y:I.y},$={x:I.x+I.width,y:I.y},u={x:I.x,y:I.y+I.height},Z={x:I.x+I.width,y:I.y+I.height},s=om(t,s.x-t.x,s.y-t.y,V),u=om(t,u.x-t.x,u.y-t.y,V),Z=om(t,Z.x-t.x,Z.y-t.y,V),$=om(t,$.x-t.x,$.y-t.y,V),q=-T,M=om(p,s.x-p.x,s.y-p.y,q),A=om(p,$.x-p.x,$.y-p.y,q),z=om(p,u.x-p.x,u.y-p.y,q),O=om(p,Z.x-p.x,Z.y-p.y,q),U=o([M,A,z,O]);_=L(_,U),_.x-=R,_.y-=h;var l=Pd(j,_,T,p);_.x=l.x-_.width/2,_.y=l.y-_.height/2}if(c>1&&f.isEditable(B)&&f.isRectEditable(B)&&B instanceof X){var S=B.getRect(),x=i.$45l,C=Qb(x[0],Y),G=Qb(x[2],Y),H=Qb(x[4],Y),J=Qb(x[6],Y);B.getRotation()?(n.moveTo(C.x,C.y),n.lineTo(G.x,G.y),n.lineTo(H.x,H.y),n.lineTo(J.x,J.y),n.lineTo(C.x,C.y)):n.rect(S.x*Y,S.y*Y,S.width*Y,S.height*Y)}}),n.stroke(),_){d.$6l=R(_),E(_,f.getEditRectPadding()/Y);var lg={x:_.x+_.width/2,y:_.y+_.height/2},Eh=wp(lg,_.width,_.height,T),Dr=Eh[0],Wl=Eh[1],nf=Eh[2],Xd=Eh[3],dr=Eh[4],Op=Eh[5],np=Eh[6],Km=Eh[7];if(Dr=Qb(Eh[0],Y),Wl=Qb(Eh[1],Y),nf=Qb(Eh[2],Y),Xd=Qb(Eh[3],Y),dr=Qb(Eh[4],Y),Op=Qb(Eh[5],Y),np=Qb(Eh[6],Y),Km=Qb(Eh[7],Y),d.$8l=_,c>0&&(d.$16l=[Dr,dr,Wl,Op,Xd,np,nf,Km],n.beginPath(),n.lineWidth=1,n.strokeStyle=Z,"dashed"===p&&n.setLineDash&&n.setLineDash(J),n.moveTo(Dr.x,Dr.y),n.lineTo(Wl.x,Wl.y),n.lineTo(Xd.x,Xd.y),n.lineTo(nf.x,nf.y),n.lineTo(Dr.x,Dr.y),n.stroke(),"dashed"===p&&n.setLineDash&&n.setLineDash([])),n.beginPath(),n.lineWidth=1,n.fillStyle=K,n.strokeStyle=u,c>0){var li=Op.x-Km.x,zi=Op.y-Km.y,Nk=l(li*li+zi*zi),Nh=dr.x-np.x,Aq=dr.y-np.y,Vf=l(Nh*Nh+Aq*Aq),op=2*w;if(f.isDirectionEditable&&1===Od.length){var _b=Od[0],dc=f.getDataUI(_b),xf=dc._55O,Ue=f.isDirectionEditable.bind(f);if(xf._42O){var gf,Fg,ie,Nq;Ue(_b,"northwest")&&(gf=!0,n.rect(Dr.x-q,Dr.y-q,w,w)),Ue(_b,"northeast")&&(Fg=!0,n.rect(Wl.x-q,Wl.y-q,w,w)),Ue(_b,"southwest")&&(ie=!0,n.rect(nf.x-q,nf.y-q,w,w)),Ue(_b,"southeast")&&(Nq=!0,n.rect(Xd.x-q,Xd.y-q,w,w)),Ue(_b,"north")&&(gf&&Fg?Nk>op&&n.rect(dr.x-q,dr.y-q,w,w):n.rect(dr.x-q,dr.y-q,w,w)),Ue(_b,"south")&&(Nq&&ie?Nk>op&&n.rect(np.x-q,np.y-q,w,w):n.rect(np.x-q,np.y-q,w,w)),Ue(_b,"west")&&(ie&&gf?Vf>op&&n.rect(Km.x-q,Km.y-q,w,w):n.rect(Km.x-q,Km.y-q,w,w)),Ue(_b,"east")&&(Nq&&Fg?Vf>op&&n.rect(Op.x-q,Op.y-q,w,w):n.rect(Op.x-q,Op.y-q,w,w))}}else Nk>op&&(n.rect(dr.x-q,dr.y-q,w,w),n.rect(np.x-q,np.y-q,w,w)),Vf>op&&(n.rect(Op.x-q,Op.y-q,w,w),n.rect(Km.x-q,Km.y-q,w,w)),n.rect(Dr.x-q,Dr.y-q,w,w),n.rect(Wl.x-q,Wl.y-q,w,w),n.rect(nf.x-q,nf.y-q,w,w),n.rect(Xd.x-q,Xd.y-q,w,w)}if(A>0){var dn=d.$23l=om(dr,0,2*-w,T);n.moveTo(dn.x+q,dn.y),n.arc(dn.x,dn.y,q,0,S,!1)}n.fill(),n.stroke(),d.$40l&&d.$44l(n,_,T);var xm,Ip,Vk=f.getLeftTopHelpers(),Vi=f.getRightTopHelpers(),ds=f.getLeftBottomHelpers(),Ci=f.getRightBottomHelpers(),qs=f.getEdgeHelpers(),qk=f.getEditHelperSize(),zg=qk/2,te=function(z,R,l,o){"leftTop"===R?(xm=_.x*Y-qk-q-("h"===o?l*(qk+q):0)-1,Ip=_.y*Y-qk-q-("v"===o?l*(qk+q):0)-1):"rightTop"===R?(xm=(_.x+_.width)*Y+q+("h"===o?l*(qk+q):0)+1,Ip=_.y*Y-qk-q-("v"===o?l*(qk+q):0)-1):"leftBottom"===R?(xm=_.x*Y-qk-q-("h"===o?l*(qk+q):0)-1,Ip=(_.y+_.height)*Y+q+("v"===o?l*(qk+q):0)+1):"rightBottom"===R&&(xm=(_.x+_.width)*Y+q+("h"===o?l*(qk+q):0)+1,Ip=(_.y+_.height)*Y+q+("v"===o?l*(qk+q):0)+1);var E=xm+zg,Z=Ip+zg,Q=(_.x+_.width/2)*Y,F=(_.y+_.height/2)*Y,J=om({x:Q,y:F},E-Q,Z-F,T);if("host"===z){if(O>0)return d.$77l(n,T,J),!0}else if("edge"===z){if(a>0)return d.$80l(n,T,J),!0}else if("remove"===z){if(g>0)return Od&&1===Od.length&&Od[0]instanceof v?d.$81l(n,T,{x:Q+qk/2+5,y:F}):d.$81l(n,T,J),!0}else if("parent"===z){if(b>0)return Od&&1===Od.length&&Od[0]instanceof v?d.$76l(n,T,{x:Q-qk/2-5,y:F}):d.$76l(n,T,J),!0}else if("elevation"===z){if(jd>0)return d.$85l(n,T,J),!0}else if("tall"===z){if(Kb>0)return d.$86l(n,T,J),!0}else if("source"===z||"target"===z){var W=Od[0],I=f.getDataUI(W),w=Xc(I,!0),G=w[0],X=w[1];if(Zn&&"source"===z)return d.$84l(n,_,G,!0,W.isLooped(),R,l,o),!0;if(Sd&&"target"===z)return d.$84l(n,_,X,!1,W.isLooped(),R,l,o),!0}};if(Vk&&Vk.length>0){var Ph=0;Vk.forEach(function(L){te(L,"leftTop",Ph,f.getLeftTopHelpersAlign()||"h")&&Ph++})}if(Vi&&Vi.length>0){var Ph=0;Vi.forEach(function(n){te(n,"rightTop",Ph,f.getRightTopHelpersAlign()||"h")&&Ph++})}if(ds&&ds.length>0){var Ph=0;ds.forEach(function(Y){te(Y,"leftBottom",Ph,f.getLeftBottomHelpersAlign()||"h")&&Ph++})}if(Ci&&Ci.length>0){var Ph=0;Ci.forEach(function(G){te(G,"rightBottom",Ph,f.getRightBottomHelpersAlign()||"h")&&Ph++})}if(qs&&qs.length>0&&((Zn||Sd)&&Od&&1===Od.length&&Od[0]instanceof v?!0:!1)){var Ph=0;qs.forEach(function(I){te(I,"edge",Ph,"h")&&Ph++})}if(d.$72l){var Hr,Ob=d.$67l,In=d.$68l,de=d.$69l,zl=(d.$71l,d.$70l),$m=d.$82l,qq=d.$83l;if(1===Ob?Hr=In:2===Ob?Hr=de:3===Ob?Hr=zl:5===Ob?Hr=$m:6===Ob&&(Hr=qq),Hr){var Gp=f.lp(d.$72l),pk=f.getDataAt(d.$72l);if(pk&&pk instanceof X){var Vp,dg,Te;if(d.$73l=pk,1===Ob)if(pk instanceof F.Grid)Vp=d.$75l=fe(pk,Gp);else if(pk instanceof F.Shape){Te=d.$74l=Qc(pk,Gp);var ed=pk.getPoints();if(Te){var ql=Te.attachIndex,ok=el(pk,f.getDataUI(pk),ql)+1,bl=ok+1>=ed.size()?0:ok+1,Jb=ed.get(ok),Or=ed.get(bl),Jh=pk.p(),mh=pk.getRotation();Jb=om(Jh,Jb.x-Jh.x,Jb.y-Jh.y,mh),Or=om(Jh,Or.x-Jh.x,Or.y-Jh.y,mh),n.beginPath(),n.strokeStyle=x,n.lineWidth=D,n.moveTo(Jb.x*Y,Jb.y*Y),n.lineTo(Or.x*Y,Or.y*Y),n.stroke()}}Vp?dg=Vp.rect:(dg=s.clone(f.getDataUIBounds(pk)),s.grow(dg,2)),n.beginPath(),n.rect(dg.x*Y,dg.y*Y,dg.width*Y,dg.height*Y),n.strokeStyle=1===Ob||4===Ob||6===Ob?W:k,n.lineWidth=2,n.setLineDash&&n.setLineDash([8,8]),n.stroke()}else delete d.$73l;Gp.x=Gp.x*Y,Gp.y=Gp.y*Y;var lc=Rh(Hr.x,Hr.y,Gp.x,Gp.y),gj=om(Hr,Gp.x-Hr.x,Gp.y-Hr.y,-lc),ff=gj.x-Hr.x;n.save(),n.translate(Hr.x,Hr.y),n.rotate(lc),U.width=ff,U.height=40;var xg=k;(1===Ob||4===Ob||6===Ob)&&(xg=W),U.comps[0].gradientColor=xg,s.drawImage(n,U,0,-20,ff,40),n.restore()}}}if($.each(function(W){var y=f.getDataUI(W);if(y){var p,c,o=y._55O,F=y._78o;if(o&&o._43O&&W instanceof m?(p=o.$15l,c=W.getSegments(),c&&c.size()||(c=bm(p)),W.isClosePath()&&c.indexOf(5)<0&&(c=new e(c._as),c.add(5))):o&&F&&o._43O&&(p=W.s("edge.points"),c=W.s("edge.segments"),p=Dh(y,p),c&&c.size()||(c=bm(p)),p&&(p=p._as)),p&&c){var Q=0,E=c.size(),T=d._hoverSegmentIndex;p=p.slice(0);for(var I=0;I<p.length;I++)p[I]=Qb(p[I],Y);n.beginPath(),n.strokeStyle=N,n.lineWidth=1,Q=0;for(var I=0;E>I;I++){var v=c.get(I);if(1===v||2===v)Q++;else if(3===v){var u=p[Q-1],w=p[Q],X=p[Q+1];n.moveTo(u.x,u.y),n.lineTo(w.x,w.y),n.lineTo(X.x,X.y),Q+=2}else if(4===v){var u=p[Q-1],L=p[Q],G=p[Q+1],X=p[Q+2];n.moveTo(u.x,u.y),n.lineTo(L.x,L.y),n.moveTo(G.x,G.y),n.lineTo(X.x,X.y),Q+=3}}if(n.stroke(),H===W||M===W&&"points"===M.s("edge.type")){n.beginPath(),Q=0,n.strokeStyle=x,n.lineWidth=D;for(var I=0;E>I;I++){var v=c.get(I);if(1===v||2===v){if(T===I){var u=p[Q-1],X=p[Q];n.moveTo(u.x,u.y),n.lineTo(X.x,X.y);break}Q++}else if(3===v){if(T===I){var u=p[Q-1],w=p[Q],X=p[Q+1];n.moveTo(u.x,u.y),n.quadraticCurveTo(w.x,w.y,X.x,X.y);break}Q+=2}else if(4===v){if(T===I){var u=p[Q-1],L=p[Q],G=p[Q+1],X=p[Q+2];n.moveTo(u.x,u.y),n.bezierCurveTo(L.x,L.y,G.x,G.y,X.x,X.y);break}Q+=3}else if(5===v&&T===I){var u=p[Q-1],X=p[0];n.moveTo(u.x,u.y),n.lineTo(X.x,X.y);break}}n.stroke()}n.beginPath(),Q=0,n.strokeStyle=t,n.lineWidth=1,n.fillStyle=z;for(var I=0;E>I;I++){var v=c.get(I);if(1===v||2===v){var X=p[Q];n.moveTo(X.x+q,X.y),n.arc(X.x,X.y,q,0,S,!0),Q++}else if(3===v){var X=p[Q+1];n.moveTo(X.x+q,X.y),n.arc(X.x,X.y,q,0,S,!0),Q+=2}else if(4===v){var X=p[Q+2];n.moveTo(X.x+q,X.y),n.arc(X.x,X.y,q,0,S,!0),Q+=3}}n.fill(),n.stroke(),n.beginPath(),Q=0,n.strokeStyle=h,n.lineWidth=1,n.fillStyle=i;for(var I=0;E>I;I++){var v=c.get(I);if(1===v||2===v)Q++;else if(3===v){var w=p[Q];n.moveTo(w.x+q,w.y),n.arc(w.x,w.y,q,0,S,!0),Q+=2}else if(4===v){var L=p[Q],G=p[Q+1];n.moveTo(L.x+q,L.y),n.arc(L.x,L.y,q,0,S,!0),n.moveTo(G.x+q,G.y),n.arc(G.x,G.y,q,0,S,!0),Q+=3}}if(n.fill(),n.stroke(),n.beginPath(),Q=0,n.strokeStyle=C,n.lineWidth=2,(H===W||M===W)&&d.$9l!=j){var X=p[d.$9l];n.moveTo(X.x+q,X.y),n.arc(X.x,X.y,q,0,S,!0),n.stroke()}}}}),d.$87l&&f.sm().contains(d.$87l)){var rk,ml=d.$87l,Xm=d.$88l,qk=f.getEditHelperSize(),zg=qk/2;if(f.isHelperEditable(ml,"pointElevation"))if(ml instanceof m){var Zf=ml.getPosition();rk=s.clone(ml.getPoints().get(Xm)),rk=om({x:Zf.x,y:Zf.y},rk.x-Zf.x,rk.y-Zf.y,ml.getRotation()),rk.x*=Y,rk.y*=Y,n.translate(rk.x,rk.y),s.drawImage(n,s.getImage("xeditinteractor_elevationIcon"),zg,-zg,qk,qk),n.translate(-rk.x,-rk.y),d._pointElevationHelperPoint={x:rk.x+qk,y:rk.y}}else if(ml instanceof v){var ns=Dh(f.getDataUI(ml),ml.s("edge.points")),rk=s.clone(ns.get(Xm));rk.x*=Y,rk.y*=Y,n.translate(rk.x,rk.y),s.drawImage(n,s.getImage("xeditinteractor_elevationIcon"),zg,-zg,qk,qk),n.translate(-rk.x,-rk.y),d._pointElevationHelperPoint={x:rk.x+qk,y:rk.y}}}n.restore(),d.$5l=0}},$89l:function(n,V,x,i){n.save();var O=this,Q=O.gv,J=Q.getEditHelperSize(),I=J/2;n.beginPath(),n.translate(x.x,x.y),n.rotate(V),s.drawImage(n,i,-I,-I,J,J),n.restore()},$85l:function(l,r,o){var $=this;$.$90l=o,$.$89l(l,r,o,s.getImage("xeditinteractor_elevationIcon"))},$86l:function(f,V,$){var D=this;D.$91l=$,D.$89l(f,V,$,s.getImage("xeditinteractor_tallIcon"))},$77l:function(V,v,N){var e=this;e.$68l=N,e.$89l(V,v,N,s.getImage("xeditinteractor_hostIcon"))},$80l:function(K,y,A){var k=this;k.$70l=A,k.$89l(K,y,A,s.getImage("xeditinteractor_edgeIcon"))},$81l:function(Z,d,P){var J=this;J.$71l=P,J.$89l(Z,d,P,s.getImage("xeditinteractor_removeIcon"))},$76l:function(Q,t,K){var O=this;O.$69l=K,O.$89l(Q,t,K,s.getImage("xeditinteractor_parentIcon"))},$84l:function(S,J,z,d,K){var U,a=this,E=a.gv,Q=E.getZoom(),A=E.getEditHelperSize(),F=A/2;z.x*=Q,z.y*=Q,K&&(d?z.x-=F+5:z.x+=F+5),z.y-=A-2,d?(a.$82l=z,U=s.getImage("xeditinteractor_sourceIcon")):(a.$83l=z,U=s.getImage("xeditinteractor_targetIcon")),S.beginPath(),S.translate(z.x,z.y),s.drawImage(S,U,-F,-F,A,A),S.translate(-z.x,-z.y)},$44l:function(Y,L,X){Y.save();var b=this.gv.getZoom(),g=l(C(L.width,2)+C(L.height,2))/2*b+10,h=g,m=h+8,f=h+18,a=X,H=L.x+L.width/2,u=L.y+L.height/2;Y.translate(H*b,u*b),Y.beginPath(),Y.strokeStyle="rgb(150, 150, 150)";for(var E=0,o=0,r=0,B=0,N=0,V=0;360>V;V++)E=V*q/180,0===V%5&&(o=Q(E)*h,r=d(E)*h,B=Q(E)*m,N=d(E)*m,Y.moveTo(o,r),Y.lineTo(B,N)),0===V%45&&(o=Q(E)*h,r=d(E)*h,B=Q(E)*f,N=d(E)*f,Y.moveTo(o,r),Y.lineTo(B,N));Y.stroke(),Y.beginPath(),Y.rotate(-K),Y.beginPath(),Y.fillStyle="rgba(255, 0, 0, 0.1)",Y.strokeStyle="rgb(157, 157, 157)",Y.moveTo(0,0),Y.arc(0,0,f,0,X,!1),Y.fill(),Y.beginPath(),Y.moveTo(0+f,0),Y.arc(0,0,f,0,X,!1),Y.stroke(),Y.rotate(K),Y.font="bold 12px Verdana, Arial";var F=20*d(a),x=20*Q(a),v=t(180*a/q)+"°";Y.textAlign="center",Y.textBaseline="middle",Y.beginPath();var k=Y.measureText("365.°").width;Y.fillStyle="white",Y.rect(F-k/2,-x-10,k,20),Y.fill(),Y.beginPath(),Y.fillStyle="rgb(79,79,79)",Y.fillText(v,F,-x),Y.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);